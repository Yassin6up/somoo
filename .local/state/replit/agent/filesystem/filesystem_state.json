{"file_contents":{"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { insertFreelancerSchema, insertProductOwnerSchema, insertCampaignSchema, insertOrderSchema, type Campaign, postComments } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport OpenAI from \"openai\";\nimport multer from \"multer\";\nimport { writeFile, mkdir } from \"fs/promises\";\nimport { join } from \"path\";\nimport { existsSync } from \"fs\";\nimport bcrypt from \"bcrypt\";\nimport { generateToken, authMiddleware, requireRole, type AuthRequest } from \"./middleware/auth\";\nimport { db } from \"./db\";\nimport { eq } from \"drizzle-orm\";\n\n// Initialize OpenAI client using Replit AI Integrations\n// This provides OpenAI-compatible API access without requiring your own OpenAI API key\n// Charges are billed to your Replit credits\nconst openai = new OpenAI({\n  baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n  apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY,\n});\n\n// Configure multer for file uploads\nconst upload = multer({ storage: multer.memoryStorage() });\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  \n  // ============================================\n  // FREELANCER ROUTES\n  // ============================================\n\n  // Create freelancer account\n  app.post(\"/api/freelancers\", async (req, res) => {\n    try {\n      const validatedData = insertFreelancerSchema.parse(req.body);\n\n      // Check if email already exists\n      const existingByEmail = await storage.getFreelancerByEmail(validatedData.email);\n      if (existingByEmail) {\n        return res.status(400).json({ error: \"البريد الإلكتروني مستخدم بالفعل\" });\n      }\n\n      // Check if username already exists\n      const existingByUsername = await storage.getFreelancerByUsername(validatedData.username);\n      if (existingByUsername) {\n        return res.status(400).json({ error: \"اسم المستخدم مستخدم بالفعل\" });\n      }\n\n      // Hash password before storing\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      const freelancerData = { ...validatedData, password: hashedPassword };\n\n      const freelancer = await storage.createFreelancer(freelancerData);\n      \n      // Generate JWT token\n      const token = generateToken({\n        userId: freelancer.id,\n        userType: \"freelancer\",\n        email: freelancer.email,\n      });\n      \n      // Don't send password back to client\n      const { password, ...freelancerWithoutPassword } = freelancer;\n      \n      res.status(201).json({ \n        user: freelancerWithoutPassword,\n        token,\n        message: \"تم إنشاء الحساب بنجاح\"\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحساب\" });\n    }\n  });\n\n  // Get all freelancers\n  app.get(\"/api/freelancers\", async (req, res) => {\n    try {\n      const freelancers = await storage.getAllFreelancers();\n      \n      // Remove passwords from response\n      const freelancersWithoutPasswords = freelancers.map(({ password, ...f }) => f);\n      \n      res.json(freelancersWithoutPasswords);\n    } catch (error) {\n      console.error(\"Error fetching freelancers:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Accept instructions (protected) - MUST be before :id route\n  app.patch(\"/api/freelancers/accept-instructions\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const userId = req.user?.userId;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const updatedFreelancer = await storage.updateFreelancer(userId, { acceptedInstructions: true });\n\n      if (!updatedFreelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      res.json({ message: \"تم قبول التعليمات بنجاح\", acceptedInstructions: true });\n    } catch (error) {\n      console.error(\"Error accepting instructions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حفظ الموافقة\" });\n    }\n  });\n\n  // Get freelancer by ID\n  app.get(\"/api/freelancers/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const freelancer = await storage.getFreelancer(id);\n\n      if (!freelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      const { password, ...freelancerWithoutPassword } = freelancer;\n      res.json(freelancerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error fetching freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Update freelancer (protected)\n  app.patch(\"/api/freelancers/:id\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      // Verify user can only update their own profile\n      if (req.user?.userId !== id) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا الحساب\" });\n      }\n\n      // Don't allow password updates through this endpoint\n      delete updates.password;\n      delete updates.id;\n\n      const updatedFreelancer = await storage.updateFreelancer(id, updates);\n\n      if (!updatedFreelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      const { password, ...freelancerWithoutPassword } = updatedFreelancer;\n      res.json(freelancerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error updating freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التحديث\" });\n    }\n  });\n\n  // ============================================\n  // PRODUCT OWNER ROUTES\n  // ============================================\n\n  // Create product owner account\n  app.post(\"/api/product-owners\", async (req, res) => {\n    try {\n      const validatedData = insertProductOwnerSchema.parse(req.body);\n\n      // Check if email already exists\n      const existingByEmail = await storage.getProductOwnerByEmail(validatedData.email);\n      if (existingByEmail) {\n        return res.status(400).json({ error: \"البريد الإلكتروني مستخدم بالفعل\" });\n      }\n\n      // Hash password before storing\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      const ownerData = { ...validatedData, password: hashedPassword };\n\n      const productOwner = await storage.createProductOwner(ownerData);\n      \n      // Generate JWT token\n      const token = generateToken({\n        userId: productOwner.id,\n        userType: \"product_owner\",\n        email: productOwner.email,\n      });\n      \n      // Don't send password back to client\n      const { password, ...ownerWithoutPassword } = productOwner;\n      \n      res.status(201).json({ \n        user: ownerWithoutPassword,\n        token,\n        message: \"تم إنشاء الحساب بنجاح\"\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحساب\" });\n    }\n  });\n\n  // Get all product owners\n  app.get(\"/api/product-owners\", async (req, res) => {\n    try {\n      const owners = await storage.getAllProductOwners();\n      \n      // Remove passwords from response\n      const ownersWithoutPasswords = owners.map(({ password, ...o }) => o);\n      \n      res.json(ownersWithoutPasswords);\n    } catch (error) {\n      console.error(\"Error fetching product owners:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Accept instructions (protected) - MUST be before :id route\n  app.patch(\"/api/product-owners/accept-instructions\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const userId = req.user?.userId;\n      \n      if (!userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const updatedOwner = await storage.updateProductOwner(userId, { acceptedInstructions: true });\n\n      if (!updatedOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      res.json({ message: \"تم قبول الشروط والأحكام بنجاح\", acceptedInstructions: true });\n    } catch (error) {\n      console.error(\"Error accepting instructions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حفظ الموافقة\" });\n    }\n  });\n\n  // Get product owner by ID\n  app.get(\"/api/product-owners/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const owner = await storage.getProductOwner(id);\n\n      if (!owner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      const { password, ...ownerWithoutPassword } = owner;\n      res.json(ownerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error fetching product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Update product owner (protected)\n  app.patch(\"/api/product-owners/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      // Verify user can only update their own profile\n      if (req.user?.userId !== id) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا الحساب\" });\n      }\n\n      // Don't allow password updates through this endpoint\n      delete updates.password;\n      delete updates.id;\n\n      const updatedOwner = await storage.updateProductOwner(id, updates);\n\n      if (!updatedOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      const { password, ...ownerWithoutPassword } = updatedOwner;\n      res.json(ownerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error updating product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التحديث\" });\n    }\n  });\n\n  // ============================================\n  // AI SUGGESTIONS (OpenAI Integration)\n  // ============================================\n\n  // Generate AI suggestions for bio/description\n  app.post(\"/api/ai/suggestions\", async (req, res) => {\n    try {\n      const { text, type } = req.body;\n\n      if (!text || text.length < 10) {\n        return res.status(400).json({ error: \"النص قصير جدًا للحصول على اقتراحات\" });\n      }\n\n      let prompt = \"\";\n      if (type === \"freelancer-bio\") {\n        prompt = `أنت مساعد ذكي في منصة سُمُوّ، منصة عربية لربط المستقلين بأصحاب المنتجات. المستقل كتب الوصف التالي عن نفسه:\n\n\"${text}\"\n\nساعده في تحسين هذا الوصف ليكون أكثر احترافية وجاذبية للعملاء. اكتب نسخة محسّنة من الوصف بالعربية، في 2-3 جمل فقط، مع التركيز على الخبرة والمهارات والقيمة المضافة.`;\n      } else if (type === \"product-description\") {\n        prompt = `أنت مساعد ذكي في منصة سُمُوّ، منصة عربية لاختبار المنتجات الرقمية. صاحب المنتج كتب الوصف التالي عن منتجه:\n\n\"${text}\"\n\nساعده في تحسين هذا الوصف ليكون أكثر وضوحًا وجاذبية للمختبرين. اكتب نسخة محسّنة من الوصف بالعربية، في 2-3 جمل فقط، مع التركيز على الميزات الرئيسية والقيمة المضافة.`;\n      } else {\n        return res.status(400).json({ error: \"نوع الاقتراح غير صحيح\" });\n      }\n\n      // Using gpt-5 - the newest OpenAI model released August 7, 2025\n      const completion = await openai.chat.completions.create({\n        model: \"gpt-5\",\n        messages: [\n          {\n            role: \"system\",\n            content: \"أنت مساعد ذكي متخصص في كتابة أوصاف احترافية باللغة العربية. تجيب دائمًا بالعربية الفصحى الواضحة.\"\n          },\n          {\n            role: \"user\",\n            content: prompt\n          }\n        ],\n        max_completion_tokens: 200,\n      });\n\n      const suggestion = completion.choices[0]?.message?.content?.trim();\n\n      if (!suggestion) {\n        return res.status(500).json({ error: \"فشل في توليد الاقتراح\" });\n      }\n\n      res.json({ suggestion });\n    } catch (error) {\n      console.error(\"Error generating AI suggestion:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء توليد الاقتراح\" });\n    }\n  });\n\n  // ============================================\n  // FILE UPLOAD (Object Storage)\n  // ============================================\n\n  // Upload profile image or ID verification (public - used during signup)\n  // Security: File type and size validation enforced\n  app.post(\"/api/upload\", upload.single(\"file\"), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"لم يتم رفع أي ملف\" });\n      }\n\n      // Validate file size (max 5MB)\n      const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB in bytes\n      if (req.file.size > MAX_FILE_SIZE) {\n        return res.status(400).json({ error: \"حجم الملف كبير جداً. الحد الأقصى 5 ميجابايت\" });\n      }\n\n      // Validate file type (only images and PDFs)\n      const allowedMimeTypes = [\n        'image/jpeg',\n        'image/jpg',\n        'image/png',\n        'image/gif',\n        'image/webp',\n        'application/pdf'\n      ];\n      \n      if (!allowedMimeTypes.includes(req.file.mimetype)) {\n        return res.status(400).json({ error: \"نوع الملف غير مدعوم. يسمح فقط بالصور (JPEG, PNG, GIF, WebP) و PDF\" });\n      }\n\n      const { type } = req.body; // 'profile', 'verification', or 'group'\n      \n      if (type !== \"profile\" && type !== \"verification\" && type !== \"group\") {\n        return res.status(400).json({ error: \"نوع الملف غير صحيح\" });\n      }\n\n      // Create uploads directory if it doesn't exist\n      const uploadsDir = join(process.cwd(), \"uploads\", type);\n      if (!existsSync(uploadsDir)) {\n        await mkdir(uploadsDir, { recursive: true });\n      }\n\n      // Generate unique filename\n      const timestamp = Date.now();\n      const filename = `${timestamp}-${req.file.originalname}`;\n      const filePath = join(uploadsDir, filename);\n\n      // Save file\n      await writeFile(filePath, req.file.buffer);\n\n      // Return URL path\n      const fileUrl = `/uploads/${type}/${filename}`;\n\n      res.json({ url: fileUrl });\n    } catch (error) {\n      console.error(\"Error uploading file:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفع الملف\" });\n    }\n  });\n\n  // ============================================\n  // AUTHENTICATION ROUTES\n  // ============================================\n\n  // Login endpoint\n  app.post(\"/api/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ error: \"البريد الإلكتروني وكلمة المرور مطلوبان\" });\n      }\n\n      // Try to find freelancer first\n      let user = await storage.getFreelancerByEmail(email);\n      let userType: \"freelancer\" | \"product_owner\" = \"freelancer\";\n\n      // If not found, try product owner\n      if (!user) {\n        user = await storage.getProductOwnerByEmail(email);\n        userType = \"product_owner\";\n      }\n\n      // User not found\n      if (!user) {\n        return res.status(401).json({ error: \"البريد الإلكتروني أو كلمة المرور غير صحيحة\" });\n      }\n\n      // Verify password using bcrypt\n      const isPasswordValid = await bcrypt.compare(password, user.password);\n      if (!isPasswordValid) {\n        return res.status(401).json({ error: \"البريد الإلكتروني أو كلمة المرور غير صحيحة\" });\n      }\n\n      // Generate JWT token\n      const token = generateToken({\n        userId: user.id,\n        userType,\n        email: user.email,\n      });\n\n      // Don't send password back\n      const { password: _, ...userWithoutPassword } = user;\n\n      res.json({\n        user: userWithoutPassword,\n        userType,\n        token,\n        message: \"تم تسجيل الدخول بنجاح\"\n      });\n    } catch (error) {\n      console.error(\"Error during login:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسجيل الدخول\" });\n    }\n  });\n\n  // Change password endpoint\n  app.post(\"/api/auth/change-password\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { currentPassword, newPassword } = req.body;\n\n      if (!currentPassword || !newPassword) {\n        return res.status(400).json({ error: \"كلمة المرور الحالية والجديدة مطلوبة\" });\n      }\n\n      if (newPassword.length < 6) {\n        return res.status(400).json({ error: \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Get user based on type\n      let user;\n      if (userType === \"freelancer\") {\n        user = await storage.getFreelancer(userId);\n      } else {\n        user = await storage.getProductOwner(userId);\n      }\n\n      if (!user) {\n        return res.status(404).json({ error: \"المستخدم غير موجود\" });\n      }\n\n      // Verify current password\n      const isPasswordValid = await bcrypt.compare(currentPassword, user.password);\n      if (!isPasswordValid) {\n        return res.status(401).json({ error: \"كلمة المرور الحالية غير صحيحة\" });\n      }\n\n      // Hash new password\n      const hashedPassword = await bcrypt.hash(newPassword, 10);\n\n      // Update password\n      if (userType === \"freelancer\") {\n        await storage.updateFreelancer(userId, { password: hashedPassword });\n      } else {\n        await storage.updateProductOwner(userId, { password: hashedPassword });\n      }\n\n      res.json({ message: \"تم تغيير كلمة المرور بنجاح\" });\n    } catch (error) {\n      console.error(\"Error changing password:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تغيير كلمة المرور\" });\n    }\n  });\n\n  // ============================================\n  // CAMPAIGN ROUTES\n  // ============================================\n\n  // Create campaign (product owners only)\n  app.post(\"/api/campaigns\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const validatedData = insertCampaignSchema.parse(req.body);\n\n      // Ensure owner_id matches the authenticated user\n      if (validatedData.owner_id !== req.user?.userId) {\n        return res.status(403).json({ error: \"يمكنك فقط إنشاء حملات لحسابك الخاص\" });\n      }\n\n      const campaign = await storage.createCampaign(validatedData);\n      res.status(201).json(campaign);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحملة\" });\n    }\n  });\n\n  // Get all campaigns (filtered based on user type)\n  app.get(\"/api/campaigns\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { status, owner_id } = req.query;\n      \n      let campaigns;\n      \n      if (req.user?.userType === \"product_owner\") {\n        // Product owners see only their campaigns\n        campaigns = await storage.getCampaignsByOwner(req.user.userId);\n      } else {\n        // Freelancers see only active campaigns (not drafts, paused, etc.)\n        const allCampaigns = await storage.getAllCampaigns();\n        campaigns = allCampaigns.filter(c => c.status === \"active\");\n      }\n\n      // Apply additional filters\n      if (status) {\n        campaigns = campaigns.filter(c => c.status === status);\n      }\n      if (owner_id && req.user?.userType === \"product_owner\") {\n        campaigns = campaigns.filter(c => c.owner_id === owner_id);\n      }\n\n      res.json(campaigns);\n    } catch (error) {\n      console.error(\"Error fetching campaigns:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الحملات\" });\n    }\n  });\n\n  // Get campaign by ID\n  app.get(\"/api/campaigns/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const campaign = await storage.getCampaign(id);\n\n      if (!campaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      // Product owners can only see their own campaigns\n      if (req.user?.userType === \"product_owner\" && campaign.owner_id !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض هذه الحملة\" });\n      }\n\n      res.json(campaign);\n    } catch (error) {\n      console.error(\"Error fetching campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات الحملة\" });\n    }\n  });\n\n  // Update campaign (product owners only, own campaigns)\n  app.patch(\"/api/campaigns/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      \n      // Get existing campaign to verify ownership\n      const existingCampaign = await storage.getCampaign(id);\n      if (!existingCampaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      if (existingCampaign.owner_id !== req.user?.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذه الحملة\" });\n      }\n\n      // Create update schema (partial of insert schema, excluding owner_id and id)\n      const updateCampaignSchema = insertCampaignSchema.partial().omit({ owner_id: true, id: true });\n      \n      // Validate updates\n      const validatedUpdates = updateCampaignSchema.parse(req.body);\n\n      const updatedCampaign = await storage.updateCampaign(id, validatedUpdates);\n      res.json(updatedCampaign);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error updating campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الحملة\" });\n    }\n  });\n\n  // Delete campaign (product owners only, own campaigns)\n  app.delete(\"/api/campaigns/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      // Get existing campaign to verify ownership\n      const existingCampaign = await storage.getCampaign(id);\n      if (!existingCampaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      if (existingCampaign.owner_id !== req.user?.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لحذف هذه الحملة\" });\n      }\n\n      await storage.deleteCampaign(id);\n      res.json({ message: \"تم حذف الحملة بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف الحملة\" });\n    }\n  });\n\n  // ============================================\n  // TASK ROUTES\n  // ============================================\n\n  // Get available tasks (freelancers can browse)\n  app.get(\"/api/tasks/available\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const tasks = await storage.getAvailableTasks();\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching available tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام المتاحة\" });\n    }\n  });\n\n  // Get freelancer's tasks (assigned, in_progress, submitted, approved)\n  app.get(\"/api/tasks/my-tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n      \n      const tasks = await storage.getTasksByFreelancer(req.user.userId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching freelancer tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب مهامك\" });\n    }\n  });\n\n  // Get single task details\n  app.get(\"/api/tasks/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const task = await storage.getTask(id);\n      \n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Check authorization: freelancer can only view their own tasks or available tasks\n      if (req.user?.userType === \"freelancer\") {\n        if (task.status !== \"available\" && task.freelancerId !== req.user.userId) {\n          return res.status(403).json({ error: \"ليس لديك صلاحية لعرض هذه المهمة\" });\n        }\n      }\n\n      res.json(task);\n    } catch (error) {\n      console.error(\"Error fetching task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهمة\" });\n    }\n  });\n\n  // Accept a task (freelancer assigns themselves)\n  app.post(\"/api/tasks/:id/accept\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      \n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Check if task exists and is available\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.status !== \"available\") {\n        return res.status(400).json({ error: \"هذه المهمة غير متاحة حالياً\" });\n      }\n\n      // Assign task to freelancer\n      const updatedTask = await storage.assignTask(id, req.user.userId);\n      \n      if (!updatedTask) {\n        return res.status(400).json({ error: \"فشل قبول المهمة\" });\n      }\n\n      // Create notification for product owner\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (campaign) {\n        await storage.createNotification({\n          userId: campaign.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم قبول مهمة\",\n          message: `تم قبول المهمة \"${task.title}\" من قبل مستقل`,\n          type: \"task_assigned\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error accepting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء قبول المهمة\" });\n    }\n  });\n\n  // Submit task with report\n  app.patch(\"/api/tasks/:id/submit\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { submission } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!submission || !submission.trim()) {\n        return res.status(400).json({ error: \"التقرير مطلوب\" });\n      }\n\n      // Check if task exists and belongs to this freelancer\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتسليم هذه المهمة\" });\n      }\n\n      if (task.status !== \"assigned\" && task.status !== \"in_progress\") {\n        return res.status(400).json({ error: \"لا يمكن تسليم هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task with submission\n      const updatedTask = await storage.updateTask(id, {\n        submission,\n        status: \"submitted\",\n        submittedAt: new Date(),\n      });\n\n      // Create notification for product owner\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (campaign) {\n        await storage.createNotification({\n          userId: campaign.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم تسليم مهمة\",\n          message: `تم تسليم المهمة \"${task.title}\" من قبل المستقل`,\n          type: \"task_submitted\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error submitting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسليم المهمة\" });\n    }\n  });\n\n  // Update task status to in_progress (freelancer starts working)\n  app.patch(\"/api/tasks/:id/start\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لبدء هذه المهمة\" });\n      }\n\n      if (task.status !== \"assigned\") {\n        return res.status(400).json({ error: \"لا يمكن بدء هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error starting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء بدء المهمة\" });\n    }\n  });\n\n  // ============================================\n  // PRODUCT OWNER - TASKS MANAGEMENT\n  // ============================================\n\n  // Get all tasks for product owner's campaigns\n  app.get(\"/api/tasks/owner\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Get all campaigns for this product owner\n      const campaigns: Campaign[] = await storage.getCampaignsByOwner(req.user.userId);\n      const campaignIds = campaigns.map((c: Campaign) => c.id);\n\n      // Get all tasks for these campaigns\n      const allTasks: any[] = [];\n      for (const campaignId of campaignIds) {\n        const tasks = await storage.getTasksByCampaign(campaignId);\n        allTasks.push(...tasks);\n      }\n\n      res.json(allTasks);\n    } catch (error) {\n      console.error(\"Error fetching owner tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Approve a task (product owner)\n  app.patch(\"/api/tasks/:id/approve\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Verify ownership through campaign\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (!campaign || campaign.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية للموافقة على هذه المهمة\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن الموافقة على هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task\n      const updatedTask = await storage.updateTask(id, {\n        status: \"approved\",\n        feedback: feedback || \"\",\n        completedAt: new Date(),\n      });\n\n      // Create notification for freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على مهمتك\",\n          message: `تمت الموافقة على المهمة \"${task.title}\" وتم إضافة ${task.reward} ر.س إلى محفظتك`,\n          type: \"task_approved\",\n        });\n      }\n\n      // Update freelancer wallet - add reward to balance\n      if (task.freelancerId) {\n        const wallet = await storage.getWalletByFreelancer(task.freelancerId);\n        if (wallet) {\n          await storage.updateWallet(wallet.id, {\n            balance: (Number(wallet.balance) + Number(task.reward)).toString(),\n            totalEarned: (Number(wallet.totalEarned) + Number(task.reward)).toString(),\n          });\n\n          // Create transaction record\n          await storage.createTransaction({\n            walletId: wallet.id,\n            taskId: task.id,\n            type: \"earning\",\n            amount: task.reward.toString(),\n            status: \"completed\",\n            description: `مكافأة المهمة: ${task.title}`,\n          });\n        }\n\n        // Create notification for freelancer\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على المهمة\",\n          message: `تمت الموافقة على المهمة \"${task.title}\" وتم إضافة ${task.reward} ر.س لمحفظتك`,\n          type: \"task_approved\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error approving task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الموافقة على المهمة\" });\n    }\n  });\n\n  // Reject a task (product owner)\n  app.patch(\"/api/tasks/:id/reject\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!feedback || !feedback.trim()) {\n        return res.status(400).json({ error: \"يجب تقديم سبب الرفض\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Verify ownership through campaign\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (!campaign || campaign.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لرفض هذه المهمة\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن رفض هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task - return to in_progress for rework\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n        feedback,\n      });\n\n      // Create notification for freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم رفض المهمة\",\n          message: `تم رفض المهمة \"${task.title}\". يرجى مراجعة الملاحظات وإعادة التسليم`,\n          type: \"task_rejected\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error rejecting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفض المهمة\" });\n    }\n  });\n\n  // ============================================\n  // GROUP ROUTES - إدارة الجروبات\n  // ============================================\n\n  // Create a new group (freelancer only)\n  app.post(\"/api/groups\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { name, description, maxMembers = 700 } = req.body;\n\n      if (!name || !name.trim()) {\n        return res.status(400).json({ error: \"اسم الجروب مطلوب\" });\n      }\n\n      if (maxMembers < 1 || maxMembers > 700) {\n        return res.status(400).json({ error: \"الحد الأقصى للأعضاء يجب أن يكون بين 1 و 700\" });\n      }\n\n      const group = await storage.createGroup({\n        name: name.trim(),\n        description: description?.trim() || \"\",\n        leaderId: req.user.userId,\n        maxMembers,\n        currentMembers: 1, // Leader is the first member\n        status: \"active\",\n      });\n\n      // Add leader as member\n      await storage.addGroupMember({\n        groupId: group.id,\n        freelancerId: req.user.userId,\n        role: \"leader\",\n      });\n\n      res.status(201).json(group);\n    } catch (error) {\n      console.error(\"Error creating group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الجروب\" });\n    }\n  });\n\n  // Get all groups (for joining)\n  app.get(\"/api/groups\", async (req, res) => {\n    try {\n      const groups = await storage.getAllGroups();\n      res.json(groups);\n    } catch (error) {\n      console.error(\"Error fetching groups:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الجروبات\" });\n    }\n  });\n\n  // Get group by ID with details\n  app.get(\"/api/groups/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const group = await storage.getGroup(id);\n\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      res.json(group);\n    } catch (error) {\n      console.error(\"Error fetching group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات الجروب\" });\n    }\n  });\n\n  // Get groups where user is leader\n  app.get(\"/api/groups/my/leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const groups = await storage.getGroupsByLeader(req.user.userId);\n      res.json(groups);\n    } catch (error) {\n      console.error(\"Error fetching leader groups:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الجروبات\" });\n    }\n  });\n\n  // Join a group (freelancer only)\n  app.post(\"/api/groups/:id/join\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      \n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      if (group.status !== \"active\") {\n        return res.status(400).json({ error: \"هذا الجروب غير نشط\" });\n      }\n\n      // Check if already a member\n      const isMember = await storage.isGroupMember(id, req.user.userId);\n      if (isMember) {\n        return res.status(400).json({ error: \"أنت عضو بالفعل في هذا الجروب\" });\n      }\n\n      // Check if group is full\n      if (group.currentMembers >= group.maxMembers) {\n        return res.status(400).json({ error: \"الجروب ممتلئ (الحد الأقصى 700 عضو)\" });\n      }\n\n      // Add member\n      const member = await storage.addGroupMember({\n        groupId: id,\n        freelancerId: req.user.userId,\n        role: \"member\",\n      });\n\n      // Update group member count\n      await storage.updateGroup(id, {\n        currentMembers: group.currentMembers + 1,\n      });\n\n      // Create notification for leader\n      await storage.createNotification({\n        userId: group.leaderId,\n        userType: \"freelancer\",\n        title: \"عضو جديد انضم للجروب\",\n        message: `انضم عضو جديد إلى جروب \"${group.name}\"`,\n        type: \"group_member_joined\",\n      });\n\n      res.status(201).json({ message: \"تم الانضمام للجروب بنجاح\", member });\n    } catch (error: any) {\n      // Handle unique constraint violation\n      if (error?.code === \"23505\" || error?.message?.includes(\"unique\")) {\n        return res.status(400).json({ error: \"أنت عضو بالفعل في هذا الجروب\" });\n      }\n      console.error(\"Error joining group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الانضمام للجروب\" });\n    }\n  });\n\n  // Leave a group (freelancer only, not leader)\n  app.post(\"/api/groups/:id/leave\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      \n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      if (group.leaderId === req.user.userId) {\n        return res.status(400).json({ error: \"لا يمكن لقائد الجروب المغادرة. يمكنك حذف الجروب بدلاً من ذلك\" });\n      }\n\n      const isMember = await storage.isGroupMember(id, req.user.userId);\n      if (!isMember) {\n        return res.status(400).json({ error: \"أنت لست عضواً في هذا الجروب\" });\n      }\n\n      await storage.removeGroupMember(id, req.user.userId);\n\n      // Update member count\n      await storage.updateGroup(id, {\n        currentMembers: Math.max(1, group.currentMembers - 1),\n      });\n\n      res.json({ message: \"تم المغادرة من الجروب بنجاح\" });\n    } catch (error) {\n      console.error(\"Error leaving group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء المغادرة من الجروب\" });\n    }\n  });\n\n  // Get group members (with details)\n  app.get(\"/api/groups/:id/members\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      \n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      const members = await storage.getGroupMembers(id);\n      res.json(members);\n    } catch (error) {\n      console.error(\"Error fetching group members:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب أعضاء الجروب\" });\n    }\n  });\n\n  // Remove member from group (leader only)\n  app.delete(\"/api/groups/:groupId/members/:freelancerId\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId, freelancerId } = req.params;\n      \n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can remove members\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه إزالة الأعضاء\" });\n      }\n\n      // Can't remove the leader\n      if (freelancerId === group.leaderId) {\n        return res.status(400).json({ error: \"لا يمكن إزالة قائد الجروب\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, freelancerId);\n      if (!isMember) {\n        return res.status(404).json({ error: \"العضو غير موجود في الجروب\" });\n      }\n\n      await storage.removeGroupMember(groupId, freelancerId);\n\n      // Update member count\n      await storage.updateGroup(groupId, {\n        currentMembers: Math.max(1, group.currentMembers - 1),\n      });\n\n      // Notify removed member\n      await storage.createNotification({\n        userId: freelancerId,\n        userType: \"freelancer\",\n        title: \"تمت إزالتك من الجروب\",\n        message: `تمت إزالتك من جروب \"${group.name}\"`,\n        type: \"group_member_removed\",\n      });\n\n      res.json({ message: \"تم إزالة العضو من الجروب بنجاح\" });\n    } catch (error) {\n      console.error(\"Error removing group member:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إزالة العضو\" });\n    }\n  });\n\n  // Update group details (leader only)\n  app.patch(\"/api/groups/:id\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can update\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه تحديث البيانات\" });\n      }\n\n      // Don't allow certain fields to be updated\n      delete updates.id;\n      delete updates.leaderId;\n      delete updates.currentMembers;\n      delete updates.createdAt;\n\n      // Validate maxMembers if provided\n      if (updates.maxMembers !== undefined) {\n        if (updates.maxMembers < group.currentMembers) {\n          return res.status(400).json({ \n            error: `لا يمكن تقليل الحد الأقصى إلى أقل من العدد الحالي (${group.currentMembers} عضو)` \n          });\n        }\n        if (updates.maxMembers > 700) {\n          return res.status(400).json({ error: \"الحد الأقصى للأعضاء هو 700\" });\n        }\n      }\n\n      const updatedGroup = await storage.updateGroup(id, updates);\n      res.json(updatedGroup);\n    } catch (error) {\n      console.error(\"Error updating group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الجروب\" });\n    }\n  });\n\n  // ============================================\n  // PROJECT ROUTES - إدارة المشاريع\n  // ============================================\n\n  // Create a new project (product owner only)\n  app.post(\"/api/projects\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { title, description, targetCountry, tasksCount, budget, deadline } = req.body;\n\n      if (!title || !title.trim()) {\n        return res.status(400).json({ error: \"عنوان المشروع مطلوب\" });\n      }\n\n      if (!tasksCount || tasksCount < 1) {\n        return res.status(400).json({ error: \"عدد المهام يجب أن يكون 1 على الأقل\" });\n      }\n\n      if (!budget || budget < 0) {\n        return res.status(400).json({ error: \"الميزانية غير صحيحة\" });\n      }\n\n      const project = await storage.createProject({\n        productOwnerId: req.user.userId,\n        title: title.trim(),\n        description: description?.trim() || \"\",\n        targetCountry: targetCountry || \"\",\n        tasksCount,\n        budget,\n        deadline: deadline ? new Date(deadline) : null,\n        status: \"pending\",\n      });\n\n      res.status(201).json(project);\n    } catch (error) {\n      console.error(\"Error creating project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المشروع\" });\n    }\n  });\n\n  // Get all pending projects (for group leaders to browse)\n  app.get(\"/api/projects/pending\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const projects = await storage.getPendingProjects();\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching pending projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get projects by product owner\n  app.get(\"/api/projects/my\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const projects = await storage.getProjectsByOwner(req.user.userId);\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching owner projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get projects accepted by a group\n  app.get(\"/api/projects/group/:groupId\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض مشاريع هذا الجروب\" });\n      }\n\n      const projects = await storage.getProjectsByGroup(groupId);\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching group projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get single project details\n  app.get(\"/api/projects/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      res.json(project);\n    } catch (error) {\n      console.error(\"Error fetching project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات المشروع\" });\n    }\n  });\n\n  // Accept a project (group leader only)\n  app.post(\"/api/projects/:id/accept\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { groupId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!groupId) {\n        return res.status(400).json({ error: \"معرف الجروب مطلوب\" });\n      }\n\n      // Verify user is the group leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه قبول المشاريع\" });\n      }\n\n      if (group.status !== \"active\") {\n        return res.status(400).json({ error: \"الجروب غير نشط\" });\n      }\n\n      // Verify project exists and is pending\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      if (project.status !== \"pending\") {\n        return res.status(400).json({ error: \"هذا المشروع تم قبوله بالفعل أو مكتمل\" });\n      }\n\n      // Accept the project\n      const updatedProject = await storage.acceptProject(id, groupId);\n\n      // Notify product owner\n      await storage.createNotification({\n        userId: project.productOwnerId,\n        userType: \"product_owner\",\n        title: \"تم قبول المشروع\",\n        message: `تم قبول مشروع \"${project.title}\" من قبل جروب \"${group.name}\"`,\n        type: \"project_accepted\",\n      });\n\n      res.json(updatedProject);\n    } catch (error) {\n      console.error(\"Error accepting project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء قبول المشروع\" });\n    }\n  });\n\n  // Update project status\n  app.patch(\"/api/projects/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      // Verify ownership\n      if (project.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا المشروع\" });\n      }\n\n      // Don't allow certain fields to be updated\n      delete updates.id;\n      delete updates.productOwnerId;\n      delete updates.acceptedByGroupId;\n      delete updates.createdAt;\n\n      const updatedProject = await storage.updateProject(id, updates);\n      res.json(updatedProject);\n    } catch (error) {\n      console.error(\"Error updating project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث المشروع\" });\n    }\n  });\n\n  // Delete a project (product owner only, only if pending)\n  app.delete(\"/api/projects/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      // Verify ownership\n      if (project.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لحذف هذا المشروع\" });\n      }\n\n      // Only allow deletion if pending\n      if (project.status !== \"pending\") {\n        return res.status(400).json({ error: \"لا يمكن حذف مشروع تم قبوله أو جاري العمل عليه\" });\n      }\n\n      await storage.deleteProject(id);\n      res.json({ message: \"تم حذف المشروع بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف المشروع\" });\n    }\n  });\n\n  // ============================================\n  // TASK ROUTES (NEW - للمهام المرتبطة بالمشاريع والجروبات)\n  // ============================================\n\n  // Create tasks for a project (group leader only, after accepting project)\n  app.post(\"/api/projects/:projectId/tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { projectId } = req.params;\n      const { tasks } = req.body; // Array of task objects\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!tasks || !Array.isArray(tasks) || tasks.length === 0) {\n        return res.status(400).json({ error: \"يجب تحديد مهمة واحدة على الأقل\" });\n      }\n\n      // Verify project\n      const project = await storage.getProject(projectId);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      if (!project.acceptedByGroupId) {\n        return res.status(400).json({ error: \"يجب قبول المشروع أولاً\" });\n      }\n\n      // Verify user is the group leader\n      const group = await storage.getGroup(project.acceptedByGroupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه إنشاء المهام\" });\n      }\n\n      // Create tasks\n      const createdTasks = [];\n      for (const taskData of tasks) {\n        const task = await storage.createTask({\n          projectId,\n          groupId: project.acceptedByGroupId,\n          freelancerId: taskData.freelancerId || null,\n          title: taskData.title,\n          description: taskData.description || \"\",\n          taskUrl: taskData.taskUrl || \"\",\n          reward: taskData.reward || \"0\",\n          status: taskData.freelancerId ? \"assigned\" : \"available\",\n          campaignId: \"\", // Not used in new system\n        });\n        createdTasks.push(task);\n\n        // Notify assigned freelancer if any\n        if (taskData.freelancerId) {\n          await storage.createNotification({\n            userId: taskData.freelancerId,\n            userType: \"freelancer\",\n            title: \"تم تعيين مهمة جديدة لك\",\n            message: `تم تعيين مهمة \"${task.title}\" لك في مشروع \"${project.title}\"`,\n            type: \"task_assigned\",\n          });\n        }\n      }\n\n      res.status(201).json(createdTasks);\n    } catch (error) {\n      console.error(\"Error creating tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المهام\" });\n    }\n  });\n\n  // Get tasks for a project\n  app.get(\"/api/projects/:projectId/tasks\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { projectId } = req.params;\n\n      const tasks = await storage.getTasksByProject(projectId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching project tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Get tasks assigned to current user\n  app.get(\"/api/tasks/my/assigned\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const tasks = await storage.getTasksByFreelancer(req.user.userId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching assigned tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Assign task to group member (leader only)\n  app.patch(\"/api/tasks/:id/assign\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { freelancerId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!freelancerId) {\n        return res.status(400).json({ error: \"معرف العضو مطلوب\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه تعيين المهام\" });\n      }\n\n      // Verify freelancer is group member\n      const isMember = await storage.isGroupMember(task.groupId, freelancerId);\n      if (!isMember) {\n        return res.status(400).json({ error: \"العضو المحدد ليس في الجروب\" });\n      }\n\n      if (task.status !== \"available\") {\n        return res.status(400).json({ error: \"هذه المهمة تم تعيينها بالفعل أو مكتملة\" });\n      }\n\n      // Assign task\n      const updatedTask = await storage.updateTask(id, {\n        freelancerId,\n        status: \"assigned\",\n      });\n\n      // Notify freelancer\n      await storage.createNotification({\n        userId: freelancerId,\n        userType: \"freelancer\",\n        title: \"تم تعيين مهمة جديدة لك\",\n        message: `تم تعيين مهمة \"${task.title}\" لك`,\n        type: \"task_assigned\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error assigning task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تعيين المهمة\" });\n    }\n  });\n\n  // Start working on task\n  app.patch(\"/api/tasks/:id/start-work\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"هذه المهمة غير معينة لك\" });\n      }\n\n      if (task.status !== \"assigned\") {\n        return res.status(400).json({ error: \"لا يمكن البدء بهذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error starting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء بدء المهمة\" });\n    }\n  });\n\n  // Submit task with proof image\n  app.patch(\"/api/tasks/:id/submit-proof\", authMiddleware, requireRole([\"freelancer\"]), upload.single(\"proofImage\"), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { report } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"هذه المهمة غير معينة لك\" });\n      }\n\n      if (task.status !== \"in_progress\") {\n        return res.status(400).json({ error: \"يجب أن تكون المهمة قيد التنفيذ للتسليم\" });\n      }\n\n      let proofImagePath: string | null = null;\n      \n      // Handle proof image upload if provided\n      if (req.file) {\n        const uploadDir = join(process.cwd(), \"uploads\", \"task-proofs\");\n        if (!existsSync(uploadDir)) {\n          await mkdir(uploadDir, { recursive: true });\n        }\n\n        const filename = `proof-${id}-${Date.now()}.${req.file.originalname.split('.').pop()}`;\n        const filepath = join(uploadDir, filename);\n        await writeFile(filepath, req.file.buffer);\n        proofImagePath = `/uploads/task-proofs/${filename}`;\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"submitted\",\n        proofImage: proofImagePath,\n        report: report || \"\",\n      });\n\n      // Notify group leader\n      if (task.groupId) {\n        const group = await storage.getGroup(task.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم تسليم مهمة للمراجعة\",\n            message: `تم تسليم مهمة \"${task.title}\" من قبل أحد الأعضاء`,\n            type: \"task_submitted\",\n          });\n        }\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error submitting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسليم المهمة\" });\n    }\n  });\n\n  // Review and approve task (group leader only)\n  app.patch(\"/api/tasks/:id/approve-by-leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه الموافقة على المهام\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن الموافقة على هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"approved\",\n        feedback: feedback || \"تمت الموافقة\",\n      });\n\n      // Notify freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على مهمتك\",\n          message: `تمت الموافقة على مهمة \"${task.title}\" من قبل قائد الجروب`,\n          type: \"task_approved_by_leader\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error approving task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الموافقة على المهمة\" });\n    }\n  });\n\n  // Reject task and request rework (group leader only)\n  app.patch(\"/api/tasks/:id/reject-by-leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!feedback || !feedback.trim()) {\n        return res.status(400).json({ error: \"يجب تقديم سبب الرفض\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه رفض المهام\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن رفض هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\", // Return to in_progress for rework\n        feedback: feedback.trim(),\n      });\n\n      // Notify freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم رفض المهمة\",\n          message: `تم رفض مهمة \"${task.title}\". يرجى مراجعة الملاحظات وإعادة التسليم`,\n          type: \"task_rejected_by_leader\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error rejecting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفض المهمة\" });\n    }\n  });\n\n  // Get tasks for group (leader and members)\n  app.get(\"/api/groups/:groupId/tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض مهام هذا الجروب\" });\n      }\n\n      const tasks = await storage.getTasksByGroup(groupId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching group tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // ============================================\n  // MESSAGES ROUTES - الرسائل الداخلية\n  // ============================================\n\n  // Send a message to group\n  app.post(\"/api/groups/:groupId/messages\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { content, type, relatedProjectId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!content || !content.trim()) {\n        return res.status(400).json({ error: \"محتوى الرسالة مطلوب\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في الجروب لإرسال رسالة\" });\n      }\n\n      const message = await storage.sendMessage({\n        groupId,\n        senderId: req.user.userId,\n        content: content.trim(),\n        type: type || \"text\",\n        relatedProjectId: relatedProjectId || null,\n      });\n\n      res.status(201).json(message);\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إرسال الرسالة\" });\n    }\n  });\n\n  // Get messages for a group\n  app.get(\"/api/groups/:groupId/messages\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض رسائل هذا الجروب\" });\n      }\n\n      const messages = await storage.getGroupMessages(groupId);\n      res.json(messages);\n    } catch (error) {\n      console.error(\"Error fetching messages:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الرسائل\" });\n    }\n  });\n\n  // Mark messages as read\n  app.patch(\"/api/messages/:id/read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      const message = await storage.markMessageAsRead(id);\n      res.json(message);\n    } catch (error) {\n      console.error(\"Error marking message as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الرسالة\" });\n    }\n  });\n\n  // ============================================\n  // WITHDRAWALS ROUTES - طلبات السحب\n  // ============================================\n\n  // Create withdrawal request\n  app.post(\"/api/withdrawals\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { amount, paymentMethod, accountNumber } = req.body;\n\n      if (!amount || amount <= 0) {\n        return res.status(400).json({ error: \"المبلغ غير صحيح\" });\n      }\n\n      if (!paymentMethod || !accountNumber) {\n        return res.status(400).json({ error: \"طريقة الدفع ورقم الحساب مطلوبان\" });\n      }\n\n      // Get freelancer wallet balance\n      const freelancer = await storage.getFreelancer(req.user.userId);\n      if (!freelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      if (parseFloat(freelancer.walletBalance) < amount) {\n        return res.status(400).json({ error: \"الرصيد غير كافٍ\" });\n      }\n\n      const withdrawal = await storage.createWithdrawal({\n        freelancerId: req.user.userId,\n        amount: amount.toString(),\n        paymentMethod,\n        accountNumber,\n        status: \"pending\",\n      });\n\n      // Create notification for freelancer\n      await storage.createNotification({\n        userId: req.user.userId,\n        userType: \"freelancer\",\n        title: \"طلب سحب جديد\",\n        message: `تم إنشاء طلب سحب بقيمة ${amount} ر.س. سيتم مراجعة الطلب قريباً`,\n        type: \"withdrawal_created\",\n      });\n\n      res.status(201).json(withdrawal);\n    } catch (error) {\n      console.error(\"Error creating withdrawal:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء طلب السحب\" });\n    }\n  });\n\n  // Get withdrawal requests for current freelancer\n  app.get(\"/api/withdrawals/my\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const withdrawals = await storage.getWithdrawalsByFreelancer(req.user.userId);\n      res.json(withdrawals);\n    } catch (error) {\n      console.error(\"Error fetching withdrawals:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب طلبات السحب\" });\n    }\n  });\n\n  // ============================================\n  // WALLET ROUTES - المحفظة\n  // ============================================\n\n  // Get wallet for current freelancer\n  app.get(\"/api/wallet\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const wallet = await storage.getWalletByFreelancer(req.user.userId);\n      if (!wallet) {\n        return res.status(404).json({ error: \"المحفظة غير موجودة\" });\n      }\n\n      res.json(wallet);\n    } catch (error) {\n      console.error(\"Error fetching wallet:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المحفظة\" });\n    }\n  });\n\n  // ============================================\n  // NOTIFICATIONS ROUTES - الإشعارات\n  // ============================================\n\n  // Get notifications for current user\n  app.get(\"/api/notifications\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const notifications = await storage.getUserNotifications(req.user.userId, req.user.userType);\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الإشعارات\" });\n    }\n  });\n\n  // Mark notification as read\n  app.patch(\"/api/notifications/:id/read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const notification = await storage.getNotification(id);\n      if (!notification) {\n        return res.status(404).json({ error: \"الإشعار غير موجود\" });\n      }\n\n      // Verify ownership\n      if (notification.userId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا الإشعار\" });\n      }\n\n      const updated = await storage.markNotificationAsRead(id);\n      res.json(updated);\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الإشعار\" });\n    }\n  });\n\n  // Mark all notifications as read\n  app.patch(\"/api/notifications/mark-all-read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      await storage.markAllNotificationsAsRead(req.user.userId, req.user.userType);\n      res.json({ message: \"تم تحديد جميع الإشعارات كمقروءة\" });\n    } catch (error) {\n      console.error(\"Error marking all notifications as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الإشعارات\" });\n    }\n  });\n\n  // Get unread notification count\n  app.get(\"/api/notifications/unread/count\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const count = await storage.getUnreadNotificationCount(req.user.userId, req.user.userType);\n      res.json({ count });\n    } catch (error) {\n      console.error(\"Error fetching unread count:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب عدد الإشعارات\" });\n    }\n  });\n\n  // ============================================\n  // ORDERS MANAGEMENT\n  // ============================================\n\n  // Create new order\n  app.post(\"/api/orders\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const validatedData = insertOrderSchema.parse(req.body);\n      \n      const order = await storage.createOrder({\n        ...validatedData,\n        productOwnerId: req.user!.userId,\n      });\n\n      // Create notification for group leader\n      const group = await storage.getGroupById(validatedData.groupId);\n      if (group) {\n        await storage.createNotification({\n          userId: group.leaderId,\n          userType: \"freelancer\",\n          title: \"طلب خدمة جديد\",\n          message: `لديك طلب خدمة جديد بقيمة $${validatedData.totalAmount}`,\n          type: \"order_created\",\n        });\n      }\n\n      res.status(201).json(order);\n    } catch (error: any) {\n      console.error(\"Error creating order:\", error);\n      res.status(400).json({ error: error.message || \"فشل في إنشاء الطلب\" });\n    }\n  });\n\n  // Get all orders (filtered by user role)\n  app.get(\"/api/orders\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { userId, userType } = req.user!;\n      \n      let orders;\n      if (userType === \"product_owner\") {\n        orders = await storage.getOrdersByProductOwner(userId);\n      } else if (userType === \"freelancer\") {\n        // Get orders for groups led by this freelancer\n        orders = await storage.getOrdersByGroupLeader(userId);\n      } else {\n        orders = [];\n      }\n\n      res.json(orders);\n    } catch (error) {\n      console.error(\"Error fetching orders:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الطلبات\" });\n    }\n  });\n\n  // Get specific order\n  app.get(\"/api/orders/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const order = await storage.getOrderById(req.params.id);\n      \n      if (!order) {\n        return res.status(404).json({ error: \"الطلب غير موجود\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      console.error(\"Error fetching order:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الطلب\" });\n    }\n  });\n\n  // Update order status\n  app.patch(\"/api/orders/:id/status\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { status } = req.body;\n      \n      if (!status) {\n        return res.status(400).json({ error: \"الحالة مطلوبة\" });\n      }\n\n      const order = await storage.updateOrderStatus(req.params.id, status);\n      \n      if (!order) {\n        return res.status(404).json({ error: \"الطلب غير موجود\" });\n      }\n\n      // Create notifications based on status\n      if (status === \"payment_confirmed\") {\n        // Notify group leader\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم تأكيد الدفع\",\n            message: `تم تأكيد دفع الطلب بقيمة $${order.totalAmount}. يمكنك الآن البدء في التنفيذ`,\n            type: \"payment_confirmed\",\n          });\n        }\n\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم تأكيد الدفع\",\n          message: `تم تأكيد دفع طلبك بقيمة $${order.totalAmount}`,\n          type: \"payment_confirmed\",\n        });\n      } else if (status === \"in_progress\") {\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"الطلب قيد التنفيذ\",\n          message: `بدأ الفريق بتنفيذ طلبك`,\n          type: \"order_in_progress\",\n        });\n\n        // Notify group leader (freelancer)\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"طلب قيد التنفيذ\",\n            message: `تم تحويل الطلب بقيمة $${order.totalAmount} إلى حالة \"قيد التنفيذ\"`,\n            type: \"order_in_progress\",\n          });\n        }\n      } else if (status === \"completed\") {\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم إكمال الطلب\",\n          message: `تم إكمال طلبك بنجاح`,\n          type: \"order_completed\",\n        });\n\n        // Notify group leader\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم إكمال الطلب\",\n            message: `تم إكمال الطلب بنجاح بقيمة $${order.totalAmount}`,\n            type: \"order_completed\",\n          });\n        }\n      }\n\n      res.json(order);\n    } catch (error) {\n      console.error(\"Error updating order:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الطلب\" });\n    }\n  });\n\n  // ============================================\n  // CONVERSATION ROUTES\n  // ============================================\n\n  // Get or create conversation\n  app.post(\"/api/conversations\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.body;\n\n      if (!groupId) {\n        return res.status(400).json({ error: \"معرف الجروب مطلوب\" });\n      }\n\n      // Get group to find leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      const productOwnerId = req.user!.userId;\n      const conversation = await storage.getOrCreateConversation(productOwnerId, groupId, group.leaderId);\n\n      res.json(conversation);\n    } catch (error) {\n      console.error(\"Error creating conversation:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المحادثة\" });\n    }\n  });\n\n  // Get all conversations for current user\n  app.get(\"/api/conversations\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const userType = req.user!.userType;\n      const userId = req.user!.userId;\n\n      let conversations;\n      if (userType === \"product_owner\") {\n        conversations = await storage.getProductOwnerConversations(userId);\n      } else if (userType === \"freelancer\") {\n        conversations = await storage.getFreelancerConversations(userId);\n      } else {\n        return res.status(400).json({ error: \"نوع المستخدم غير صحيح\" });\n      }\n\n      // Fetch group details for each conversation\n      const conversationsWithDetails = await Promise.all(\n        conversations.map(async (conv) => {\n          const group = await storage.getGroup(conv.groupId);\n          const leader = await storage.getFreelancer(conv.leaderId);\n          const productOwner = await storage.getProductOwner(conv.productOwnerId);\n          \n          return {\n            ...conv,\n            group,\n            leader,\n            productOwner,\n          };\n        })\n      );\n\n      res.json(conversationsWithDetails);\n    } catch (error) {\n      console.error(\"Error fetching conversations:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المحادثات\" });\n    }\n  });\n\n  // Get conversation messages\n  app.get(\"/api/conversations/:id/messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const conversationId = req.params.id;\n\n      // Verify user has access to this conversation\n      const conversation = await storage.getConversation(conversationId);\n      if (!conversation) {\n        return res.status(404).json({ error: \"المحادثة غير موجودة\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Check if user is part of conversation\n      if (userType === \"product_owner\" && conversation.productOwnerId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n      if (userType === \"freelancer\" && conversation.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n\n      const messages = await storage.getConversationMessages(conversationId);\n\n      // Mark messages as read\n      await storage.markMessagesAsRead(conversationId, userId);\n\n      res.json(messages);\n    } catch (error) {\n      console.error(\"Error fetching messages:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الرسائل\" });\n    }\n  });\n\n  // Send message\n  app.post(\"/api/conversations/:id/messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const conversationId = req.params.id;\n      const { content } = req.body;\n\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى الرسالة مطلوب\" });\n      }\n\n      // Verify user has access to this conversation\n      const conversation = await storage.getConversation(conversationId);\n      if (!conversation) {\n        return res.status(404).json({ error: \"المحادثة غير موجودة\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Check if user is part of conversation\n      if (userType === \"product_owner\" && conversation.productOwnerId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n      if (userType === \"freelancer\" && conversation.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n\n      const message = await storage.sendMessage(conversationId, userId, userType, content);\n\n      // Create notification for the recipient\n      const recipientId = userType === \"product_owner\" ? conversation.leaderId : conversation.productOwnerId;\n      const recipientType = userType === \"product_owner\" ? \"freelancer\" : \"product_owner\";\n      \n      await storage.createNotification({\n        userId: recipientId,\n        userType: recipientType,\n        title: \"رسالة جديدة\",\n        message: `لديك رسالة جديدة في المحادثة`,\n        type: \"new_message\",\n      });\n\n      res.json(message);\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إرسال الرسالة\" });\n    }\n  });\n\n  // ============================================\n  // GROUP POSTS ROUTES (Community Feature)\n  // ============================================\n\n  // Get posts by group (with optional filtering and sorting)\n  app.get(\"/api/groups/:groupId/posts\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { sort, mediaOnly } = req.query;\n      const userId = req.user!.userId;\n\n      // Verify user is a group member or leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"المجموعة غير موجودة\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, userId);\n      const isLeader = group.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      let posts = await storage.getPostsByGroup(groupId);\n      \n      // Filter media-only posts if requested\n      if (mediaOnly === 'true') {\n        posts = posts.filter(post => post.imageUrl);\n      }\n      \n      // Sort posts if requested\n      if (sort === 'popular') {\n        posts = posts.sort((a, b) => {\n          const scoreA = (a.likesCount || 0) + (a.commentsCount || 0);\n          const scoreB = (b.likesCount || 0) + (b.commentsCount || 0);\n          return scoreB - scoreA;\n        });\n      }\n      \n      res.json(posts);\n    } catch (error) {\n      console.error(\"Error fetching group posts:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المنشورات\" });\n    }\n  });\n\n  // Create post\n  app.post(\"/api/groups/:groupId/posts\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { content, imageUrl } = req.body;\n      const userId = req.user!.userId;\n\n      // Validate content\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى المنشور مطلوب\" });\n      }\n\n      // Verify user is a group member or leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"المجموعة غير موجودة\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, userId);\n      const isLeader = group.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const newPost = await storage.createPost({\n        groupId,\n        authorId: userId,\n        content: content.trim(),\n        imageUrl: imageUrl || null,\n      });\n\n      res.status(201).json(newPost);\n    } catch (error) {\n      console.error(\"Error creating post:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المنشور\" });\n    }\n  });\n\n  // Delete post\n  app.delete(\"/api/posts/:postId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Only author or group leader can delete\n      const group = await storage.getGroup(post.groupId);\n      if (post.authorId !== userId && group?.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح لك بحذف هذا المنشور\" });\n      }\n\n      await storage.deletePost(postId);\n      res.json({ message: \"تم حذف المنشور بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting post:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف المنشور\" });\n    }\n  });\n\n  // Get comments for a post\n  app.get(\"/api/posts/:postId/comments\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const comments = await storage.getCommentsByPost(postId);\n      res.json(comments);\n    } catch (error) {\n      console.error(\"Error fetching comments:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب التعليقات\" });\n    }\n  });\n\n  // Create comment\n  app.post(\"/api/posts/:postId/comments\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const { content, imageUrl } = req.body;\n      const userId = req.user!.userId;\n\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى التعليق مطلوب\" });\n      }\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const newComment = await storage.createComment({\n        postId,\n        authorId: userId,\n        content: content.trim(),\n        imageUrl: imageUrl || null,\n      });\n\n      res.status(201).json(newComment);\n    } catch (error) {\n      console.error(\"Error creating comment:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء التعليق\" });\n    }\n  });\n\n  // Delete comment\n  app.delete(\"/api/comments/:commentId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { commentId } = req.params;\n      const userId = req.user!.userId;\n\n      const [comment] = await db.select().from(postComments).where(eq(postComments.id, commentId));\n      \n      if (!comment) {\n        return res.status(404).json({ error: \"التعليق غير موجود\" });\n      }\n\n      const post = await storage.getPost(comment.postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Only author or group leader can delete\n      const group = await storage.getGroup(post.groupId);\n      if (comment.authorId !== userId && group?.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح لك بحذف هذا التعليق\" });\n      }\n\n      await storage.deleteComment(commentId);\n      res.json({ message: \"تم حذف التعليق بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting comment:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف التعليق\" });\n    }\n  });\n\n  // Get reactions for a post\n  app.get(\"/api/posts/:postId/reactions\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      const reactions = await storage.getReactionsByPost(postId);\n      const userReaction = await storage.getUserReaction(postId, userId);\n\n      res.json({ reactions, userReaction });\n    } catch (error) {\n      console.error(\"Error fetching reactions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب التفاعلات\" });\n    }\n  });\n\n  // Toggle reaction (like/unlike)\n  app.post(\"/api/posts/:postId/reactions\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const { type = \"like\" } = req.body;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      // Check if user already reacted\n      const existingReaction = await storage.getUserReaction(postId, userId);\n\n      if (existingReaction) {\n        // Remove reaction (unlike)\n        await storage.deleteReaction(postId, userId);\n        res.json({ message: \"تم إلغاء الإعجاب\", liked: false });\n      } else {\n        // Add reaction (like)\n        await storage.createReaction({\n          postId,\n          userId,\n          type,\n        });\n        res.json({ message: \"تم الإعجاب بالمنشور\", liked: true });\n      }\n    } catch (error) {\n      console.error(\"Error toggling reaction:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التفاعل مع المنشور\" });\n    }\n  });\n\n  // ============================================\n  // HEALTH CHECK\n  // ============================================\n\n  app.get(\"/api/health\", (req, res) => {\n    res.json({ status: \"ok\", message: \"Sumou API is running\" });\n  });\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","size_bytes":99963},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\n// Serve uploaded files\napp.use('/uploads', express.static('uploads'));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2283},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/Navbar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Menu, X, LogIn, UserPlus, User, LogOut, LayoutDashboard, Settings, Briefcase, Building2 } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { NotificationsDropdown } from \"@/components/NotificationsDropdown\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport function Navbar() {\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [user, setUser] = useState<any>(null);\n  const [userType, setUserType] = useState<string | null>(null);\n  const [, navigate] = useLocation();\n\n  const loadUserData = () => {\n    const token = localStorage.getItem(\"token\");\n    const userData = localStorage.getItem(\"user\");\n    const type = localStorage.getItem(\"userType\");\n    \n    if (token && userData) {\n      try {\n        setUser(JSON.parse(userData));\n        setUserType(type);\n      } catch (e) {\n        console.error(\"Error parsing user data:\", e);\n        setUser(null);\n        setUserType(null);\n      }\n    } else {\n      setUser(null);\n      setUserType(null);\n    }\n  };\n\n  useEffect(() => {\n    loadUserData();\n\n    // Listen for storage events (login/logout in other tabs)\n    const handleStorageChange = (e: StorageEvent) => {\n      if (e.key === \"user\" || e.key === \"token\" || e.key === \"userType\") {\n        loadUserData();\n      }\n    };\n\n    // Listen for custom login event\n    const handleLoginEvent = () => {\n      loadUserData();\n    };\n\n    window.addEventListener(\"storage\", handleStorageChange);\n    window.addEventListener(\"userLoggedIn\", handleLoginEvent);\n\n    return () => {\n      window.removeEventListener(\"storage\", handleStorageChange);\n      window.removeEventListener(\"userLoggedIn\", handleLoginEvent);\n    };\n  }, []);\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"userType\");\n    setUser(null);\n    navigate(\"/\");\n  };\n\n  const getUserInitials = () => {\n    if (!user?.fullName) return \"م\";\n    const names = user.fullName.split(\" \");\n    if (names.length >= 2) {\n      return names[0][0] + names[1][0];\n    }\n    return names[0][0];\n  };\n\n  const getUserTypeBadge = () => {\n    if (userType === \"freelancer\") {\n      return (\n        <Badge variant=\"default\" className=\"text-xs gap-1 bg-primary/90 hover:bg-primary\" data-testid=\"badge-user-type\">\n          <Briefcase className=\"h-3 w-3\" />\n          مستقل\n        </Badge>\n      );\n    } else if (userType === \"product_owner\") {\n      return (\n        <Badge variant=\"secondary\" className=\"text-xs gap-1\" data-testid=\"badge-user-type\">\n          <Building2 className=\"h-3 w-3\" />\n          صاحب مشروع\n        </Badge>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <nav className=\"sticky top-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center h-16\">\n          {/* Logo */}\n          <Link href=\"/\">\n            <div className=\"flex items-center gap-2 hover-elevate active-elevate-2 px-3 py-2 rounded-xl transition-all cursor-pointer\" data-testid=\"link-home\">\n              <div className=\"text-2xl font-bold bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">\n                سُمُوّ\n              </div>\n            </div>\n          </Link>\n\n          {/* Desktop Navigation */}\n          <div className=\"hidden md:flex items-center gap-2\">\n            <Link href=\"/\">\n              <div className=\"px-4 py-2 hover-elevate active-elevate-2 rounded-xl transition-all text-sm font-medium cursor-pointer\" data-testid=\"link-home-nav\">\n                الرئيسية\n              </div>\n            </Link>\n            <Link href=\"/services\">\n              <div className=\"px-4 py-2 hover-elevate active-elevate-2 rounded-xl transition-all text-sm font-medium cursor-pointer\" data-testid=\"link-services-nav\">\n                الخدمات\n              </div>\n            </Link>\n            <Link href=\"/groups\">\n              <div className=\"px-4 py-2 hover-elevate active-elevate-2 rounded-xl transition-all text-sm font-medium cursor-pointer\" data-testid=\"link-groups-nav\">\n                الجروبات\n              </div>\n            </Link>\n            <Link href=\"/projects\">\n              <div className=\"px-4 py-2 hover-elevate active-elevate-2 rounded-xl transition-all text-sm font-medium cursor-pointer\" data-testid=\"link-projects-nav\">\n                المشاريع\n              </div>\n            </Link>\n            <Link href=\"/freelancers\">\n              <div className=\"px-4 py-2 hover-elevate active-elevate-2 rounded-xl transition-all text-sm font-medium cursor-pointer\" data-testid=\"link-freelancers-nav\">\n                المستقلين\n              </div>\n            </Link>\n          </div>\n\n          {/* Desktop CTA Buttons / User Profile */}\n          <div className=\"hidden md:flex items-center gap-3\">\n            {user ? (\n              <>\n                <NotificationsDropdown />\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <button className=\"flex items-center gap-2 hover-elevate active-elevate-2 rounded-xl px-3 py-2\" data-testid=\"button-user-menu\">\n                      <div className=\"relative\">\n                        <Avatar className=\"h-8 w-8\" data-testid=\"avatar-user\">\n                          <AvatarImage src={user.profileImage} alt={user.fullName} />\n                          <AvatarFallback className=\"bg-primary/10 text-primary text-sm font-semibold\">\n                            {getUserInitials()}\n                          </AvatarFallback>\n                        </Avatar>\n                        {userType && (\n                          <div className=\"absolute -bottom-1 -right-1 bg-background rounded-full p-0.5\" data-testid=\"avatar-badge-container\">\n                            {userType === \"freelancer\" ? (\n                              <Briefcase className=\"h-3 w-3 text-primary\" data-testid=\"icon-freelancer\" />\n                            ) : (\n                              <Building2 className=\"h-3 w-3 text-secondary-foreground\" data-testid=\"icon-product-owner\" />\n                            )}\n                          </div>\n                        )}\n                      </div>\n                      <span className=\"text-sm font-medium\">{user.fullName}</span>\n                    </button>\n                  </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\" className=\"w-56 rounded-xl\">\n                  <DropdownMenuLabel className=\"font-normal\">\n                    <div className=\"flex flex-col space-y-2\">\n                      <p className=\"text-sm font-medium\">{user.fullName}</p>\n                      <p className=\"text-xs text-muted-foreground\">{user.email}</p>\n                      {getUserTypeBadge()}\n                    </div>\n                  </DropdownMenuLabel>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={() => navigate(\"/dashboard\")} data-testid=\"menu-dashboard\">\n                    <LayoutDashboard className=\"ml-2 h-4 w-4\" />\n                    لوحة التحكم\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => navigate(\"/profile\")} data-testid=\"menu-profile\">\n                    <User className=\"ml-2 h-4 w-4\" />\n                    الملف الشخصي\n                  </DropdownMenuItem>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={handleLogout} className=\"text-destructive\" data-testid=\"menu-logout\">\n                    <LogOut className=\"ml-2 h-4 w-4\" />\n                    تسجيل الخروج\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n              </>\n            ) : (\n              <>\n                <Link href=\"/login\">\n                  <Button variant=\"ghost\" className=\"rounded-2xl\" data-testid=\"button-login-header\">\n                    <LogIn className=\"ml-2 h-4 w-4\" />\n                    تسجيل الدخول\n                  </Button>\n                </Link>\n                <Link href=\"/role-selection\">\n                  <Button variant=\"default\" className=\"rounded-2xl\" data-testid=\"button-signup\">\n                    <UserPlus className=\"ml-2 h-4 w-4\" />\n                    إنشاء حساب\n                  </Button>\n                </Link>\n              </>\n            )}\n          </div>\n\n          {/* Mobile Menu Button */}\n          <button\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            className=\"md:hidden p-2 hover-elevate active-elevate-2 rounded-xl\"\n            data-testid=\"button-mobile-menu\"\n          >\n            {mobileMenuOpen ? <X className=\"h-6 w-6\" /> : <Menu className=\"h-6 w-6\" />}\n          </button>\n        </div>\n\n        {/* Mobile Menu */}\n        {mobileMenuOpen && (\n          <div className=\"md:hidden py-4 space-y-2 border-t\">\n            <Link href=\"/\">\n              <div className=\"block px-4 py-2 hover-elevate active-elevate-2 rounded-xl text-sm font-medium cursor-pointer\" data-testid=\"link-home-mobile\">\n                الرئيسية\n              </div>\n            </Link>\n            <Link href=\"/services\">\n              <div className=\"block px-4 py-2 hover-elevate active-elevate-2 rounded-xl text-sm font-medium cursor-pointer\" data-testid=\"link-services-mobile\">\n                الخدمات\n              </div>\n            </Link>\n            <Link href=\"/groups\">\n              <div className=\"block px-4 py-2 hover-elevate active-elevate-2 rounded-xl text-sm font-medium cursor-pointer\" data-testid=\"link-groups-mobile\">\n                الجروبات\n              </div>\n            </Link>\n            <Link href=\"/projects\">\n              <div className=\"block px-4 py-2 hover-elevate active-elevate-2 rounded-xl text-sm font-medium cursor-pointer\" data-testid=\"link-projects-mobile\">\n                المشاريع\n              </div>\n            </Link>\n            <Link href=\"/freelancers\">\n              <div className=\"block px-4 py-2 hover-elevate active-elevate-2 rounded-xl text-sm font-medium cursor-pointer\" data-testid=\"link-freelancers-mobile\">\n                المستقلين\n              </div>\n            </Link>\n            \n            <div className=\"pt-2 flex flex-col gap-2\">\n              {user ? (\n                <>\n                  <div className=\"flex items-center gap-3 px-4 py-2 rounded-xl border\" data-testid=\"mobile-user-info\">\n                    <div className=\"relative\">\n                      <Avatar className=\"h-10 w-10\">\n                        <AvatarImage src={user.profileImage} alt={user.fullName} />\n                        <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n                          {getUserInitials()}\n                        </AvatarFallback>\n                      </Avatar>\n                      {userType && (\n                        <div className=\"absolute -bottom-1 -right-1 bg-background rounded-full p-0.5\" data-testid=\"avatar-badge-container-mobile\">\n                          {userType === \"freelancer\" ? (\n                            <Briefcase className=\"h-3 w-3 text-primary\" />\n                          ) : (\n                            <Building2 className=\"h-3 w-3 text-secondary-foreground\" />\n                          )}\n                        </div>\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm font-medium\">{user.fullName}</p>\n                      <p className=\"text-xs text-muted-foreground\">{user.email}</p>\n                      <div className=\"mt-1\">{getUserTypeBadge()}</div>\n                    </div>\n                  </div>\n                  <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" onClick={() => { navigate(\"/dashboard\"); setMobileMenuOpen(false); }} data-testid=\"button-dashboard-mobile\">\n                    <LayoutDashboard className=\"ml-2 h-4 w-4\" />\n                    لوحة التحكم\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" onClick={() => { navigate(\"/profile\"); setMobileMenuOpen(false); }} data-testid=\"button-profile-mobile\">\n                    <User className=\"ml-2 h-4 w-4\" />\n                    الملف الشخصي\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start text-destructive\" onClick={() => { handleLogout(); setMobileMenuOpen(false); }} data-testid=\"button-logout-mobile\">\n                    <LogOut className=\"ml-2 h-4 w-4\" />\n                    تسجيل الخروج\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Link href=\"/login\">\n                    <Button variant=\"outline\" className=\"w-full rounded-2xl\" data-testid=\"button-login-mobile\">\n                      <LogIn className=\"ml-2 h-4 w-4\" />\n                      تسجيل الدخول\n                    </Button>\n                  </Link>\n                  <Link href=\"/role-selection\">\n                    <Button variant=\"default\" className=\"w-full rounded-2xl\" data-testid=\"button-signup-mobile\">\n                      <UserPlus className=\"ml-2 h-4 w-4\" />\n                      إنشاء حساب\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </nav>\n  );\n}\n","size_bytes":14046},"replit.md":{"content":"# منصة سُمُوّ - Sumou Platform\n\n## Overview\nSumou Platform is an Arabic digital platform connecting professional freelancers with digital product owners. Its primary purpose is to facilitate application, website, and system testing, provide authentic reviews, and enhance social media engagement. The platform aims to be a robust marketplace for digital product quality assurance and improvement, with a vision to become a leading hub for digital product enhancement services in the Arabic-speaking world.\n\n## User Preferences\nI prefer the AI to maintain a professional yet approachable tone. When suggesting code changes, provide clear, concise explanations for the rationale behind the changes. Prioritize iterative development, presenting changes in manageable chunks. For significant architectural decisions or major code overhauls, please ask for confirmation before proceeding. Ensure all communication is clear and directly addresses the task at hand. I prefer to maintain the existing file structure and naming conventions unless a strong, justified reason for alteration is presented.\n\n## System Architecture\nThe platform is built with a modern web stack, featuring a modular project structure with `client/`, `server/`, and `shared/` directories.\n\n**UI/UX Decisions:**\n- **Design Language:** Modern SaaS aesthetic with soft shadows, rounded edges, and a clean layout.\n- **Color Scheme:** Primary deep blue (#002e62), white background (#FAFAFA).\n- **Typography:** Tajawal Bold/Thick (Arabic), Inter (English).\n- **Responsiveness & RTL:** Fully responsive design with comprehensive Right-to-Left (RTL) support.\n- **Interactive Elements:** Hover effects, 3D elevations, and Framer Motion animations.\n- **Component Library:** Shadcn UI for consistent and rapid development.\n- **Icon System:** All UI elements use lucide-react icons exclusively (NO emojis permitted). Icon usage follows semantic color coding: CheckCircle2 (positive/approval), XCircle (prohibitions), AlertTriangle (warnings), Lightbulb (recommendations), Wallet (financial), Pin (objectives), ShieldAlert (security/policy).\n\n**Technical Implementations & Feature Specifications:**\n- **Frontend:** React with TypeScript, Wouter for routing, Tailwind CSS, Shadcn UI, React Hook Form with Zod for validation, and TanStack Query for data management.\n- **Backend:** Express.js.\n- **Forms:** Multi-step forms with robust validation for registration. All auth forms include autocomplete attributes.\n- **User Authentication:** JWT-based sessions and role-based authorization. Navbar synchronizes immediately after signup/login. Profile page shows graceful error states. User data read from localStorage at form submission.\n- **Mandatory Instructions for Both User Types:** \n    - **Freelancers:** Must accept comprehensive 5-section guidelines (FreelancerInstructions.tsx) covering ethical review practices (minimum 3.4-star ratings), platform liability, professional conduct, and **money holding policy** (Section 5: 7-day hold period with Wallet/Pin/CheckCircle2/ShieldAlert icons) before accessing the dashboard.\n    - **Product Owners:** Must accept 8-section guidelines (ProductOwnerInstructions.tsx) covering transparency requirements, truthful information provision, constructive feedback acceptance, company verification allowance, freelancer coordination policies, platform usage ethics, violation consequences, and **quality assurance mechanism** (Section 8: 7-day guarantee with CheckCircle2/Lightbulb/AlertTriangle icons for review deletion refunds and location-based freelancer selection recommendations).\n    - Both tracked by `acceptedInstructions` database field in respective tables.\n    - Signup flow: registration → mandatory instructions acceptance → dashboard access.\n    - All instruction pages use RTL layout with color-coded sections (blue for policies, green for benefits, amber for warnings, red for prohibitions) and lucide-react icons only (zero emojis).\n    - **Quality Assurance Features:**\n        - Product owners get 7-day guarantee: full refund if reviews are deleted\n        - Freelancers have 7-day earnings hold to ensure review legitimacy\n        - Recommendation system: choose freelancers from same country for better review retention\n- **Group-Based Work System:**\n    - **Groups:** Freelancers can create groups (up to 700 members) with custom image uploads (max 5MB) and a portfolio gallery (up to 12 images). Group leaders manage members, accept projects, and earn a 5% commission.\n    - **Projects:** Product owners create projects; group leaders browse and accept them. Project workflow: pending → accepted → in_progress → completed.\n    - **Tasks:** Leaders create and assign tasks to members. Task workflow: available → assigned → in_progress → submitted → approved/rejected. Members submit proof images/reports.\n    - **Internal Messaging:** Real-time messaging for group members (text, file, project-related).\n    - **Earnings & Withdrawals:** Automatic earnings calculation, wallet balance tracking, withdrawal request system (Vodafone Cash, Etisalat Cash, Orange Cash, Bank Card, Bank Transfer), and withdrawal history.\n- **Direct Purchase System:** Product owners can purchase services directly from group leaders (e.g., Google Play reviews, UX testing, Google Maps reviews) with defined pricing ($1-$2 per service). Payment methods include Vodafone Cash, Etisalat Cash, Orange Cash, Bank Card. Order management tracks status: pending → payment_confirmed → in_progress → completed.\n- **Conversations System:** Real-time messaging between product owners and group leaders for direct communication:\n    - **Database Schema:** Two tables: `conversations` (tracks conversation threads) and `conversationMessages` (stores individual messages)\n    - **Access Points:** \n        - Product owners: \"المحادثات\" page in dashboard sidebar (/product-owner-dashboard/conversations)\n        - Product owners: Dedicated chat page with leader profile (/groups/:id/chat)\n        - Freelancers: \"المحادثات\" page in dashboard sidebar (/freelancer-dashboard/conversations)\n    - **Conversation Initiation:** Product owners can start conversations from GroupDetails page via \"ابدأ محادثة\" (Start Conversation) button which redirects to dedicated chat page\n    - **Chat with Leader Page Features:**\n        - Split-view layout: leader profile card (right, sticky with z-50) and chat area (left)\n        - Leader profile displays: avatar, name, online status, service, rating (4.8 stars), location, response time, safety guidelines\n        - Safety guidelines with color-coded icons (ShieldAlert, CheckCircle2, AlertTriangle, Lightbulb)\n        - Action buttons: \"طلب محادثة شفهية\" (coming soon) and \"المحادثة النصية نشطة\"\n        - Auto-creates conversation on page load for authenticated product owners\n        - Message refresh every 3 seconds, auto-scroll to bottom, Enter to send\n    - **Message Features:** Real-time message display, sender identification (product_owner vs freelancer), read/unread status tracking, timestamp display\n    - **UI Components:** Split-view interface with conversation list and active chat area, RTL-optimized message bubbles\n    - **API Endpoints:** POST /api/conversations (create/get conversation), GET /api/conversations (list all), GET /api/conversations/:id/messages (fetch messages), POST /api/conversations/:id/messages (send message)\n    - **Security:** Backend authentication verification via /api/auth/user, role-based access control, conversation creation only for authenticated product owners\n- **Product Owner Signup:** Simplified 3-step form (Basic Info → Service Selection & Calculation → Confirmation) with 7 service types and automatic cost calculation based on quantity (1-1000 reviews).\n- **Dashboards:** Freelancer and Product Owner dashboards with real-time stats and modular Shadcn sidebar navigation. Freelancer dashboard has 9 pages: Overview, Available Tasks, My Tasks, Wallet, Withdrawals, Orders, Conversations, Notifications, Settings. Product Owner dashboard has 9 pages: Overview, Projects, Active Projects, Completed Projects, Payments, Orders, Conversations, Notifications, Settings.\n- **Notifications System (Nov 15, 2025):** Comprehensive notification system for both user types:\n    - **Database Schema:** notifications table with userId, userType, title, message, type, isRead, createdAt\n    - **Notification Pages:** Dedicated pages for both dashboards (/freelancer-dashboard/notifications, /product-owner-dashboard/notifications) with:\n        - Full list of notifications with icon-based types\n        - Mark individual notification as read\n        - Mark all as read functionality\n        - Unread badge counter\n        - RTL layout with color-coded notification types\n    - **Sidebar Integration:** Bell icon with \"الإشعارات\" link in both FreelancerSidebar and ProductOwnerSidebar\n    - **Automatic Notifications:** Backend creates notifications for:\n        - **Withdrawals:** withdrawal_created (when freelancer creates withdrawal request)\n        - **Orders:** payment_confirmed (both users), order_in_progress (both users), order_completed (both users)\n        - **Tasks:** task_assigned, task_submitted, task_approved, task_rejected\n        - **Messages:** new_message\n        - **Groups:** group_member_joined, group_member_removed\n    - **API Endpoints:** GET /api/notifications (filtered by user), GET /api/notifications/unread/count, PATCH /api/notifications/:id/read, PATCH /api/notifications/read-all\n    - **Icon Mapping:** Bell (general), CheckCircle2 (approved/completed), XCircle (rejected), Wallet (withdrawals/payments), MessageSquare (messages), Users (group), ClipboardList (tasks)\n- **Project Details Page:** Comprehensive project view (/projects/:id) displaying project information, task list, stats, and task creation interface (for group leaders).\n- **User Type Badge:** Visual indicator (briefcase for freelancers, building for product owners) displayed in the Navbar dropdown menu.\n- **Authentication Architecture:** `user`, `userType`, and `token` stored in localStorage. Role-based checks read `userType` from localStorage.\n- **API Request Layer:** `apiRequest()` function automatically includes JWT token in Authorization header for all authenticated mutations.\n- **Orders Display & Notifications:** Both dashboards display orders with service type, quantity, payment method, status, and total amount. A Navbar component includes a notifications dropdown with unread badge and mark-as-read functionality.\n- **Services Showcase Page:** Public-facing page (/services) displaying 4 main platform services with modern SaaS design:\n    - **Google Maps Reviews**: Professional Google Maps rating improvement with targeted audience engagement\n    - **App Reviews (Android & iOS)**: Authentic reviews for apps to increase trust and downloads\n    - **UX Testing**: Comprehensive user experience analysis before product launch\n    - **Social Media Engagement**: Real interaction services for increased reach and followers\n    - Design features: Dark navy background (#030712), gradient blue cards (navy→light blue), RTL layout, responsive 4-column grid, rounded corners (rounded-3xl), shadow effects, hover animations, AI-generated illustrations for each service\n- **Original Features:** Campaign management, freelancer listing, file uploads (profile images, ID verification, task proof), SEO/social media optimization, and Framer Motion animations on homepage.\n\n**System Design Choices:**\n- **Data Schemas:** Shared TypeScript data models for consistency across the stack.\n- **Layout Architecture:** \n    - Consistent sidebar width and proper `h-screen`/`overflow-auto` for scrollable content areas\n    - **Dashboard Layouts (Nov 15, 2025):** Fixed sidebar positioning to prevent content overlay. Structure: `SidebarProvider > flex wrapper (dir=\"rtl\") > Sidebar (side=\"right\") + main content`. Sidebar placed BEFORE content in DOM order to prevent overlay while maintaining RTL visual layout (sidebar appears on right, content on left). Both FreelancerDashboardLayout and ProductOwnerDashboardLayout use this pattern.\n\n## External Dependencies\n- **OpenAI (via Replit AI Integrations):** For AI-powered suggestions.\n- **Object Storage:** For file uploads (e.g., profile pictures, ID verifications).\n- **PostgreSQL:** For persistent data storage in production (Neon).","size_bytes":12465},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/pages/Login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useLocation } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { LogIn, Mail, Lock, Sparkles } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link } from \"wouter\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  password: z.string().min(1, \"كلمة المرور مطلوبة\"),\n  rememberMe: z.boolean().optional(),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      rememberMe: false,\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginFormData) => {\n      const response = await fetch(\"/api/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"فشل تسجيل الدخول\");\n      }\n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      // Store token and user data in localStorage\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", data.userType);\n      \n      // Dispatch custom event to update Navbar\n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم تسجيل الدخول بنجاح!\",\n        description: \"مرحبًا بعودتك إلى منصة سُمُوّ\",\n      });\n      \n      // Navigate based on user type\n      if (data.userType === \"product_owner\") {\n        navigate(\"/campaigns\");\n      } else {\n        navigate(\"/dashboard\");\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ في تسجيل الدخول\",\n        description: error.message || \"البريد الإلكتروني أو كلمة المرور غير صحيحة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginFormData) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 flex items-center justify-center py-12 px-4\">\n        <div className=\"w-full max-w-md\">\n          {/* Header */}\n          <div className=\"text-center mb-8 space-y-3\">\n            <div className=\"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-2\">\n              <Sparkles className=\"h-4 w-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">مرحبًا بعودتك</span>\n            </div>\n            <h1 className=\"text-3xl font-bold\">تسجيل الدخول</h1>\n            <p className=\"text-muted-foreground\">\n              ادخل إلى حسابك في منصة سُمُوّ\n            </p>\n          </div>\n\n          {/* Login Card */}\n          <Card className=\"rounded-2xl shadow-xl border-2\">\n            <CardHeader className=\"space-y-2 pb-6\">\n              <CardTitle className=\"text-2xl text-center\">تسجيل الدخول</CardTitle>\n              <CardDescription className=\"text-center\">\n                ادخل بياناتك للوصول إلى حسابك\n              </CardDescription>\n            </CardHeader>\n\n            <CardContent className=\"space-y-6\">\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                  {/* Email Field */}\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"flex items-center gap-2\">\n                          <Mail className=\"h-4 w-4 text-primary\" />\n                          البريد الإلكتروني\n                        </FormLabel>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            type=\"email\"\n                            placeholder=\"example@email.com\" \n                            className=\"rounded-xl h-11\" \n                            data-testid=\"input-email\"\n                            autoComplete=\"email\"\n                            name=\"email\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Password Field */}\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"flex items-center gap-2\">\n                          <Lock className=\"h-4 w-4 text-primary\" />\n                          كلمة المرور\n                        </FormLabel>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            type=\"password\"\n                            placeholder=\"••••••••\" \n                            className=\"rounded-xl h-11\" \n                            data-testid=\"input-password\"\n                            autoComplete=\"current-password\"\n                            name=\"password\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Remember Me & Forgot Password */}\n                  <div className=\"flex items-center justify-between\">\n                    <FormField\n                      control={form.control}\n                      name=\"rememberMe\"\n                      render={({ field }) => (\n                        <FormItem className=\"flex items-center gap-2 space-y-0\">\n                          <FormControl>\n                            <Checkbox\n                              checked={field.value}\n                              onCheckedChange={field.onChange}\n                              data-testid=\"checkbox-remember\"\n                            />\n                          </FormControl>\n                          <FormLabel className=\"text-sm cursor-pointer mt-0\">\n                            تذكرني\n                          </FormLabel>\n                        </FormItem>\n                      )}\n                    />\n                    <a \n                      href=\"#forgot-password\" \n                      className=\"text-sm text-primary hover:underline\"\n                      data-testid=\"link-forgot-password\"\n                    >\n                      نسيت كلمة المرور؟\n                    </a>\n                  </div>\n\n                  {/* Submit Button */}\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full rounded-xl h-11 text-base\"\n                    disabled={loginMutation.isPending}\n                    data-testid=\"button-login\"\n                  >\n                    {loginMutation.isPending ? (\n                      \"جاري تسجيل الدخول...\"\n                    ) : (\n                      <>\n                        <LogIn className=\"ml-2 h-5 w-5\" />\n                        تسجيل الدخول\n                      </>\n                    )}\n                  </Button>\n\n                  {/* Divider */}\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-0 flex items-center\">\n                      <div className=\"w-full border-t\"></div>\n                    </div>\n                    <div className=\"relative flex justify-center text-xs\">\n                      <span className=\"bg-card px-3 text-muted-foreground\">\n                        أو\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* Sign Up Link */}\n                  <div className=\"text-center space-y-3\">\n                    <p className=\"text-sm text-muted-foreground\">\n                      ليس لديك حساب؟{\" \"}\n                      <Link href=\"/role-selection\" className=\"text-primary font-semibold hover:underline\" data-testid=\"link-signup\">\n                        أنشئ حسابًا جديدًا\n                      </Link>\n                    </p>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n\n          {/* Additional Info */}\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-xs text-muted-foreground\">\n              بتسجيل الدخول، أنت توافق على{\" \"}\n              <a href=\"#terms\" className=\"text-primary hover:underline\" data-testid=\"link-terms\">الشروط والأحكام</a>\n              {\" \"}و{\" \"}\n              <a href=\"#privacy\" className=\"text-primary hover:underline\" data-testid=\"link-privacy\">سياسة الخصوصية</a>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":10071},"client/src/pages/Freelancers.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { motion } from \"framer-motion\";\nimport {\n  Users,\n  MapPin,\n  Star,\n  Briefcase,\n  CheckCircle2,\n  Mail,\n  Phone,\n  Award,\n  TrendingUp,\n  Shield,\n  Search,\n  Filter\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\ntype Freelancer = {\n  id: string;\n  email: string;\n  fullName: string;\n  username: string;\n  phone: string;\n  countryCode: string;\n  jobTitle?: string;\n  teamSize?: number;\n  services: string[];\n  bio?: string;\n  aboutMe?: string;\n  profileImage?: string;\n  isVerified?: boolean;\n  createdAt: string;\n};\n\nexport default function Freelancers() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedService, setSelectedService] = useState<string>(\"all\");\n\n  const { data: freelancers, isLoading } = useQuery<Freelancer[]>({\n    queryKey: [\"/api/freelancers\"],\n  });\n\n  // Filter freelancers based on search and service\n  const filteredFreelancers = freelancers?.filter((freelancer) => {\n    const matchesSearch = \n      freelancer.fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      freelancer.username.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      (freelancer.jobTitle ?? \"\").toLowerCase().includes(searchTerm.toLowerCase());\n\n    const matchesService = \n      selectedService === \"all\" || \n      freelancer.services.includes(selectedService);\n\n    return matchesSearch && matchesService;\n  });\n\n  // Get unique services from all freelancers\n  const allServices = Array.from(\n    new Set(freelancers?.flatMap((f) => f.services) || [])\n  );\n\n  // Get initials for avatar fallback\n  const getInitials = (name: string) => {\n    return name\n      .split(\" \")\n      .map((n) => n[0])\n      .join(\"\")\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  // Format date\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return new Intl.DateTimeFormat(\"ar-SA\", {\n      year: \"numeric\",\n      month: \"long\",\n    }).format(date);\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n\n      {/* Hero Section */}\n      <section className=\"relative bg-gradient-to-br from-background via-background to-primary/5 py-16 border-b\">\n        <div className=\"absolute inset-0 bg-grid-pattern opacity-5\"></div>\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative\">\n          <div className=\"text-center space-y-6\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5 }}\n            >\n              <div className=\"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-4\">\n                <Users className=\"h-5 w-5 text-primary\" />\n                <span className=\"text-sm font-medium text-primary\" data-testid=\"text-freelancers-count\">\n                  {freelancers?.length || 0}+ مستقل محترف\n                </span>\n              </div>\n              \n              <h1 className=\"text-4xl sm:text-5xl font-bold mb-4\" data-testid=\"text-page-title\">\n                <span className=\"bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">\n                  المستقلون المحترفون\n                </span>\n              </h1>\n              \n              <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\" data-testid=\"text-page-description\">\n                اكتشف أفضل المتخصصين في اختبار التطبيقات، التقييمات، وتحسين تجربة المستخدم\n              </p>\n            </motion.div>\n\n            {/* Stats */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n              className=\"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto mt-8\"\n            >\n              <div className=\"bg-card/50 backdrop-blur-sm rounded-2xl p-4 border hover-elevate\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Award className=\"h-5 w-5 text-amber-500\" />\n                  <span className=\"text-2xl font-bold text-amber-500\" data-testid=\"text-verified-count\">\n                    {freelancers?.filter(f => f.isVerified)?.length || 0}\n                  </span>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">مستقل موثق</p>\n              </div>\n\n              <div className=\"bg-card/50 backdrop-blur-sm rounded-2xl p-4 border hover-elevate\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Briefcase className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-2xl font-bold text-primary\" data-testid=\"text-services-count\">\n                    {allServices.length}\n                  </span>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">خدمة متنوعة</p>\n              </div>\n\n              <div className=\"bg-card/50 backdrop-blur-sm rounded-2xl p-4 border hover-elevate\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <TrendingUp className=\"h-5 w-5 text-green-500\" />\n                  <span className=\"text-2xl font-bold text-green-500\" data-testid=\"text-success-rate\">98%</span>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">نسبة النجاح</p>\n              </div>\n\n              <div className=\"bg-card/50 backdrop-blur-sm rounded-2xl p-4 border hover-elevate\">\n                <div className=\"flex items-center justify-center gap-2 mb-2\">\n                  <Shield className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-2xl font-bold text-primary\" data-testid=\"text-reliability\">100%</span>\n                </div>\n                <p className=\"text-sm text-muted-foreground\">موثوقية</p>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Filters Section */}\n      <section className=\"bg-background border-b sticky top-16 z-40 backdrop-blur-sm bg-background/95\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            {/* Search */}\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"ابحث عن مستقل...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pr-10\"\n                data-testid=\"input-search\"\n              />\n            </div>\n\n            {/* Service Filter */}\n            <div className=\"flex items-center gap-2 md:w-64\">\n              <Filter className=\"h-4 w-4 text-muted-foreground\" />\n              <Select value={selectedService} onValueChange={setSelectedService}>\n                <SelectTrigger data-testid=\"select-service-filter\">\n                  <SelectValue placeholder=\"جميع الخدمات\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">جميع الخدمات</SelectItem>\n                  {allServices.map((service) => (\n                    <SelectItem key={service} value={service}>\n                      {service}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          {/* Results Count */}\n          <div className=\"mt-4 text-sm text-muted-foreground\" data-testid=\"text-results-count\">\n            عرض {filteredFreelancers?.length || 0} من {freelancers?.length || 0} مستقل\n          </div>\n        </div>\n      </section>\n\n      {/* Freelancers Grid */}\n      <section className=\"flex-1 py-12 bg-muted/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[...Array(6)].map((_, i) => (\n                <Card key={i} className=\"rounded-3xl\">\n                  <CardHeader className=\"space-y-4\">\n                    <div className=\"flex items-start gap-4\">\n                      <Skeleton className=\"h-16 w-16 rounded-full\" />\n                      <div className=\"flex-1 space-y-2\">\n                        <Skeleton className=\"h-5 w-32\" />\n                        <Skeleton className=\"h-4 w-24\" />\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <Skeleton className=\"h-20 w-full\" />\n                    <div className=\"flex gap-2\">\n                      <Skeleton className=\"h-6 w-16\" />\n                      <Skeleton className=\"h-6 w-20\" />\n                    </div>\n                    <Skeleton className=\"h-10 w-full\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredFreelancers && filteredFreelancers.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {filteredFreelancers.map((freelancer, index) => (\n                <motion.div\n                  key={freelancer.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: index * 0.05 }}\n                >\n                  <Card \n                    className=\"rounded-3xl hover-elevate active-elevate-2 transition-all h-full border-2 relative overflow-visible\"\n                    data-testid={`card-freelancer-${freelancer.id}`}\n                  >\n                    {/* Verified Badge */}\n                    {freelancer.isVerified && (\n                      <div className=\"absolute -top-3 -left-3 z-10\">\n                        <Badge className=\"bg-green-500 text-white hover:bg-green-600 rounded-xl px-3 py-1 shadow-lg\" data-testid={`badge-verified-${freelancer.id}`}>\n                          <CheckCircle2 className=\"h-3 w-3 ml-1\" />\n                          موثق\n                        </Badge>\n                      </div>\n                    )}\n\n                    <CardHeader className=\"space-y-4\">\n                      <div className=\"flex items-start gap-4\">\n                        {/* Avatar */}\n                        <Avatar className=\"h-16 w-16 border-2 border-primary/20\">\n                          <AvatarImage src={freelancer.profileImage} alt={freelancer.fullName} />\n                          <AvatarFallback className=\"bg-primary/10 text-primary font-bold text-lg\">\n                            {getInitials(freelancer.fullName)}\n                          </AvatarFallback>\n                        </Avatar>\n\n                        {/* Name & Title */}\n                        <div className=\"flex-1 min-w-0\">\n                          <h3 className=\"font-bold text-lg mb-1 truncate\" data-testid={`text-freelancer-name-${freelancer.id}`}>\n                            {freelancer.fullName}\n                          </h3>\n                          <p className=\"text-sm text-muted-foreground mb-1\" data-testid={`text-freelancer-username-${freelancer.id}`}>\n                            @{freelancer.username}\n                          </p>\n                          {freelancer.jobTitle && (\n                            <Badge variant=\"secondary\" className=\"text-xs\" data-testid={`badge-job-title-${freelancer.id}`}>\n                              <Briefcase className=\"h-3 w-3 ml-1\" />\n                              {freelancer.jobTitle}\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                    </CardHeader>\n\n                    <CardContent className=\"space-y-4\">\n                      {/* Bio */}\n                      {freelancer.bio && (\n                        <p className=\"text-sm text-muted-foreground line-clamp-3\" data-testid={`text-freelancer-bio-${freelancer.id}`}>\n                          {freelancer.bio}\n                        </p>\n                      )}\n\n                      {/* Services */}\n                      {freelancer.services.length > 0 && (\n                        <div className=\"space-y-2\">\n                          <p className=\"text-xs font-semibold text-muted-foreground flex items-center gap-1\">\n                            <Star className=\"h-3 w-3\" />\n                            الخدمات المتاحة\n                          </p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {freelancer.services.slice(0, 3).map((service, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"text-xs bg-primary/5 border-primary/20\"\n                                data-testid={`badge-service-${freelancer.id}-${i}`}\n                              >\n                                {service}\n                              </Badge>\n                            ))}\n                            {freelancer.services.length > 3 && (\n                              <Badge variant=\"outline\" className=\"text-xs\" data-testid={`badge-more-services-${freelancer.id}`}>\n                                +{freelancer.services.length - 3}\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Team Size */}\n                      {freelancer.teamSize && freelancer.teamSize > 1 && (\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\" data-testid={`text-team-size-${freelancer.id}`}>\n                          <Users className=\"h-4 w-4\" />\n                          <span>فريق من {freelancer.teamSize} أعضاء</span>\n                        </div>\n                      )}\n\n                      {/* Contact Info */}\n                      <div className=\"space-y-2 pt-4 border-t\">\n                        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\" data-testid={`text-freelancer-email-${freelancer.id}`}>\n                          <Mail className=\"h-3 w-3\" />\n                          <span className=\"truncate\">{freelancer.email}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\" data-testid={`text-freelancer-phone-${freelancer.id}`}>\n                          <Phone className=\"h-3 w-3\" />\n                          <span>{freelancer.countryCode} {freelancer.phone}</span>\n                        </div>\n                      </div>\n\n                      {/* Join Date */}\n                      <div className=\"flex items-center gap-2 text-xs text-muted-foreground\" data-testid={`text-join-date-${freelancer.id}`}>\n                        <MapPin className=\"h-3 w-3\" />\n                        <span>انضم في {formatDate(freelancer.createdAt)}</span>\n                      </div>\n\n                      {/* Action Button */}\n                      <Button\n                        className=\"w-full rounded-2xl\"\n                        variant=\"default\"\n                        data-testid={`button-contact-${freelancer.id}`}\n                      >\n                        <Mail className=\"ml-2 h-4 w-4\" />\n                        تواصل الآن\n                      </Button>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-16\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-muted mb-4\">\n                <Users className=\"h-8 w-8 text-muted-foreground\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-2\">لا توجد نتائج</h3>\n              <p className=\"text-muted-foreground\">\n                جرب تغيير معايير البحث أو الفلتر\n              </p>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":16996},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/pages/RoleSelection.tsx":{"content":"import { Link } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Users, Briefcase, Sparkles } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function RoleSelection() {\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n\n      <div className=\"flex-1 py-16 px-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"text-center mb-12\">\n            <div className=\"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-6\">\n              <Sparkles className=\"h-4 w-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">ابدأ رحلتك معنا</span>\n            </div>\n            <h1 className=\"text-4xl font-bold mb-4\" data-testid=\"text-role-title\">\n              اختر نوع حسابك\n            </h1>\n            <p className=\"text-lg text-muted-foreground\">\n              هل أنت مستقل تبحث عن فرص أم صاحب منتج تحتاج لاختباره؟\n            </p>\n          </div>\n\n          <div className=\"flex justify-center gap-4 flex-wrap\">\n            <Link href=\"/freelancer-signup\">\n              <motion.div\n                className=\"inline-flex items-center justify-center gap-2 rounded-full py-6 px-12 text-lg font-bold shadow-lg bg-primary text-primary-foreground hover-elevate active-elevate-2 cursor-pointer transition-all\"\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                transition={{ duration: 0.2 }}\n                data-testid=\"button-freelancer\"\n              >\n                <Users className=\"h-6 w-6\" />\n                <span>مستقل محترف</span>\n              </motion.div>\n            </Link>\n\n            <Link href=\"/product-owner-signup\">\n              <motion.div\n                className=\"inline-flex items-center justify-center gap-2 rounded-full py-6 px-12 text-lg font-bold shadow-lg bg-primary text-primary-foreground hover-elevate active-elevate-2 cursor-pointer transition-all\"\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                transition={{ duration: 0.2 }}\n                data-testid=\"button-owner\"\n              >\n                <Briefcase className=\"h-6 w-6\" />\n                <span>صاحب منتج رقمي</span>\n              </motion.div>\n            </Link>\n          </div>\n\n          <div className=\"text-center mt-8\">\n            <p className=\"text-sm text-muted-foreground\">\n              لديك حساب بالفعل؟{\" \"}\n              <Link href=\"/login\" className=\"text-primary font-medium hover:underline\" data-testid=\"link-login\">\n                تسجيل الدخول\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":2896},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"server/storage.ts":{"content":"import { \n  type User, \n  type InsertUser,\n  type Freelancer,\n  type InsertFreelancer,\n  type ProductOwner,\n  type InsertProductOwner,\n  type Campaign,\n  type InsertCampaign,\n  type Task,\n  type InsertTask,\n  type Wallet,\n  type InsertWallet,\n  type Transaction,\n  type InsertTransaction,\n  type Payment,\n  type InsertPayment,\n  type Notification,\n  type InsertNotification,\n  type Group,\n  type InsertGroup,\n  type GroupMember,\n  type InsertGroupMember,\n  type Project,\n  type InsertProject,\n  type Message,\n  type InsertMessage,\n  type Withdrawal,\n  type InsertWithdrawal,\n  type Order,\n  type InsertOrder,\n  type Conversation,\n  type InsertConversation,\n  type ConversationMessage,\n  type InsertConversationMessage,\n  type GroupPost,\n  type InsertGroupPost,\n  type PostComment,\n  type InsertPostComment,\n  type PostReaction,\n  type InsertPostReaction,\n  users,\n  freelancers,\n  productOwners,\n  campaigns,\n  tasks,\n  wallets,\n  transactions,\n  payments,\n  notifications,\n  groups,\n  groupMembers,\n  projects,\n  messages,\n  withdrawals,\n  orders,\n  conversations,\n  conversationMessages,\n  groupPosts,\n  postComments,\n  postReactions,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, or, desc } from \"drizzle-orm\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // Legacy user methods (for compatibility)\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n\n  // Freelancer methods\n  getFreelancer(id: string): Promise<Freelancer | undefined>;\n  getFreelancerByEmail(email: string): Promise<Freelancer | undefined>;\n  getFreelancerByUsername(username: string): Promise<Freelancer | undefined>;\n  createFreelancer(freelancer: InsertFreelancer): Promise<Freelancer>;\n  updateFreelancer(id: string, updates: Partial<Freelancer>): Promise<Freelancer | undefined>;\n  getAllFreelancers(): Promise<Freelancer[]>;\n\n  // Product Owner methods\n  getProductOwner(id: string): Promise<ProductOwner | undefined>;\n  getProductOwnerByEmail(email: string): Promise<ProductOwner | undefined>;\n  createProductOwner(owner: InsertProductOwner): Promise<ProductOwner>;\n  updateProductOwner(id: string, updates: Partial<ProductOwner>): Promise<ProductOwner | undefined>;\n  getAllProductOwners(): Promise<ProductOwner[]>;\n\n  // Campaign methods\n  getCampaign(id: string): Promise<Campaign | undefined>;\n  getCampaignsByOwner(productOwnerId: string): Promise<Campaign[]>;\n  getAllCampaigns(): Promise<Campaign[]>;\n  getActiveCampaigns(): Promise<Campaign[]>;\n  createCampaign(campaign: InsertCampaign): Promise<Campaign>;\n  updateCampaign(id: string, updates: Partial<Campaign>): Promise<Campaign | undefined>;\n  deleteCampaign(id: string): Promise<void>;\n\n  // Task methods\n  getTask(id: string): Promise<Task | undefined>;\n  getTasksByCampaign(campaignId: string): Promise<Task[]>;\n  getTasksByFreelancer(freelancerId: string): Promise<Task[]>;\n  getAvailableTasks(): Promise<Task[]>;\n  createTask(task: InsertTask): Promise<Task>;\n  updateTask(id: string, updates: Partial<Task>): Promise<Task | undefined>;\n  assignTask(taskId: string, freelancerId: string): Promise<Task | undefined>;\n\n  // Wallet methods\n  getWalletByFreelancer(freelancerId: string): Promise<Wallet | undefined>;\n  createWallet(freelancerId: string): Promise<Wallet>;\n  updateWallet(id: string, updates: Partial<Wallet>): Promise<Wallet | undefined>;\n\n  // Transaction methods\n  getTransactionsByWallet(walletId: string): Promise<Transaction[]>;\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n\n  // Payment methods\n  getPaymentsByCampaign(campaignId: string): Promise<Payment[]>;\n  getPaymentsByOwner(productOwnerId: string): Promise<Payment[]>;\n  createPayment(payment: InsertPayment): Promise<Payment>;\n  updatePayment(id: string, updates: Partial<Payment>): Promise<Payment | undefined>;\n\n  // Notification methods\n  getNotificationsByUser(userId: string, userType: string): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: string): Promise<void>;\n\n  // Group methods\n  getGroup(id: string): Promise<Group | undefined>;\n  getAllGroups(): Promise<Group[]>;\n  getGroupsByLeader(leaderId: string): Promise<Group[]>;\n  getGroupsByMember(freelancerId: string): Promise<Group[]>;\n  createGroup(group: InsertGroup): Promise<Group>;\n  updateGroup(id: string, updates: Partial<Group>): Promise<Group | undefined>;\n\n  // Group Member methods\n  getGroupMembers(groupId: string): Promise<GroupMember[]>;\n  addGroupMember(member: InsertGroupMember): Promise<GroupMember>;\n  removeGroupMember(groupId: string, freelancerId: string): Promise<void>;\n  isGroupMember(groupId: string, freelancerId: string): Promise<boolean>;\n\n  // Group Join Request methods\n  getJoinRequestsByGroup(groupId: string): Promise<GroupJoinRequest[]>;\n  getJoinRequestByFreelancer(groupId: string, freelancerId: string): Promise<GroupJoinRequest | undefined>;\n  createJoinRequest(request: InsertGroupJoinRequest): Promise<GroupJoinRequest>;\n  updateJoinRequest(id: string, updates: Partial<GroupJoinRequest>): Promise<GroupJoinRequest | undefined>;\n  deleteJoinRequest(id: string): Promise<void>;\n\n  // Project methods\n  getProject(id: string): Promise<Project | undefined>;\n  getProjectsByOwner(productOwnerId: string): Promise<Project[]>;\n  getPendingProjects(): Promise<Project[]>;\n  getProjectsByGroup(groupId: string): Promise<Project[]>;\n  createProject(project: InsertProject): Promise<Project>;\n  updateProject(id: string, updates: Partial<Project>): Promise<Project | undefined>;\n  acceptProject(projectId: string, groupId: string): Promise<Project | undefined>;\n\n  // Message methods\n  getMessagesByGroup(groupId: string): Promise<Message[]>;\n  createMessage(message: InsertMessage): Promise<Message>;\n\n  // Withdrawal methods\n  getWithdrawalsByFreelancer(freelancerId: string): Promise<Withdrawal[]>;\n  getAllWithdrawals(): Promise<Withdrawal[]>;\n  createWithdrawal(withdrawal: InsertWithdrawal): Promise<Withdrawal>;\n  updateWithdrawal(id: string, updates: Partial<Withdrawal>): Promise<Withdrawal | undefined>;\n\n  // Order methods\n  getOrderById(id: string): Promise<Order | undefined>;\n  getOrdersByProductOwner(productOwnerId: string): Promise<Order[]>;\n  getOrdersByGroupLeader(leaderId: string): Promise<Order[]>;\n  createOrder(order: InsertOrder): Promise<Order>;\n  updateOrderStatus(id: string, status: string): Promise<Order | undefined>;\n\n  // Helper methods for orders\n  getGroupById(id: string): Promise<Group | undefined>;\n  markAllNotificationsAsRead(userId: string, userType: string): Promise<void>;\n  getUnreadNotificationCount(userId: string, userType: string): Promise<number>;\n\n  // Conversation methods\n  getOrCreateConversation(productOwnerId: string, groupId: string, leaderId: string): Promise<Conversation>;\n  getConversation(conversationId: string): Promise<Conversation | undefined>;\n  getConversationMessages(conversationId: string): Promise<ConversationMessage[]>;\n  sendMessage(conversationId: string, senderId: string, senderType: string, content: string): Promise<ConversationMessage>;\n  getProductOwnerConversations(productOwnerId: string): Promise<Conversation[]>;\n  getFreelancerConversations(freelancerId: string): Promise<Conversation[]>;\n  markMessagesAsRead(conversationId: string, userId: string): Promise<void>;\n\n  // Group Posts methods\n  getPostsByGroup(groupId: string): Promise<GroupPost[]>;\n  getPost(postId: string): Promise<GroupPost | undefined>;\n  createPost(post: InsertGroupPost): Promise<GroupPost>;\n  deletePost(postId: string): Promise<void>;\n  updatePostCounts(postId: string, likesCount?: number, commentsCount?: number): Promise<void>;\n\n  // Post Comments methods\n  getCommentsByPost(postId: string): Promise<PostComment[]>;\n  createComment(comment: InsertPostComment): Promise<PostComment>;\n  deleteComment(commentId: string): Promise<void>;\n\n  // Post Reactions methods\n  getReactionsByPost(postId: string): Promise<PostReaction[]>;\n  getUserReaction(postId: string, userId: string): Promise<PostReaction | undefined>;\n  createReaction(reaction: InsertPostReaction): Promise<PostReaction>;\n  deleteReaction(postId: string, userId: string): Promise<void>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private freelancers: Map<string, Freelancer>;\n  private productOwners: Map<string, ProductOwner>;\n\n  constructor() {\n    this.users = new Map();\n    this.freelancers = new Map();\n    this.productOwners = new Map();\n  }\n\n  // Legacy user methods\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n\n  // Freelancer methods\n  async getFreelancer(id: string): Promise<Freelancer | undefined> {\n    return this.freelancers.get(id);\n  }\n\n  async getFreelancerByEmail(email: string): Promise<Freelancer | undefined> {\n    return Array.from(this.freelancers.values()).find(\n      (freelancer) => freelancer.email === email\n    );\n  }\n\n  async getFreelancerByUsername(username: string): Promise<Freelancer | undefined> {\n    return Array.from(this.freelancers.values()).find(\n      (freelancer) => freelancer.username === username\n    );\n  }\n\n  async createFreelancer(insertFreelancer: InsertFreelancer): Promise<Freelancer> {\n    const id = randomUUID();\n    const freelancer: Freelancer = { \n      ...insertFreelancer, \n      id,\n      countryCode: insertFreelancer.countryCode || \"+966\",\n      jobTitle: insertFreelancer.jobTitle || null,\n      teamSize: insertFreelancer.teamSize || null,\n      services: insertFreelancer.services || null,\n      bio: insertFreelancer.bio || null,\n      aboutMe: insertFreelancer.aboutMe || null,\n      profileImage: insertFreelancer.profileImage || null,\n      idVerification: insertFreelancer.idVerification || null,\n      paymentMethod: insertFreelancer.paymentMethod || null,\n      accountNumber: insertFreelancer.accountNumber || null,\n      isVerified: false,\n      createdAt: new Date(),\n    };\n    this.freelancers.set(id, freelancer);\n    return freelancer;\n  }\n\n  async updateFreelancer(id: string, updates: Partial<Freelancer>): Promise<Freelancer | undefined> {\n    const existing = this.freelancers.get(id);\n    if (!existing) return undefined;\n    \n    const updated = { ...existing, ...updates };\n    this.freelancers.set(id, updated);\n    return updated;\n  }\n\n  async getAllFreelancers(): Promise<Freelancer[]> {\n    return Array.from(this.freelancers.values());\n  }\n\n  // Product Owner methods\n  async getProductOwner(id: string): Promise<ProductOwner | undefined> {\n    return this.productOwners.get(id);\n  }\n\n  async getProductOwnerByEmail(email: string): Promise<ProductOwner | undefined> {\n    return Array.from(this.productOwners.values()).find(\n      (owner) => owner.email === email\n    );\n  }\n\n  async createProductOwner(insertOwner: InsertProductOwner): Promise<ProductOwner> {\n    const id = randomUUID();\n    const owner: ProductOwner = { \n      ...insertOwner, \n      id,\n      companyName: insertOwner.companyName || null,\n      productDescription: insertOwner.productDescription || null,\n      productUrl: insertOwner.productUrl || null,\n      services: insertOwner.services || null,\n      package: insertOwner.package || null,\n      budget: insertOwner.budget || null,\n      duration: insertOwner.duration || null,\n      createdAt: new Date(),\n    };\n    this.productOwners.set(id, owner);\n    return owner;\n  }\n\n  async updateProductOwner(id: string, updates: Partial<ProductOwner>): Promise<ProductOwner | undefined> {\n    const existing = this.productOwners.get(id);\n    if (!existing) return undefined;\n    \n    const updated = { ...existing, ...updates };\n    this.productOwners.set(id, updated);\n    return updated;\n  }\n\n  async getAllProductOwners(): Promise<ProductOwner[]> {\n    return Array.from(this.productOwners.values());\n  }\n\n  // Stub implementations for new methods (not used since we're using DatabaseStorage)\n  async getCampaign(): Promise<Campaign | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getCampaignsByOwner(): Promise<Campaign[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getAllCampaigns(): Promise<Campaign[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getActiveCampaigns(): Promise<Campaign[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createCampaign(): Promise<Campaign> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateCampaign(): Promise<Campaign | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async deleteCampaign(): Promise<void> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getTask(): Promise<Task | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getTasksByCampaign(): Promise<Task[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getTasksByFreelancer(): Promise<Task[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getAvailableTasks(): Promise<Task[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createTask(): Promise<Task> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateTask(): Promise<Task | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async assignTask(): Promise<Task | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getWalletByFreelancer(): Promise<Wallet | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createWallet(): Promise<Wallet> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateWallet(): Promise<Wallet | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getTransactionsByWallet(): Promise<Transaction[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createTransaction(): Promise<Transaction> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getPaymentsByCampaign(): Promise<Payment[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getPaymentsByOwner(): Promise<Payment[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createPayment(): Promise<Payment> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updatePayment(): Promise<Payment | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getNotificationsByUser(): Promise<Notification[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createNotification(): Promise<Notification> { throw new Error(\"Not implemented in MemStorage\"); }\n  async markNotificationAsRead(): Promise<void> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getGroup(): Promise<Group | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getGroupsByLeader(): Promise<Group[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getGroupsByMember(): Promise<Group[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createGroup(): Promise<Group> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateGroup(): Promise<Group | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getGroupMembers(): Promise<GroupMember[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async addGroupMember(): Promise<GroupMember> { throw new Error(\"Not implemented in MemStorage\"); }\n  async removeGroupMember(): Promise<void> { throw new Error(\"Not implemented in MemStorage\"); }\n  async isGroupMember(): Promise<boolean> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getJoinRequestsByGroup(): Promise<GroupJoinRequest[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getJoinRequestByFreelancer(): Promise<GroupJoinRequest | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createJoinRequest(): Promise<GroupJoinRequest> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateJoinRequest(): Promise<GroupJoinRequest | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async deleteJoinRequest(): Promise<void> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getProject(): Promise<Project | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getProjectsByOwner(): Promise<Project[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getPendingProjects(): Promise<Project[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getProjectsByGroup(): Promise<Project[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createProject(): Promise<Project> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateProject(): Promise<Project | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async acceptProject(): Promise<Project | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getMessagesByGroup(): Promise<Message[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createMessage(): Promise<Message> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getWithdrawalsByFreelancer(): Promise<Withdrawal[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async getAllWithdrawals(): Promise<Withdrawal[]> { throw new Error(\"Not implemented in MemStorage\"); }\n  async createWithdrawal(): Promise<Withdrawal> { throw new Error(\"Not implemented in MemStorage\"); }\n  async updateWithdrawal(): Promise<Withdrawal | undefined> { throw new Error(\"Not implemented in MemStorage\"); }\n}\n\n// Database Storage Implementation\nexport class DatabaseStorage implements IStorage {\n  // Legacy user methods\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  // Freelancer methods\n  async getFreelancer(id: string): Promise<Freelancer | undefined> {\n    const [freelancer] = await db.select().from(freelancers).where(eq(freelancers.id, id));\n    return freelancer || undefined;\n  }\n\n  async getFreelancerByEmail(email: string): Promise<Freelancer | undefined> {\n    const [freelancer] = await db.select().from(freelancers).where(eq(freelancers.email, email));\n    return freelancer || undefined;\n  }\n\n  async getFreelancerByUsername(username: string): Promise<Freelancer | undefined> {\n    const [freelancer] = await db.select().from(freelancers).where(eq(freelancers.username, username));\n    return freelancer || undefined;\n  }\n\n  async createFreelancer(insertFreelancer: InsertFreelancer): Promise<Freelancer> {\n    const [freelancer] = await db.insert(freelancers).values(insertFreelancer).returning();\n    // Create wallet for the freelancer\n    await this.createWallet(freelancer.id);\n    return freelancer;\n  }\n\n  async updateFreelancer(id: string, updates: Partial<Freelancer>): Promise<Freelancer | undefined> {\n    const [updated] = await db.update(freelancers).set(updates).where(eq(freelancers.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async getAllFreelancers(): Promise<Freelancer[]> {\n    return await db.select().from(freelancers);\n  }\n\n  // Product Owner methods\n  async getProductOwner(id: string): Promise<ProductOwner | undefined> {\n    const [owner] = await db.select().from(productOwners).where(eq(productOwners.id, id));\n    return owner || undefined;\n  }\n\n  async getProductOwnerByEmail(email: string): Promise<ProductOwner | undefined> {\n    const [owner] = await db.select().from(productOwners).where(eq(productOwners.email, email));\n    return owner || undefined;\n  }\n\n  async createProductOwner(insertOwner: InsertProductOwner): Promise<ProductOwner> {\n    const [owner] = await db.insert(productOwners).values(insertOwner).returning();\n    return owner;\n  }\n\n  async updateProductOwner(id: string, updates: Partial<ProductOwner>): Promise<ProductOwner | undefined> {\n    const [updated] = await db.update(productOwners).set(updates).where(eq(productOwners.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async getAllProductOwners(): Promise<ProductOwner[]> {\n    return await db.select().from(productOwners);\n  }\n\n  // Campaign methods\n  async getCampaign(id: string): Promise<Campaign | undefined> {\n    const [campaign] = await db.select().from(campaigns).where(eq(campaigns.id, id));\n    return campaign || undefined;\n  }\n\n  async getCampaignsByOwner(productOwnerId: string): Promise<Campaign[]> {\n    return await db.select().from(campaigns).where(eq(campaigns.productOwnerId, productOwnerId)).orderBy(desc(campaigns.createdAt));\n  }\n\n  async getAllCampaigns(): Promise<Campaign[]> {\n    return await db.select().from(campaigns).orderBy(desc(campaigns.createdAt));\n  }\n\n  async getActiveCampaigns(): Promise<Campaign[]> {\n    return await db.select().from(campaigns).where(or(eq(campaigns.status, \"active\"), eq(campaigns.status, \"in_progress\"))).orderBy(desc(campaigns.createdAt));\n  }\n\n  async createCampaign(insertCampaign: InsertCampaign): Promise<Campaign> {\n    const [campaign] = await db.insert(campaigns).values(insertCampaign).returning();\n    return campaign;\n  }\n\n  async updateCampaign(id: string, updates: Partial<Campaign>): Promise<Campaign | undefined> {\n    const [updated] = await db.update(campaigns).set({ ...updates, updatedAt: new Date() }).where(eq(campaigns.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async deleteCampaign(id: string): Promise<void> {\n    await db.delete(campaigns).where(eq(campaigns.id, id));\n  }\n\n  // Task methods\n  async getTask(id: string): Promise<Task | undefined> {\n    const [task] = await db.select().from(tasks).where(eq(tasks.id, id));\n    return task || undefined;\n  }\n\n  async getTasksByCampaign(campaignId: string): Promise<Task[]> {\n    return await db.select().from(tasks).where(eq(tasks.campaignId, campaignId)).orderBy(desc(tasks.createdAt));\n  }\n\n  async getTasksByFreelancer(freelancerId: string): Promise<Task[]> {\n    return await db.select().from(tasks).where(eq(tasks.freelancerId, freelancerId)).orderBy(desc(tasks.createdAt));\n  }\n\n  async getAvailableTasks(): Promise<Task[]> {\n    return await db.select().from(tasks).where(eq(tasks.status, \"available\")).orderBy(desc(tasks.createdAt));\n  }\n\n  async createTask(insertTask: InsertTask): Promise<Task> {\n    const [task] = await db.insert(tasks).values(insertTask).returning();\n    return task;\n  }\n\n  async updateTask(id: string, updates: Partial<Task>): Promise<Task | undefined> {\n    const [updated] = await db.update(tasks).set(updates).where(eq(tasks.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async assignTask(taskId: string, freelancerId: string): Promise<Task | undefined> {\n    const [updated] = await db.update(tasks)\n      .set({ \n        freelancerId, \n        status: \"assigned\", \n        assignedAt: new Date() \n      })\n      .where(and(eq(tasks.id, taskId), eq(tasks.status, \"available\")))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Wallet methods\n  async getWalletByFreelancer(freelancerId: string): Promise<Wallet | undefined> {\n    const [wallet] = await db.select().from(wallets).where(eq(wallets.freelancerId, freelancerId));\n    return wallet || undefined;\n  }\n\n  async createWallet(freelancerId: string): Promise<Wallet> {\n    const [wallet] = await db.insert(wallets).values({ freelancerId }).returning();\n    return wallet;\n  }\n\n  async updateWallet(id: string, updates: Partial<Wallet>): Promise<Wallet | undefined> {\n    const [updated] = await db.update(wallets).set({ ...updates, updatedAt: new Date() }).where(eq(wallets.id, id)).returning();\n    return updated || undefined;\n  }\n\n  // Transaction methods\n  async getTransactionsByWallet(walletId: string): Promise<Transaction[]> {\n    return await db.select().from(transactions).where(eq(transactions.walletId, walletId)).orderBy(desc(transactions.createdAt));\n  }\n\n  async createTransaction(transaction: InsertTransaction): Promise<Transaction> {\n    const [newTransaction] = await db.insert(transactions).values(transaction).returning();\n    return newTransaction;\n  }\n\n  // Payment methods\n  async getPaymentsByCampaign(campaignId: string): Promise<Payment[]> {\n    return await db.select().from(payments).where(eq(payments.campaignId, campaignId)).orderBy(desc(payments.createdAt));\n  }\n\n  async getPaymentsByOwner(productOwnerId: string): Promise<Payment[]> {\n    return await db.select().from(payments).where(eq(payments.productOwnerId, productOwnerId)).orderBy(desc(payments.createdAt));\n  }\n\n  async createPayment(insertPayment: InsertPayment): Promise<Payment> {\n    const [payment] = await db.insert(payments).values(insertPayment).returning();\n    return payment;\n  }\n\n  async updatePayment(id: string, updates: Partial<Payment>): Promise<Payment | undefined> {\n    const [updated] = await db.update(payments).set(updates).where(eq(payments.id, id)).returning();\n    return updated || undefined;\n  }\n\n  // Notification methods\n  async getNotificationsByUser(userId: string, userType: string): Promise<Notification[]> {\n    return await db.select().from(notifications)\n      .where(and(eq(notifications.userId, userId), eq(notifications.userType, userType)))\n      .orderBy(desc(notifications.createdAt));\n  }\n\n  async createNotification(insertNotification: InsertNotification): Promise<Notification> {\n    const [notification] = await db.insert(notifications).values(insertNotification).returning();\n    return notification;\n  }\n\n  async markNotificationAsRead(id: string): Promise<void> {\n    await db.update(notifications).set({ isRead: true }).where(eq(notifications.id, id));\n  }\n\n  // Group methods\n  async getGroup(id: string): Promise<Group | undefined> {\n    const [group] = await db.select().from(groups).where(eq(groups.id, id));\n    return group || undefined;\n  }\n\n  async getAllGroups(): Promise<Group[]> {\n    return await db.select().from(groups).orderBy(desc(groups.createdAt));\n  }\n\n  async getGroupsByLeader(leaderId: string): Promise<Group[]> {\n    return await db.select().from(groups).where(eq(groups.leaderId, leaderId)).orderBy(desc(groups.createdAt));\n  }\n\n  async getGroupsByMember(freelancerId: string): Promise<Group[]> {\n    const memberGroups = await db\n      .select({ group: groups })\n      .from(groupMembers)\n      .innerJoin(groups, eq(groupMembers.groupId, groups.id))\n      .where(eq(groupMembers.freelancerId, freelancerId));\n    return memberGroups.map(mg => mg.group);\n  }\n\n  async createGroup(insertGroup: InsertGroup): Promise<Group> {\n    const [group] = await db.insert(groups).values(insertGroup).returning();\n    // Add leader as a member\n    await this.addGroupMember({\n      groupId: group.id,\n      freelancerId: group.leaderId,\n      role: \"leader\",\n    });\n    return group;\n  }\n\n  async updateGroup(id: string, updates: Partial<Group>): Promise<Group | undefined> {\n    const [updated] = await db.update(groups).set(updates).where(eq(groups.id, id)).returning();\n    return updated || undefined;\n  }\n\n  // Group Member methods\n  async getGroupMembers(groupId: string): Promise<GroupMember[]> {\n    return await db.select().from(groupMembers).where(eq(groupMembers.groupId, groupId)).orderBy(desc(groupMembers.joinedAt));\n  }\n\n  async addGroupMember(member: InsertGroupMember): Promise<GroupMember> {\n    const [newMember] = await db.insert(groupMembers).values(member).returning();\n    // Update group's current members count\n    await db.update(groups)\n      .set({ currentMembers: db.select({ count: groupMembers.id }).from(groupMembers).where(eq(groupMembers.groupId, member.groupId)) as any })\n      .where(eq(groups.id, member.groupId));\n    return newMember;\n  }\n\n  async removeGroupMember(groupId: string, freelancerId: string): Promise<void> {\n    await db.delete(groupMembers).where(and(eq(groupMembers.groupId, groupId), eq(groupMembers.freelancerId, freelancerId)));\n    // Update group's current members count\n    const count = await db.select().from(groupMembers).where(eq(groupMembers.groupId, groupId));\n    await db.update(groups).set({ currentMembers: count.length }).where(eq(groups.id, groupId));\n  }\n\n  async isGroupMember(groupId: string, freelancerId: string): Promise<boolean> {\n    const [member] = await db.select().from(groupMembers)\n      .where(and(eq(groupMembers.groupId, groupId), eq(groupMembers.freelancerId, freelancerId)));\n    return !!member;\n  }\n\n  // Group Join Request methods\n  async getJoinRequestsByGroup(groupId: string): Promise<GroupJoinRequest[]> {\n    return await db.select().from(groupJoinRequests).where(eq(groupJoinRequests.groupId, groupId));\n  }\n\n  async getJoinRequestByFreelancer(groupId: string, freelancerId: string): Promise<GroupJoinRequest | undefined> {\n    const [request] = await db.select().from(groupJoinRequests)\n      .where(and(eq(groupJoinRequests.groupId, groupId), eq(groupJoinRequests.freelancerId, freelancerId)));\n    return request || undefined;\n  }\n\n  async createJoinRequest(request: InsertGroupJoinRequest): Promise<GroupJoinRequest> {\n    const [newRequest] = await db.insert(groupJoinRequests).values(request).returning();\n    return newRequest;\n  }\n\n  async updateJoinRequest(id: string, updates: Partial<GroupJoinRequest>): Promise<GroupJoinRequest | undefined> {\n    const [updated] = await db.update(groupJoinRequests).set(updates).where(eq(groupJoinRequests.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async deleteJoinRequest(id: string): Promise<void> {\n    await db.delete(groupJoinRequests).where(eq(groupJoinRequests.id, id));\n  }\n\n  // Project methods\n  async getProject(id: string): Promise<Project | undefined> {\n    const [project] = await db.select().from(projects).where(eq(projects.id, id));\n    return project || undefined;\n  }\n\n  async getProjectsByOwner(productOwnerId: string): Promise<Project[]> {\n    return await db.select().from(projects).where(eq(projects.productOwnerId, productOwnerId)).orderBy(desc(projects.createdAt));\n  }\n\n  async getPendingProjects(): Promise<Project[]> {\n    return await db.select().from(projects).where(eq(projects.status, \"pending\")).orderBy(desc(projects.createdAt));\n  }\n\n  async getProjectsByGroup(groupId: string): Promise<Project[]> {\n    return await db.select().from(projects).where(eq(projects.acceptedByGroupId, groupId)).orderBy(desc(projects.createdAt));\n  }\n\n  async createProject(insertProject: InsertProject): Promise<Project> {\n    const [project] = await db.insert(projects).values(insertProject).returning();\n    return project;\n  }\n\n  async updateProject(id: string, updates: Partial<Project>): Promise<Project | undefined> {\n    const [updated] = await db.update(projects).set({ ...updates, updatedAt: new Date() }).where(eq(projects.id, id)).returning();\n    return updated || undefined;\n  }\n\n  async acceptProject(projectId: string, groupId: string): Promise<Project | undefined> {\n    const [updated] = await db.update(projects)\n      .set({ \n        status: \"accepted\", \n        acceptedByGroupId: groupId,\n        updatedAt: new Date() \n      })\n      .where(and(eq(projects.id, projectId), eq(projects.status, \"pending\")))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Message methods\n  async getMessagesByGroup(groupId: string): Promise<Message[]> {\n    return await db.select().from(messages).where(eq(messages.groupId, groupId)).orderBy(desc(messages.createdAt));\n  }\n\n  async createMessage(insertMessage: InsertMessage): Promise<Message> {\n    const [message] = await db.insert(messages).values(insertMessage).returning();\n    return message;\n  }\n\n  // Withdrawal methods\n  async getWithdrawalsByFreelancer(freelancerId: string): Promise<Withdrawal[]> {\n    return await db.select().from(withdrawals).where(eq(withdrawals.freelancerId, freelancerId)).orderBy(desc(withdrawals.createdAt));\n  }\n\n  async getAllWithdrawals(): Promise<Withdrawal[]> {\n    return await db.select().from(withdrawals).orderBy(desc(withdrawals.createdAt));\n  }\n\n  async createWithdrawal(insertWithdrawal: InsertWithdrawal): Promise<Withdrawal> {\n    const [withdrawal] = await db.insert(withdrawals).values(insertWithdrawal).returning();\n    return withdrawal;\n  }\n\n  async updateWithdrawal(id: string, updates: Partial<Withdrawal>): Promise<Withdrawal | undefined> {\n    const [updated] = await db.update(withdrawals).set(updates).where(eq(withdrawals.id, id)).returning();\n    return updated || undefined;\n  }\n\n  // Order methods\n  async getOrderById(id: string): Promise<Order | undefined> {\n    const [order] = await db.select().from(orders).where(eq(orders.id, id));\n    return order || undefined;\n  }\n\n  async getOrdersByProductOwner(productOwnerId: string): Promise<Order[]> {\n    return await db.select().from(orders).where(eq(orders.productOwnerId, productOwnerId)).orderBy(desc(orders.createdAt));\n  }\n\n  async getOrdersByGroupLeader(leaderId: string): Promise<Order[]> {\n    // Get all groups led by this freelancer\n    const leaderGroups = await db.select().from(groups).where(eq(groups.leaderId, leaderId));\n    const groupIds = leaderGroups.map(g => g.id);\n    \n    if (groupIds.length === 0) {\n      return [];\n    }\n\n    // Get all orders for these groups\n    const groupOrders: Order[] = [];\n    for (const groupId of groupIds) {\n      const ordersForGroup = await db.select().from(orders).where(eq(orders.groupId, groupId)).orderBy(desc(orders.createdAt));\n      groupOrders.push(...ordersForGroup);\n    }\n    \n    return groupOrders;\n  }\n\n  async createOrder(insertOrder: InsertOrder): Promise<Order> {\n    const [order] = await db.insert(orders).values(insertOrder).returning();\n    return order;\n  }\n\n  async updateOrderStatus(id: string, status: string): Promise<Order | undefined> {\n    const now = new Date();\n    const updateData: any = { status, updatedAt: now };\n    \n    if (status === \"payment_confirmed\") {\n      updateData.paidAt = now;\n    } else if (status === \"completed\") {\n      updateData.completedAt = now;\n    }\n\n    const [updated] = await db.update(orders).set(updateData).where(eq(orders.id, id)).returning();\n    return updated || undefined;\n  }\n\n  // Helper methods\n  async getGroupById(id: string): Promise<Group | undefined> {\n    return await this.getGroup(id);\n  }\n\n  async markAllNotificationsAsRead(userId: string, userType: string): Promise<void> {\n    await db.update(notifications)\n      .set({ isRead: true })\n      .where(and(\n        eq(notifications.userId, userId),\n        eq(notifications.userType, userType),\n        eq(notifications.isRead, false)\n      ));\n  }\n\n  async getUnreadNotificationCount(userId: string, userType: string): Promise<number> {\n    const result = await db.select().from(notifications).where(and(\n      eq(notifications.userId, userId),\n      eq(notifications.userType, userType),\n      eq(notifications.isRead, false)\n    ));\n    return result.length;\n  }\n\n  // Conversation methods\n  async getOrCreateConversation(productOwnerId: string, groupId: string, leaderId: string): Promise<Conversation> {\n    // Check if conversation already exists\n    const [existing] = await db.select().from(conversations).where(and(\n      eq(conversations.productOwnerId, productOwnerId),\n      eq(conversations.groupId, groupId)\n    ));\n\n    if (existing) {\n      return existing;\n    }\n\n    // Create new conversation\n    const [conversation] = await db.insert(conversations).values({\n      productOwnerId,\n      groupId,\n      leaderId,\n      lastMessageAt: new Date(),\n    }).returning();\n\n    return conversation;\n  }\n\n  async getConversation(conversationId: string): Promise<Conversation | undefined> {\n    const [conversation] = await db.select().from(conversations).where(eq(conversations.id, conversationId));\n    return conversation || undefined;\n  }\n\n  async getConversationMessages(conversationId: string): Promise<ConversationMessage[]> {\n    return await db.select().from(conversationMessages)\n      .where(eq(conversationMessages.conversationId, conversationId))\n      .orderBy(conversationMessages.createdAt);\n  }\n\n  async sendMessage(conversationId: string, senderId: string, senderType: string, content: string): Promise<ConversationMessage> {\n    // Insert message\n    const [message] = await db.insert(conversationMessages).values({\n      conversationId,\n      senderId,\n      senderType,\n      content,\n      isRead: false,\n    }).returning();\n\n    // Update conversation lastMessageAt\n    await db.update(conversations)\n      .set({ lastMessageAt: new Date() })\n      .where(eq(conversations.id, conversationId));\n\n    return message;\n  }\n\n  async getProductOwnerConversations(productOwnerId: string): Promise<Conversation[]> {\n    return await db.select().from(conversations)\n      .where(eq(conversations.productOwnerId, productOwnerId))\n      .orderBy(desc(conversations.lastMessageAt));\n  }\n\n  async getFreelancerConversations(freelancerId: string): Promise<Conversation[]> {\n    return await db.select().from(conversations)\n      .where(eq(conversations.leaderId, freelancerId))\n      .orderBy(desc(conversations.lastMessageAt));\n  }\n\n  async markMessagesAsRead(conversationId: string, userId: string): Promise<void> {\n    await db.update(conversationMessages)\n      .set({ isRead: true })\n      .where(and(\n        eq(conversationMessages.conversationId, conversationId),\n        eq(conversationMessages.isRead, false)\n      ));\n  }\n\n  // Group Posts methods\n  async getPostsByGroup(groupId: string): Promise<GroupPost[]> {\n    return await db.select().from(groupPosts)\n      .where(eq(groupPosts.groupId, groupId))\n      .orderBy(desc(groupPosts.createdAt));\n  }\n\n  async getPost(postId: string): Promise<GroupPost | undefined> {\n    const [post] = await db.select().from(groupPosts).where(eq(groupPosts.id, postId));\n    return post || undefined;\n  }\n\n  async createPost(post: InsertGroupPost): Promise<GroupPost> {\n    const [newPost] = await db.insert(groupPosts).values(post).returning();\n    return newPost;\n  }\n\n  async deletePost(postId: string): Promise<void> {\n    await db.delete(groupPosts).where(eq(groupPosts.id, postId));\n  }\n\n  async updatePostCounts(postId: string, likesCount?: number, commentsCount?: number): Promise<void> {\n    const updates: any = { updatedAt: new Date() };\n    if (likesCount !== undefined) updates.likesCount = likesCount;\n    if (commentsCount !== undefined) updates.commentsCount = commentsCount;\n    \n    await db.update(groupPosts)\n      .set(updates)\n      .where(eq(groupPosts.id, postId));\n  }\n\n  // Post Comments methods\n  async getCommentsByPost(postId: string): Promise<PostComment[]> {\n    return await db.select().from(postComments)\n      .where(eq(postComments.postId, postId))\n      .orderBy(postComments.createdAt);\n  }\n\n  async createComment(comment: InsertPostComment): Promise<PostComment> {\n    const [newComment] = await db.insert(postComments).values(comment).returning();\n    \n    // Increment comments count\n    const post = await this.getPost(comment.postId);\n    if (post) {\n      await this.updatePostCounts(comment.postId, undefined, post.commentsCount + 1);\n    }\n    \n    return newComment;\n  }\n\n  async deleteComment(commentId: string): Promise<void> {\n    // Get comment first to update count\n    const [comment] = await db.select().from(postComments).where(eq(postComments.id, commentId));\n    \n    await db.delete(postComments).where(eq(postComments.id, commentId));\n    \n    // Decrement comments count\n    if (comment) {\n      const post = await this.getPost(comment.postId);\n      if (post && post.commentsCount > 0) {\n        await this.updatePostCounts(comment.postId, undefined, post.commentsCount - 1);\n      }\n    }\n  }\n\n  // Post Reactions methods\n  async getReactionsByPost(postId: string): Promise<PostReaction[]> {\n    return await db.select().from(postReactions)\n      .where(eq(postReactions.postId, postId));\n  }\n\n  async getUserReaction(postId: string, userId: string): Promise<PostReaction | undefined> {\n    const [reaction] = await db.select().from(postReactions)\n      .where(and(\n        eq(postReactions.postId, postId),\n        eq(postReactions.userId, userId)\n      ));\n    return reaction || undefined;\n  }\n\n  async createReaction(reaction: InsertPostReaction): Promise<PostReaction> {\n    const [newReaction] = await db.insert(postReactions).values(reaction).returning();\n    \n    // Increment likes count\n    const post = await this.getPost(reaction.postId);\n    if (post) {\n      await this.updatePostCounts(reaction.postId, post.likesCount + 1, undefined);\n    }\n    \n    return newReaction;\n  }\n\n  async deleteReaction(postId: string, userId: string): Promise<void> {\n    await db.delete(postReactions)\n      .where(and(\n        eq(postReactions.postId, postId),\n        eq(postReactions.userId, userId)\n      ));\n    \n    // Decrement likes count\n    const post = await this.getPost(postId);\n    if (post && post.likesCount > 0) {\n      await this.updatePostCounts(postId, post.likesCount - 1, undefined);\n    }\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":41588},"client/src/components/StepIndicator.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { Check } from \"lucide-react\";\n\ninterface Step {\n  id: number;\n  title: string;\n}\n\ninterface StepIndicatorProps {\n  steps: Step[];\n  currentStep: number;\n}\n\nexport function StepIndicator({ steps, currentStep }: StepIndicatorProps) {\n  return (\n    <div className=\"w-full py-8\" data-testid=\"step-indicator\">\n      <div className=\"flex items-center justify-between max-w-3xl mx-auto px-4\">\n        {steps.map((step, index) => (\n          <div key={step.id} className=\"flex items-center flex-1\">\n            {/* Step Circle */}\n            <div className=\"flex flex-col items-center\">\n              <div\n                className={cn(\n                  \"w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all shadow-md\",\n                  currentStep > step.id\n                    ? \"bg-primary text-primary-foreground\"\n                    : currentStep === step.id\n                    ? \"bg-primary text-primary-foreground ring-4 ring-primary/20\"\n                    : \"bg-muted text-muted-foreground\"\n                )}\n                data-testid={`step-${step.id}`}\n              >\n                {currentStep > step.id ? (\n                  <Check className=\"w-5 h-5\" />\n                ) : (\n                  <span>{step.id}</span>\n                )}\n              </div>\n              <p\n                className={cn(\n                  \"mt-2 text-xs sm:text-sm font-medium text-center whitespace-nowrap\",\n                  currentStep >= step.id ? \"text-foreground\" : \"text-muted-foreground\"\n                )}\n              >\n                {step.title}\n              </p>\n            </div>\n\n            {/* Connector Line */}\n            {index < steps.length - 1 && (\n              <div\n                className={cn(\n                  \"flex-1 h-0.5 mx-2 transition-all\",\n                  currentStep > step.id ? \"bg-primary\" : \"bg-muted\"\n                )}\n              />\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2034},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/pages/Campaigns.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Plus, Trash2, Edit, Eye, Filter } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\n\ntype Campaign = {\n  id: string;\n  owner_id: string;\n  title: string;\n  description: string | null;\n  service_type: string;\n  budget: number;\n  package_type: string;\n  target_testers: number;\n  duration_days: number | null;\n  requirements: string[] | null;\n  status: string;\n  created_at: string;\n  completed_at: string | null;\n};\n\nconst campaignFormSchema = z.object({\n  title: z.string().min(3, \"يجب أن يكون العنوان 3 أحرف على الأقل\"),\n  description: z.string().optional(),\n  service_type: z.string().min(1, \"نوع الخدمة مطلوب\"),\n  budget: z.number().min(1, \"الميزانية مطلوبة\"),\n  package_type: z.string().min(1, \"نوع الباقة مطلوب\"),\n  target_testers: z.number().min(1, \"عدد المختبرين مطلوب\"),\n  duration_days: z.number().optional(),\n  requirements: z.array(z.string()).optional(),\n});\n\ntype CampaignFormData = z.infer<typeof campaignFormSchema>;\n\nconst statusColors: Record<string, { bg: string; text: string; label: string }> = {\n  draft: { bg: \"bg-muted dark:bg-muted\", text: \"text-muted-foreground dark:text-muted-foreground\", label: \"مسودة\" },\n  active: { bg: \"bg-primary/10 dark:bg-primary/20\", text: \"text-primary dark:text-primary\", label: \"نشط\" },\n  paused: { bg: \"bg-secondary dark:bg-secondary\", text: \"text-secondary-foreground dark:text-secondary-foreground\", label: \"متوقف\" },\n  completed: { bg: \"bg-accent dark:bg-accent\", text: \"text-accent-foreground dark:text-accent-foreground\", label: \"مكتمل\" },\n  cancelled: { bg: \"bg-muted dark:bg-muted\", text: \"text-muted-foreground dark:text-muted-foreground\", label: \"ملغي\" },\n};\n\nconst packageTypes = [\n  { value: \"basic\", label: \"أساسي - 499 ر.س\", price: 499 },\n  { value: \"pro\", label: \"احترافي - 1299 ر.س\", price: 1299 },\n  { value: \"growth\", label: \"نمو - 2999 ر.س\", price: 2999 },\n];\n\nconst serviceTypes = [\n  \"اختبار تطبيقات\",\n  \"تقييم خرائط Google Maps\",\n  \"تقييم تطبيقات Android\",\n  \"تقييم تطبيقات iOS\",\n  \"تقييم مواقع إلكترونية\",\n  \"اختبار أنظمة Software\",\n  \"مراجعات تجربة المستخدم UX/UI\",\n  \"التفاعل مع منشورات السوشيال ميديا\",\n];\n\nexport default function Campaigns() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n\n  const form = useForm<CampaignFormData>({\n    resolver: zodResolver(campaignFormSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      service_type: \"\",\n      budget: 0,\n      package_type: \"\",\n      target_testers: 10,\n      duration_days: 7,\n      requirements: [],\n    },\n  });\n\n  const { data: campaigns = [], isLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const createCampaignMutation = useMutation({\n    mutationFn: async (data: CampaignFormData) => {\n      const token = localStorage.getItem(\"token\");\n      const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n      \n      const response = await fetch(\"/api/campaigns\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          ...data,\n          owner_id: user.id,\n          status: \"draft\",\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"حدث خطأ أثناء إنشاء الحملة\");\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      setIsCreateDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"تم إنشاء الحملة بنجاح\",\n        description: \"يمكنك الآن إدارة حملتك الجديدة\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الحملة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteCampaignMutation = useMutation({\n    mutationFn: async (campaignId: string) => {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch(`/api/campaigns/${campaignId}`, {\n        method: \"DELETE\",\n        headers: {\n          \"Authorization\": `Bearer ${token}`,\n        },\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"حدث خطأ أثناء حذف الحملة\");\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: \"تم حذف الحملة\",\n        description: \"تم حذف الحملة بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء حذف الحملة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (data: CampaignFormData) => {\n    createCampaignMutation.mutate(data);\n  };\n\n  const handlePackageChange = (packageType: string) => {\n    const pkg = packageTypes.find(p => p.value === packageType);\n    if (pkg) {\n      form.setValue(\"budget\", pkg.price);\n      form.setValue(\"package_type\", packageType);\n    }\n  };\n\n  const filteredCampaigns = campaigns.filter(campaign => {\n    if (filterStatus === \"all\") return true;\n    return campaign.status === filterStatus;\n  });\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 container mx-auto px-4 py-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\">حملاتي</h1>\n              <p className=\"text-muted-foreground\">إدارة وإنشاء الحملات التسويقية والاختبارية</p>\n            </div>\n\n            <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n              <DialogTrigger asChild>\n                <Button size=\"lg\" data-testid=\"button-create-campaign\">\n                  <Plus className=\"w-5 h-5 ml-2\" />\n                  إنشاء حملة جديدة\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>إنشاء حملة جديدة</DialogTitle>\n                  <DialogDescription>\n                    أنشئ حملة تسويقية أو اختبارية جديدة واختر الباقة المناسبة\n                  </DialogDescription>\n                </DialogHeader>\n\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"title\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>عنوان الحملة</FormLabel>\n                          <FormControl>\n                            <Input {...field} placeholder=\"مثال: اختبار تطبيق التوصيل الجديد\" data-testid=\"input-campaign-title\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"description\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>وصف الحملة (اختياري)</FormLabel>\n                          <FormControl>\n                            <Textarea {...field} placeholder=\"وصف تفصيلي للحملة والأهداف المرجوة...\" rows={3} data-testid=\"input-campaign-description\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"service_type\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>نوع الخدمة</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-service-type\">\n                                <SelectValue placeholder=\"اختر نوع الخدمة\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {serviceTypes.map((service) => (\n                                <SelectItem key={service} value={service}>\n                                  {service}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"package_type\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>الباقة</FormLabel>\n                          <Select onValueChange={(value) => {\n                            field.onChange(value);\n                            handlePackageChange(value);\n                          }} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-package-type\">\n                                <SelectValue placeholder=\"اختر الباقة المناسبة\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {packageTypes.map((pkg) => (\n                                <SelectItem key={pkg.value} value={pkg.value}>\n                                  {pkg.label}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"target_testers\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>عدد المختبرين المطلوب</FormLabel>\n                            <FormControl>\n                              <Input\n                                type=\"number\"\n                                {...field}\n                                onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                                data-testid=\"input-target-testers\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"duration_days\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>المدة (أيام)</FormLabel>\n                            <FormControl>\n                              <Input\n                                type=\"number\"\n                                {...field}\n                                onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                                data-testid=\"input-duration-days\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={form.control}\n                      name=\"budget\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>الميزانية (ر.س)</FormLabel>\n                          <FormControl>\n                            <Input\n                              type=\"number\"\n                              {...field}\n                              onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                              disabled\n                              data-testid=\"input-budget\"\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <DialogFooter>\n                      <Button type=\"button\" variant=\"outline\" onClick={() => setIsCreateDialogOpen(false)} data-testid=\"button-cancel\">\n                        إلغاء\n                      </Button>\n                      <Button type=\"submit\" disabled={createCampaignMutation.isPending} data-testid=\"button-submit-campaign\">\n                        {createCampaignMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء الحملة\"}\n                      </Button>\n                    </DialogFooter>\n                  </form>\n                </Form>\n              </DialogContent>\n            </Dialog>\n          </div>\n\n          <div className=\"mb-6 flex items-center gap-4\">\n            <Filter className=\"w-5 h-5 text-muted-foreground\" />\n            <Select value={filterStatus} onValueChange={setFilterStatus}>\n              <SelectTrigger className=\"w-48\" data-testid=\"select-filter-status\">\n                <SelectValue placeholder=\"تصفية حسب الحالة\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">جميع الحملات</SelectItem>\n                <SelectItem value=\"draft\">مسودات</SelectItem>\n                <SelectItem value=\"active\">نشطة</SelectItem>\n                <SelectItem value=\"paused\">متوقفة</SelectItem>\n                <SelectItem value=\"completed\">مكتملة</SelectItem>\n                <SelectItem value=\"cancelled\">ملغاة</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardHeader>\n                    <div className=\"h-6 bg-muted rounded w-3/4 mb-2\"></div>\n                    <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"h-20 bg-muted rounded\"></div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredCampaigns.length === 0 ? (\n            <Card className=\"text-center py-12\">\n              <CardContent>\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-16 h-16 rounded-full bg-muted flex items-center justify-center\">\n                    <Plus className=\"w-8 h-8 text-muted-foreground\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-semibold mb-2\">لا توجد حملات بعد</h3>\n                    <p className=\"text-muted-foreground mb-4\">\n                      {filterStatus === \"all\" ? \"ابدأ بإنشاء حملتك الأولى\" : \"لا توجد حملات بهذه الحالة\"}\n                    </p>\n                    {filterStatus === \"all\" && (\n                      <Button onClick={() => setIsCreateDialogOpen(true)} data-testid=\"button-create-first-campaign\">\n                        <Plus className=\"w-5 h-5 ml-2\" />\n                        إنشاء حملة جديدة\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {filteredCampaigns.map((campaign) => (\n                <Card key={campaign.id} className=\"hover-elevate transition-all\" data-testid={`card-campaign-${campaign.id}`}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-start gap-2\">\n                      <div className=\"flex-1\">\n                        <CardTitle className=\"text-lg mb-2\">{campaign.title}</CardTitle>\n                        <CardDescription className=\"line-clamp-2\">\n                          {campaign.description || \"لا يوجد وصف\"}\n                        </CardDescription>\n                      </div>\n                      <Badge \n                        className={`${statusColors[campaign.status]?.bg} ${statusColors[campaign.status]?.text}`}\n                        data-testid={`badge-status-${campaign.id}`}\n                      >\n                        {statusColors[campaign.status]?.label || campaign.status}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">نوع الخدمة</p>\n                        <p className=\"font-medium\">{campaign.service_type}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">الميزانية</p>\n                        <p className=\"font-medium\">{campaign.budget} ر.س</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">المختبرين</p>\n                        <p className=\"font-medium\">{campaign.target_testers}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">المدة</p>\n                        <p className=\"font-medium\">{campaign.duration_days || \"غير محدد\"} يوم</p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-2 pt-4 border-t\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"flex-1\"\n                        onClick={() => navigate(`/campaigns/${campaign.id}`)}\n                        data-testid={`button-view-${campaign.id}`}\n                      >\n                        <Eye className=\"w-4 h-4 ml-2\" />\n                        عرض\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"flex-1\"\n                        onClick={() => navigate(`/campaigns/${campaign.id}/edit`)}\n                        data-testid={`button-edit-${campaign.id}`}\n                      >\n                        <Edit className=\"w-4 h-4 ml-2\" />\n                        تعديل\n                      </Button>\n                      <Button\n                        variant=\"destructive\"\n                        size=\"sm\"\n                        onClick={() => {\n                          if (confirm(\"هل أنت متأكد من حذف هذه الحملة؟\")) {\n                            deleteCampaignMutation.mutate(campaign.id);\n                          }\n                        }}\n                        data-testid={`button-delete-${campaign.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":22062},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Tajawal Font as Primary */\n* {\n  font-family: 'Tajawal', 'Inter', system-ui, -apple-system, sans-serif;\n}\n\n/* Bold for headings */\nh1, h2, h3, h4, h5, h6, .font-bold {\n  font-weight: 800; /* Extra Bold (Thick) */\n}\n\n/* Medium for buttons and important text */\nbutton, .font-medium {\n  font-weight: 700; /* Bold */\n}\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 98%;\n\n  --foreground: 0 0% 13%;\n\n  --border: 0deg 53.85% 97.45%;\n\n  --card: 0 0% 96%;\n\n  --card-foreground: 0 0% 13%;\n\n  --card-border: 0 0% 88%;\n\n  --sidebar: 0 0% 94%;\n\n  --sidebar-foreground: 0 0% 13%;\n\n  --sidebar-border: 0 0% 86%;\n\n  --sidebar-primary: 212 100% 31%;\n\n  --sidebar-primary-foreground: 0 0% 100%;\n\n  --sidebar-accent: 212 15% 85%;\n\n  --sidebar-accent-foreground: 212 30% 25%;\n\n  --sidebar-ring: 212 100% 31%;\n\n  --popover: 0 0% 92%;\n\n  --popover-foreground: 0 0% 13%;\n\n  --popover-border: 0 0% 84%;\n\n  --primary: 212 100% 31%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 212 8% 88%;\n\n  --secondary-foreground: 212 15% 20%;\n\n  --muted: 212 20% 85%;\n\n  --muted-foreground: 212 12% 35%;\n\n  --accent: 212 12% 87%;\n\n  --accent-foreground: 212 20% 25%;\n\n  --destructive: 0 84% 42%;\n\n  --destructive-foreground: 0 0% 100%;\n\n  --input: 0deg 100% 97.45%;\n  --ring: 212 100% 31%;\n  --chart-1: 212 100% 31%;\n  --chart-2: 212 80% 40%;\n  --chart-3: 212 60% 50%;\n  --chart-4: 0 0% 40%;\n  --chart-5: 0 0% 60%;\n\n  --font-sans: Cairo, Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 0 0% 8%;\n\n  --foreground: 0 0% 95%;\n\n  --border: 0 0% 18%;\n\n  --card: 0 0% 11%;\n\n  --card-foreground: 0 0% 95%;\n\n  --card-border: 0 0% 20%;\n\n  --sidebar: 0 0% 13%;\n\n  --sidebar-foreground: 0 0% 95%;\n\n  --sidebar-border: 0 0% 22%;\n\n  --sidebar-primary: 212 80% 45%;\n\n  --sidebar-primary-foreground: 0 0% 100%;\n\n  --sidebar-accent: 212 12% 18%;\n\n  --sidebar-accent-foreground: 212 30% 85%;\n\n  --sidebar-ring: 212 80% 45%;\n\n  --popover: 0 0% 15%;\n\n  --popover-foreground: 0 0% 95%;\n\n  --popover-border: 0 0% 24%;\n\n  --primary: 212 80% 45%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 212 8% 20%;\n\n  --secondary-foreground: 212 15% 90%;\n\n  --muted: 212 10% 17%;\n\n  --muted-foreground: 212 12% 75%;\n\n  --accent: 212 12% 19%;\n\n  --accent-foreground: 212 20% 85%;\n\n  --destructive: 0 84% 32%;\n\n  --destructive-foreground: 0 0% 100%;\n\n  --input: 0 0% 35%;\n  --ring: 212 80% 45%;\n  --chart-1: 212 80% 60%;\n  --chart-2: 212 60% 50%;\n  --chart-3: 212 40% 40%;\n  --chart-4: 0 0% 65%;\n  --chart-5: 0 0% 50%;\n\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* Marquee animation for scrolling logos */\n  @keyframes marquee {\n    0% {\n      transform: translateX(0);\n    }\n    100% {\n      transform: translateX(-50%);\n    }\n  }\n\n  .animate-marquee {\n    animation: marquee 25s linear infinite;\n  }\n}","size_bytes":12633},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/pages/Dashboard.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\n\nexport default function Dashboard() {\n  const [, navigate] = useLocation();\n\n  useEffect(() => {\n    const userType = localStorage.getItem(\"userType\");\n    const token = localStorage.getItem(\"token\");\n    \n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n\n    if (userType === \"freelancer\") {\n      navigate(\"/freelancer-dashboard\");\n    } else if (userType === \"product_owner\") {\n      navigate(\"/product-owner-dashboard\");\n    } else {\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/20\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n        <p className=\"mt-4 text-muted-foreground\">جاري التحميل...</p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":919},"client/src/components/FileUpload.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Upload, X, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface FileUploadProps {\n  type: \"profile\" | \"verification\";\n  currentFile?: string;\n  onFileUploaded: (url: string) => void;\n  accept?: string;\n}\n\nexport function FileUpload({ type, currentFile, onFileUploaded, accept = \"image/*\" }: FileUploadProps) {\n  const [uploading, setUploading] = useState(false);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(currentFile || null);\n  const { toast } = useToast();\n\n  const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Create preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreviewUrl(reader.result as string);\n    };\n    reader.readAsDataURL(file);\n\n    // Upload file\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      formData.append(\"type\", type);\n\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error(\"فشل رفع الملف\");\n      }\n\n      const data = await response.json();\n      onFileUploaded(data.url);\n      \n      toast({\n        title: \"تم رفع الملف بنجاح\",\n        description: \"تم حفظ الملف على الخادم\",\n      });\n    } catch (error) {\n      toast({\n        title: \"خطأ في رفع الملف\",\n        description: \"حاول مرة أخرى\",\n        variant: \"destructive\",\n      });\n      setPreviewUrl(null);\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleRemove = () => {\n    setPreviewUrl(null);\n    onFileUploaded(\"\");\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      {previewUrl ? (\n        <div className=\"relative\">\n          {type === \"profile\" ? (\n            <div className=\"w-24 h-24 rounded-2xl overflow-hidden border-2\">\n              <img src={previewUrl} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n            </div>\n          ) : (\n            <div className=\"p-4 rounded-xl border bg-muted/30\">\n              <p className=\"text-sm\">✓ تم رفع الملف</p>\n            </div>\n          )}\n          <Button\n            type=\"button\"\n            size=\"icon\"\n            variant=\"destructive\"\n            className=\"absolute -top-2 -right-2 h-6 w-6 rounded-full\"\n            onClick={handleRemove}\n            data-testid=\"button-remove-file\"\n          >\n            <X className=\"h-3 w-3\" />\n          </Button>\n        </div>\n      ) : (\n        <label className=\"block\">\n          <input\n            type=\"file\"\n            accept={accept}\n            onChange={handleFileChange}\n            className=\"hidden\"\n            disabled={uploading}\n            data-testid={`input-file-${type}`}\n          />\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            className=\"rounded-xl\"\n            disabled={uploading}\n            onClick={(e) => {\n              e.preventDefault();\n              e.currentTarget.previousElementSibling?.dispatchEvent(new MouseEvent('click'));\n            }}\n            data-testid={`button-upload-${type}`}\n          >\n            {uploading ? (\n              <>\n                <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />\n                جاري الرفع...\n              </>\n            ) : (\n              <>\n                <Upload className=\"ml-2 h-4 w-4\" />\n                {type === \"profile\" ? \"اختر صورة\" : \"رفع الملف\"}\n              </>\n            )}\n          </Button>\n        </label>\n      )}\n    </div>\n  );\n}\n","size_bytes":3784},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const token = localStorage.getItem(\"token\");\n  const headers: Record<string, string> = {};\n  \n  if (data) {\n    headers[\"Content-Type\"] = \"application/json\";\n  }\n  \n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  \n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1570},"client/src/pages/ProductOwnerSignup.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { StepIndicator } from \"@/components/StepIndicator\";\nimport { PasswordStrength } from \"@/components/PasswordStrength\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { ArrowRight, ArrowLeft, DollarSign, Star } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst steps = [\n  { id: 1, title: \"المعلومات الأساسية\" },\n  { id: 2, title: \"اختيار الخدمة\" },\n  { id: 3, title: \"التأكيد\" },\n];\n\n// قائمة الخدمات المتاحة\nconst servicesList = [\n  { id: \"google_play_review\", name: \"تقييم تطبيقك على Google Play\", pricePerReview: 1 },\n  { id: \"ios_review\", name: \"تقييم تطبيقك على iOS\", pricePerReview: 1 },\n  { id: \"website_review\", name: \"تقييم موقعك الإلكتروني\", pricePerReview: 1 },\n  { id: \"ux_testing\", name: \"اختبار تجربة المستخدم لتطبيقك أو موقعك\", pricePerReview: 1 },\n  { id: \"software_testing\", name: \"اختبار أنظمة السوفت وير\", pricePerReview: 1 },\n  { id: \"social_media_engagement\", name: \"التفاعل مع منشورات السوشيال ميديا\", pricePerReview: 1 },\n  { id: \"google_maps_review\", name: \"تقييمات خرائط جوجل ماب (Google Maps Reviews)\", pricePerReview: 2 },\n];\n\nconst step1Schema = z.object({\n  fullName: z.string().min(3, \"الاسم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  password: z.string().min(8, \"كلمة المرور يجب أن تحتوي على 8 أحرف على الأقل\"),\n});\n\nconst step2Schema = z.object({\n  serviceType: z.string().min(1, \"اختر نوع الخدمة\"),\n  reviewsCount: z.number().min(1, \"عدد التقييمات يجب أن يكون 1 على الأقل\").max(1000, \"الحد الأقصى 1000 تقييم\"),\n});\n\nconst step3Schema = z.object({\n  acceptTerms: z.boolean().refine((val) => val === true, \"يجب الموافقة على الشروط والأحكام\"),\n});\n\ntype FormData = z.infer<typeof step1Schema> & \n  z.infer<typeof step2Schema> & \n  z.infer<typeof step3Schema>;\n\nexport default function ProductOwnerSignup() {\n  const [currentStep, setCurrentStep] = useState(1);\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<Partial<FormData>>({\n    reviewsCount: 50,\n  });\n\n  const createOwnerMutation = useMutation({\n    mutationFn: async (data: Partial<FormData>) => {\n      const response = await fetch(\"/api/product-owners\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          fullName: data.fullName,\n          email: data.email,\n          password: data.password,\n          services: [data.serviceType],\n        }),\n      });\n      \n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = \"فشل إنشاء الحساب\";\n        \n        if (typeof errorData.error === 'string') {\n          errorMessage = errorData.error;\n        } else if (Array.isArray(errorData.error)) {\n          errorMessage = errorData.error.map((e: any) => e.message || e.code).join(', ');\n        }\n        \n        throw new Error(errorMessage);\n      }\n      \n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", \"product_owner\");\n      \n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم إنشاء الحساب بنجاح!\",\n        description: \"يرجى قراءة الشروط والأحكام الهامة قبل البدء\",\n      });\n      // Redirect to instructions page first\n      navigate(\"/product-owner-instructions\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"حدث خطأ\",\n        description: error.message || \"فشل في إنشاء الحساب. حاول مرة أخرى.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getSchemaForStep = (step: number) => {\n    switch (step) {\n      case 1: return step1Schema;\n      case 2: return step2Schema;\n      case 3: return step3Schema;\n      default: return step1Schema;\n    }\n  };\n\n  const defaultFormValues = useMemo(() => ({\n    ...formData,\n  }), [currentStep]);\n\n  const form = useForm<FormData>({\n    resolver: zodResolver(getSchemaForStep(currentStep)),\n    values: defaultFormValues as any,\n    mode: \"onChange\",\n  });\n\n  // حساب التكلفة\n  const selectedService = servicesList.find(s => s.id === formData.serviceType);\n  const reviewsCount = formData.reviewsCount || 0;\n  const pricePerReview = selectedService?.pricePerReview || 0;\n  const totalCost = reviewsCount * pricePerReview;\n\n  const handleNext = async () => {\n    const isValid = await form.trigger();\n    if (isValid) {\n      const currentValues = form.getValues();\n      const updatedFormData = { ...formData, ...currentValues };\n      setFormData(updatedFormData);\n      \n      if (currentStep < 3) {\n        setCurrentStep(currentStep + 1);\n        form.clearErrors();\n      } else {\n        createOwnerMutation.mutate(updatedFormData);\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      const currentValues = form.getValues();\n      setFormData({ ...formData, ...currentValues });\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 py-8 px-4\">\n        <div className=\"max-w-3xl mx-auto\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold mb-2\">إنشاء حساب صاحب منتج</h1>\n            <p className=\"text-muted-foreground\">احصل على تقييمات واختبارات حقيقية لمنتجك</p>\n          </div>\n\n          <StepIndicator steps={steps} currentStep={currentStep} />\n\n          <Card className=\"rounded-2xl shadow-lg\">\n            <CardHeader className=\"border-b\">\n              <CardTitle className=\"text-2xl text-center\">\n                {steps[currentStep - 1].title}\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\"p-6 md:p-8\">\n              <Form {...form}>\n                <form className=\"space-y-6\">\n                  {/* Step 1: Basic Information */}\n                  {currentStep === 1 && (\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"fullName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>الاسم الكامل / اسم الشركة *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"أحمد محمد\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-fullname\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>البريد الإلكتروني *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"email\" \n                                placeholder=\"info@company.com\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-email\"\n                                autoComplete=\"email\"\n                                name=\"email\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>كلمة المرور *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"password\" \n                                placeholder=\"••••••••\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-password\"\n                                autoComplete=\"new-password\"\n                                name=\"password\"\n                              />\n                            </FormControl>\n                            <PasswordStrength password={field.value || \"\"} />\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Step 2: Service Selection */}\n                  {currentStep === 2 && (\n                    <div className=\"space-y-6\">\n                      <FormField\n                        control={form.control}\n                        name=\"serviceType\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>اختر نوع الخدمة *</FormLabel>\n                            <Select \n                              onValueChange={(value) => {\n                                field.onChange(value);\n                                setFormData({ ...formData, serviceType: value });\n                              }} \n                              defaultValue={field.value}\n                            >\n                              <FormControl>\n                                <SelectTrigger className=\"rounded-xl\" data-testid=\"select-service-type\">\n                                  <SelectValue placeholder=\"اختر الخدمة المطلوبة\" />\n                                </SelectTrigger>\n                              </FormControl>\n                              <SelectContent>\n                                {servicesList.map((service) => (\n                                  <SelectItem key={service.id} value={service.id}>\n                                    {service.name}\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      {formData.serviceType && (\n                        <>\n                          <FormField\n                            control={form.control}\n                            name=\"reviewsCount\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>أدخل عدد التقييمات المطلوبة *</FormLabel>\n                                <FormControl>\n                                  <Input \n                                    {...field} \n                                    type=\"number\"\n                                    min=\"1\"\n                                    max=\"1000\"\n                                    placeholder=\"50\" \n                                    className=\"rounded-xl\" \n                                    data-testid=\"input-reviews-count\"\n                                    onChange={(e) => {\n                                      const value = parseInt(e.target.value) || 0;\n                                      field.onChange(value);\n                                      setFormData({ ...formData, reviewsCount: value });\n                                    }}\n                                  />\n                                </FormControl>\n                                <FormDescription>\n                                  أدخل عدد التقييمات التي تحتاجها (من 1 إلى 1000)\n                                </FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          {/* عرض ملخص التكلفة */}\n                          <div className=\"bg-primary/5 border border-primary/20 p-6 rounded-2xl space-y-4\">\n                            <div className=\"flex items-center gap-2 mb-4\">\n                              <DollarSign className=\"h-5 w-5 text-primary\" />\n                              <h3 className=\"font-bold text-lg\">ملخص التكلفة</h3>\n                            </div>\n                            \n                            <div className=\"space-y-3\">\n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">نوع الخدمة:</span>\n                                <span className=\"font-medium\">{selectedService?.name}</span>\n                              </div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">عدد التقييمات:</span>\n                                <span className=\"font-medium flex items-center gap-1\">\n                                  <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n                                  {reviewsCount} تقييم\n                                </span>\n                              </div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">سعر التقييم الواحد:</span>\n                                <span className=\"font-medium\">{pricePerReview} دولار</span>\n                              </div>\n                              \n                              <div className=\"h-px bg-border my-3\"></div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"font-bold text-lg\">التكلفة الإجمالية:</span>\n                                <span className=\"font-bold text-2xl text-primary\">\n                                  ${totalCost}\n                                </span>\n                              </div>\n                            </div>\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Step 3: Confirmation */}\n                  {currentStep === 3 && (\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-accent/10 p-6 rounded-2xl space-y-4\">\n                        <h3 className=\"font-semibold text-lg\">ملخص الطلب</h3>\n                        <div className=\"space-y-3 text-sm\">\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">الاسم:</span>\n                            <span className=\"font-medium\">{formData.fullName}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">البريد الإلكتروني:</span>\n                            <span className=\"font-medium\">{formData.email}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">الخدمة:</span>\n                            <span className=\"font-medium\">{selectedService?.name}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">عدد التقييمات:</span>\n                            <span className=\"font-medium\">{reviewsCount} تقييم</span>\n                          </div>\n                          <div className=\"h-px bg-border my-2\"></div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"font-bold\">التكلفة الإجمالية:</span>\n                            <span className=\"font-bold text-primary text-lg\">${totalCost}</span>\n                          </div>\n                        </div>\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"acceptTerms\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex items-start gap-2 space-y-0 p-4 bg-muted/30 rounded-xl\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-terms\"\n                              />\n                            </FormControl>\n                            <div className=\"flex-1\">\n                              <FormLabel className=\"text-sm leading-relaxed cursor-pointer\">\n                                أتعهد بعدم طلب تقييمات غير حقيقية، وجميع التجارب ستكون فعلية داخل المنصة. أوافق على{\" \"}\n                                <a href=\"#terms\" className=\"text-primary hover:underline\">الشروط والأحكام</a>\n                              </FormLabel>\n                              <FormMessage />\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Navigation Buttons */}\n                  <div className=\"flex gap-3 pt-4\">\n                    {currentStep > 1 && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={handleBack}\n                        className=\"flex-1 rounded-2xl\"\n                        data-testid=\"button-back\"\n                      >\n                        <ArrowLeft className=\"ml-2 h-4 w-4\" />\n                        رجوع\n                      </Button>\n                    )}\n                    \n                    <Button \n                      type=\"button\"\n                      onClick={handleNext}\n                      disabled={createOwnerMutation.isPending}\n                      className=\"flex-1 rounded-2xl\"\n                      data-testid=\"button-next\"\n                    >\n                      {currentStep === 3 ? (\n                        createOwnerMutation.isPending ? \"جارٍ إنشاء الحساب...\" : \"إنشاء الحساب\"\n                      ) : (\n                        <>\n                          التالي\n                          <ArrowRight className=\"mr-2 h-4 w-4\" />\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n\n          {/* Sign in link */}\n          <div className=\"text-center mt-6\">\n            <p className=\"text-sm text-muted-foreground\">\n              هل لديك حساب بالفعل؟{\" \"}\n              <a href=\"/login\" className=\"text-primary hover:underline font-medium\">\n                تسجيل الدخول\n              </a>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":21096},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/PasswordStrength.tsx":{"content":"import { useMemo } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface PasswordStrengthProps {\n  password: string;\n}\n\nexport function PasswordStrength({ password }: PasswordStrengthProps) {\n  const strength = useMemo(() => {\n    if (!password) return { level: 0, text: \"\", color: \"\" };\n\n    let score = 0;\n    \n    // Length check\n    if (password.length >= 8) score += 1;\n    if (password.length >= 12) score += 1;\n    \n    // Character variety checks\n    if (/[a-z]/.test(password)) score += 1;\n    if (/[A-Z]/.test(password)) score += 1;\n    if (/[0-9]/.test(password)) score += 1;\n    if (/[^a-zA-Z0-9]/.test(password)) score += 1;\n\n    if (score <= 2) return { level: 1, text: \"ضعيفة\", color: \"bg-destructive\" };\n    if (score <= 4) return { level: 2, text: \"متوسطة\", color: \"bg-yellow-500\" };\n    return { level: 3, text: \"قوية\", color: \"bg-primary\" };\n  }, [password]);\n\n  if (!password) return null;\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"password-strength\">\n      <div className=\"flex gap-1\">\n        {[1, 2, 3].map((level) => (\n          <div\n            key={level}\n            className={cn(\n              \"h-1.5 flex-1 rounded-full transition-all\",\n              level <= strength.level ? strength.color : \"bg-muted\"\n            )}\n          />\n        ))}\n      </div>\n      <p className=\"text-xs text-muted-foreground\">\n        قوة كلمة المرور: <span className=\"font-medium\">{strength.text}</span>\n      </p>\n    </div>\n  );\n}\n","size_bytes":1494},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport jwt from \"jsonwebtoken\";\n\n// JWT secret from environment - REQUIRED for production\nif (!process.env.JWT_SECRET && process.env.NODE_ENV === \"production\") {\n  throw new Error(\"JWT_SECRET environment variable must be set in production\");\n}\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"development-secret-key-DO-NOT-USE-IN-PRODUCTION\";\nconst JWT_EXPIRES_IN = \"7d\"; // Token expires in 7 days\n\nexport interface AuthPayload {\n  userId: string;\n  userType: \"freelancer\" | \"product_owner\";\n  email: string;\n}\n\nexport interface AuthRequest extends Request {\n  user?: AuthPayload;\n}\n\n// Generate JWT token\nexport function generateToken(payload: AuthPayload): string {\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n}\n\n// Verify JWT token\nexport function verifyToken(token: string): AuthPayload | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as AuthPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\n// Authentication middleware\nexport function authMiddleware(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    // Check for token in Authorization header or cookie\n    const authHeader = req.headers.authorization;\n    const token = authHeader?.startsWith(\"Bearer \") \n      ? authHeader.substring(7) \n      : req.cookies?.token;\n\n    if (!token) {\n      return res.status(401).json({ error: \"غير مصرح - يرجى تسجيل الدخول\" });\n    }\n\n    const payload = verifyToken(token);\n    if (!payload) {\n      return res.status(401).json({ error: \"رمز غير صالح - يرجى تسجيل الدخول مرة أخرى\" });\n    }\n\n    req.user = payload;\n    next();\n  } catch (error) {\n    return res.status(401).json({ error: \"خطأ في المصادقة\" });\n  }\n}\n\n// Optional auth middleware (doesn't fail if no token)\nexport function optionalAuthMiddleware(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    const authHeader = req.headers.authorization;\n    const token = authHeader?.startsWith(\"Bearer \")\n      ? authHeader.substring(7)\n      : req.cookies?.token;\n\n    if (token) {\n      const payload = verifyToken(token);\n      if (payload) {\n        req.user = payload;\n      }\n    }\n    next();\n  } catch (error) {\n    next();\n  }\n}\n\n// Role-based authorization middleware\nexport function requireRole(allowedRoles: (\"freelancer\" | \"product_owner\")[]) {\n  return (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user) {\n      return res.status(401).json({ error: \"غير مصرح - يرجى تسجيل الدخول\" });\n    }\n\n    if (!allowedRoles.includes(req.user.userType)) {\n      return res.status(403).json({ error: \"ممنوع - ليس لديك صلاحية للوصول\" });\n    }\n\n    next();\n  };\n}\n","size_bytes":2784},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"design_guidelines.md":{"content":"# Sumou Platform Design Guidelines (سُمُوّ)\n\n## Design Philosophy\n\n**Reference-Based Approach**: Modern SaaS aesthetic inspired by Figma/Notion—clean interfaces, clear hierarchy, professional presentation, RTL-first with seamless LTR adaptation.\n\n**Core Principles**: Spacious layouts, professional yet approachable, clear visual hierarchy, breathing room between elements.\n\n## Brand Identity\n\n**Primary Color**: Deep Blue (#002e62 - HSL: 212, 100%, 31%) - A professional, trustworthy deep blue that conveys stability, professionalism, and reliability.\n\n**Color Psychology**: The deep blue color represents trust, stability, and professionalism, perfectly suited for a platform connecting professionals and digital product owners.\n\n## Typography\n\n**Fonts**: Cairo (Arabic primary, RTL-optimized) + Inter (Latin fallback) via Google Fonts CDN\n\n**Scale**:\n- Hero: 3.5-4.5rem, weight 700-800\n- Page Titles: 2.5-3rem, weight 700\n- Section Headers: 1.875-2.25rem, weight 600\n- Card Titles: 1.25-1.5rem, weight 600\n- Body: 1rem, weight 400\n- Small/Captions: 0.875rem, weight 400-500\n\n**RTL/LTR**: Use `dir=\"rtl\"` for Arabic, mirror spacing/padding/margins, flip directional icons, right-align RTL text.\n\n## Layout & Spacing\n\n**Spacing Units**: 2, 4, 6, 8, 12, 16, 20, 24, 32 (Tailwind)\n\n**Common Patterns**:\n- Component padding: p-6/p-8\n- Section spacing: py-16 to py-24 (desktop), py-12 (mobile)\n- Card gaps: gap-6/gap-8\n- Form fields: space-y-6\n- Buttons: px-8 py-3 (large), px-6 py-2.5 (medium)\n\n**Grids**:\n- Features: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Dashboard: grid-cols-1 md:grid-cols-2 xl:grid-cols-3\n- Pricing: grid-cols-1 lg:grid-cols-3\n\n**Containers**: Full-width with max-w-7xl mx-auto px-6 | Forms: max-w-2xl mx-auto | Modals: max-w-lg to max-w-3xl\n\n**Breakpoints**: Mobile <768px | Tablet 768-1024px | Desktop >1024px | Wide >1440px\n\n## Components\n\n### Navigation\n\n**Landing Header**: Fixed/sticky, backdrop-blur, logo right (RTL)/left (LTR), nav links gap-8 weight-500, CTA rounded-2xl shadow-sm\n\n**Dashboard Sidebar**: 280px fixed, icons from Heroicons, active state with deep blue accent strip, collapsible mobile overlay\n\n### Forms & Inputs\n\n**Text Inputs**: 1px border, rounded-xl, px-4 py-3, deep blue ring on focus, red border for errors, icons right (RTL) with mr-3\n\n**Multi-Step Forms**: Progress indicator with step numbers/connecting lines, current step deep blue, completed with checkmarks, max-w-2xl centered, prev/next buttons at bottom\n\n**File Upload**: Dashed border rounded-xl, drag-drop zone, uploaded files list with remove button, circular preview (profile), rectangular (docs)\n\n**Select/Multi-Select**: Custom styled matching inputs, multi-select with checkboxes, selected tags as rounded-full chips with close icon, gap-2 wrapping\n\n**Password**: Toggle icon right (RTL), strength bar below (weak/medium/strong), requirements checklist on focus\n\n**OTP**: 6 squared boxes rounded corners, auto-focus next, centered modal with backdrop-blur, resend timer\n\n### Cards\n\n**Primary Card**: White bg, rounded-2xl, shadow-md, p-6/p-8, hover: shadow-lg + scale-105\n\n**Feature Cards**: Large circular icon (light blue bg), title weight-600 text-lg, 2-3 line description, optional \"Learn more\" link\n\n**Pricing Cards**: Vertical layout, badge for \"Popular\", bold package name, large price, checkmark feature list, full-width CTA at bottom\n\n**Dashboard Stats**: Large number (2.5rem, weight 700), label below, circular icon corner, trend arrow with %\n\n### Buttons\n\n**Primary**: Deep Blue (#002e62) bg, white text weight-600, rounded-2xl, px-8 py-3/px-6 py-2.5, shadow-md, hover: scale-105 transition-all 200ms\n\n**On Hero Images**: backdrop-blur-md, semi-transparent bg, rounded-2xl, shadow\n\n**Secondary**: 2px deep blue border, transparent/white bg, deep blue text, same sizing\n\n**Icon**: p-2/p-3, rounded-xl, hover bg treatment\n\n### Dashboard Elements\n\n**Sidebar Items**: Icon + label gap-3, px-4 py-3, rounded-xl, active: deep blue tint bg + deep blue text, hover: light bg\n\n**Data Tables**: Header row bg tint weight-600, subtle row dividers, row hover light bg, icon buttons for actions, centered pagination\n\n**Empty States**: Centered icon/illustration, \"No [items] yet\" headline, descriptive text, primary CTA\n\n### AI Suggestions\n\n**Card Style**: Light blue tint bg, lightbulb/sparkle icon, medium weight text, \"Apply\"/\"Dismiss\" buttons, close icon, positioned contextually\n\n### Modals\n\n**Structure**: Semi-transparent dark backdrop, centered rounded-2xl container, close button top-right (RTL: top-left), bold title, comfortable padding, action buttons aligned right (RTL: left)\n\n**Confirmations**: Circular deep blue checkmark icon, centered message, single primary button\n\n## Landing Page Sections\n\n**Hero**: Full-width min-h-85vh, large bg image (diverse users/digital marketplace), centered content with z-index, extra-large 2-line headline, max-w-2xl subheadline, dual CTAs (side-by-side desktop/stacked mobile) with backdrop-blur-md semi-transparent bg\n\n**How It Works**: Centered title/subtitle, 3-col grid (desktop)/single (mobile), numbered icons with titles/descriptions, connecting lines optional\n\n**Features**: 6 cards in 2x3 grid (desktop), equal height flex layout\n\n**Freelancer/Product Owner**: Alternating left-right image-text, headline + bullets + CTA, background alternates white/subtle tint\n\n**Pricing**: Centered header, 3 cards side-by-side (desktop), center card elevated as \"Popular\"\n\n**Social Proof**: Testimonial cards with photo/quote/name/role, 2-col grid or carousel, star ratings\n\n**Footer**: 4-col (desktop)/stacked (mobile): About, Services, Support, Legal + logo/tagline right (RTL), social icons, language switcher, copyright\n\n## Registration Flows\n\n**Account Selection**: Minimal centered layout, 2 large cards side-by-side (desktop), icon + role + 3-4 bullets + button, equal weight\n\n**Freelancer Steps**:\n1. Name, email, password (strength indicator), phone (country code), terms checkbox\n2. Job title (icon), bio textarea (4-5 rows), team size, services multi-select\n3. Profile pic (circular preview), ID upload (rectangular), verification badges\n4. Payment method dropdown, account details, info card\n\n**Product Owner Steps**:\n1. Company name, website, product type, category\n2. Product URL (live) or file upload (unreleased APK/TestFlight), target audience\n3. Service checkbox grid, package cards (Basic/Pro/Growth) with comparison\n4. Budget input/package selection, timeline, campaign objectives textarea\n\n## Dashboard Layouts\n\n**Freelancer**: 280px sidebar, full-width main content, top bar (welcome + notifications + profile), 4 metric cards, filterable tasks list/grid, activity feed\n\n**Product Owner**: Similar sidebar, campaign overview cards, active campaigns table, analytics charts, prominent wallet balance\n\n## Images\n\n- **Hero**: High-quality photo/illustration of diverse people collaborating in digital workspace, bright/optimistic/professional\n- **Features**: Platform screenshots/illustrations showing functionality\n- **Account Cards**: Icon illustrations (freelancer: person+tools, owner: person+product/chart)\n- **Empty States**: Friendly, simple, guiding custom illustrations\n\n## Accessibility\n\n- Clear focus indicators, sufficient contrast ratios\n- Full keyboard navigation, ARIA labels for RTL screen readers\n- Clear form validation errors, loading states for async actions\n\n---\n\n**Quick Reference**: Deep Blue primary (#002e62 / HSL: 212, 100%, 31%), rounded-2xl standard radius, Cairo/Inter fonts, RTL-first mirroring, shadow-md standard elevation, transition-all duration-200ms standard animation\n\n## Color Palette\n\n**Primary Colors**:\n- Deep Blue: `hsl(212, 100%, 31%)` - Main brand color\n- Deep Blue Light (for dark mode): `hsl(212, 80%, 45%)` - Lighter variant for dark backgrounds\n\n**Accent Colors**:\n- Blue Light: `hsl(212, 15%, 85%)` - For subtle backgrounds\n- Blue Muted: `hsl(212, 10%, 90%)` - For muted elements\n\n**Usage Guidelines**:\n- Use primary deep blue for CTAs, active states, links, and key UI elements\n- Use blue accents for hover states, focus rings, and highlights\n- Maintain sufficient contrast ratios for accessibility (WCAG AA minimum)\n- Pair with neutral grays for backgrounds and text\n- Use sparingly to maintain visual hierarchy","size_bytes":8257},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"shared/schema.ts":{"content":"import { sql, relations } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, timestamp, decimal, boolean, uniqueIndex } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Freelancer schema\nexport const freelancers = pgTable(\"freelancers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  username: text(\"username\").notNull().unique(),\n  phone: text(\"phone\").notNull(),\n  countryCode: text(\"country_code\").notNull().default(\"+966\"),\n  jobTitle: text(\"job_title\"),\n  teamSize: integer(\"team_size\").default(1),\n  services: text(\"services\").array().default(sql`ARRAY[]::text[]`),\n  bio: text(\"bio\"),\n  aboutMe: text(\"about_me\"),\n  profileImage: text(\"profile_image\"),\n  idVerification: text(\"id_verification\"),\n  paymentMethod: text(\"payment_method\"),\n  accountNumber: text(\"account_number\"),\n  isVerified: boolean(\"is_verified\").default(false),\n  acceptedInstructions: boolean(\"accepted_instructions\").default(false),\n  lastSeen: timestamp(\"last_seen\"), // آخر ظهور (للحالة أونلاين/أوفلاين)\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Product Owner schema\nexport const productOwners = pgTable(\"product_owners\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  companyName: text(\"company_name\"),\n  phone: text(\"phone\"),\n  productName: text(\"product_name\"),\n  productType: text(\"product_type\"),\n  productDescription: text(\"product_description\"),\n  productUrl: text(\"product_url\"),\n  services: text(\"services\").array().default(sql`ARRAY[]::text[]`),\n  package: text(\"package\"),\n  budget: text(\"budget\"),\n  duration: text(\"duration\"),\n  acceptedInstructions: boolean(\"accepted_instructions\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Campaigns schema\nexport const campaigns = pgTable(\"campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  productType: text(\"product_type\").notNull(),\n  productUrl: text(\"product_url\"),\n  services: text(\"services\").array().notNull(),\n  package: text(\"package\").notNull(),\n  budget: decimal(\"budget\", { precision: 10, scale: 2 }).notNull(),\n  testersNeeded: integer(\"testers_needed\").notNull(),\n  testersAssigned: integer(\"testers_assigned\").default(0).notNull(),\n  status: text(\"status\").notNull().default(\"draft\"), // draft, active, in_progress, completed, cancelled\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Groups schema - الجروبات (MOVED BEFORE TASKS)\nexport const groups = pgTable(\"groups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  groupImage: text(\"group_image\"), // صورة الجروب\n  portfolioImages: text(\"portfolio_images\").array().default(sql`ARRAY[]::text[]`), // صور البورتفوليو (قبل وبعد)\n  leaderId: varchar(\"leader_id\").notNull().references(() => freelancers.id),\n  maxMembers: integer(\"max_members\").default(700).notNull(),\n  currentMembers: integer(\"current_members\").default(1).notNull(),\n  status: text(\"status\").notNull().default(\"active\"), // active, inactive\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Projects schema - المشاريع من أصحاب المشاريع (MOVED BEFORE TASKS)\nexport const projects = pgTable(\"projects\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  targetCountry: text(\"target_country\").notNull(),\n  tasksCount: integer(\"tasks_count\").notNull(), // عدد المهام المطلوبة\n  budget: decimal(\"budget\", { precision: 10, scale: 2 }).notNull(),\n  deadline: timestamp(\"deadline\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, accepted, in_progress, completed, cancelled\n  acceptedByGroupId: varchar(\"accepted_by_group_id\").references(() => groups.id),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Tasks schema (individual testing tasks assigned to freelancers)\nexport const tasks = pgTable(\"tasks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").references(() => campaigns.id),\n  projectId: varchar(\"project_id\").references(() => projects.id),\n  groupId: varchar(\"group_id\").references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").references(() => freelancers.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  serviceType: text(\"service_type\").notNull(),\n  reward: decimal(\"reward\", { precision: 10, scale: 2 }).notNull(),\n  status: text(\"status\").notNull().default(\"available\"), // available, assigned, in_progress, submitted, approved, rejected\n  assignedAt: timestamp(\"assigned_at\"),\n  submittedAt: timestamp(\"submitted_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  submission: text(\"submission\"), // Freelancer's submission/report\n  proofImage: text(\"proof_image\"), // صورة الإثبات\n  taskUrl: text(\"task_url\"), // رابط المهمة\n  feedback: text(\"feedback\"), // Product owner's or leader's feedback\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Wallets schema (freelancer wallets)\nexport const wallets = pgTable(\"wallets\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  freelancerId: varchar(\"freelancer_id\").notNull().unique().references(() => freelancers.id),\n  balance: decimal(\"balance\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  pendingBalance: decimal(\"pending_balance\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  totalEarned: decimal(\"total_earned\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  totalWithdrawn: decimal(\"total_withdrawn\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Transactions schema (wallet transactions)\nexport const transactions = pgTable(\"transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  walletId: varchar(\"wallet_id\").notNull().references(() => wallets.id),\n  taskId: varchar(\"task_id\").references(() => tasks.id),\n  type: text(\"type\").notNull(), // earning, withdrawal, refund\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, completed, failed\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Payments schema (product owner payments)\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").notNull().references(() => campaigns.id),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\").notNull(), // stripe, paypal, stc_pay\n  paymentIntentId: text(\"payment_intent_id\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, completed, failed, refunded\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Notifications schema\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull(), // can be freelancer or product owner\n  userType: text(\"user_type\").notNull(), // freelancer or product_owner\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  type: text(\"type\").notNull(), // task_assigned, payment_received, campaign_update, etc.\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Group Members schema - أعضاء الجروبات\nexport const groupMembers = pgTable(\"group_members\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  role: text(\"role\").notNull().default(\"member\"), // leader, member\n  joinedAt: timestamp(\"joined_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueGroupMember: uniqueIndex(\"unique_group_member_idx\").on(table.groupId, table.freelancerId),\n}));\n\n// Messages schema - الرسائل الداخلية\nexport const messages = pgTable(\"messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  senderId: varchar(\"sender_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  type: text(\"type\").notNull().default(\"text\"), // text, task_post, image\n  relatedProjectId: varchar(\"related_project_id\").references(() => projects.id),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Withdrawals schema - طلبات السحب\nexport const withdrawals = pgTable(\"withdrawals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\").notNull(),\n  accountNumber: text(\"account_number\").notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, completed, rejected\n  processedAt: timestamp(\"processed_at\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Orders schema - الطلبات المباشرة من أصحاب المشاريع للجروبات\nexport const orders = pgTable(\"orders\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  serviceType: text(\"service_type\").notNull(), // google_play_reviews, ios_reviews, website_reviews, ux_testing, software_testing, social_media, google_maps\n  quantity: integer(\"quantity\").notNull(), // عدد المراجعات/المهام المطلوبة\n  pricePerUnit: decimal(\"price_per_unit\", { precision: 10, scale: 2 }).notNull(), // السعر لكل وحدة\n  totalAmount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(), // الإجمالي\n  paymentMethod: text(\"payment_method\").notNull(), // vodafone_cash, etisalat_cash, orange_cash, bank_card\n  paymentDetails: text(\"payment_details\"), // رقم الهاتف أو بيانات البطاقة\n  status: text(\"status\").notNull().default(\"pending\"), // pending, payment_confirmed, in_progress, completed, cancelled\n  paidAt: timestamp(\"paid_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Group Join Requests schema - طلبات الانضمام للجروبات\nexport const groupJoinRequests = pgTable(\"group_join_requests\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  message: text(\"message\"), // رسالة من المتقدم\n  status: text(\"status\").notNull().default(\"pending\"), // pending, approved, rejected\n  reviewedAt: timestamp(\"reviewed_at\"),\n  reviewNotes: text(\"review_notes\"), // ملاحظات من قائد الجروب\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueJoinRequest: uniqueIndex(\"unique_join_request_idx\").on(table.groupId, table.freelancerId),\n}));\n\n// Conversations schema - المحادثات المباشرة\nexport const conversations = pgTable(\"conversations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  leaderId: varchar(\"leader_id\").notNull().references(() => freelancers.id),\n  lastMessageAt: timestamp(\"last_message_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueConversation: uniqueIndex(\"unique_conversation_idx\").on(table.productOwnerId, table.groupId),\n}));\n\n// Conversation Messages schema - رسائل المحادثة المباشرة\nexport const conversationMessages = pgTable(\"conversation_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  conversationId: varchar(\"conversation_id\").notNull().references(() => conversations.id),\n  senderId: varchar(\"sender_id\").notNull(), // يمكن أن يكون product owner أو freelancer\n  senderType: text(\"sender_type\").notNull(), // product_owner, freelancer\n  content: text(\"content\").notNull(),\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Group Posts schema - منشورات الجروب (Community Posts)\nexport const groupPosts = pgTable(\"group_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  authorId: varchar(\"author_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"), // صورة المنشور (اختيارية)\n  likesCount: integer(\"likes_count\").default(0).notNull(),\n  commentsCount: integer(\"comments_count\").default(0).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Post Comments schema - تعليقات المنشورات\nexport const postComments = pgTable(\"post_comments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => groupPosts.id),\n  authorId: varchar(\"author_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"), // صورة التعليق (اختيارية)\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Post Reactions schema - تفاعلات المنشورات (لايكات)\nexport const postReactions = pgTable(\"post_reactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => groupPosts.id),\n  userId: varchar(\"user_id\").notNull().references(() => freelancers.id),\n  type: text(\"type\").notNull().default(\"like\"), // like, love, etc.\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueReaction: uniqueIndex(\"unique_reaction_idx\").on(table.postId, table.userId),\n}));\n\n// Relations\nexport const freelancersRelations = relations(freelancers, ({ one, many }) => ({\n  wallet: one(wallets, { fields: [freelancers.id], references: [wallets.freelancerId] }),\n  tasks: many(tasks),\n  groupsLeading: many(groups),\n  groupMemberships: many(groupMembers),\n  withdrawals: many(withdrawals),\n  messages: many(messages),\n  groupJoinRequests: many(groupJoinRequests),\n}));\n\nexport const productOwnersRelations = relations(productOwners, ({ many }) => ({\n  campaigns: many(campaigns),\n  payments: many(payments),\n  projects: many(projects),\n  orders: many(orders),\n  conversations: many(conversations),\n}));\n\nexport const campaignsRelations = relations(campaigns, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [campaigns.productOwnerId], references: [productOwners.id] }),\n  tasks: many(tasks),\n  payments: many(payments),\n}));\n\nexport const tasksRelations = relations(tasks, ({ one, many }) => ({\n  campaign: one(campaigns, { fields: [tasks.campaignId], references: [campaigns.id] }),\n  project: one(projects, { fields: [tasks.projectId], references: [projects.id] }),\n  group: one(groups, { fields: [tasks.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [tasks.freelancerId], references: [freelancers.id] }),\n  transactions: many(transactions),\n}));\n\nexport const walletsRelations = relations(wallets, ({ one, many }) => ({\n  freelancer: one(freelancers, { fields: [wallets.freelancerId], references: [freelancers.id] }),\n  transactions: many(transactions),\n}));\n\nexport const transactionsRelations = relations(transactions, ({ one }) => ({\n  wallet: one(wallets, { fields: [transactions.walletId], references: [wallets.id] }),\n  task: one(tasks, { fields: [transactions.taskId], references: [tasks.id] }),\n}));\n\nexport const paymentsRelations = relations(payments, ({ one }) => ({\n  campaign: one(campaigns, { fields: [payments.campaignId], references: [campaigns.id] }),\n  productOwner: one(productOwners, { fields: [payments.productOwnerId], references: [productOwners.id] }),\n}));\n\nexport const groupsRelations = relations(groups, ({ one, many }) => ({\n  leader: one(freelancers, { fields: [groups.leaderId], references: [freelancers.id] }),\n  members: many(groupMembers),\n  tasks: many(tasks),\n  messages: many(messages),\n  posts: many(groupPosts),\n  acceptedProjects: many(projects),\n  orders: many(orders),\n  joinRequests: many(groupJoinRequests),\n  conversations: many(conversations),\n}));\n\nexport const groupMembersRelations = relations(groupMembers, ({ one }) => ({\n  group: one(groups, { fields: [groupMembers.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [groupMembers.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const projectsRelations = relations(projects, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [projects.productOwnerId], references: [productOwners.id] }),\n  acceptedByGroup: one(groups, { fields: [projects.acceptedByGroupId], references: [groups.id] }),\n  tasks: many(tasks),\n  messages: many(messages),\n}));\n\nexport const messagesRelations = relations(messages, ({ one }) => ({\n  group: one(groups, { fields: [messages.groupId], references: [groups.id] }),\n  sender: one(freelancers, { fields: [messages.senderId], references: [freelancers.id] }),\n  relatedProject: one(projects, { fields: [messages.relatedProjectId], references: [projects.id] }),\n}));\n\nexport const withdrawalsRelations = relations(withdrawals, ({ one }) => ({\n  freelancer: one(freelancers, { fields: [withdrawals.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const ordersRelations = relations(orders, ({ one }) => ({\n  productOwner: one(productOwners, { fields: [orders.productOwnerId], references: [productOwners.id] }),\n  group: one(groups, { fields: [orders.groupId], references: [groups.id] }),\n}));\n\nexport const groupJoinRequestsRelations = relations(groupJoinRequests, ({ one }) => ({\n  group: one(groups, { fields: [groupJoinRequests.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [groupJoinRequests.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const conversationsRelations = relations(conversations, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [conversations.productOwnerId], references: [productOwners.id] }),\n  group: one(groups, { fields: [conversations.groupId], references: [groups.id] }),\n  leader: one(freelancers, { fields: [conversations.leaderId], references: [freelancers.id] }),\n  messages: many(conversationMessages),\n}));\n\nexport const conversationMessagesRelations = relations(conversationMessages, ({ one }) => ({\n  conversation: one(conversations, { fields: [conversationMessages.conversationId], references: [conversations.id] }),\n}));\n\nexport const groupPostsRelations = relations(groupPosts, ({ one, many }) => ({\n  group: one(groups, { fields: [groupPosts.groupId], references: [groups.id] }),\n  author: one(freelancers, { fields: [groupPosts.authorId], references: [freelancers.id] }),\n  comments: many(postComments),\n  reactions: many(postReactions),\n}));\n\nexport const postCommentsRelations = relations(postComments, ({ one }) => ({\n  post: one(groupPosts, { fields: [postComments.postId], references: [groupPosts.id] }),\n  author: one(freelancers, { fields: [postComments.authorId], references: [freelancers.id] }),\n}));\n\nexport const postReactionsRelations = relations(postReactions, ({ one }) => ({\n  post: one(groupPosts, { fields: [postReactions.postId], references: [groupPosts.id] }),\n  user: one(freelancers, { fields: [postReactions.userId], references: [freelancers.id] }),\n}));\n\n// Insert schemas for validation\nexport const insertFreelancerSchema = createInsertSchema(freelancers).omit({\n  id: true,\n  isVerified: true,\n  createdAt: true,\n});\n\nexport const insertProductOwnerSchema = createInsertSchema(productOwners).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCampaignSchema = createInsertSchema(campaigns).omit({\n  id: true,\n  testersAssigned: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTaskSchema = createInsertSchema(tasks).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWalletSchema = createInsertSchema(wallets).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGroupSchema = createInsertSchema(groups).omit({\n  id: true,\n  currentMembers: true,\n  createdAt: true,\n});\n\nexport const insertGroupMemberSchema = createInsertSchema(groupMembers).omit({\n  id: true,\n  joinedAt: true,\n});\n\nexport const insertProjectSchema = createInsertSchema(projects).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWithdrawalSchema = createInsertSchema(withdrawals).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertOrderSchema = createInsertSchema(orders).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertGroupJoinRequestSchema = createInsertSchema(groupJoinRequests).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertConversationSchema = createInsertSchema(conversations).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertConversationMessageSchema = createInsertSchema(conversationMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGroupPostSchema = createInsertSchema(groupPosts).omit({\n  id: true,\n  likesCount: true,\n  commentsCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPostCommentSchema = createInsertSchema(postComments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPostReactionSchema = createInsertSchema(postReactions).omit({\n  id: true,\n  createdAt: true,\n});\n\n// TypeScript types\nexport type Freelancer = typeof freelancers.$inferSelect;\nexport type InsertFreelancer = z.infer<typeof insertFreelancerSchema>;\nexport type ProductOwner = typeof productOwners.$inferSelect;\nexport type InsertProductOwner = z.infer<typeof insertProductOwnerSchema>;\nexport type Campaign = typeof campaigns.$inferSelect;\nexport type InsertCampaign = z.infer<typeof insertCampaignSchema>;\nexport type Task = typeof tasks.$inferSelect;\nexport type InsertTask = z.infer<typeof insertTaskSchema>;\nexport type Wallet = typeof wallets.$inferSelect;\nexport type InsertWallet = z.infer<typeof insertWalletSchema>;\nexport type Transaction = typeof transactions.$inferSelect;\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\nexport type Notification = typeof notifications.$inferSelect;\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Group = typeof groups.$inferSelect;\nexport type InsertGroup = z.infer<typeof insertGroupSchema>;\nexport type GroupMember = typeof groupMembers.$inferSelect;\nexport type InsertGroupMember = z.infer<typeof insertGroupMemberSchema>;\nexport type Project = typeof projects.$inferSelect;\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type Withdrawal = typeof withdrawals.$inferSelect;\nexport type InsertWithdrawal = z.infer<typeof insertWithdrawalSchema>;\nexport type Order = typeof orders.$inferSelect;\nexport type InsertOrder = z.infer<typeof insertOrderSchema>;\nexport type GroupJoinRequest = typeof groupJoinRequests.$inferSelect;\nexport type InsertGroupJoinRequest = z.infer<typeof insertGroupJoinRequestSchema>;\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type ConversationMessage = typeof conversationMessages.$inferSelect;\nexport type InsertConversationMessage = z.infer<typeof insertConversationMessageSchema>;\nexport type GroupPost = typeof groupPosts.$inferSelect;\nexport type InsertGroupPost = z.infer<typeof insertGroupPostSchema>;\nexport type PostComment = typeof postComments.$inferSelect;\nexport type InsertPostComment = z.infer<typeof insertPostCommentSchema>;\nexport type PostReaction = typeof postReactions.$inferSelect;\nexport type InsertPostReaction = z.infer<typeof insertPostReactionSchema>;\n\n// Service options\nexport const serviceOptions = [\n  \"اختبار تطبيقات\",\n  \"تقييم خرائط Google Maps\",\n  \"تقييم تطبيقات Android\",\n  \"تقييم تطبيقات iOS\",\n  \"تقييم مواقع إلكترونية\",\n  \"اختبار أنظمة Software\",\n  \"مراجعات تجربة المستخدم UX/UI\",\n  \"التفاعل مع منشورات السوشيال ميديا\",\n] as const;\n\n// Product types\nexport const productTypes = [\n  \"تطبيق موبايل\",\n  \"موقع إلكتروني\",\n  \"نظام سوفت وير\",\n  \"متجر إلكتروني\",\n] as const;\n\n// Payment methods\nexport const paymentMethods = [\n  \"فودافون كاش\",\n  \"اتصالات كاش\",\n  \"أورانج كاش\",\n  \"التحويل البنكي\",\n  \"محفظة سُمُوّ\",\n] as const;\n\n// Payment method details configuration\nexport const paymentMethodDetails: Record<string, { label: string; placeholder: string; inputType: string }> = {\n  \"فودافون كاش\": {\n    label: \"رقم محفظة فودافون كاش\",\n    placeholder: \"مثال: 01012345678\",\n    inputType: \"tel\",\n  },\n  \"اتصالات كاش\": {\n    label: \"رقم محفظة اتصالات كاش\",\n    placeholder: \"مثال: 01112345678\",\n    inputType: \"tel\",\n  },\n  \"أورانج كاش\": {\n    label: \"رقم محفظة أورانج كاش\",\n    placeholder: \"مثال: 01212345678\",\n    inputType: \"tel\",\n  },\n  \"التحويل البنكي\": {\n    label: \"رقم الحساب البنكي (IBAN)\",\n    placeholder: \"مثال: SA1234567890123456789012\",\n    inputType: \"text\",\n  },\n  \"محفظة سُمُوّ\": {\n    label: \"معرف محفظة سُمُوّ\",\n    placeholder: \"سيتم إنشاؤه تلقائيًا\",\n    inputType: \"text\",\n  },\n};\n\n// Packages\nexport const packages = [\n  {\n    id: \"basic\",\n    name: \"Basic\",\n    nameAr: \"أساسي\",\n    testers: 10,\n    features: [\n      \"10 مختبرين متخصصين\",\n      \"تقرير أساسي عن التجربة\",\n      \"مدة التنفيذ: 3-5 أيام\",\n      \"دعم فني أساسي\",\n    ],\n    price: \"499\",\n  },\n  {\n    id: \"pro\",\n    name: \"Pro\",\n    nameAr: \"احترافي\",\n    testers: 30,\n    features: [\n      \"30 مختبرًا متخصصًا\",\n      \"تحليل UX/UI مفصل\",\n      \"تقرير شامل مع توصيات\",\n      \"مدة التنفيذ: 5-7 أيام\",\n      \"دعم فني ذو أولوية\",\n    ],\n    price: \"1299\",\n    recommended: true,\n  },\n  {\n    id: \"growth\",\n    name: \"Growth\",\n    nameAr: \"نمو\",\n    testers: 50,\n    features: [\n      \"50+ مختبرًا من مختلف الفئات\",\n      \"اختبار + تقييم + تفاعل سوشيال\",\n      \"تحليل ذكي بالـ AI\",\n      \"تقارير تفصيلية أسبوعية\",\n      \"مدة التنفيذ: 7-14 يوم\",\n      \"مدير حساب مخصص\",\n      \"دعم فني على مدار الساعة\",\n    ],\n    price: \"2999\",\n  },\n] as const;\n\n// Keep the existing users table for compatibility\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n","size_bytes":29787},"client/src/pages/Home.tsx":{"content":"import { Link } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { motion, useInView } from \"framer-motion\";\nimport { useRef } from \"react\";\nimport { \n  UserPlus, \n  FileCheck, \n  BarChart3, \n  Users, \n  TrendingUp,\n  Star,\n  CheckCircle2,\n  Sparkles,\n  Shield,\n  Zap,\n  Target,\n  Award,\n  Clock,\n  Globe,\n  MessageSquare,\n  MapPin,\n  Apple,\n  Smartphone,\n  Share2,\n  Palette,\n  type LucideIcon\n} from \"lucide-react\";\nimport { SiGoogle, SiTrustpilot } from \"react-icons/si\";\n\n// ServiceIcon component with circular background and glow effect\nfunction ServiceIcon({ \n  icon: Icon, \n  bgColor, \n  iconColor, \n  glowColor \n}: { \n  icon: LucideIcon; \n  bgColor: string; \n  iconColor: string; \n  glowColor: string;\n}) {\n  return (\n    <div \n      className={`inline-flex p-4 rounded-2xl ${bgColor} shadow-lg relative`}\n      style={{\n        boxShadow: `0 8px 24px ${glowColor}`\n      }}\n    >\n      <Icon className={`h-7 w-7 ${iconColor}`} strokeWidth={2} />\n    </div>\n  );\n}\n\n// Component for advanced fade-in animations on scroll with 3D effects\nfunction FadeInSection({ children, delay = 0 }: { children: React.ReactNode; delay?: number }) {\n  const ref = useRef(null);\n  const isInView = useInView(ref, { once: true, margin: \"-100px\" });\n\n  return (\n    <motion.div\n      ref={ref}\n      initial={{ opacity: 0, y: 50, rotateX: -15, scale: 0.95 }}\n      animate={isInView ? { \n        opacity: 1, \n        y: 0, \n        rotateX: 0,\n        scale: 1\n      } : { \n        opacity: 0, \n        y: 50, \n        rotateX: -15,\n        scale: 0.95\n      }}\n      transition={{ \n        duration: 0.8, \n        delay, \n        ease: [0.25, 0.46, 0.45, 0.94] // Custom cubic-bezier\n      }}\n      style={{ transformStyle: \"preserve-3d\" }}\n    >\n      {children}\n    </motion.div>\n  );\n}\n\n// Advanced animated background particles\nfunction AnimatedParticle({ delay = 0, x = \"0%\", y = \"0%\" }: { delay?: number; x?: string; y?: string }) {\n  return (\n    <motion.div\n      className=\"absolute w-2 h-2 bg-primary/20 rounded-full\"\n      style={{ left: x, top: y }}\n      animate={{\n        y: [0, -30, 0],\n        x: [0, 15, 0],\n        opacity: [0.2, 0.5, 0.2],\n        scale: [1, 1.5, 1],\n      }}\n      transition={{\n        duration: 4,\n        delay,\n        repeat: Infinity,\n        ease: \"easeInOut\"\n      }}\n    />\n  );\n}\n\n// Floating icon component with advanced motion\nfunction FloatingIcon({ icon: Icon, color, delay = 0 }: { icon: any; color: string; delay?: number }) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0, rotate: -180 }}\n      animate={{ \n        opacity: [0.4, 0.7, 0.4],\n        scale: [1, 1.2, 1],\n        rotate: [0, 360],\n        y: [0, -20, 0],\n      }}\n      transition={{\n        duration: 6,\n        delay,\n        repeat: Infinity,\n        ease: \"easeInOut\"\n      }}\n      className={`${color}`}\n    >\n      <Icon className=\"w-8 h-8\" />\n    </motion.div>\n  );\n}\n\nexport default function Home() {\n  const reviewServices = [\n    { \n      icon: Share2, \n      title: \"زيادة التفاعل على منشورات وصفحات السوشيال ميديا\",\n      subtitle: \"توسيع ووصول منشوراتك\", \n      value: \"2,500+\", \n      label: \"تفاعل تم\", \n      iconColor: \"text-primary\",\n      bgColor: \"bg-primary/10\",\n      glowColor: \"rgba(76, 175, 80, 0.15)\",\n      gradient: \"from-primary to-primary\"\n    },\n    { \n      icon: Star, \n      title: \"تحسين تقييمات تطبيقات Google Play و App Store\",\n      subtitle: \"رفع تقييمات تطبيقاتك\", \n      value: \"1,800+\", \n      label: \"تقييم تم\", \n      iconColor: \"text-primary\",\n      bgColor: \"bg-primary/10\",\n      glowColor: \"rgba(76, 175, 80, 0.15)\",\n      gradient: \"from-primary to-primary\"\n    },\n    { \n      icon: MapPin, \n      title: \"تقييمات حقيقية على خرائط Google Maps\",\n      subtitle: \"تحسين ظهور نشاطك التجاري\", \n      value: \"1,200+\", \n      label: \"تقييم تم\", \n      iconColor: \"text-primary\",\n      bgColor: \"bg-primary/10\",\n      glowColor: \"rgba(76, 175, 80, 0.15)\",\n      gradient: \"from-primary to-primary\"\n    },\n    { \n      icon: Palette, \n      title: \"اختبار شامل لتجربة المستخدم UX/UI\",\n      subtitle: \"تقييمات دقيقة لتجربة المستخدم\", \n      value: \"950+\", \n      label: \"اختبار تم\", \n      iconColor: \"text-primary\",\n      bgColor: \"bg-primary/10\",\n      glowColor: \"rgba(76, 175, 80, 0.15)\",\n      gradient: \"from-primary to-primary\"\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n\n      {/* Hero Section - Inspired by the image */}\n      <section className=\"relative overflow-hidden bg-gradient-to-br from-background via-background to-primary/5 py-16 lg:py-24\">\n        <div className=\"absolute inset-0 bg-grid-pattern opacity-5\"></div>\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative\">\n          <div className=\"grid lg:grid-cols-2 gap-12 items-center\">\n            {/* Left Side - Main Content */}\n            <div className=\"space-y-8 text-center lg:text-right\">\n              <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full\">\n                <Sparkles className=\"h-4 w-4 text-primary\" />\n                <span className=\"text-sm font-medium text-primary\">المنصة الأولى في المنطقة</span>\n              </div>\n\n              <h1 className=\"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight\" data-testid=\"text-hero-title\">\n                <span className=\"block mb-2\">\n                  اختبر تطبيقك، حسّن\n                </span>\n                <span className=\"block mb-2\">\n                  تقييماتك، واجعل\n                </span>\n                <span className=\"bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">\n                  منتجك ينمو مع\n                </span>\n                <br />\n                <span className=\"bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">\n                  مستخدمين حقيقيين\n                </span>\n              </h1>\n              \n              <p className=\"text-lg sm:text-xl text-muted-foreground leading-relaxed max-w-2xl mx-auto lg:mx-0\" data-testid=\"text-hero-description\">\n                نربط بين أصحاب المنتجات الرقمية والمتخصصين في{\" \"}\n                <span className=\"text-primary font-semibold\">Test & Grow</span> و\n                <span className=\"text-primary font-semibold\">المنصات الرقمية</span>{\" \"}\n                المتخصصين في الاختبار والتقييم\n              </p>\n\n              <div className=\"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start\">\n                <Link href=\"/role-selection\">\n                  <Button size=\"lg\" className=\"w-full sm:w-auto rounded-2xl shadow-lg text-base px-8 hover-elevate\" data-testid=\"button-start-now\">\n                    <Sparkles className=\"ml-2 h-5 w-5\" />\n                    أنشئ حسابك الآن\n                  </Button>\n                </Link>\n                <Button \n                  size=\"lg\" \n                  variant=\"outline\" \n                  className=\"w-full sm:w-auto rounded-2xl shadow-md text-base px-8 hover-elevate\" \n                  data-testid=\"button-learn-more\"\n                  onClick={() => document.getElementById('about')?.scrollIntoView({ behavior: 'smooth' })}\n                >\n                  <BarChart3 className=\"ml-2 h-5 w-5\" />\n                  تعرف على المزيد\n                </Button>\n              </div>\n\n              {/* Feature Badges */}\n              <div className=\"flex flex-wrap gap-3 justify-center lg:justify-start pt-4\">\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <CheckCircle2 className=\"h-4 w-4 text-primary\" />\n                  <span className=\"text-muted-foreground\">تقييمات حقيقية من مستخدمين متخصصين</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <CheckCircle2 className=\"h-4 w-4 text-primary\" />\n                  <span className=\"text-muted-foreground\">دعم فوري، متواصل على مدار الساعة</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <CheckCircle2 className=\"h-4 w-4 text-primary\" />\n                  <span className=\"text-muted-foreground\">سرعة في إنجاز المهام</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Right Side - Review Services Card - Horizontal 3D Layout */}\n            <div className=\"relative w-full\" style={{ perspective: '1200px' }}>\n              <div className=\"absolute -top-6 -right-6 w-24 h-24 bg-primary/20 rounded-full blur-3xl\"></div>\n              <div className=\"absolute -bottom-6 -left-6 w-32 h-32 bg-primary/20 rounded-full blur-3xl\"></div>\n              \n              <motion.div\n                initial={{ opacity: 0, y: 20, rotateX: -15 }}\n                animate={{ \n                  opacity: 1, \n                  y: [0, -10, 0],\n                  rotateX: 0\n                }}\n                transition={{ \n                  opacity: { duration: 0.5 },\n                  rotateX: { duration: 0.5 },\n                  y: { \n                    duration: 3,\n                    repeat: Infinity,\n                    repeatType: \"reverse\",\n                    ease: \"easeInOut\"\n                  }\n                }}\n                whileHover={{\n                  rotateY: 5,\n                  rotateX: 5,\n                  scale: 1.02,\n                  transition: { duration: 0.3 }\n                }}\n                style={{\n                  transformStyle: 'preserve-3d',\n                }}\n              >\n                <Card className=\"rounded-3xl shadow-2xl border-2 relative overflow-visible hover-elevate backdrop-blur-sm bg-card/95 w-full max-w-5xl\" data-testid=\"card-review-services\" style={{ transform: 'translateZ(50px)' }}>\n                  {/* Decorative gradient overlay */}\n                  <div className=\"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-primary/20 to-transparent rounded-full -translate-y-12 translate-x-12\"></div>\n                  \n                  <CardContent className=\"p-6 lg:p-8\">\n                    <div className=\"flex items-center justify-between mb-6\">\n                      <h3 className=\"text-xl lg:text-2xl font-bold bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">خدماتنا المميزة</h3>\n                      <Badge className=\"text-primary rounded-xl px-3 shadow-sm\" variant=\"outline\">\n                        <Sparkles className=\"h-3 w-3 ml-1\" />\n                        احترافي\n                      </Badge>\n                    </div>\n\n                    {/* Horizontal Grid Layout - Updated to 2x2 */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 lg:gap-6\">\n                      {reviewServices.map((service, index) => (\n                        <motion.div\n                          key={index}\n                          initial={{ opacity: 0, y: 20 }}\n                          animate={{ opacity: 1, y: 0 }}\n                          transition={{ duration: 0.5, delay: index * 0.1 }}\n                          whileHover={{ y: -5, scale: 1.02 }}\n                          className=\"rounded-2xl p-5 hover-elevate active-elevate-2 transition-all group border border-border/50 shadow-sm text-center\"\n                          data-testid={`service-${index}`}\n                        >\n                          <motion.div\n                            animate={{ \n                              rotate: [0, 5, -5, 0],\n                              scale: [1, 1.05, 1]\n                            }}\n                            transition={{ \n                              duration: 2.5,\n                              repeat: Infinity,\n                              repeatDelay: 3\n                            }}\n                            className=\"mb-4\"\n                          >\n                            <ServiceIcon \n                              icon={service.icon} \n                              bgColor={service.bgColor}\n                              iconColor={service.iconColor}\n                              glowColor={service.glowColor}\n                            />\n                          </motion.div>\n                          \n                          <h4 className=\"text-sm font-bold text-foreground mb-1\">{service.title}</h4>\n                          <p className=\"text-xs text-muted-foreground font-medium mb-3\">{service.subtitle}</p>\n                          \n                          <div className=\"flex items-center justify-center gap-2\">\n                            <div className={`text-2xl font-bold bg-gradient-to-r ${service.gradient} bg-clip-text text-transparent`}>\n                              {service.value}\n                            </div>\n                            <motion.div\n                              whileHover={{ scale: 1.2, rotate: 15 }}\n                              className={`p-1.5 rounded-full ${service.bgColor}`}\n                            >\n                              <Star className={`h-3 w-3 ${service.iconColor} fill-current`} />\n                            </motion.div>\n                          </div>\n                          <span className=\"text-xs text-muted-foreground block mt-1\">{service.label}</span>\n                        </motion.div>\n                      ))}\n                    </div>\n\n                    {/* Bottom CTA */}\n                    <motion.div\n                      whileHover={{ scale: 1.02 }}\n                      className=\"rounded-2xl p-5 mt-6\"\n                    >\n                      <div className=\"flex items-center justify-between flex-wrap gap-3\">\n                        <div>\n                          <p className=\"text-sm font-bold text-foreground mb-1\">جاهز للبدء؟</p>\n                          <p className=\"text-xs text-muted-foreground\">انضم لأكثر من 500+ عميل راضٍ</p>\n                        </div>\n                        <Link href=\"/role-selection\">\n                          <Button size=\"sm\" className=\"rounded-xl shadow-md hover-elevate\">\n                            <UserPlus className=\"h-4 w-4 ml-2\" />\n                            ابدأ الآن\n                          </Button>\n                        </Link>\n                      </div>\n                    </motion.div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Trust & Reviews Section */}\n      <section className=\"py-16 bg-background\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <FadeInSection>\n            <div className=\"text-center mb-12\">\n              <p className=\"text-sm text-muted-foreground mb-8\">\n                Loved by the best companies across the world\n              </p>\n              \n              {/* Reviews Grid */}\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12 mb-12\">\n                {/* Google Review */}\n                <motion.div\n                  whileHover={{ scale: 1.05 }}\n                  className=\"flex flex-col items-center gap-2\"\n                >\n                  <SiGoogle className=\"h-12 w-12 text-[#4285f4]\" />\n                  <div className=\"flex items-center gap-2 mt-2\">\n                    <span className=\"text-3xl font-bold text-foreground\">4.9</span>\n                    <div className=\"flex gap-0.5\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star key={i} className=\"h-4 w-4 text-[#fbbc04] fill-[#fbbc04]\" />\n                      ))}\n                    </div>\n                  </div>\n                </motion.div>\n\n                {/* Trustpilot Review */}\n                <motion.div\n                  whileHover={{ scale: 1.05 }}\n                  className=\"flex flex-col items-center gap-2\"\n                >\n                  <SiTrustpilot className=\"h-12 w-12 text-[#00b67a]\" />\n                  <div className=\"flex flex-col items-center gap-1 mt-2\">\n                    <div className=\"flex gap-0.5\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star key={i} className=\"h-4 w-4 text-[#00b67a] fill-[#00b67a]\" />\n                      ))}\n                    </div>\n                    <span className=\"text-sm font-medium text-foreground mt-1\">TrustScore 4.6</span>\n                    <span className=\"text-xs text-muted-foreground\">825 reviews</span>\n                  </div>\n                </motion.div>\n\n                {/* G2 Review */}\n                <motion.div\n                  whileHover={{ scale: 1.05 }}\n                  className=\"flex flex-col items-center gap-2\"\n                >\n                  <div className=\"w-12 h-12 rounded-full bg-[#ff492c] flex items-center justify-center\">\n                    <span className=\"text-white font-bold text-2xl\">G2</span>\n                  </div>\n                  <div className=\"flex items-center gap-2 mt-2\">\n                    <span className=\"text-3xl font-bold text-foreground\">4.9</span>\n                    <div className=\"flex gap-0.5\">\n                      {[...Array(5)].map((_, i) => (\n                        <Star key={i} className=\"h-4 w-4 text-[#fbbc04] fill-[#fbbc04]\" />\n                      ))}\n                    </div>\n                  </div>\n                </motion.div>\n              </div>\n\n              {/* Trusted Companies Logos - Animated Marquee */}\n              <div className=\"relative overflow-hidden mt-12\">\n                <div className=\"flex animate-marquee whitespace-nowrap\">\n                  <div className=\"flex items-center gap-12 mx-6\">\n                    <span className=\"text-base font-medium text-muted-foreground/50\">iHeartMEDIA</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-5 h-5 bg-[#ff6719] rounded flex items-center justify-center\">\n                        <span className=\"text-white font-bold text-xs\">Y</span>\n                      </div>\n                      <span className=\"text-base font-medium text-muted-foreground/50\">Combinator</span>\n                    </div>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">PSG</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50 tracking-wider\">AIRBUS</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">supabase</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">zapier</span>\n                  </div>\n                  <div className=\"flex items-center gap-12 mx-6\">\n                    <span className=\"text-base font-medium text-muted-foreground/50\">iHeartMEDIA</span>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-5 h-5 bg-[#ff6719] rounded flex items-center justify-center\">\n                        <span className=\"text-white font-bold text-xs\">Y</span>\n                      </div>\n                      <span className=\"text-base font-medium text-muted-foreground/50\">Combinator</span>\n                    </div>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">PSG</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50 tracking-wider\">AIRBUS</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">supabase</span>\n                    <span className=\"text-base font-medium text-muted-foreground/50\">zapier</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </FadeInSection>\n        </div>\n      </section>\n\n      {/* About Platform - SEO Content */}\n      <section id=\"about\" className=\"py-20 bg-background\">\n        <div className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <FadeInSection>\n            <div className=\"text-center mb-12\">\n              <Badge className=\"mb-4 text-primary rounded-xl px-4 py-1\" variant=\"outline\">\n                <Sparkles className=\"h-3 w-3 ml-1\" />\n                عن المنصة\n              </Badge>\n              <h2 className=\"text-3xl sm:text-4xl font-bold mb-6\" data-testid=\"text-about-title\">\n                منصة سُمُوّ - الحل الأمثل لاختبار وتطوير المنتجات الرقمية\n              </h2>\n            </div>\n          </FadeInSection>\n\n          <div className=\"prose prose-lg max-w-none text-right space-y-6\">\n            <FadeInSection delay={0.1}>\n              <p className=\"text-lg text-foreground leading-relaxed\">\n                <strong>منصة سُمُوّ</strong> هي المنصة الرائدة في المنطقة العربية التي تربط بين أصحاب المنتجات الرقمية والمستقلين المحترفين المتخصصين في اختبار التطبيقات، المواقع الإلكترونية، وتحسين تجربة المستخدم. نوفر لك حلولاً متكاملة لضمان جودة منتجك الرقمي وزيادة انتشاره على جميع المنصات.\n              </p>\n            </FadeInSection>\n\n            <FadeInSection delay={0.2}>\n              <h3 className=\"text-2xl font-bold text-foreground mt-8 mb-4\">ما الذي تقدمه منصة سُمُوّ؟</h3>\n              <p className=\"text-foreground leading-relaxed\">\n                نحن نقدم <strong>خدمات شاملة ومتنوعة</strong> تساعدك على تحسين منتجك الرقمي وزيادة انتشاره. من خلال شبكة واسعة من المستقلين المحترفين في جميع أنحاء الوطن العربي، نضمن لك الحصول على <strong>تقييمات حقيقية</strong> و<strong>اختبارات دقيقة</strong> و<strong>تفاعل فعّال</strong> على منصات التواصل الاجتماعي.\n              </p>\n            </FadeInSection>\n\n            <FadeInSection delay={0.3}>\n              <h3 className=\"text-2xl font-bold text-foreground mt-8 mb-4\">خدماتنا المتخصصة</h3>\n            </FadeInSection>\n            \n            <div className=\"space-y-4 text-foreground\">\n              <FadeInSection delay={0.1}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  {/* Animated background particles */}\n                  <AnimatedParticle delay={0} x=\"10%\" y=\"20%\" />\n                  <AnimatedParticle delay={0.5} x=\"80%\" y=\"60%\" />\n                  <AnimatedParticle delay={1} x=\"50%\" y=\"40%\" />\n                  \n                  {/* Floating decorative icons */}\n                  <motion.div className=\"absolute top-4 left-4 opacity-20\">\n                    <FloatingIcon icon={Sparkles} color=\"text-primary\" delay={0} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.1 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                  >\n                    <ServiceIcon \n                      icon={Star}\n                      bgColor=\"bg-primary/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(76, 175, 80, 0.15)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      تحسين تقييمات تطبيقات Google Play و App Store\n                      <motion.div\n                        animate={{ scale: [1, 1.2, 1] }}\n                        transition={{ duration: 1.5, repeat: Infinity }}\n                      >\n                        <Zap className=\"h-5 w-5 text-primary\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      نوفر <strong>تقييمات حقيقية واحترافية</strong> لتطبيقاتك على متجري Google Play و App Store من قبل مستخدمين فعليين. نساعدك على تحسين تصنيف تطبيقك وزيادة ثقة المستخدمين الجدد، مما يؤدي إلى زيادة التحميلات وتحسين ظهور تطبيقك في نتائج البحث.\n                    </p>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n\n              <FadeInSection delay={0.15}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  {/* Animated background particles */}\n                  <AnimatedParticle delay={0.2} x=\"15%\" y=\"30%\" />\n                  <AnimatedParticle delay={0.7} x=\"75%\" y=\"50%\" />\n                  <AnimatedParticle delay={1.2} x=\"45%\" y=\"70%\" />\n                  \n                  {/* Floating star ratings */}\n                  <motion.div className=\"absolute top-6 left-6 opacity-20\">\n                    <FloatingIcon icon={MapPin} color=\"text-primary\" delay={0.3} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.1 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                  >\n                    <ServiceIcon \n                      icon={MapPin}\n                      bgColor=\"bg-primary/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(76, 175, 80, 0.15)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      تقييمات حقيقية على خرائط Google Maps\n                      <motion.div\n                        animate={{ scale: [1, 1.2, 1] }}\n                        transition={{ duration: 1.5, repeat: Infinity }}\n                      >\n                        <MapPin className=\"h-5 w-5 text-primary\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      احصل على <strong>تقييمات حقيقية وموثوقة</strong> على Google Maps من مستخدمين فعليين قاموا بتجربة خدماتك. نساعدك على <strong>تحسين ترتيبك</strong> في نتائج البحث المحلية وزيادة ثقة العملاء الجدد، مما يؤدي إلى زيادة المبيعات والانتشار.\n                    </p>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n\n              <FadeInSection delay={0.2}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  {/* Featured badge with animation */}\n                  <motion.div \n                    className=\"absolute top-3 left-3 z-20\"\n                    animate={{\n                      y: [0, -5, 0],\n                    }}\n                    transition={{\n                      duration: 2,\n                      repeat: Infinity,\n                      ease: \"easeInOut\"\n                    }}\n                  >\n                    <Badge className=\"text-primary rounded-lg px-3 py-1 shadow-lg\" variant=\"outline\">\n                      <motion.span\n                        animate={{ rotate: [0, 20, -20, 0] }}\n                        transition={{ duration: 2, repeat: Infinity }}\n                        className=\"inline-block\"\n                      >\n                        <Sparkles className=\"h-3 w-3 ml-1\" />\n                      </motion.span>\n                      مميزة\n                    </Badge>\n                  </motion.div>\n                  \n                  {/* Animated background particles - more for featured */}\n                  <AnimatedParticle delay={0} x=\"20%\" y=\"25%\" />\n                  <AnimatedParticle delay={0.3} x=\"70%\" y=\"45%\" />\n                  <AnimatedParticle delay={0.6} x=\"40%\" y=\"65%\" />\n                  <AnimatedParticle delay={0.9} x=\"85%\" y=\"30%\" />\n                  \n                  {/* Floating social icons */}\n                  <motion.div className=\"absolute top-8 right-8 opacity-15\">\n                    <FloatingIcon icon={Users} color=\"text-primary\" delay={0.5} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.15 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                    animate={{\n                      y: [0, -8, 0]\n                    }}\n                  >\n                    <ServiceIcon \n                      icon={Share2}\n                      bgColor=\"bg-primary/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(139, 92, 246, 0.25)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10 pt-8\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      زيادة التفاعل على منشورات وصفحات السوشيال ميديا\n                      <motion.div\n                        animate={{ \n                          scale: [1, 1.2, 1]\n                        }}\n                        transition={{ duration: 2, repeat: Infinity }}\n                      >\n                        <Sparkles className=\"h-5 w-5 text-primary\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      <strong>خدمة حصرية</strong> تساعدك على <strong>زيادة التفاعل والانتشار</strong> لمحتواك على منصات التواصل الاجتماعي مثل Facebook، Instagram، Twitter، وLinkedIn. يقوم مستقلون حقيقيون بالتفاعل مع منشوراتك من خلال الإعجابات، التعليقات الحقيقية، والمشاركات، مما يعزز من <strong>ظهور المحتوى</strong> في خوارزميات السوشيال ميديا ويزيد من الوصول إلى جمهور أوسع. هذه الخدمة مثالية لـ:\n                    </p>\n                    <ul className=\"list-disc list-inside mr-6 space-y-2 mt-3 text-sm\">\n                      <li>أصحاب الأعمال الذين يرغبون في زيادة الوعي بعلامتهم التجارية</li>\n                      <li>المؤثرين والمبدعين الذين يسعون لزيادة التفاعل مع محتواهم</li>\n                      <li>الشركات الناشئة التي تحتاج إلى بناء حضور قوي على السوشيال ميديا</li>\n                      <li>الحملات التسويقية التي تستهدف الوصول لجمهور أكبر</li>\n                    </ul>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n\n              <FadeInSection delay={0.25}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <AnimatedParticle delay={0.4} x=\"25%\" y=\"35%\" />\n                  <AnimatedParticle delay={0.9} x=\"65%\" y=\"55%\" />\n                  <AnimatedParticle delay={1.4} x=\"55%\" y=\"75%\" />\n                  \n                  <motion.div className=\"absolute top-6 right-6 opacity-15\">\n                    <FloatingIcon icon={Target} color=\"text-primary\" delay={0.6} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.1 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                  >\n                    <ServiceIcon \n                      icon={Palette}\n                      bgColor=\"bg-primary/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(76, 175, 80, 0.15)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      اختبار شامل لتجربة المستخدم UX/UI\n                      <motion.div\n                        animate={{ y: [0, -3, 0] }}\n                        transition={{ duration: 1.8, repeat: Infinity }}\n                      >\n                        <Palette className=\"h-5 w-5 text-primary\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      احصل على <strong>تحليل احترافي</strong> لتجربة المستخدم وواجهة التطبيق أو الموقع الخاص بك. نقدم توصيات عملية لتحسين التصميم، سهولة الاستخدام، وزيادة معدلات التحويل، مما يساعدك على <strong>تقليل معدل الارتداد</strong> وزيادة رضا المستخدمين.\n                    </p>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n\n              <FadeInSection delay={0.3}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <AnimatedParticle delay={0.6} x=\"30%\" y=\"40%\" />\n                  <AnimatedParticle delay={1.1} x=\"60%\" y=\"60%\" />\n                  <AnimatedParticle delay={1.6} x=\"50%\" y=\"80%\" />\n                  \n                  <motion.div className=\"absolute bottom-8 left-8 opacity-15\">\n                    <FloatingIcon icon={Zap} color=\"text-primary\" delay={0.8} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.1 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                  >\n                    <ServiceIcon \n                      icon={Globe}\n                      bgColor=\"bg-green-100/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(34, 197, 94, 0.15)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      اختبار المواقع الإلكترونية\n                      <motion.div\n                        animate={{ rotate: [0, 360] }}\n                        transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n                      >\n                        <Globe className=\"h-5 w-5 text-primary\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      فحص شامل لموقعك الإلكتروني يشمل اختبار الأداء، التوافق مع المتصفحات، الاستجابة على الأجهزة المختلفة، وأمان الموقع. نضمن لك موقع <strong>سريع، آمن، ومتوافق</strong> مع جميع الأجهزة.\n                    </p>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n\n              <FadeInSection delay={0.35}>\n                <motion.div \n                  className=\"relative flex items-start gap-4 p-6 rounded-2xl overflow-hidden group\"\n                  whileHover={{ scale: 1.02, x: 5 }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <AnimatedParticle delay={0.8} x=\"35%\" y=\"45%\" />\n                  <AnimatedParticle delay={1.3} x=\"70%\" y=\"65%\" />\n                  <AnimatedParticle delay={1.8} x=\"45%\" y=\"85%\" />\n                  \n                  <motion.div className=\"absolute top-8 left-8 opacity-15\">\n                    <FloatingIcon icon={Award} color=\"text-primary\" delay={1} />\n                  </motion.div>\n                  \n                  <motion.div \n                    whileHover={{ scale: 1.1 }}\n                    transition={{ duration: 0.5 }}\n                    className=\"flex-shrink-0 relative z-10\"\n                  >\n                    <ServiceIcon \n                      icon={Star}\n                      bgColor=\"bg-primary/80\"\n                      iconColor=\"text-primary\"\n                      glowColor=\"rgba(76, 175, 80, 0.15)\"\n                    />\n                  </motion.div>\n                  <div className=\"flex-1 relative z-10\">\n                    <h4 className=\"text-xl font-bold text-primary mb-2 flex items-center gap-2\">\n                      تقييمات المستخدمين الحقيقية\n                      <motion.div\n                        animate={{ scale: [1, 1.3, 1] }}\n                        transition={{ duration: 2.5, repeat: Infinity }}\n                      >\n                        <Star className=\"h-5 w-5 text-primary fill-current\" />\n                      </motion.div>\n                    </h4>\n                    <p className=\"leading-relaxed text-foreground\">\n                      احصل على <strong>آراء وتقييمات صادقة</strong> من مستخدمين فعليين على متاجر التطبيقات (App Store & Google Play). نساعدك على بناء <strong>سمعة قوية</strong> وزيادة التحميلات من خلال تقييمات إيجابية موثوقة.\n                    </p>\n                  </div>\n                </motion.div>\n              </FadeInSection>\n            </div>\n\n            <FadeInSection delay={0.4}>\n              <h3 className=\"text-2xl font-bold text-foreground mt-12 mb-6\">لماذا تختار منصة سُمُوّ؟</h3>\n            </FadeInSection>\n            \n            <div className=\"grid md:grid-cols-2 gap-4 text-foreground\">\n              <FadeInSection delay={0.1}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">شبكة واسعة من المستقلين المحترفين</strong> في جميع أنحاء الوطن العربي\n                  </div>\n                </div>\n              </FadeInSection>\n              <FadeInSection delay={0.15}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">نظام أمان متقدم</strong> لحماية بياناتك ومعاملاتك المالية\n                  </div>\n                </div>\n              </FadeInSection>\n              <FadeInSection delay={0.2}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">سرعة في الإنجاز</strong> واحصل على النتائج في وقت قياسي\n                  </div>\n                </div>\n              </FadeInSection>\n              <FadeInSection delay={0.25}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">دقة عالية</strong> في التقييمات والاختبارات من مختصين محترفين\n                  </div>\n                </div>\n              </FadeInSection>\n              <FadeInSection delay={0.3}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">ضمان الجودة</strong> مع إمكانية إعادة الاختبار\n                  </div>\n                </div>\n              </FadeInSection>\n              <FadeInSection delay={0.35}>\n                <div className=\"flex items-start gap-3 p-3 rounded-lg hover:bg-primary/5 transition-colors\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary mt-1 flex-shrink-0\" />\n                  <div>\n                    <strong className=\"text-foreground\">دعم فني على مدار الساعة</strong> لمساعدتك في أي وقت\n                  </div>\n                </div>\n              </FadeInSection>\n            </div>\n\n            <FadeInSection delay={0.5}>\n              <div className=\"rounded-2xl p-8 mt-12\">\n                <h3 className=\"text-2xl font-bold text-foreground mb-6 flex items-center gap-2\">\n                  <Zap className=\"h-6 w-6 text-primary\" />\n                  كيف تعمل المنصة؟\n                </h3>\n                <div className=\"grid md:grid-cols-2 gap-6\">\n                  <div className=\"flex items-start gap-4\">\n                    <div className=\"w-10 h-10 bg-primary rounded-xl flex items-center justify-center flex-shrink-0 text-white font-bold\">1</div>\n                    <div>\n                      <strong className=\"text-foreground block mb-1\">أصحاب المنتجات:</strong>\n                      <p className=\"text-sm text-muted-foreground\">قم بإنشاء حساب وأضف حملتك الخاصة بتفاصيل المنتج والخدمات المطلوبة</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-4\">\n                    <div className=\"w-10 h-10 bg-primary rounded-xl flex items-center justify-center flex-shrink-0 text-white font-bold\">2</div>\n                    <div>\n                      <strong className=\"text-foreground block mb-1\">المستقلون:</strong>\n                      <p className=\"text-sm text-muted-foreground\">تصفح الحملات المتاحة واختر المهام التي تناسب خبراتك</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-4\">\n                    <div className=\"w-10 h-10 bg-primary rounded-xl flex items-center justify-center flex-shrink-0 text-white font-bold\">3</div>\n                    <div>\n                      <strong className=\"text-foreground block mb-1\">الإنجاز:</strong>\n                      <p className=\"text-sm text-muted-foreground\">يقوم المستقلون بتنفيذ المهام وتقديم التقارير التفصيلية</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-4\">\n                    <div className=\"w-10 h-10 bg-primary rounded-xl flex items-center justify-center flex-shrink-0 text-white font-bold\">4</div>\n                    <div>\n                      <strong className=\"text-foreground block mb-1\">المراجعة والدفع:</strong>\n                      <p className=\"text-sm text-muted-foreground\">يتم مراجعة العمل والموافقة عليه، ثم يتم الدفع بشكل آمن</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </FadeInSection>\n\n            <FadeInSection delay={0.6}>\n              <p className=\"text-lg text-foreground leading-relaxed mt-12 text-center p-6 rounded-2xl\">\n                انضم اليوم إلى <strong>مئات العملاء الراضين</strong> الذين يثقون بمنصة سُمُوّ لتطوير منتجاتهم الرقمية. سواء كنت صاحب منتج رقمي تبحث عن اختبارات موثوقة وتقييمات حقيقية، أو مستقل محترف يبحث عن فرص عمل مرنة ومربحة، <strong className=\"text-primary\">منصة سُمُوّ هي خيارك الأمثل</strong>.\n              </p>\n            </FadeInSection>\n          </div>\n        </div>\n      </section>\n\n\n      {/* CTA Section */}\n      <section className=\"py-20 bg-background relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-grid-pattern opacity-5\"></div>\n        <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center space-y-8 relative\">\n          <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full mb-4\">\n            <Sparkles className=\"h-4 w-4 text-primary\" />\n            <span className=\"text-sm font-medium text-primary\">انضم الآن</span>\n          </div>\n          \n          <h2 className=\"text-3xl sm:text-4xl font-bold\" data-testid=\"text-cta-title\">\n            ابدأ رحلتك مع سُمُوّ اليوم\n          </h2>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            انضم إلى مئات المستقلين وأصحاب المنتجات الذين يثقون بنا لتطوير منتجاتهم الرقمية\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <Link href=\"/role-selection\">\n              <Button size=\"lg\" className=\"rounded-2xl shadow-lg text-base px-8 hover-elevate\" data-testid=\"button-cta\">\n                <UserPlus className=\"ml-2 h-5 w-5\" />\n                ابدأ الآن مجانًا\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":47494},"client/src/pages/FreelancerSignup.tsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { StepIndicator } from \"@/components/StepIndicator\";\nimport { PasswordStrength } from \"@/components/PasswordStrength\";\nimport { FileUpload } from \"@/components/FileUpload\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Briefcase, Users as UsersIcon, Puzzle, Edit3, Camera, CreditCard, ArrowRight, ArrowLeft, Upload } from \"lucide-react\";\nimport { serviceOptions, paymentMethods, paymentMethodDetails } from \"@shared/schema\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst steps = [\n  { id: 1, title: \"المعلومات الأساسية\" },\n  { id: 2, title: \"المهارات والخدمات\" },\n  { id: 3, title: \"التوثيق\" },\n  { id: 4, title: \"إعدادات الدفع\" },\n];\n\n// Form schemas for each step\nconst step1Schema = z.object({\n  fullName: z.string().min(3, \"الاسم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  username: z.string().min(3, \"اسم المستخدم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  phone: z.string().min(9, \"رقم الهاتف غير صحيح\"),\n  countryCode: z.string(),\n  password: z.string().min(8, \"كلمة المرور يجب أن تحتوي على 8 أحرف على الأقل\"),\n});\n\nconst step2Schema = z.object({\n  bio: z.string().min(20, \"الوصف يجب أن يحتوي على 20 حرفًا على الأقل\"),\n  jobTitle: z.string().min(3, \"المسمى المهني مطلوب\"),\n  teamSize: z.string(),\n  services: z.array(z.string()).min(1, \"اختر خدمة واحدة على الأقل\"),\n  aboutMe: z.string().min(50, \"الوصف التفصيلي يجب أن يحتوي على 50 حرفًا على الأقل\"),\n});\n\nconst step3Schema = z.object({\n  profileImage: z.string().optional(),\n  idVerification: z.string().optional(),\n});\n\nconst step4Schema = z.object({\n  paymentMethod: z.string().min(1, \"اختر وسيلة الدفع\"),\n  accountNumber: z.string().optional(),\n});\n\ntype FormData = z.infer<typeof step1Schema> & \n  z.infer<typeof step2Schema> & \n  z.infer<typeof step3Schema> & \n  z.infer<typeof step4Schema>;\n\nexport default function FreelancerSignup() {\n  const [currentStep, setCurrentStep] = useState(1);\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<Partial<FormData>>({\n    countryCode: \"+966\",\n    teamSize: \"1\",\n    services: [],\n  });\n\n  const createFreelancerMutation = useMutation({\n    mutationFn: async (data: Partial<FormData>) => {\n      const response = await fetch(\"/api/freelancers\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          ...data,\n          teamSize: parseInt(data.teamSize || \"1\", 10),\n        }),\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"فشل إنشاء الحساب\");\n      }\n      \n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      // Store token and user data in localStorage\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", \"freelancer\");\n      \n      // Dispatch custom event to update Navbar\n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم إنشاء الحساب بنجاح!\",\n        description: \"مرحبًا بك في منصة سُمُوّ. يرجى قراءة التعليمات الهامة قبل البدء\",\n      });\n      // Redirect to instructions page first\n      navigate(\"/freelancer-instructions\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"حدث خطأ\",\n        description: error.message || \"فشل في إنشاء الحساب. حاول مرة أخرى.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getSchemaForStep = (step: number) => {\n    switch (step) {\n      case 1: return step1Schema;\n      case 2: return step2Schema;\n      case 3: return step3Schema;\n      case 4: return step4Schema;\n      default: return step1Schema;\n    }\n  };\n\n  // Memoize default values to prevent re-initialization\n  const defaultFormValues = useMemo(() => ({\n    fullName: formData.fullName || \"\",\n    username: formData.username || \"\",\n    email: formData.email || \"\",\n    phone: formData.phone || \"\",\n    countryCode: formData.countryCode || \"+966\",\n    password: formData.password || \"\",\n    bio: formData.bio || \"\",\n    jobTitle: formData.jobTitle || \"\",\n    teamSize: formData.teamSize || \"1\",\n    services: formData.services || [],\n    aboutMe: formData.aboutMe || \"\",\n    profileImage: formData.profileImage || \"\",\n    idVerification: formData.idVerification || \"\",\n    paymentMethod: formData.paymentMethod || \"\",\n    accountNumber: formData.accountNumber || \"\",\n  }), [currentStep, formData]);\n\n  const form = useForm<FormData>({\n    resolver: zodResolver(getSchemaForStep(currentStep)),\n    values: defaultFormValues as any,\n    mode: \"onChange\",\n  });\n\n  const handleNext = async () => {\n    const isValid = await form.trigger();\n    if (isValid) {\n      const currentValues = form.getValues();\n      const updatedFormData = { ...formData, ...currentValues };\n      setFormData(updatedFormData);\n      \n      if (currentStep < 4) {\n        setCurrentStep(currentStep + 1);\n        form.clearErrors();\n      } else {\n        // Submit form to backend\n        createFreelancerMutation.mutate(updatedFormData);\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      const currentValues = form.getValues();\n      setFormData({ ...formData, ...currentValues });\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  // Watch payment method value outside of JSX to avoid hook call issues\n  const selectedPaymentMethod = form.watch(\"paymentMethod\");\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 py-8 px-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          <StepIndicator steps={steps} currentStep={currentStep} />\n\n          <Card className=\"rounded-2xl shadow-lg\">\n            <CardHeader className=\"border-b\">\n              <CardTitle className=\"text-2xl text-center\">\n                {steps[currentStep - 1].title}\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\"p-6 md:p-8\">\n              <Form {...form}>\n                <form className=\"space-y-6\">\n                  {/* Step 1: Basic Information */}\n                  {currentStep === 1 && (\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"fullName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>الاسم الكامل *</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"أحمد محمد\" className=\"rounded-xl\" data-testid=\"input-fullname\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"username\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>اسم المستخدم *</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"ahmed_tester\" className=\"rounded-xl\" data-testid=\"input-username\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>البريد الإلكتروني *</FormLabel>\n                            <FormControl>\n                              <Input {...field} type=\"email\" placeholder=\"ahmed@example.com\" className=\"rounded-xl\" data-testid=\"input-email\" autoComplete=\"email\" name=\"email\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"grid grid-cols-3 gap-3\">\n                        <FormField\n                          control={form.control}\n                          name=\"countryCode\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>كود الدولة</FormLabel>\n                              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                                <FormControl>\n                                  <SelectTrigger className=\"rounded-xl\" data-testid=\"select-country-code\">\n                                    <SelectValue />\n                                  </SelectTrigger>\n                                </FormControl>\n                                <SelectContent>\n                                  <SelectItem value=\"+966\">🇸🇦 السعودية +966</SelectItem>\n                                  <SelectItem value=\"+971\">🇦🇪 الإمارات +971</SelectItem>\n                                  <SelectItem value=\"+965\">🇰🇼 الكويت +965</SelectItem>\n                                  <SelectItem value=\"+973\">🇧🇭 البحرين +973</SelectItem>\n                                  <SelectItem value=\"+974\">🇶🇦 قطر +974</SelectItem>\n                                  <SelectItem value=\"+968\">🇴🇲 عمان +968</SelectItem>\n                                  <SelectItem value=\"+20\">🇪🇬 مصر +20</SelectItem>\n                                  <SelectItem value=\"+962\">🇯🇴 الأردن +962</SelectItem>\n                                  <SelectItem value=\"+961\">🇱🇧 لبنان +961</SelectItem>\n                                  <SelectItem value=\"+963\">🇸🇾 سوريا +963</SelectItem>\n                                  <SelectItem value=\"+964\">🇮🇶 العراق +964</SelectItem>\n                                  <SelectItem value=\"+970\">🇵🇸 فلسطين +970</SelectItem>\n                                  <SelectItem value=\"+212\">🇲🇦 المغرب +212</SelectItem>\n                                  <SelectItem value=\"+213\">🇩🇿 الجزائر +213</SelectItem>\n                                  <SelectItem value=\"+216\">🇹🇳 تونس +216</SelectItem>\n                                  <SelectItem value=\"+218\">🇱🇾 ليبيا +218</SelectItem>\n                                  <SelectItem value=\"+249\">🇸🇩 السودان +249</SelectItem>\n                                  <SelectItem value=\"+967\">🇾🇪 اليمن +967</SelectItem>\n                                  <SelectItem value=\"+222\">🇲🇷 موريتانيا +222</SelectItem>\n                                  <SelectItem value=\"+253\">🇩🇯 جيبوتي +253</SelectItem>\n                                  <SelectItem value=\"+252\">🇸🇴 الصومال +252</SelectItem>\n                                  <SelectItem value=\"+269\">🇰🇲 جزر القمر +269</SelectItem>\n                                </SelectContent>\n                              </Select>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={form.control}\n                          name=\"phone\"\n                          render={({ field }) => (\n                            <FormItem className=\"col-span-2\">\n                              <FormLabel>رقم الهاتف *</FormLabel>\n                              <FormControl>\n                                <Input {...field} placeholder=\"501234567\" className=\"rounded-xl\" data-testid=\"input-phone\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>كلمة المرور *</FormLabel>\n                            <FormControl>\n                              <Input {...field} type=\"password\" placeholder=\"••••••••\" className=\"rounded-xl\" data-testid=\"input-password\" autoComplete=\"new-password\" name=\"password\" />\n                            </FormControl>\n                            <PasswordStrength password={field.value || \"\"} />\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Step 2: Skills & Services */}\n                  {currentStep === 2 && (\n                    <div className=\"space-y-6\">\n                      <FormField\n                        control={form.control}\n                        name=\"bio\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>وصف قصير عن نفسك *</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                {...field} \n                                placeholder=\"مثال: أنا محمد، مختبر تطبيقات وخرائط Google لدي 40 شخصًا قادرين على الاختبار من فريقي...\" \n                                className=\"rounded-xl min-h-[100px]\" \n                                data-testid=\"input-bio\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <Card className=\"rounded-xl bg-muted/30\">\n                        <CardContent className=\"p-6 space-y-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"jobTitle\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Briefcase className=\"h-4 w-4\" />\n                                  المسمى المهني *\n                                </FormLabel>\n                                <FormControl>\n                                  <Input {...field} placeholder=\"مثال: مختبر تطبيقات - مسوّق تقييمات - مدير فريق مراجعين\" className=\"rounded-xl\" data-testid=\"input-job-title\" />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"teamSize\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <UsersIcon className=\"h-4 w-4\" />\n                                  عدد أعضاء الفريق *\n                                </FormLabel>\n                                <FormControl>\n                                  <Input {...field} type=\"number\" min=\"1\" className=\"rounded-xl\" data-testid=\"input-team-size\" />\n                                </FormControl>\n                                <FormDescription className=\"text-xs\">\n                                  أدخل عدد الأشخاص الذين يعملون معك في تنفيذ المهام\n                                </FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"services\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Puzzle className=\"h-4 w-4\" />\n                                  المجالات التي تقدمها *\n                                </FormLabel>\n                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2\">\n                                  {serviceOptions.map((service) => (\n                                    <FormField\n                                      key={service}\n                                      control={form.control}\n                                      name=\"services\"\n                                      render={({ field }) => (\n                                        <FormItem className=\"flex items-start gap-2 p-3 rounded-xl border hover-elevate transition-all\">\n                                          <FormControl>\n                                            <Checkbox\n                                              checked={(field.value || []).includes(service)}\n                                              onCheckedChange={(checked) => {\n                                                const current = field.value || [];\n                                                const updated = checked\n                                                  ? [...current, service]\n                                                  : current.filter((s) => s !== service);\n                                                field.onChange(updated);\n                                              }}\n                                              className=\"mt-0.5\"\n                                              data-testid={`checkbox-service-${service}`}\n                                            />\n                                          </FormControl>\n                                          <FormLabel className=\"text-sm font-normal cursor-pointer\">\n                                            {service}\n                                          </FormLabel>\n                                        </FormItem>\n                                      )}\n                                    />\n                                  ))}\n                                </div>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"aboutMe\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Edit3 className=\"h-4 w-4\" />\n                                  الوصف المهني (نبذة تفصيلية) *\n                                </FormLabel>\n                                <FormControl>\n                                  <Textarea \n                                    {...field} \n                                    placeholder=\"اكتب نبذة عنك توضح كيف تنفذ المهام مع فريقك، وما يميزك عن الآخرين...\" \n                                    className=\"rounded-xl min-h-[150px]\" \n                                    data-testid=\"input-about-me\"\n                                  />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </CardContent>\n                      </Card>\n                    </div>\n                  )}\n\n                  {/* Step 3: Verification */}\n                  {currentStep === 3 && (\n                    <div className=\"space-y-6\">\n                      <Card className=\"rounded-xl bg-muted/30\">\n                        <CardContent className=\"p-6 space-y-6\">\n                          <FormField\n                            control={form.control}\n                            name=\"profileImage\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Camera className=\"h-4 w-4\" />\n                                  صورة الملف الشخصي\n                                </FormLabel>\n                                <FormControl>\n                                  <div className=\"flex items-center gap-4\">\n                                    <FileUpload\n                                      type=\"profile\"\n                                      currentFile={field.value}\n                                      onFileUploaded={(url) => field.onChange(url)}\n                                      accept=\"image/*\"\n                                    />\n                                    <div className=\"flex-1\">\n                                      <p className=\"text-xs text-muted-foreground\">\n                                        اختر صورة واضحة لزيادة الثقة بينك وبين العملاء\n                                      </p>\n                                    </div>\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"idVerification\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>إثبات الهوية (اختياري)</FormLabel>\n                                <FormControl>\n                                  <div>\n                                    <FileUpload\n                                      type=\"verification\"\n                                      currentFile={field.value}\n                                      onFileUploaded={(url) => field.onChange(url)}\n                                      accept=\"image/*,application/pdf\"\n                                    />\n                                    <p className=\"text-xs text-muted-foreground mt-2\">\n                                      PDF أو صورة - سيتم مراجعتها يدويًا من قبل الإدارة\n                                    </p>\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </CardContent>\n                      </Card>\n                    </div>\n                  )}\n\n                  {/* Step 4: Payment Settings */}\n                  {currentStep === 4 && (\n                    <div className=\"space-y-4\">\n                      <Card className=\"rounded-xl bg-accent/10\">\n                        <CardContent className=\"p-6 space-y-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"paymentMethod\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <CreditCard className=\"h-4 w-4\" />\n                                  وسيلة الدفع المفضلة *\n                                </FormLabel>\n                                <Select onValueChange={field.onChange} defaultValue={field.value}>\n                                  <FormControl>\n                                    <SelectTrigger className=\"rounded-xl\" data-testid=\"select-payment-method\">\n                                      <SelectValue placeholder=\"اختر وسيلة الدفع\" />\n                                    </SelectTrigger>\n                                  </FormControl>\n                                  <SelectContent>\n                                    {paymentMethods.map((method) => (\n                                      <SelectItem key={method} value={method}>\n                                        {method}\n                                      </SelectItem>\n                                    ))}\n                                  </SelectContent>\n                                </Select>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          {selectedPaymentMethod && selectedPaymentMethod !== \"محفظة سُمُوّ\" && (\n                            <FormField\n                              control={form.control}\n                              name=\"accountNumber\"\n                              render={({ field }) => {\n                                const methodDetails = paymentMethodDetails[selectedPaymentMethod];\n                                \n                                return (\n                                  <FormItem>\n                                    <FormLabel>{methodDetails?.label || \"رقم الحساب أو المحفظة\"}</FormLabel>\n                                    <FormControl>\n                                      <Input \n                                        {...field} \n                                        type={methodDetails?.inputType || \"text\"}\n                                        placeholder={methodDetails?.placeholder || \"مثال: 1234 5678 9012 3456\"} \n                                        className=\"rounded-xl\" \n                                        data-testid=\"input-account-number\" \n                                      />\n                                    </FormControl>\n                                    <FormDescription className=\"text-xs\">\n                                      {selectedPaymentMethod === \"التحويل البنكي\" && \"أدخل رقم الحساب البنكي الدولي (IBAN)\"}\n                                      {selectedPaymentMethod.includes(\"كاش\") && \"أدخل رقم هاتف المحفظة\"}\n                                    </FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                );\n                              }}\n                            />\n                          )}\n                          \n                          {selectedPaymentMethod === \"محفظة سُمُوّ\" && (\n                            <div className=\"p-4 bg-primary/10 rounded-xl border border-primary/20\">\n                              <p className=\"text-sm text-muted-foreground\">\n                                ℹ️ سيتم إنشاء محفظة سُمُوّ تلقائيًا لك عند إنشاء الحساب. يمكنك استخدامها لاستلام المدفوعات مباشرة في المنصة.\n                              </p>\n                            </div>\n                          )}\n                        </CardContent>\n                      </Card>\n\n                      <div className=\"flex items-start gap-2 p-4 bg-muted/30 rounded-xl\">\n                        <Checkbox id=\"terms\" data-testid=\"checkbox-terms\" />\n                        <label htmlFor=\"terms\" className=\"text-sm leading-relaxed cursor-pointer\">\n                          أوافق على{\" \"}\n                          <a href=\"#terms\" className=\"text-primary hover:underline\">الشروط والأحكام</a>\n                          {\" \"}و{\" \"}\n                          <a href=\"#privacy\" className=\"text-primary hover:underline\">سياسة الخصوصية</a>\n                        </label>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Navigation Buttons */}\n                  <div className=\"flex gap-3 pt-4\">\n                    {currentStep > 1 && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={handleBack}\n                        className=\"flex-1 rounded-2xl\"\n                        data-testid=\"button-back\"\n                      >\n                        <ArrowLeft className=\"ml-2 h-4 w-4\" />\n                        السابق\n                      </Button>\n                    )}\n                    <Button \n                      type=\"button\" \n                      onClick={handleNext}\n                      className=\"flex-1 rounded-2xl\"\n                      data-testid=\"button-next\"\n                      disabled={createFreelancerMutation.isPending}\n                    >\n                      {createFreelancerMutation.isPending ? \"جاري الإنشاء...\" : currentStep === 4 ? \"إنشاء الحساب\" : \"التالي\"}\n                      {currentStep < 4 && !createFreelancerMutation.isPending && <ArrowRight className=\"mr-2 h-4 w-4\" />}\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":31084},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/Home\";\nimport RoleSelection from \"@/pages/RoleSelection\";\nimport FreelancerSignup from \"@/pages/FreelancerSignup\";\nimport ProductOwnerSignup from \"@/pages/ProductOwnerSignup\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport FreelancerDashboard from \"@/pages/FreelancerDashboard\";\nimport ProductOwnerDashboard from \"@/pages/ProductOwnerDashboard\";\nimport Login from \"@/pages/Login\";\nimport Campaigns from \"@/pages/Campaigns\";\nimport Freelancers from \"@/pages/Freelancers\";\nimport Profile from \"@/pages/Profile\";\nimport Groups from \"@/pages/Groups\";\nimport CreateGroup from \"@/pages/CreateGroup\";\nimport GroupDetails from \"@/pages/GroupDetails\";\nimport GroupCommunity from \"@/pages/GroupCommunity\";\nimport ChatWithLeader from \"@/pages/ChatWithLeader\";\nimport Projects from \"@/pages/Projects\";\nimport ProjectDetails from \"@/pages/ProjectDetails\";\nimport CreateProject from \"@/pages/CreateProject\";\nimport MyTasks from \"@/pages/MyTasks\";\nimport PurchaseService from \"@/pages/PurchaseService\";\nimport { FreelancerDashboardLayout } from \"@/components/FreelancerDashboardLayout\";\nimport FreelancerOverview from \"@/pages/freelancer-dashboard/Overview\";\nimport AvailableTasks from \"@/pages/freelancer-dashboard/AvailableTasks\";\nimport MyTasksPage from \"@/pages/freelancer-dashboard/MyTasks\";\nimport WalletPage from \"@/pages/freelancer-dashboard/Wallet\";\nimport WithdrawalsPage from \"@/pages/freelancer-dashboard/Withdrawals\";\nimport OrdersPage from \"@/pages/freelancer-dashboard/Orders\";\nimport SettingsPage from \"@/pages/freelancer-dashboard/Settings\";\nimport FreelancerConversations from \"@/pages/freelancer-dashboard/Conversations\";\nimport FreelancerNotifications from \"@/pages/freelancer-dashboard/Notifications\";\nimport { ProductOwnerDashboardLayout } from \"@/components/ProductOwnerDashboardLayout\";\nimport ProductOwnerOverview from \"@/pages/product-owner-dashboard/Overview\";\nimport ProductOwnerProjects from \"@/pages/product-owner-dashboard/Projects\";\nimport ActiveProjects from \"@/pages/product-owner-dashboard/ActiveProjects\";\nimport CompletedProjects from \"@/pages/product-owner-dashboard/CompletedProjects\";\nimport ProductOwnerOrders from \"@/pages/product-owner-dashboard/Orders\";\nimport PaymentsPage from \"@/pages/product-owner-dashboard/Payments\";\nimport ProductOwnerSettings from \"@/pages/product-owner-dashboard/Settings\";\nimport ProductOwnerConversations from \"@/pages/product-owner-dashboard/Conversations\";\nimport ProductOwnerNotifications from \"@/pages/product-owner-dashboard/Notifications\";\nimport FreelancerInstructions from \"@/pages/FreelancerInstructions\";\nimport ProductOwnerInstructions from \"@/pages/ProductOwnerInstructions\";\nimport Services from \"@/pages/Services\";\nimport TermsConditions from \"@/pages/TermsConditions\";\nimport PrivacyPolicy from \"@/pages/PrivacyPolicy\";\nimport RefundPolicy from \"@/pages/RefundPolicy\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/services\" component={Services} />\n      <Route path=\"/terms-conditions\" component={TermsConditions} />\n      <Route path=\"/privacy-policy\" component={PrivacyPolicy} />\n      <Route path=\"/refund-policy\" component={RefundPolicy} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/role-selection\" component={RoleSelection} />\n      <Route path=\"/freelancer-signup\" component={FreelancerSignup} />\n      <Route path=\"/freelancer-instructions\" component={FreelancerInstructions} />\n      <Route path=\"/product-owner-signup\" component={ProductOwnerSignup} />\n      <Route path=\"/product-owner-instructions\" component={ProductOwnerInstructions} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n      \n      {/* Freelancer Dashboard with Sidebar */}\n      <Route path=\"/freelancer-dashboard\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerOverview />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/tasks/available\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <AvailableTasks />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/tasks/my-tasks\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <MyTasksPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/wallet\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <WalletPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/withdrawals\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <WithdrawalsPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/orders\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <OrdersPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/conversations\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerConversations />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/settings\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <SettingsPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/notifications\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerNotifications />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n\n      {/* Product Owner Dashboard with Sidebar */}\n      <Route path=\"/product-owner-dashboard\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerOverview />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects/active\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ActiveProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects/completed\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <CompletedProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/payments\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <PaymentsPage />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/orders\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerOrders />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/settings\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerSettings />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/notifications\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerNotifications />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/conversations\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerConversations />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/profile\" component={Profile} />\n      <Route path=\"/campaigns\" component={Campaigns} />\n      <Route path=\"/freelancers\" component={Freelancers} />\n      <Route path=\"/groups\" component={Groups} />\n      <Route path=\"/groups/create\" component={CreateGroup} />\n      <Route path=\"/groups/:id/community\" component={GroupCommunity} />\n      <Route path=\"/groups/:id/chat\" component={ChatWithLeader} />\n      <Route path=\"/groups/:id\" component={GroupDetails} />\n      <Route path=\"/purchase/:groupId\" component={PurchaseService} />\n      <Route path=\"/projects\" component={Projects} />\n      <Route path=\"/projects/create\" component={CreateProject} />\n      <Route path=\"/projects/:id\" component={ProjectDetails} />\n      <Route path=\"/my-tasks\" component={MyTasks} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":8968},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/Footer.tsx":{"content":"import { Link } from \"wouter\";\n\nexport function Footer() {\n  return (\n    <footer className=\"bg-muted/30 border-t mt-auto\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          {/* Brand */}\n          <div className=\"space-y-4\">\n            <div className=\"text-2xl font-bold bg-gradient-to-br from-primary to-primary/70 bg-clip-text text-transparent\">\n              سُمُوّ\n            </div>\n            <p className=\"text-sm text-muted-foreground\">\n              منصة تربط المستقلين المحترفين بأصحاب المنتجات الرقمية\n            </p>\n          </div>\n\n          {/* Links */}\n          <div>\n            <h3 className=\"font-semibold mb-4\">الروابط السريعة</h3>\n            <ul className=\"space-y-2 text-sm\">\n              <li>\n                <Link href=\"/\">\n                  <span className=\"text-muted-foreground hover:text-foreground transition-colors cursor-pointer\" data-testid=\"link-footer-home\">\n                    الرئيسية\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/services\">\n                  <span className=\"text-muted-foreground hover:text-foreground transition-colors cursor-pointer\" data-testid=\"link-footer-services\">\n                    الخدمات\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <a href=\"#how-it-works\" className=\"text-muted-foreground hover:text-foreground transition-colors\" data-testid=\"link-footer-how-it-works\">\n                  كيف تعمل\n                </a>\n              </li>\n            </ul>\n          </div>\n\n          {/* Legal */}\n          <div>\n            <h3 className=\"font-semibold mb-4\">قانوني</h3>\n            <ul className=\"space-y-2 text-sm\">\n              <li>\n                <Link href=\"/privacy-policy\">\n                  <span className=\"text-muted-foreground hover:text-foreground transition-colors cursor-pointer\" data-testid=\"link-privacy\">\n                    سياسة الخصوصية\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/terms-conditions\">\n                  <span className=\"text-muted-foreground hover:text-foreground transition-colors cursor-pointer\" data-testid=\"link-terms\">\n                    الشروط والأحكام\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/refund-policy\">\n                  <span className=\"text-muted-foreground hover:text-foreground transition-colors cursor-pointer\" data-testid=\"link-refund\">\n                    سياسة استرداد الأموال\n                  </span>\n                </Link>\n              </li>\n            </ul>\n          </div>\n\n          {/* Support */}\n          <div>\n            <h3 className=\"font-semibold mb-4\">الدعم</h3>\n            <ul className=\"space-y-2 text-sm\">\n              <li>\n                <a href=\"#support\" className=\"text-muted-foreground hover:text-foreground transition-colors\" data-testid=\"link-support\">\n                  مركز المساعدة\n                </a>\n              </li>\n              <li>\n                <a href=\"#contact\" className=\"text-muted-foreground hover:text-foreground transition-colors\" data-testid=\"link-contact\">\n                  تواصل معنا\n                </a>\n              </li>\n            </ul>\n          </div>\n        </div>\n\n        {/* Copyright */}\n        <div className=\"mt-8 pt-8 border-t text-center text-sm text-muted-foreground\">\n          <p>© {new Date().getFullYear()} سُمُوّ. جميع الحقوق محفوظة.</p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","size_bytes":3877},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/pages/FreelancerDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"@/components/ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Task, Wallet, Order, Withdrawal } from \"@shared/schema\";\nimport { \n  Wallet as WalletIcon, \n  FileCheck, \n  TrendingUp, \n  Search, \n  Star, \n  Clock, \n  CheckCircle2,\n  AlertCircle,\n  Send,\n  Play,\n  ShoppingCart,\n  Calendar,\n  Package,\n  CreditCard,\n  Download,\n  Plus\n} from \"lucide-react\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nexport default function FreelancerDashboard() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submissionText, setSubmissionText] = useState(\"\");\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\n  \n  // Withdrawal form state\n  const [showWithdrawalDialog, setShowWithdrawalDialog] = useState(false);\n  const [withdrawalAmount, setWithdrawalAmount] = useState(\"\");\n  const [withdrawalMethod, setWithdrawalMethod] = useState(\"\");\n  const [withdrawalAccount, setWithdrawalAccount] = useState(\"\");\n\n  // Fetch available tasks\n  const { data: availableTasks = [], isLoading: loadingAvailable } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/available\"],\n  });\n\n  // Fetch freelancer's tasks\n  const { data: myTasks = [], isLoading: loadingMyTasks } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  // Fetch wallet\n  const { data: wallet } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  // Fetch orders for groups led by this freelancer\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Fetch withdrawals\n  const { data: withdrawals = [], isLoading: loadingWithdrawals } = useQuery<Withdrawal[]>({\n    queryKey: [\"/api/withdrawals/my\"],\n  });\n\n  // Accept task mutation\n  const acceptTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest(\"POST\", `/api/tasks/${taskId}/accept`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/available\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم قبول المهمة بنجاح\",\n        description: \"يمكنك الآن البدء بالعمل على هذه المهمة\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء قبول المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Start task mutation\n  const startTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest(\"PATCH\", `/api/tasks/${taskId}/start`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم بدء المهمة\",\n        description: \"المهمة الآن قيد التنفيذ\",\n      });\n    },\n  });\n\n  // Submit task mutation\n  const submitTaskMutation = useMutation({\n    mutationFn: async ({ taskId, submission }: { taskId: string; submission: string }) => {\n      return apiRequest(\"PATCH\", `/api/tasks/${taskId}/submit`, { submission });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      setShowSubmitDialog(false);\n      setSubmissionText(\"\");\n      setSelectedTask(null);\n      toast({\n        title: \"تم تسليم المهمة بنجاح\",\n        description: \"سيتم مراجعة عملك من قبل صاحب المنتج\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تسليم المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAcceptTask = (task: Task) => {\n    acceptTaskMutation.mutate(task.id);\n  };\n\n  const handleStartTask = (task: Task) => {\n    startTaskMutation.mutate(task.id);\n  };\n\n  const handleSubmitTask = () => {\n    if (!selectedTask || !submissionText.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى كتابة التقرير\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    submitTaskMutation.mutate({\n      taskId: selectedTask.id,\n      submission: submissionText,\n    });\n  };\n\n  const openSubmitDialog = (task: Task) => {\n    setSelectedTask(task);\n    setSubmissionText(task.submission || \"\");\n    setShowSubmitDialog(true);\n  };\n\n  // Withdrawal mutation\n  const createWithdrawalMutation = useMutation({\n    mutationFn: async (data: { amount: number; paymentMethod: string; accountNumber: string }) => {\n      return apiRequest(\"POST\", \"/api/withdrawals\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/withdrawals/my\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/wallet\"] });\n      setShowWithdrawalDialog(false);\n      setWithdrawalAmount(\"\");\n      setWithdrawalMethod(\"\");\n      setWithdrawalAccount(\"\");\n      toast({\n        title: \"تم إرسال طلب السحب\",\n        description: \"سيتم مراجعة طلبك ومعالجته في أقرب وقت\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء إنشاء طلب السحب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleWithdrawalSubmit = () => {\n    const amount = parseFloat(withdrawalAmount);\n    \n    if (!withdrawalAmount || amount <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال مبلغ صحيح\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalMethod) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار طريقة الدفع\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalAccount.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال رقم الحساب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const walletBalance = parseFloat(wallet?.balance || \"0\");\n    if (amount > walletBalance) {\n      toast({\n        title: \"خطأ\",\n        description: `الرصيد المتاح غير كافٍ. الرصيد الحالي: ${walletBalance} ر.س`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createWithdrawalMutation.mutate({\n      amount: Number(withdrawalAmount),\n      paymentMethod: withdrawalMethod,\n      accountNumber: withdrawalAccount,\n    });\n  };\n\n  // Filter available tasks\n  const filteredAvailableTasks = availableTasks.filter((task) =>\n    task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.serviceType.includes(searchQuery)\n  );\n\n  // Calculate stats\n  const completedTasks = myTasks.filter((t) => t.status === \"approved\").length;\n  const activeTasks = myTasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\").length;\n  const pendingTasks = myTasks.filter((t) => t.status === \"submitted\").length;\n  const totalOrders = orders.length;\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\").length;\n\n  const getStatusBadge = (status: string, taskId: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      available: { label: \"متاحة\", variant: \"outline\" },\n      assigned: { label: \"مقبولة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"تم التسليم\", variant: \"secondary\" },\n      approved: { label: \"موافق عليها\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n    \n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant} data-testid={`badge-status-${taskId}`}>{statusInfo.label}</Badge>;\n  };\n\n  const getOrderStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-order-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          {/* Welcome Section */}\n          <div className=\"mb-8\">\n            <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"text-welcome\">\n              لوحة تحكم المستقل\n            </h1>\n            <p className=\"text-lg text-muted-foreground\">\n              مرحباً بك! ابدأ بتصفح المهام المتاحة واختر ما يناسب مهاراتك\n            </p>\n          </div>\n\n          {/* Stats */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n            <Card className=\"rounded-2xl shadow-md\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">المهام النشطة</p>\n                    <p className=\"text-2xl font-bold mt-1\" data-testid=\"stat-active-tasks\">{activeTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Clock className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">قيد المراجعة</p>\n                    <p className=\"text-2xl font-bold mt-1\" data-testid=\"stat-pending-tasks\">{pendingTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <AlertCircle className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">المكتملة</p>\n                    <p className=\"text-2xl font-bold mt-1\" data-testid=\"stat-completed-tasks\">{completedTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <CheckCircle2 className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">الأرباح</p>\n                    <p className=\"text-2xl font-bold mt-1\" data-testid=\"stat-earnings\">\n                      {wallet?.balance || \"0\"} ر.س\n                    </p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <WalletIcon className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Tabs for Available Tasks, My Tasks, Orders, and Withdrawals */}\n          <Tabs defaultValue=\"orders\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-2 md:grid-cols-4 gap-2\" data-testid=\"tabs-tasks\">\n              <TabsTrigger value=\"orders\" data-testid=\"tab-orders\">\n                <ShoppingCart className=\"h-4 w-4 ml-2\" />\n                الطلبات ({totalOrders})\n              </TabsTrigger>\n              <TabsTrigger value=\"withdrawals\" data-testid=\"tab-withdrawals\">\n                <Download className=\"h-4 w-4 ml-2\" />\n                السحوبات ({withdrawals.length})\n              </TabsTrigger>\n              <TabsTrigger value=\"available\" data-testid=\"tab-available-tasks\">\n                المهام المتاحة ({filteredAvailableTasks.length})\n              </TabsTrigger>\n              <TabsTrigger value=\"my-tasks\" data-testid=\"tab-my-tasks\">\n                مهامي ({myTasks.length})\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Orders Tab */}\n            <TabsContent value=\"orders\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">الطلبات الواردة من أصحاب المنتجات</h2>\n\n              {orders.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Package className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض الطلبات الواردة من أصحاب المنتجات هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {orders.map((order) => (\n                    <Card key={order.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-order-${order.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{order.serviceType}</h3>\n                              {getOrderStatusBadge(order.status)}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">\n                              الكمية: {order.quantity} • السعر لكل وحدة: ${order.pricePerUnit}\n                            </p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <WalletIcon className=\"h-4 w-4\" />\n                                ${order.totalAmount}\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(order.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"bg-muted/50 rounded-xl p-4\">\n                          <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">طريقة الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                order.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                order.paymentMethod === 'orange_cash' ? 'أورانج كاش' : 'البطاقة البنكية'}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">بيانات الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentDetails}</p>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Withdrawals Tab */}\n            <TabsContent value=\"withdrawals\" className=\"space-y-4\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div>\n                  <h2 className=\"text-xl font-bold\">السحوبات والأرباح</h2>\n                  <p className=\"text-muted-foreground\">إدارة طلبات السحب وتتبع حالتها</p>\n                </div>\n                <Button \n                  onClick={() => setShowWithdrawalDialog(true)}\n                  className=\"rounded-xl\"\n                  data-testid=\"button-new-withdrawal\"\n                >\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  طلب سحب جديد\n                </Button>\n              </div>\n\n              {/* Wallet Balance Card */}\n              <Card className=\"rounded-2xl shadow-md bg-gradient-to-br from-primary/10 to-primary/5\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">الرصيد المتاح</p>\n                      <p className=\"text-3xl font-bold text-primary\" data-testid=\"text-wallet-balance\">\n                        {wallet?.balance || \"0\"} ر.س\n                      </p>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        إجمالي الأرباح: {wallet?.totalEarned || \"0\"} ر.س\n                      </p>\n                    </div>\n                    <div className=\"w-16 h-16 bg-primary/20 rounded-2xl flex items-center justify-center\">\n                      <WalletIcon className=\"h-8 w-8 text-primary\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Withdrawals List */}\n              {loadingWithdrawals ? (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {[1, 2].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-6 bg-muted rounded mb-2 w-1/3\"></div>\n                        <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : withdrawals.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Download className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات سحب</h3>\n                    <p className=\"text-muted-foreground\">يمكنك إنشاء طلب سحب جديد للحصول على أرباحك</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {withdrawals.map((withdrawal) => (\n                    <Card key={withdrawal.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-withdrawal-${withdrawal.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{withdrawal.amount} ر.س</h3>\n                              <Badge \n                                variant={\n                                  withdrawal.status === \"completed\" ? \"default\" : \n                                  withdrawal.status === \"pending\" ? \"outline\" : \n                                  withdrawal.status === \"processing\" ? \"secondary\" : \"destructive\"\n                                }\n                                data-testid={`badge-withdrawal-status-${withdrawal.id}`}\n                              >\n                                {withdrawal.status === \"completed\" ? \"مكتمل\" : \n                                 withdrawal.status === \"pending\" ? \"قيد الانتظار\" : \n                                 withdrawal.status === \"processing\" ? \"قيد المعالجة\" : \"مرفوض\"}\n                              </Badge>\n                            </div>\n                            <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CreditCard className=\"h-4 w-4\" />\n                                {withdrawal.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                 withdrawal.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                 withdrawal.paymentMethod === 'orange_cash' ? 'أورانج كاش' : \n                                 withdrawal.paymentMethod === 'bank_card' ? 'البطاقة البنكية' : withdrawal.paymentMethod}\n                              </span>\n                              <span>{withdrawal.accountNumber}</span>\n                              <span className=\"flex items-center gap-1\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(withdrawal.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                            {withdrawal.notes && (\n                              <p className=\"text-sm text-muted-foreground mt-2 bg-muted/50 rounded-lg p-3\">\n                                <span className=\"font-semibold\">ملاحظات:</span> {withdrawal.notes}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Available Tasks Tab */}\n            <TabsContent value=\"available\" className=\"space-y-4\">\n              {/* Search */}\n              <div className=\"relative\">\n                <Search className=\"absolute right-3 top-3 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"ابحث عن مهام...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pr-9 rounded-xl\"\n                  data-testid=\"input-search-tasks\"\n                />\n              </div>\n\n              {loadingAvailable ? (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {[1, 2, 3].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                        <div className=\"h-3 bg-muted rounded mb-4\"></div>\n                        <div className=\"h-8 bg-muted rounded\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : filteredAvailableTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12\">\n                    <div className=\"text-center space-y-4\">\n                      <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto\">\n                        <FileCheck className=\"h-10 w-10 text-muted-foreground\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"text-no-tasks\">\n                          لا توجد مهام متاحة حالياً\n                        </h3>\n                        <p className=\"text-muted-foreground\">\n                          سنقوم بإشعارك عند توفر مهام جديدة مناسبة لمهاراتك\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {filteredAvailableTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-task-${task.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between gap-2 mb-2\">\n                          <CardTitle className=\"text-lg\" data-testid={`text-task-title-${task.id}`}>\n                            {task.title}\n                          </CardTitle>\n                          {getStatusBadge(task.status, task.id)}\n                        </div>\n                        <Badge variant=\"outline\" className=\"w-fit\" data-testid={`badge-service-${task.id}`}>\n                          {task.serviceType}\n                        </Badge>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        <p className=\"text-sm text-muted-foreground line-clamp-2\" data-testid={`text-task-description-${task.id}`}>\n                          {task.description}\n                        </p>\n                        <div className=\"flex items-center justify-between pt-2\">\n                          <div className=\"flex items-center gap-1\">\n                            <Star className=\"h-4 w-4 text-primary fill-primary\" />\n                            <span className=\"font-bold text-primary\" data-testid={`text-task-reward-${task.id}`}>\n                              {task.reward} ر.س\n                            </span>\n                          </div>\n                          <Button\n                            onClick={() => handleAcceptTask(task)}\n                            disabled={acceptTaskMutation.isPending}\n                            className=\"rounded-xl\"\n                            size=\"sm\"\n                            data-testid={`button-accept-task-${task.id}`}\n                          >\n                            قبول المهمة\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* My Tasks Tab */}\n            <TabsContent value=\"my-tasks\" className=\"space-y-4\">\n              {loadingMyTasks ? (\n                <div className=\"space-y-4\">\n                  {[1, 2].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                        <div className=\"h-3 bg-muted rounded mb-4\"></div>\n                        <div className=\"h-8 bg-muted rounded\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : myTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12\">\n                    <div className=\"text-center space-y-4\">\n                      <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto\">\n                        <FileCheck className=\"h-10 w-10 text-muted-foreground\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"text-no-my-tasks\">\n                          ليس لديك مهام حالياً\n                        </h3>\n                        <p className=\"text-muted-foreground\">\n                          ابدأ بتصفح المهام المتاحة واختر ما يناسبك\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"space-y-4\">\n                  {myTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md\" data-testid={`card-my-task-${task.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between gap-2\">\n                          <div className=\"flex-1\">\n                            <CardTitle className=\"text-lg mb-2\" data-testid={`text-my-task-title-${task.id}`}>\n                              {task.title}\n                            </CardTitle>\n                            <CardDescription data-testid={`text-my-task-description-${task.id}`}>\n                              {task.description}\n                            </CardDescription>\n                          </div>\n                          {getStatusBadge(task.status, task.id)}\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-2\">\n                          <Badge variant=\"outline\" data-testid={`badge-my-task-service-${task.id}`}>\n                            {task.serviceType}\n                          </Badge>\n                          <span className=\"text-sm font-semibold text-primary\" data-testid={`text-my-task-reward-${task.id}`}>\n                            {task.reward} ر.س\n                          </span>\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        {task.submission && (\n                          <div className=\"p-4 bg-muted/50 rounded-xl\">\n                            <p className=\"text-sm font-semibold mb-1\">التقرير المقدم:</p>\n                            <p className=\"text-sm text-muted-foreground\" data-testid={`text-my-task-submission-${task.id}`}>\n                              {task.submission}\n                            </p>\n                          </div>\n                        )}\n                        {task.feedback && (\n                          <div className=\"p-4 bg-primary/5 rounded-xl border border-primary/20\">\n                            <p className=\"text-sm font-semibold mb-1 text-primary\">تعليق صاحب المنتج:</p>\n                            <p className=\"text-sm\" data-testid={`text-my-task-feedback-${task.id}`}>\n                              {task.feedback}\n                            </p>\n                          </div>\n                        )}\n                        <div className=\"flex items-center gap-2\">\n                          {task.status === \"assigned\" && (\n                            <Button\n                              onClick={() => handleStartTask(task)}\n                              disabled={startTaskMutation.isPending}\n                              variant=\"outline\"\n                              className=\"rounded-xl\"\n                              size=\"sm\"\n                              data-testid={`button-start-task-${task.id}`}\n                            >\n                              <Play className=\"h-4 w-4 ml-1\" />\n                              بدء العمل\n                            </Button>\n                          )}\n                          {(task.status === \"assigned\" || task.status === \"in_progress\") && (\n                            <Button\n                              onClick={() => openSubmitDialog(task)}\n                              className=\"rounded-xl\"\n                              size=\"sm\"\n                              data-testid={`button-submit-task-${task.id}`}\n                            >\n                              <Send className=\"h-4 w-4 ml-1\" />\n                              تسليم المهمة\n                            </Button>\n                          )}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n\n      {/* Submit Task Dialog */}\n      <Dialog open={showSubmitDialog} onOpenChange={setShowSubmitDialog}>\n        <DialogContent className=\"rounded-2xl\" data-testid=\"dialog-submit-task\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-submit-dialog-title\">تسليم المهمة</DialogTitle>\n            <DialogDescription data-testid=\"text-submit-dialog-description\">\n              قم بكتابة تقرير مفصل عن عملك في هذه المهمة\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-semibold mb-2 block\">التقرير</label>\n              <Textarea\n                value={submissionText}\n                onChange={(e) => setSubmissionText(e.target.value)}\n                placeholder=\"اكتب تقريرك هنا...\"\n                rows={8}\n                className=\"rounded-xl resize-none\"\n                data-testid=\"textarea-submission\"\n              />\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowSubmitDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-submit\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleSubmitTask}\n              disabled={submitTaskMutation.isPending || !submissionText.trim()}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-submit\"\n            >\n              <Send className=\"h-4 w-4 ml-1\" />\n              تسليم\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* New Withdrawal Dialog */}\n      <Dialog open={showWithdrawalDialog} onOpenChange={setShowWithdrawalDialog}>\n        <DialogContent className=\"rounded-2xl\" data-testid=\"dialog-new-withdrawal\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-withdrawal-dialog-title\">طلب سحب جديد</DialogTitle>\n            <DialogDescription data-testid=\"text-withdrawal-dialog-description\">\n              املأ البيانات المطلوبة لطلب سحب أرباحك\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"amount\">المبلغ (ر.س)</Label>\n              <Input\n                id=\"amount\"\n                type=\"number\"\n                value={withdrawalAmount}\n                onChange={(e) => setWithdrawalAmount(e.target.value)}\n                placeholder=\"أدخل المبلغ\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-amount\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                الرصيد المتاح: {wallet?.balance || \"0\"} ر.س\n              </p>\n            </div>\n\n            <div>\n              <Label htmlFor=\"payment-method\">طريقة الدفع</Label>\n              <Select value={withdrawalMethod} onValueChange={setWithdrawalMethod}>\n                <SelectTrigger className=\"rounded-xl mt-1\" data-testid=\"select-withdrawal-method\">\n                  <SelectValue placeholder=\"اختر طريقة الدفع\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"vodafone_cash\">فودافون كاش</SelectItem>\n                  <SelectItem value=\"etisalat_cash\">اتصالات كاش</SelectItem>\n                  <SelectItem value=\"orange_cash\">أورانج كاش</SelectItem>\n                  <SelectItem value=\"bank_card\">البطاقة البنكية</SelectItem>\n                  <SelectItem value=\"bank_transfer\">تحويل بنكي</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"account-number\">رقم الحساب / المحفظة</Label>\n              <Input\n                id=\"account-number\"\n                value={withdrawalAccount}\n                onChange={(e) => setWithdrawalAccount(e.target.value)}\n                placeholder=\"أدخل رقم الحساب\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-account\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                تأكد من صحة رقم الحساب لتجنب التأخير في التحويل\n              </p>\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowWithdrawalDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-withdrawal\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleWithdrawalSubmit}\n              disabled={createWithdrawalMutation.isPending}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-withdrawal\"\n            >\n              <Download className=\"h-4 w-4 ml-1\" />\n              إرسال الطلب\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":39377},"client/src/pages/ProductOwnerDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  BarChart3, \n  Users, \n  Rocket, \n  Wallet, \n  Plus, \n  Eye,\n  CheckCircle,\n  XCircle,\n  Clock,\n  FileText,\n  TrendingUp,\n  Calendar,\n  ShoppingCart,\n  Package\n} from \"lucide-react\";\nimport type { Campaign, Task, Order } from \"@shared/schema\";\n\ninterface TaskWithCampaign extends Task {\n  campaign?: Campaign;\n}\n\nexport default function ProductOwnerDashboard() {\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<TaskWithCampaign | null>(null);\n  const [feedback, setFeedback] = useState(\"\");\n\n  // Fetch campaigns\n  const { data: campaigns = [], isLoading: campaignsLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  // Fetch tasks for all campaigns\n  const { data: allTasks = [], isLoading: tasksLoading } = useQuery<TaskWithCampaign[]>({\n    queryKey: [\"/api/tasks/owner\"],\n    enabled: campaigns.length > 0,\n  });\n\n  // Fetch orders from direct purchase system\n  const { data: orders = [], isLoading: ordersLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Calculate statistics\n  const stats = {\n    activeCampaigns: campaigns.filter(c => c.status === \"active\").length,\n    totalTasks: allTasks.length,\n    submittedTasks: allTasks.filter(t => t.status === \"submitted\").length,\n    completedTasks: allTasks.filter(t => t.status === \"approved\").length,\n    totalSpent: campaigns.reduce((sum, c) => sum + Number(c.budget), 0),\n    totalOrders: orders.length,\n    pendingOrders: orders.filter(o => o.status === \"pending\").length,\n    completedOrders: orders.filter(o => o.status === \"completed\").length,\n    totalOrdersAmount: orders.reduce((sum, o) => sum + Number(o.totalAmount), 0),\n  };\n\n  // Approve task mutation\n  const approveTaskMutation = useMutation({\n    mutationFn: async ({ taskId, feedback }: { taskId: string; feedback: string }) => {\n      return await apiRequest(\"PATCH\", `/api/tasks/${taskId}/approve`, { feedback });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تمت الموافقة على المهمة\",\n        description: \"تم الموافقة على المهمة وإضافة المكافأة لمحفظة المستقل\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/owner\"] });\n      setSelectedTask(null);\n      setFeedback(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: error.message || \"فشلت الموافقة على المهمة\",\n      });\n    },\n  });\n\n  // Reject task mutation\n  const rejectTaskMutation = useMutation({\n    mutationFn: async ({ taskId, feedback }: { taskId: string; feedback: string }) => {\n      return await apiRequest(\"PATCH\", `/api/tasks/${taskId}/reject`, { feedback });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم رفض المهمة\",\n        description: \"تم رفض المهمة وإعادتها للمستقل\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/owner\"] });\n      setSelectedTask(null);\n      setFeedback(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: error.message || \"فشل رفض المهمة\",\n      });\n    },\n  });\n\n  const handleApprove = () => {\n    if (!selectedTask) return;\n    approveTaskMutation.mutate({ taskId: selectedTask.id, feedback });\n  };\n\n  const handleReject = () => {\n    if (!selectedTask || !feedback.trim()) {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: \"يجب كتابة سبب الرفض\",\n      });\n      return;\n    }\n    rejectTaskMutation.mutate({ taskId: selectedTask.id, feedback });\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      available: { label: \"متاحة\", variant: \"outline\" },\n      assigned: { label: \"معينة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"مُسلّمة\", variant: \"default\" },\n      approved: { label: \"مقبولة\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  const getOrderStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-order-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  if (campaignsLoading || tasksLoading || ordersLoading) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n            <p className=\"mt-4 text-muted-foreground\">جاري التحميل...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          {/* Welcome Section */}\n          <div className=\"mb-8\">\n            <div className=\"flex items-center gap-3 mb-2\">\n              <h1 className=\"text-3xl font-bold\" data-testid=\"text-owner-welcome\">\n                لوحة تحكم صاحب المنتج\n              </h1>\n              <Rocket className=\"h-8 w-8 text-primary\" />\n            </div>\n            <p className=\"text-lg text-muted-foreground\">\n              إدارة حملاتك ومراجعة المهام المُسلّمة\n            </p>\n          </div>\n\n          {/* Statistics Cards */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8\">\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-total-orders\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">إجمالي الطلبات</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.totalOrders}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <ShoppingCart className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-active-campaigns\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">الحملات النشطة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.activeCampaigns}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Rocket className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-submitted-tasks\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">مهام قيد المراجعة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.submittedTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Clock className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-completed-tasks\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">مهام مكتملة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-green-600\">{stats.completedTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-green-500/10 rounded-xl flex items-center justify-center\">\n                    <CheckCircle className=\"h-6 w-6 text-green-600\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-total-spent\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">إجمالي الميزانية</p>\n                    <p className=\"text-2xl font-bold mt-1\">{stats.totalSpent.toFixed(2)} ر.س</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Wallet className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <Tabs defaultValue=\"orders\" className=\"space-y-6\" data-testid=\"tabs-main\">\n            <TabsList className=\"bg-muted/50 p-1 rounded-2xl w-full sm:w-auto\">\n              <TabsTrigger value=\"orders\" className=\"rounded-xl\" data-testid=\"tab-orders\">\n                <ShoppingCart className=\"h-4 w-4 ml-2\" />\n                طلباتي ({stats.totalOrders})\n              </TabsTrigger>\n              <TabsTrigger value=\"submitted\" className=\"rounded-xl\" data-testid=\"tab-submitted\">\n                <Clock className=\"h-4 w-4 ml-2\" />\n                قيد المراجعة ({stats.submittedTasks})\n              </TabsTrigger>\n              <TabsTrigger value=\"campaigns\" className=\"rounded-xl\" data-testid=\"tab-campaigns\">\n                <BarChart3 className=\"h-4 w-4 ml-2\" />\n                جميع الحملات\n              </TabsTrigger>\n              <TabsTrigger value=\"all-tasks\" className=\"rounded-xl\" data-testid=\"tab-all-tasks\">\n                <FileText className=\"h-4 w-4 ml-2\" />\n                جميع المهام\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Orders Tab */}\n            <TabsContent value=\"orders\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">طلباتي من الجروبات</h2>\n\n              {orders.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Package className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات</h3>\n                    <p className=\"text-muted-foreground mb-4\">ابحث عن جروبات المطورين واطلب خدماتهم</p>\n                    <Button className=\"rounded-xl\" data-testid=\"button-browse-groups\">\n                      <Users className=\"h-4 w-4 ml-2\" />\n                      تصفح الجروبات\n                    </Button>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {orders.map((order) => (\n                    <Card key={order.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-order-${order.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{order.serviceType}</h3>\n                              {getOrderStatusBadge(order.status)}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">\n                              الكمية: {order.quantity} • السعر لكل وحدة: ${order.pricePerUnit}\n                            </p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                ${order.totalAmount}\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(order.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"bg-muted/50 rounded-xl p-4\">\n                          <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">طريقة الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                order.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                order.paymentMethod === 'orange_cash' ? 'أورانج كاش' : 'البطاقة البنكية'}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">بيانات الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentDetails}</p>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Submitted Tasks Tab */}\n            <TabsContent value=\"submitted\" className=\"space-y-4\">\n              {allTasks.filter(t => t.status === \"submitted\").length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Clock className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد مهام قيد المراجعة</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض المهام المُسلّمة من المستقلين هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {allTasks.filter(t => t.status === \"submitted\").map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-task-${task.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{task.title}</h3>\n                              {getStatusBadge(task.status)}\n                              <Badge variant=\"outline\" className=\"rounded-lg\">{task.serviceType}</Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{task.description}</p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                {task.reward} ر.س\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                سُلّمت: {task.submittedAt ? new Date(task.submittedAt).toLocaleDateString('ar-SA') : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        {task.submission && (\n                          <div className=\"bg-muted/50 rounded-xl p-4 mb-4\">\n                            <p className=\"text-sm font-semibold mb-2\">تقرير المستقل:</p>\n                            <p className=\"text-sm whitespace-pre-wrap\">{task.submission}</p>\n                          </div>\n                        )}\n\n                        <div className=\"flex gap-2\">\n                          <Dialog>\n                            <DialogTrigger asChild>\n                              <Button \n                                size=\"sm\" \n                                className=\"rounded-xl flex-1\" \n                                onClick={() => setSelectedTask(task)}\n                                data-testid={`button-review-${task.id}`}\n                              >\n                                <Eye className=\"h-4 w-4 ml-2\" />\n                                مراجعة وتقييم\n                              </Button>\n                            </DialogTrigger>\n                            <DialogContent className=\"sm:max-w-[500px]\" data-testid=\"dialog-review-task\">\n                              <DialogHeader>\n                                <DialogTitle>مراجعة المهمة</DialogTitle>\n                                <DialogDescription>\n                                  قم بمراجعة التقرير وقرر الموافقة أو الرفض\n                                </DialogDescription>\n                              </DialogHeader>\n\n                              <div className=\"space-y-4\">\n                                <div>\n                                  <p className=\"text-sm font-semibold mb-1\">عنوان المهمة:</p>\n                                  <p className=\"text-sm\">{selectedTask?.title}</p>\n                                </div>\n\n                                <div>\n                                  <p className=\"text-sm font-semibold mb-1\">التقرير:</p>\n                                  <div className=\"bg-muted/50 rounded-lg p-3 max-h-48 overflow-y-auto\">\n                                    <p className=\"text-sm whitespace-pre-wrap\">{selectedTask?.submission}</p>\n                                  </div>\n                                </div>\n\n                                <div>\n                                  <label className=\"text-sm font-semibold mb-1 block\">\n                                    تعليقك (اختياري للموافقة، مطلوب للرفض)\n                                  </label>\n                                  <Textarea\n                                    placeholder=\"اكتب تعليقك هنا...\"\n                                    value={feedback}\n                                    onChange={(e) => setFeedback(e.target.value)}\n                                    className=\"rounded-xl min-h-[100px]\"\n                                    data-testid=\"textarea-feedback\"\n                                  />\n                                </div>\n\n                                <div className=\"flex gap-2\">\n                                  <Button\n                                    onClick={handleApprove}\n                                    disabled={approveTaskMutation.isPending}\n                                    className=\"flex-1 rounded-xl bg-green-600 hover:bg-green-700\"\n                                    data-testid=\"button-approve-task\"\n                                  >\n                                    <CheckCircle className=\"h-4 w-4 ml-2\" />\n                                    موافقة\n                                  </Button>\n                                  <Button\n                                    onClick={handleReject}\n                                    disabled={rejectTaskMutation.isPending}\n                                    variant=\"destructive\"\n                                    className=\"flex-1 rounded-xl\"\n                                    data-testid=\"button-reject-task\"\n                                  >\n                                    <XCircle className=\"h-4 w-4 ml-2\" />\n                                    رفض\n                                  </Button>\n                                </div>\n                              </div>\n                            </DialogContent>\n                          </Dialog>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Campaigns Tab */}\n            <TabsContent value=\"campaigns\" className=\"space-y-4\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">حملاتي</h2>\n                <Button className=\"rounded-xl\" data-testid=\"button-new-campaign\">\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  حملة جديدة\n                </Button>\n              </div>\n\n              {campaigns.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Rocket className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد حملات بعد</h3>\n                    <p className=\"text-muted-foreground mb-4\">أنشئ أول حملة لاختبار منتجك</p>\n                    <Button className=\"rounded-xl\" data-testid=\"button-create-first-campaign\">\n                      <Plus className=\"h-4 w-4 ml-2\" />\n                      إنشاء حملة جديدة\n                    </Button>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {campaigns.map((campaign) => (\n                    <Card key={campaign.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-campaign-${campaign.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <CardTitle className=\"text-xl mb-2\">{campaign.title}</CardTitle>\n                            <p className=\"text-sm text-muted-foreground\">{campaign.description}</p>\n                          </div>\n                          {getStatusBadge(campaign.status)}\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm\">\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">الميزانية</p>\n                            <p className=\"font-bold text-primary\">{campaign.budget} ر.س</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">المختبرين المطلوبين</p>\n                            <p className=\"font-bold\">{campaign.testersNeeded}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">المُعيّنين</p>\n                            <p className=\"font-bold\">{campaign.testersAssigned}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">الباقة</p>\n                            <p className=\"font-bold\">{campaign.package}</p>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-2 mt-4\">\n                          <Button size=\"sm\" variant=\"outline\" className=\"rounded-xl\" data-testid={`button-view-campaign-${campaign.id}`}>\n                            <Eye className=\"h-4 w-4 ml-2\" />\n                            عرض التفاصيل\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* All Tasks Tab */}\n            <TabsContent value=\"all-tasks\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">جميع المهام</h2>\n\n              {allTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <FileText className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد مهام</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض جميع المهام الخاصة بحملاتك هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {allTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md\" data-testid={`card-all-task-${task.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{task.title}</h3>\n                              {getStatusBadge(task.status)}\n                              <Badge variant=\"outline\" className=\"rounded-lg\">{task.serviceType}</Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{task.description}</p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                {task.reward} ر.س\n                              </span>\n                              {task.submittedAt && (\n                                <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                  <Calendar className=\"h-4 w-4\" />\n                                  {new Date(task.submittedAt).toLocaleDateString('ar-SA')}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":29065},"client/src/pages/PurchaseService.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, ShoppingCart, Check } from \"lucide-react\";\nimport type { Group } from \"@shared/schema\";\n\nconst SERVICE_TYPES = [\n  { value: \"google_play_reviews\", label: \"تقييم تطبيقات Google Play\", price: 1 },\n  { value: \"ios_reviews\", label: \"تقييم تطبيقات iOS\", price: 1 },\n  { value: \"website_reviews\", label: \"تقييم مواقع إلكترونية\", price: 1 },\n  { value: \"ux_testing\", label: \"اختبار تجربة المستخدم UX\", price: 1 },\n  { value: \"software_testing\", label: \"اختبار أنظمة Software\", price: 1 },\n  { value: \"social_media\", label: \"التفاعل مع السوشيال ميديا\", price: 1 },\n  { value: \"google_maps\", label: \"تقييم خرائط Google Maps\", price: 2 },\n];\n\nconst PAYMENT_METHODS = [\n  { value: \"vodafone_cash\", label: \"فودافون كاش\", icon: \"📱\" },\n  { value: \"etisalat_cash\", label: \"اتصالات كاش\", icon: \"📱\" },\n  { value: \"orange_cash\", label: \"أورانج كاش\", icon: \"📱\" },\n  { value: \"bank_card\", label: \"بطاقة بنكية\", icon: \"💳\" },\n];\n\nexport default function PurchaseService() {\n  const [, params] = useRoute(\"/purchase/:groupId\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  \n  const [step, setStep] = useState(1);\n  const [serviceType, setServiceType] = useState(\"\");\n  const [quantity, setQuantity] = useState(1);\n  const [paymentMethod, setPaymentMethod] = useState(\"\");\n  const [paymentDetails, setPaymentDetails] = useState(\"\");\n\n  const groupId = params?.groupId;\n\n  // Check authentication and role\n  useEffect(() => {\n    const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n    const token = localStorage.getItem(\"token\");\n    const userType = localStorage.getItem(\"userType\");\n    \n    if (!currentUser || !token || userType !== \"product_owner\") {\n      toast({\n        title: \"غير مصرح\",\n        description: \"يجب تسجيل الدخول كصاحب منتج للوصول لهذه الصفحة\",\n        variant: \"destructive\",\n      });\n      navigate(\"/login\");\n    }\n  }, [navigate, toast]);\n\n  // Fetch group details\n  const { data: group, isLoading } = useQuery<Group>({\n    queryKey: [\"/api/groups\", groupId],\n    enabled: !!groupId,\n  });\n\n  // Calculate total price\n  const selectedService = SERVICE_TYPES.find(s => s.value === serviceType);\n  const pricePerUnit = selectedService?.price || 0;\n  const totalAmount = pricePerUnit * quantity;\n\n  // Create order mutation\n  const createOrderMutation = useMutation({\n    mutationFn: async () => {\n      const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n      \n      return await apiRequest(\"POST\", \"/api/orders\", {\n        productOwnerId: currentUser?.id,\n        groupId: groupId,\n        serviceType,\n        quantity,\n        pricePerUnit: pricePerUnit.toString(),\n        totalAmount: totalAmount.toString(),\n        paymentMethod,\n        paymentDetails,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/orders\"] });\n      toast({\n        title: \"تم إنشاء الطلب بنجاح\",\n        description: \"سيتم مراجعة طلبك والرد عليك قريباً\",\n      });\n      navigate(\"/product-owner-dashboard\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الطلب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = () => {\n    if (!serviceType || !quantity || !paymentMethod || !paymentDetails) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إكمال جميع الحقول\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createOrderMutation.mutate();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"text-center\">جاري التحميل...</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(\"/groups\")}\n            className=\"mb-4\"\n            data-testid=\"button-back-to-groups\"\n          >\n            <ArrowLeft className=\"ml-2 h-4 w-4\" />\n            العودة للجروبات\n          </Button>\n\n          <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n            شراء خدمة من {group?.name}\n          </h1>\n          <p className=\"text-muted-foreground\">\n            اختر الخدمة المطلوبة وقم بإكمال عملية الدفع\n          </p>\n        </div>\n\n        {/* Progress Steps */}\n        <div className=\"flex items-center justify-center mb-8\">\n          {[1, 2, 3].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div\n                className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                  step >= s ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\"\n                }`}\n              >\n                {step > s ? <Check className=\"h-5 w-5\" /> : s}\n              </div>\n              {s < 3 && <div className={`w-20 h-1 ${step > s ? \"bg-primary\" : \"bg-muted\"}`} />}\n            </div>\n          ))}\n        </div>\n\n        {/* Step 1: Select Service */}\n        {step === 1 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>اختر نوع الخدمة</CardTitle>\n              <CardDescription>حدد الخدمة التي تحتاجها من الجروب</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"service-type\">نوع الخدمة</Label>\n                <Select value={serviceType} onValueChange={setServiceType}>\n                  <SelectTrigger id=\"service-type\" data-testid=\"select-service-type\">\n                    <SelectValue placeholder=\"اختر نوع الخدمة\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {SERVICE_TYPES.map((service) => (\n                      <SelectItem key={service.value} value={service.value}>\n                        {service.label} - ${service.price} لكل وحدة\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"quantity\">عدد المراجعات / المهام</Label>\n                <Input\n                  id=\"quantity\"\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"1000\"\n                  value={quantity}\n                  onChange={(e) => setQuantity(Math.max(1, Math.min(1000, parseInt(e.target.value) || 1)))}\n                  data-testid=\"input-quantity\"\n                />\n                <p className=\"text-sm text-muted-foreground\">\n                  (من 1 إلى 1000)\n                </p>\n              </div>\n\n              {serviceType && (\n                <div className=\"bg-muted p-4 rounded-lg\">\n                  <div className=\"flex justify-between mb-2\">\n                    <span>السعر لكل وحدة:</span>\n                    <span className=\"font-bold\">${pricePerUnit}</span>\n                  </div>\n                  <div className=\"flex justify-between mb-2\">\n                    <span>الكمية:</span>\n                    <span className=\"font-bold\">{quantity}</span>\n                  </div>\n                  <div className=\"border-t pt-2 mt-2\">\n                    <div className=\"flex justify-between text-lg\">\n                      <span className=\"font-bold\">الإجمالي:</span>\n                      <span className=\"font-bold text-primary\">${totalAmount}</span>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              <Button\n                className=\"w-full\"\n                onClick={() => setStep(2)}\n                disabled={!serviceType}\n                data-testid=\"button-next-step-1\"\n              >\n                التالي\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Step 2: Select Payment Method */}\n        {step === 2 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>اختر طريقة الدفع</CardTitle>\n              <CardDescription>حدد الطريقة التي تفضلها للدفع</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <RadioGroup value={paymentMethod} onValueChange={setPaymentMethod}>\n                {PAYMENT_METHODS.map((method) => (\n                  <div key={method.value} className=\"flex items-center space-x-2 space-x-reverse\">\n                    <RadioGroupItem\n                      value={method.value}\n                      id={method.value}\n                      data-testid={`radio-payment-${method.value}`}\n                    />\n                    <Label htmlFor={method.value} className=\"flex items-center gap-2 cursor-pointer flex-1\">\n                      <span className=\"text-2xl\">{method.icon}</span>\n                      <span>{method.label}</span>\n                    </Label>\n                  </div>\n                ))}\n              </RadioGroup>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setStep(1)}\n                  className=\"flex-1\"\n                  data-testid=\"button-back-step-2\"\n                >\n                  السابق\n                </Button>\n                <Button\n                  onClick={() => setStep(3)}\n                  disabled={!paymentMethod}\n                  className=\"flex-1\"\n                  data-testid=\"button-next-step-2\"\n                >\n                  التالي\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Step 3: Payment Details */}\n        {step === 3 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>بيانات الدفع</CardTitle>\n              <CardDescription>أدخل بيانات الدفع لإتمام العملية</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"payment-details\">\n                  {paymentMethod === \"bank_card\" ? \"رقم البطاقة\" : \"رقم الهاتف\"}\n                </Label>\n                <Input\n                  id=\"payment-details\"\n                  type={paymentMethod === \"bank_card\" ? \"text\" : \"tel\"}\n                  placeholder={paymentMethod === \"bank_card\" ? \"XXXX-XXXX-XXXX-XXXX\" : \"01XXXXXXXXX\"}\n                  value={paymentDetails}\n                  onChange={(e) => setPaymentDetails(e.target.value)}\n                  data-testid=\"input-payment-details\"\n                />\n              </div>\n\n              <div className=\"bg-muted p-4 rounded-lg\">\n                <h4 className=\"font-bold mb-3\">ملخص الطلب</h4>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span>الخدمة:</span>\n                    <span>{SERVICE_TYPES.find(s => s.value === serviceType)?.label}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>الكمية:</span>\n                    <span>{quantity}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>طريقة الدفع:</span>\n                    <span>{PAYMENT_METHODS.find(p => p.value === paymentMethod)?.label}</span>\n                  </div>\n                  <div className=\"border-t pt-2 mt-2\">\n                    <div className=\"flex justify-between text-lg\">\n                      <span className=\"font-bold\">المبلغ الإجمالي:</span>\n                      <span className=\"font-bold text-primary\">${totalAmount}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setStep(2)}\n                  className=\"flex-1\"\n                  data-testid=\"button-back-step-3\"\n                >\n                  السابق\n                </Button>\n                <Button\n                  onClick={handleSubmit}\n                  disabled={!paymentDetails || createOrderMutation.isPending}\n                  className=\"flex-1\"\n                  data-testid=\"button-submit-order\"\n                >\n                  <ShoppingCart className=\"ml-2 h-4 w-4\" />\n                  {createOrderMutation.isPending ? \"جاري الإرسال...\" : \"تأكيد الطلب\"}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":14114},"client/src/pages/Profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  User, \n  Mail, \n  Phone, \n  Briefcase, \n  MapPin, \n  Calendar,\n  Star,\n  Award,\n  Settings,\n  Edit\n} from \"lucide-react\";\nimport type { Freelancer, ProductOwner } from \"@shared/schema\";\n\nexport default function Profile() {\n  const [, navigate] = useLocation();\n  const [userType, setUserType] = useState<string | null>(null);\n  const [user, setUser] = useState<any>(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const type = localStorage.getItem(\"userType\");\n    const userData = localStorage.getItem(\"user\");\n\n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n\n    setUserType(type);\n    if (userData) {\n      try {\n        setUser(JSON.parse(userData));\n      } catch (e) {\n        console.error(\"Error parsing user data:\", e);\n      }\n    }\n  }, [navigate]);\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center max-w-md mx-auto p-6\">\n            <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <User className=\"h-10 w-10 text-muted-foreground\" />\n            </div>\n            <h2 className=\"text-2xl font-bold mb-2\">لا توجد بيانات مستخدم</h2>\n            <p className=\"text-muted-foreground mb-6\">\n              لم نتمكن من تحميل بيانات ملفك الشخصي. يرجى تسجيل الدخول مرة أخرى.\n            </p>\n            <Button onClick={() => navigate(\"/login\")} className=\"rounded-2xl\">\n              تسجيل الدخول\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const getUserInitials = () => {\n    if (!user?.fullName) return \"م\";\n    const names = user.fullName.split(\" \");\n    if (names.length >= 2) {\n      return names[0][0] + names[1][0];\n    }\n    return names[0][0];\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          {/* Header */}\n          <div className=\"mb-8\">\n            <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"text-profile-title\">\n              الملف الشخصي\n            </h1>\n            <p className=\"text-lg text-muted-foreground\">\n              عرض وتحديث معلوماتك الشخصية\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            {/* Profile Card */}\n            <div className=\"lg:col-span-1\">\n              <Card className=\"rounded-2xl shadow-md\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex flex-col items-center text-center space-y-4\">\n                    <Avatar className=\"h-24 w-24\" data-testid=\"avatar-profile\">\n                      <AvatarImage src={user.profileImage} alt={user.fullName} />\n                      <AvatarFallback className=\"bg-primary/10 text-primary text-2xl font-bold\">\n                        {getUserInitials()}\n                      </AvatarFallback>\n                    </Avatar>\n\n                    <div className=\"space-y-1\">\n                      <h2 className=\"text-2xl font-bold\" data-testid=\"text-user-name\">\n                        {user.fullName}\n                      </h2>\n                      {user.username && (\n                        <p className=\"text-sm text-muted-foreground\" data-testid=\"text-username\">\n                          @{user.username}\n                        </p>\n                      )}\n                      <Badge variant=\"default\" className=\"mt-2\" data-testid=\"badge-user-type\">\n                        {userType === \"freelancer\" ? \"مستقل\" : \"صاحب منتج\"}\n                      </Badge>\n                    </div>\n\n                    {user.jobTitle && (\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\" data-testid=\"text-job-title\">\n                        <Briefcase className=\"h-4 w-4\" />\n                        {user.jobTitle}\n                      </div>\n                    )}\n\n                    <Button variant=\"outline\" className=\"w-full rounded-2xl mt-4\" data-testid=\"button-edit-profile\">\n                      <Edit className=\"ml-2 h-4 w-4\" />\n                      تعديل الملف الشخصي\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Quick Stats for Freelancer */}\n              {userType === \"freelancer\" && (\n                <Card className=\"rounded-2xl shadow-md mt-6\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">إحصائيات سريعة</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Award className=\"h-5 w-5 text-primary\" />\n                        <span className=\"text-sm\">التقييم</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n                        <span className=\"font-semibold\">--</span>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm\">المهام المكتملة</span>\n                      <span className=\"font-semibold\" data-testid=\"stat-completed-tasks\">0</span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm\">إجمالي الأرباح</span>\n                      <span className=\"font-semibold text-green-600\">0 ر.س</span>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n\n            {/* Details Tabs */}\n            <div className=\"lg:col-span-2\">\n              <Card className=\"rounded-2xl shadow-md\">\n                <CardHeader>\n                  <CardTitle>تفاصيل الحساب</CardTitle>\n                  <CardDescription>المعلومات الشخصية وإعدادات الحساب</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Tabs defaultValue=\"personal\" className=\"w-full\">\n                    <TabsList className=\"grid w-full grid-cols-2 rounded-xl\">\n                      <TabsTrigger value=\"personal\" className=\"rounded-lg\" data-testid=\"tab-personal\">\n                        المعلومات الشخصية\n                      </TabsTrigger>\n                      <TabsTrigger value=\"account\" className=\"rounded-lg\" data-testid=\"tab-account\">\n                        إعدادات الحساب\n                      </TabsTrigger>\n                    </TabsList>\n\n                    <TabsContent value=\"personal\" className=\"space-y-4 mt-6\">\n                      {/* Email */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Mail className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">البريد الإلكتروني</p>\n                          <p className=\"text-base\" data-testid=\"text-email\">{user.email}</p>\n                        </div>\n                      </div>\n\n                      {/* Phone */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Phone className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">رقم الهاتف</p>\n                          <p className=\"text-base\" data-testid=\"text-phone\">\n                            {user.countryCode} {user.phone}\n                          </p>\n                        </div>\n                      </div>\n\n                      {/* Bio - Freelancer */}\n                      {userType === \"freelancer\" && user.bio && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <User className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">نبذة مختصرة</p>\n                            <p className=\"text-base\" data-testid=\"text-bio\">{user.bio}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* About Me - Freelancer */}\n                      {userType === \"freelancer\" && user.aboutMe && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <User className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">عني</p>\n                            <p className=\"text-base whitespace-pre-wrap\" data-testid=\"text-about-me\">\n                              {user.aboutMe}\n                            </p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Company Name - Product Owner */}\n                      {userType === \"product_owner\" && user.companyName && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">اسم الشركة</p>\n                            <p className=\"text-base\" data-testid=\"text-company-name\">{user.companyName}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Product Name - Product Owner */}\n                      {userType === \"product_owner\" && user.productName && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">اسم المنتج</p>\n                            <p className=\"text-base\" data-testid=\"text-product-name\">{user.productName}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Services */}\n                      {user.services && user.services.length > 0 && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Award className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground mb-2\">الخدمات</p>\n                            <div className=\"flex flex-wrap gap-2\" data-testid=\"container-services\">\n                              {user.services.map((service: string, index: number) => (\n                                <Badge key={index} variant=\"secondary\" className=\"rounded-lg\">\n                                  {service}\n                                </Badge>\n                              ))}\n                            </div>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Join Date */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Calendar className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">تاريخ الانضمام</p>\n                          <p className=\"text-base\" data-testid=\"text-join-date\">\n                            {user.createdAt ? new Date(user.createdAt).toLocaleDateString(\"ar-EG\", {\n                              year: \"numeric\",\n                              month: \"long\",\n                              day: \"numeric\"\n                            }) : \"غير متوفر\"}\n                          </p>\n                        </div>\n                      </div>\n                    </TabsContent>\n\n                    <TabsContent value=\"account\" className=\"space-y-4 mt-6\">\n                      {/* Payment Method - Freelancer */}\n                      {userType === \"freelancer\" && user.paymentMethod && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">وسيلة الدفع</p>\n                            <p className=\"text-base\" data-testid=\"text-payment-method\">{user.paymentMethod}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Verification Status - Freelancer */}\n                      {userType === \"freelancer\" && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Award className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">حالة التوثيق</p>\n                            <Badge \n                              variant={user.isVerified ? \"default\" : \"secondary\"} \n                              className=\"mt-1\"\n                              data-testid=\"badge-verified-status\"\n                            >\n                              {user.isVerified ? \"موثق\" : \"غير موثق\"}\n                            </Badge>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Settings Buttons */}\n                      <div className=\"space-y-3 pt-4\">\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" data-testid=\"button-change-password\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          تغيير كلمة المرور\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" data-testid=\"button-notifications\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          إعدادات الإشعارات\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start text-destructive\" data-testid=\"button-delete-account\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          حذف الحساب\n                        </Button>\n                      </div>\n                    </TabsContent>\n                  </Tabs>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":16222},"client/src/pages/MyTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { CheckCircle2, Clock, FileText, Upload, Calendar, DollarSign } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function MyTasks() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submission, setSubmission] = useState(\"\");\n  const [proofImage, setProofImage] = useState(\"\");\n\n  // Fetch assigned tasks\n  const { data: tasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my/assigned\"],\n  });\n\n  // Start work mutation\n  const startWorkMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return await apiRequest(`/api/tasks/${taskId}/start-work`, \"PATCH\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my/assigned\"] });\n      toast({\n        title: \"تم بدء العمل\",\n        description: \"تم بدء العمل على المهمة بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء بدء العمل\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Submit task mutation\n  const submitTaskMutation = useMutation({\n    mutationFn: async ({ taskId, data }: { taskId: string; data: { submission: string; proofImage?: string } }) => {\n      return await apiRequest(`/api/tasks/${taskId}/submit-proof`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my/assigned\"] });\n      toast({\n        title: \"تم تسليم المهمة\",\n        description: \"تم تسليم المهمة بنجاح وهي الآن قيد المراجعة\",\n      });\n      setSelectedTask(null);\n      setSubmission(\"\");\n      setProofImage(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء تسليم المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmitTask = () => {\n    if (selectedTask && submission.trim()) {\n      submitTaskMutation.mutate({\n        taskId: selectedTask.id,\n        data: {\n          submission: submission.trim(),\n          proofImage: proofImage.trim() || undefined,\n        },\n      });\n    }\n  };\n\n  // Filter tasks by status\n  const assignedTasks = tasks.filter(t => t.status === \"assigned\");\n  const inProgressTasks = tasks.filter(t => t.status === \"in_progress\");\n  const submittedTasks = tasks.filter(t => t.status === \"submitted\");\n  const approvedTasks = tasks.filter(t => t.status === \"approved\");\n  const rejectedTasks = tasks.filter(t => t.status === \"rejected\");\n\n  const renderTaskCard = (task: Task) => (\n    <Card key={task.id} data-testid={`card-task-${task.id}`}>\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex-1\">\n            <CardTitle className=\"text-lg mb-2\">{task.title}</CardTitle>\n            <CardDescription className=\"line-clamp-2\">\n              {task.description}\n            </CardDescription>\n          </div>\n          <Badge variant={\n            task.status === \"assigned\" ? \"secondary\" :\n            task.status === \"in_progress\" ? \"default\" :\n            task.status === \"submitted\" ? \"outline\" :\n            task.status === \"approved\" ? \"default\" : \"destructive\"\n          }>\n            {task.status === \"assigned\" ? \"معينة\" :\n             task.status === \"in_progress\" ? \"جارية\" :\n             task.status === \"submitted\" ? \"مُسلّمة\" :\n             task.status === \"approved\" ? \"مُوافق عليها\" : \"مرفوضة\"}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <div className=\"flex items-center text-muted-foreground\">\n              <DollarSign className=\"ml-2 h-4 w-4\" />\n              المكافأة\n            </div>\n            <span className=\"font-semibold text-green-600\">{task.reward} ر.س</span>\n          </div>\n\n          {task.taskUrl && (\n            <div className=\"flex items-center justify-between text-sm\">\n              <div className=\"flex items-center text-muted-foreground\">\n                <FileText className=\"ml-2 h-4 w-4\" />\n                رابط المهمة\n              </div>\n              <a\n                href={task.taskUrl}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-primary hover:underline\"\n                onClick={(e) => e.stopPropagation()}\n              >\n                فتح الرابط\n              </a>\n            </div>\n          )}\n\n          {task.assignedAt && (\n            <div className=\"flex items-center justify-between text-sm\">\n              <div className=\"flex items-center text-muted-foreground\">\n                <Calendar className=\"ml-2 h-4 w-4\" />\n                تم التعيين\n              </div>\n              <span>{new Date(task.assignedAt).toLocaleDateString(\"ar\")}</span>\n            </div>\n          )}\n\n          {task.feedback && (\n            <div className=\"p-3 rounded-lg bg-muted/50 text-sm\">\n              <p className=\"font-semibold mb-1\">ملاحظات القائد:</p>\n              <p className=\"text-muted-foreground\">{task.feedback}</p>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          {task.status === \"assigned\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => startWorkMutation.mutate(task.id)}\n              disabled={startWorkMutation.isPending}\n              data-testid={`button-start-work-${task.id}`}\n            >\n              <Clock className=\"ml-2 h-4 w-4\" />\n              {startWorkMutation.isPending ? \"جاري البدء...\" : \"بدء العمل\"}\n            </Button>\n          )}\n\n          {task.status === \"in_progress\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => setSelectedTask(task)}\n              data-testid={`button-submit-task-${task.id}`}\n            >\n              <Upload className=\"ml-2 h-4 w-4\" />\n              تسليم المهمة\n            </Button>\n          )}\n\n          {task.status === \"rejected\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => setSelectedTask(task)}\n              data-testid={`button-resubmit-task-${task.id}`}\n            >\n              <Upload className=\"ml-2 h-4 w-4\" />\n              إعادة التسليم\n            </Button>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n            مهامي\n          </h1>\n          <p className=\"text-muted-foreground\">\n            تابع وأنجز مهامك المعينة\n          </p>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8\">\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">معينة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{assignedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">جارية</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{inProgressTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مُسلّمة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{submittedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مُوافق عليها</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\">{approvedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مرفوضة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-destructive\">{rejectedTasks.length}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tabs */}\n        <Tabs defaultValue=\"all\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            <TabsTrigger value=\"all\" data-testid=\"tab-all-tasks\">\n              الكل ({tasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"assigned\" data-testid=\"tab-assigned\">\n              معينة ({assignedTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"in_progress\" data-testid=\"tab-in-progress\">\n              جارية ({inProgressTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"submitted\" data-testid=\"tab-submitted\">\n              مُسلّمة ({submittedTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"completed\" data-testid=\"tab-completed\">\n              مُكتملة ({approvedTasks.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"all\" className=\"mt-6\">\n            {isLoading ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {[1, 2, 3].map((i) => (\n                  <Card key={i} className=\"animate-pulse\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"h-32 bg-muted rounded\" />\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : tasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">لا توجد مهام</h3>\n                  <p className=\"text-muted-foreground\">لم يتم تعيين أي مهام لك بعد</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {tasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"assigned\" className=\"mt-6\">\n            {assignedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام معينة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {assignedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"in_progress\" className=\"mt-6\">\n            {inProgressTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Clock className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام جارية</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {inProgressTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"submitted\" className=\"mt-6\">\n            {submittedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <FileText className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام مُسلّمة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {submittedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"completed\" className=\"mt-6\">\n            {approvedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام مُكتملة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {approvedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Submit Task Dialog */}\n      <Dialog open={!!selectedTask} onOpenChange={() => {\n        setSelectedTask(null);\n        setSubmission(\"\");\n        setProofImage(\"\");\n      }}>\n        <DialogContent className=\"max-w-2xl\" data-testid=\"dialog-submit-task\">\n          <DialogHeader>\n            <DialogTitle>تسليم المهمة</DialogTitle>\n            <DialogDescription>\n              قم بكتابة تقرير عن إنجاز المهمة وإرفاق صورة الإثبات\n            </DialogDescription>\n          </DialogHeader>\n\n          {selectedTask && (\n            <div className=\"space-y-4\">\n              <div className=\"p-4 rounded-lg bg-muted/50\">\n                <h3 className=\"font-semibold mb-1\">{selectedTask.title}</h3>\n                <p className=\"text-sm text-muted-foreground\">{selectedTask.description}</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">التقرير *</label>\n                <Textarea\n                  placeholder=\"اكتب تقرير مفصل عن كيفية إنجاز المهمة...\"\n                  className=\"resize-none min-h-[150px]\"\n                  value={submission}\n                  onChange={(e) => setSubmission(e.target.value)}\n                  data-testid=\"input-submission\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">رابط صورة الإثبات (اختياري)</label>\n                <Input\n                  type=\"url\"\n                  placeholder=\"https://example.com/proof-image.jpg\"\n                  value={proofImage}\n                  onChange={(e) => setProofImage(e.target.value)}\n                  data-testid=\"input-proof-image\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  يمكنك رفع الصورة على خدمة مثل Imgur ووضع الرابط هنا\n                </p>\n              </div>\n            </div>\n          )}\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSelectedTask(null);\n                setSubmission(\"\");\n                setProofImage(\"\");\n              }}\n              data-testid=\"button-cancel-submit\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleSubmitTask}\n              disabled={!submission.trim() || submitTaskMutation.isPending}\n              data-testid=\"button-confirm-submit\"\n            >\n              {submitTaskMutation.isPending ? \"جاري التسليم...\" : \"تسليم المهمة\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17262},"client/src/pages/GroupDetails.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Users, ArrowRight, Crown, UserMinus, MessageCircle, Briefcase, CheckCircle2, Clock, MessageSquareText } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group, GroupMember, Project, Task, Freelancer } from \"@shared/schema\";\n\nexport default function GroupDetails() {\n  const params = useParams();\n  const groupId = params.id as string;\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [memberToRemove, setMemberToRemove] = useState<string | null>(null);\n  const [user, setUser] = useState<any>(() => {\n    const userData = localStorage.getItem(\"user\");\n    return userData ? JSON.parse(userData) : null;\n  });\n\n  // Fetch group details\n  const { data: group, isLoading: groupLoading } = useQuery<Group>({\n    queryKey: [\"/api/groups\", groupId],\n  });\n\n  // Fetch group members\n  const { data: members = [], isLoading: membersLoading } = useQuery<(GroupMember & { freelancer: Freelancer })[]>({\n    queryKey: [\"/api/groups\", groupId, \"members\"],\n  });\n\n  // Fetch group projects\n  const { data: projects = [] } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/group\", groupId],\n  });\n\n  // Fetch group tasks\n  const { data: tasks = [] } = useQuery<Task[]>({\n    queryKey: [\"/api/groups\", groupId, \"tasks\"],\n  });\n\n  // Check if current user is the leader\n  const isLeader = user && group && user.userId === group.leaderId;\n\n  // Check if current user is product owner\n  const userType = localStorage.getItem(\"userType\");\n  const isProductOwner = userType === \"product_owner\";\n\n  // Leave group mutation\n  const leaveGroupMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/groups/${groupId}/leave`, \"POST\");\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم المغادرة بنجاح\",\n        description: \"تم مغادرة الجروب بنجاح\",\n      });\n      navigate(\"/groups\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء مغادرة الجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Remove member mutation\n  const removeMemberMutation = useMutation({\n    mutationFn: async (freelancerId: string) => {\n      return await apiRequest(`/api/groups/${groupId}/members/${freelancerId}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId, \"members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId] });\n      toast({\n        title: \"تم الإزالة بنجاح\",\n        description: \"تم إزالة العضو من الجروب\",\n      });\n      setMemberToRemove(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إزالة العضو\",\n        variant: \"destructive\",\n      });\n      setMemberToRemove(null);\n    },\n  });\n\n  // Navigate to chat page\n  const handleStartConversation = () => {\n    navigate(`/groups/${groupId}/chat`);\n  };\n\n  if (groupLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card className=\"animate-pulse\">\n            <CardHeader>\n              <div className=\"h-8 bg-muted rounded w-1/3 mb-4\" />\n              <div className=\"h-4 bg-muted rounded w-2/3\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-64 bg-muted rounded\" />\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  if (!group) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <Users className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">الجروب غير موجود</h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                لم يتم العثور على هذا الجروب\n              </p>\n              <Button onClick={() => navigate(\"/groups\")}>\n                العودة للجروبات\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(\"/groups\")}\n          className=\"mb-6\"\n          data-testid=\"button-back-to-groups\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة للجروبات\n        </Button>\n\n        {/* Group Header */}\n        <Card className=\"mb-6 overflow-hidden\">\n          {/* Group Image */}\n          {group.groupImage && (\n            <div className=\"w-full h-64 overflow-hidden bg-muted\">\n              <img\n                src={group.groupImage}\n                alt={group.name}\n                className=\"w-full h-full object-cover\"\n                onError={(e) => {\n                  e.currentTarget.parentElement!.style.display = 'none';\n                }}\n              />\n            </div>\n          )}\n\n          <CardHeader>\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-3 mb-2\">\n                  <CardTitle className=\"text-3xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                    {group.name}\n                  </CardTitle>\n                  <Badge variant={group.status === \"active\" ? \"default\" : \"secondary\"}>\n                    {group.status === \"active\" ? \"نشط\" : \"غير نشط\"}\n                  </Badge>\n                  {isLeader && (\n                    <Badge variant=\"outline\" className=\"gap-1\">\n                      <Crown className=\"h-3 w-3 text-yellow-600\" />\n                      أنت القائد\n                    </Badge>\n                  )}\n                </div>\n                <CardDescription className=\"text-base\">\n                  {group.description || \"لا يوجد وصف\"}\n                </CardDescription>\n              </div>\n\n              <div className=\"flex gap-2\">\n                {!isProductOwner && (\n                  <Button\n                    onClick={() => navigate(`/groups/${groupId}/community`)}\n                    variant=\"default\"\n                    data-testid=\"button-community\"\n                  >\n                    <MessageSquareText className=\"ml-2 h-4 w-4\" />\n                    مجتمع المجموعة\n                  </Button>\n                )}\n                {isProductOwner && (\n                  <Button\n                    onClick={handleStartConversation}\n                    data-testid=\"button-start-conversation\"\n                  >\n                    <MessageCircle className=\"ml-2 h-4 w-4\" />\n                    ابدأ محادثة\n                  </Button>\n                )}\n                {!isLeader && !isProductOwner && (\n                  <Button\n                    variant=\"destructive\"\n                    onClick={() => leaveGroupMutation.mutate()}\n                    disabled={leaveGroupMutation.isPending}\n                    data-testid=\"button-leave-group\"\n                  >\n                    مغادرة الجروب\n                  </Button>\n                )}\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-lg bg-primary/10\">\n                  <Users className=\"h-5 w-5 text-primary\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">الأعضاء</p>\n                  <p className=\"text-xl font-bold\">\n                    {group.currentMembers} / {group.maxMembers}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-lg bg-blue-500/10\">\n                  <Briefcase className=\"h-5 w-5 text-blue-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">المشاريع</p>\n                  <p className=\"text-xl font-bold\">{projects.length}</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-lg bg-green-500/10\">\n                  <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">المهام المكتملة</p>\n                  <p className=\"text-xl font-bold\">\n                    {tasks.filter(t => t.status === \"approved\").length}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-lg bg-yellow-500/10\">\n                  <Clock className=\"h-5 w-5 text-yellow-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">المهام الجارية</p>\n                  <p className=\"text-xl font-bold\">\n                    {tasks.filter(t => t.status === \"in_progress\").length}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Tabs */}\n        <Tabs defaultValue=\"members\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"members\" data-testid=\"tab-members\">\n              الأعضاء ({members.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"projects\" data-testid=\"tab-projects\">\n              المشاريع ({projects.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"tasks\" data-testid=\"tab-tasks\">\n              المهام ({tasks.length})\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Members Tab */}\n          <TabsContent value=\"members\" className=\"mt-6\">\n            {membersLoading ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {[1, 2, 3].map((i) => (\n                  <Card key={i} className=\"animate-pulse\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"h-20 bg-muted rounded\" />\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : members.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Users className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">لا يوجد أعضاء</h3>\n                  <p className=\"text-muted-foreground\">لا يوجد أعضاء في الجروب حالياً</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {members.map((member) => (\n                  <Card key={member.id} data-testid={`card-member-${member.freelancerId}`}>\n                    <CardContent className=\"pt-6\">\n                      <div className=\"flex items-start justify-between mb-4\">\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar>\n                            <AvatarFallback>\n                              {member.freelancer?.fullName?.charAt(0) || \"U\"}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div>\n                            <h4 className=\"font-semibold\">{member.freelancer?.fullName || \"مستخدم\"}</h4>\n                            <p className=\"text-sm text-muted-foreground\">\n                              {member.freelancer?.username || \"@user\"}\n                            </p>\n                          </div>\n                        </div>\n\n                        {member.role === \"leader\" && (\n                          <Crown className=\"h-5 w-5 text-yellow-600\" />\n                        )}\n                      </div>\n\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-muted-foreground\">الدور:</span>\n                          <Badge variant={member.role === \"leader\" ? \"default\" : \"secondary\"}>\n                            {member.role === \"leader\" ? \"قائد\" : \"عضو\"}\n                          </Badge>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-muted-foreground\">انضم في:</span>\n                          <span>{new Date(member.joinedAt).toLocaleDateString(\"ar\")}</span>\n                        </div>\n                      </div>\n\n                      {isLeader && member.role !== \"leader\" && (\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          className=\"w-full mt-4\"\n                          onClick={() => setMemberToRemove(member.freelancerId)}\n                          data-testid={`button-remove-member-${member.freelancerId}`}\n                        >\n                          <UserMinus className=\"ml-2 h-4 w-4\" />\n                          إزالة من الجروب\n                        </Button>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Projects Tab */}\n          <TabsContent value=\"projects\" className=\"mt-6\">\n            {projects.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Briefcase className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع</h3>\n                  <p className=\"text-muted-foreground\">لم يتم قبول أي مشاريع بعد</p>\n                  {isLeader && (\n                    <Button \n                      className=\"mt-4\"\n                      onClick={() => navigate(\"/projects\")}\n                    >\n                      تصفح المشاريع المتاحة\n                    </Button>\n                  )}\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                {projects.map((project) => (\n                  <Card key={project.id} className=\"hover-elevate cursor-pointer\" data-testid={`card-project-${project.id}`}>\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <CardTitle className=\"text-lg\">{project.title}</CardTitle>\n                        <Badge>\n                          {project.status === \"pending\" ? \"معلق\" :\n                           project.status === \"accepted\" ? \"مقبول\" :\n                           project.status === \"in_progress\" ? \"جاري\" :\n                           project.status === \"completed\" ? \"مكتمل\" : \"ملغي\"}\n                        </Badge>\n                      </div>\n                      <CardDescription className=\"line-clamp-2\">\n                        {project.description}\n                      </CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-muted-foreground\">الميزانية:</span>\n                          <span className=\"font-semibold\">{project.budget} ر.س</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-muted-foreground\">عدد المهام:</span>\n                          <span>{project.tasksCount}</span>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n\n          {/* Tasks Tab */}\n          <TabsContent value=\"tasks\" className=\"mt-6\">\n            {tasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">لا توجد مهام</h3>\n                  <p className=\"text-muted-foreground\">لم يتم إنشاء أي مهام بعد</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-4\">\n                {tasks.map((task) => (\n                  <Card key={task.id} data-testid={`card-task-${task.id}`}>\n                    <CardHeader>\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                          <CardDescription className=\"line-clamp-2 mt-1\">\n                            {task.description}\n                          </CardDescription>\n                        </div>\n                        <Badge>\n                          {task.status === \"available\" ? \"متاحة\" :\n                           task.status === \"assigned\" ? \"معينة\" :\n                           task.status === \"in_progress\" ? \"جارية\" :\n                           task.status === \"submitted\" ? \"مُسلّمة\" :\n                           task.status === \"approved\" ? \"مُوافق عليها\" : \"مرفوضة\"}\n                        </Badge>\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"text-sm text-muted-foreground\">\n                          المكافأة: <span className=\"font-semibold text-foreground\">{task.reward} ر.س</span>\n                        </div>\n                        {task.status === \"available\" && (\n                          <Button size=\"sm\">\n                            تعيين المهمة\n                          </Button>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Remove Member Dialog */}\n      <AlertDialog open={!!memberToRemove} onOpenChange={() => setMemberToRemove(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>تأكيد إزالة العضو</AlertDialogTitle>\n            <AlertDialogDescription>\n              هل أنت متأكد من إزالة هذا العضو من الجروب؟ هذا الإجراء لا يمكن التراجع عنه.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-remove\">إلغاء</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => memberToRemove && removeMemberMutation.mutate(memberToRemove)}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-remove\"\n            >\n              {removeMemberMutation.isPending ? \"جاري الإزالة...\" : \"إزالة\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","size_bytes":21178},"client/src/pages/Groups.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Users, Search, UserPlus, Crown, TrendingUp, MessageCircle, ShoppingCart } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group } from \"@shared/schema\";\n\nexport default function Groups() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  // Get current user from localStorage\n  const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n  const userType = localStorage.getItem(\"userType\");\n  const isProductOwner = userType === \"product_owner\";\n  const isFreelancer = userType === \"freelancer\";\n\n  // Fetch all groups\n  const { data: groups = [], isLoading } = useQuery<Group[]>({\n    queryKey: [\"/api/groups\"],\n  });\n\n  // Join group mutation\n  const joinGroupMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      return await apiRequest(`/api/groups/${groupId}/join`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\"] });\n      toast({\n        title: \"تم الانضمام بنجاح\",\n        description: \"تم انضمامك للجروب بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء الانضمام للجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Start conversation mutation\n  const startConversationMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      const response = await apiRequest(\"/api/conversations\", \"POST\", { groupId });\n      return response;\n    },\n    onSuccess: (data: any) => {\n      navigate(`/product-owner-dashboard/conversations?conversationId=${data.id}`);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء بدء المحادثة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Filter groups based on search\n  const filteredGroups = groups.filter((group) =>\n    group.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    (group.description?.toLowerCase()?.includes(searchTerm.toLowerCase()) ?? false)\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header Section */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                الجروبات\n              </h1>\n              <p className=\"text-muted-foreground\">\n                {isFreelancer ? \"انضم لجروب واعمل مع فريق محترف على المشاريع\" : \"اختر جروب محترف لتنفيذ مشروعك\"}\n              </p>\n            </div>\n\n            {isFreelancer && (\n              <Button\n                onClick={() => navigate(\"/groups/create\")}\n                size=\"lg\"\n                data-testid=\"button-create-group\"\n              >\n                <UserPlus className=\"ml-2 h-5 w-5\" />\n                إنشاء جروب جديد\n              </Button>\n            )}\n          </div>\n\n          {/* Search Bar */}\n          <div className=\"relative max-w-md\">\n            <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"ابحث عن جروب...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pr-10\"\n              data-testid=\"input-search-groups\"\n            />\n          </div>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">إجمالي الجروبات</CardTitle>\n              <Users className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{groups.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">جروبات نشطة</CardTitle>\n              <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {groups.filter(g => g.status === \"active\").length}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">إجمالي الأعضاء</CardTitle>\n              <Users className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {groups.reduce((sum, g) => sum + (g.currentMembers || 0), 0)}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Groups Grid */}\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardHeader>\n                  <div className=\"h-6 bg-muted rounded w-3/4 mb-2\" />\n                  <div className=\"h-4 bg-muted rounded w-full\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-20 bg-muted rounded mb-4\" />\n                  <div className=\"h-10 bg-muted rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredGroups.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <Users className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد جروبات</h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                {searchTerm ? \"لم يتم العثور على جروبات تطابق البحث\" : \"لا توجد جروبات متاحة حالياً\"}\n              </p>\n              {!searchTerm && (\n                <Button onClick={() => navigate(\"/groups/create\")} data-testid=\"button-create-first-group\">\n                  <UserPlus className=\"ml-2 h-4 w-4\" />\n                  إنشاء أول جروب\n                </Button>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredGroups.map((group) => (\n              <Card\n                key={group.id}\n                className=\"hover-elevate cursor-pointer transition-all overflow-hidden\"\n                onClick={() => navigate(`/groups/${group.id}`)}\n                data-testid={`card-group-${group.id}`}\n              >\n                {/* Portfolio Images Gallery */}\n                {group.portfolioImages && group.portfolioImages.length > 0 && (\n                  <div className=\"w-full bg-muted/30 p-3\">\n                    <div className=\"flex gap-2 overflow-x-auto scrollbar-hide\" style={{ scrollbarWidth: 'none' }}>\n                      {group.portfolioImages.slice(0, 12).map((image, idx) => (\n                        <div\n                          key={idx}\n                          className=\"flex-shrink-0 w-24 h-24 rounded-md overflow-hidden bg-muted hover-elevate\"\n                          data-testid={`img-portfolio-${group.id}-${idx}`}\n                        >\n                          <img\n                            src={image}\n                            alt={`نموذج عمل ${idx + 1}`}\n                            className=\"w-full h-full object-cover\"\n                            onError={(e) => {\n                              e.currentTarget.src = `https://placehold.co/200x200/e5e7eb/6b7280?text=${idx + 1}`;\n                            }}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                    <p className=\"text-xs text-center text-muted-foreground mt-2\">\n                      نماذج من أعمال سابقة (قبل وبعد)\n                    </p>\n                  </div>\n                )}\n\n                <CardHeader>\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <CardTitle className=\"text-xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                      {group.name}\n                    </CardTitle>\n                    <Badge variant={group.status === \"active\" ? \"default\" : \"secondary\"}>\n                      {group.status === \"active\" ? \"نشط\" : \"غير نشط\"}\n                    </Badge>\n                  </div>\n                  <CardDescription className=\"line-clamp-2 min-h-[2.5rem]\">\n                    {group.description || \"لا يوجد وصف\"}\n                  </CardDescription>\n                </CardHeader>\n\n                <CardContent>\n                  <div className=\"space-y-3 mb-4\">\n                    {/* Member Count */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <Users className=\"ml-2 h-4 w-4\" />\n                        الأعضاء\n                      </div>\n                      <span className=\"font-semibold\">\n                        {group.currentMembers || 0} / {group.maxMembers}\n                      </span>\n                    </div>\n\n                    {/* Leader Badge */}\n                    <div className=\"flex items-center text-sm text-muted-foreground\">\n                      <Crown className=\"ml-2 h-4 w-4 text-yellow-600\" />\n                      <span>قائد الجروب: {group.leaderId}</span>\n                    </div>\n                  </div>\n\n                  {/* Action buttons - different for Product Owners vs Freelancers */}\n                  {isProductOwner ? (\n                    <div className=\"space-y-2\">\n                      <div className=\"flex gap-2\">\n                        <Button\n                          className=\"flex-1\"\n                          variant=\"default\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            navigate(`/purchase/${group.id}`);\n                          }}\n                          data-testid={`button-purchase-service-${group.id}`}\n                        >\n                          <ShoppingCart className=\"ml-2 h-4 w-4\" />\n                          شراء الخدمة\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            startConversationMutation.mutate(group.id);\n                          }}\n                          disabled={startConversationMutation.isPending}\n                          data-testid={`button-contact-leader-${group.id}`}\n                        >\n                          <MessageCircle className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                      <Button\n                        className=\"w-full\"\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/groups/${group.id}`);\n                        }}\n                        data-testid={`button-view-group-${group.id}`}\n                      >\n                        عرض التفاصيل\n                      </Button>\n                    </div>\n                  ) : (\n                    <div className=\"flex gap-2\">\n                      <Button\n                        className=\"flex-1\"\n                        variant=\"default\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          navigate(`/groups/${group.id}`);\n                        }}\n                        data-testid={`button-view-group-${group.id}`}\n                      >\n                        عرض التفاصيل\n                      </Button>\n\n                      {isFreelancer && group.status === \"active\" && (group.currentMembers || 0) < group.maxMembers && (\n                        <Button\n                          variant=\"outline\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            joinGroupMutation.mutate(group.id);\n                          }}\n                          disabled={joinGroupMutation.isPending}\n                          data-testid={`button-join-group-${group.id}`}\n                        >\n                          <UserPlus className=\"h-4 w-4\" />\n                        </Button>\n                      )}\n                    </div>\n                  )}\n\n                  {(group.currentMembers || 0) >= group.maxMembers && (\n                    <p className=\"text-xs text-destructive text-center mt-2\">\n                      الجروب ممتلئ\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":14321},"client/src/pages/CreateProject.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { ArrowRight, Briefcase } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { insertProjectSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst createProjectSchema = insertProjectSchema.omit({ productOwnerId: true }).extend({\n  budget: z.string().min(1, \"الميزانية مطلوبة\"),\n  tasksCount: z.number().min(1, \"يجب أن يكون عدد المهام 1 على الأقل\"),\n});\n\ntype CreateProjectForm = z.infer<typeof createProjectSchema>;\n\nexport default function CreateProject() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n\n  const form = useForm<CreateProjectForm>({\n    resolver: zodResolver(createProjectSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      targetCountry: \"السعودية\",\n      tasksCount: 10,\n      budget: \"\",\n      deadline: undefined,\n    },\n  });\n\n  const createProjectMutation = useMutation({\n    mutationFn: async (data: CreateProjectForm) => {\n      return await apiRequest(\"/api/projects\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/pending\"] });\n      toast({\n        title: \"تم إنشاء المشروع\",\n        description: \"تم إنشاء المشروع بنجاح وهو متاح الآن لقادة الجروبات\",\n      });\n      navigate(\"/projects\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المشروع\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CreateProjectForm) => {\n    createProjectMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(\"/projects\")}\n          className=\"mb-6\"\n          data-testid=\"button-back-to-projects\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة للمشاريع\n        </Button>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center gap-3 mb-2\">\n              <div className=\"p-3 rounded-lg bg-primary/10\">\n                <Briefcase className=\"h-6 w-6 text-primary\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-2xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  إنشاء مشروع جديد\n                </CardTitle>\n                <CardDescription>\n                  أنشئ مشروعاً جديداً ليقبله قادة الجروبات\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                {/* Title */}\n                <FormField\n                  control={form.control}\n                  name=\"title\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>عنوان المشروع *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"مثال: اختبار تطبيق التجارة الإلكترونية\"\n                          {...field}\n                          data-testid=\"input-project-title\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        عنوان واضح ومختصر للمشروع\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Description */}\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>وصف المشروع *</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"وصف تفصيلي عن المشروع والمهام المطلوبة...\"\n                          className=\"resize-none min-h-[150px]\"\n                          {...field}\n                          data-testid=\"input-project-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اشرح تفاصيل المشروع وما هو المطلوب من الفريلانسرز\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {/* Target Country */}\n                  <FormField\n                    control={form.control}\n                    name=\"targetCountry\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الدولة المستهدفة *</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"السعودية\"\n                            {...field}\n                            data-testid=\"input-target-country\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          الدولة التي يجب أن يكون الفريلانسرز منها\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Tasks Count */}\n                  <FormField\n                    control={form.control}\n                    name=\"tasksCount\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>عدد المهام *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"number\"\n                            min=\"1\"\n                            {...field}\n                            onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                            data-testid=\"input-tasks-count\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          عدد المهام المطلوب إنجازها\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {/* Budget */}\n                  <FormField\n                    control={form.control}\n                    name=\"budget\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الميزانية (ر.س) *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            placeholder=\"1000\"\n                            {...field}\n                            data-testid=\"input-budget\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          إجمالي ميزانية المشروع\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Deadline */}\n                  <FormField\n                    control={form.control}\n                    name=\"deadline\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الموعد النهائي (اختياري)</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"date\"\n                            {...field}\n                            value={field.value ? new Date(field.value).toISOString().split('T')[0] : \"\"}\n                            onChange={(e) => field.onChange(e.target.value ? new Date(e.target.value) : undefined)}\n                            data-testid=\"input-deadline\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          الموعد النهائي لإنجاز المشروع\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                {/* Info Card */}\n                <Card className=\"bg-muted/50\">\n                  <CardContent className=\"pt-6\">\n                    <h4 className=\"font-semibold mb-3\">ملاحظات هامة:</h4>\n                    <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>سيكون المشروع متاحاً لجميع قادة الجروبات للقبول</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>عند قبول المشروع، سيقوم قائد الجروب بتوزيع المهام على الأعضاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستدفع 5% عمولة إضافية لقائد الجروب عند إنجاز كل مهمة</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك متابعة تقدم المشروع ومراجعة المهام المنجزة</span>\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                {/* Submit Buttons */}\n                <div className=\"flex gap-3\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => navigate(\"/projects\")}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createProjectMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-submit\"\n                  >\n                    {createProjectMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء المشروع\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":12161},"client/src/pages/CreateGroup.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { ArrowRight, Users, Image, Upload } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { insertGroupSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst createGroupSchema = insertGroupSchema.extend({\n  maxMembers: z.number().min(2, \"يجب أن يكون الحد الأقصى للأعضاء 2 على الأقل\").max(700, \"الحد الأقصى 700 عضو\"),\n}).omit({ leaderId: true });\n\ntype CreateGroupForm = z.infer<typeof createGroupSchema>;\n\nexport default function CreateGroup() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [imagePreview, setImagePreview] = useState<string>(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n\n  const form = useForm<CreateGroupForm>({\n    resolver: zodResolver(createGroupSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      groupImage: \"\",\n      maxMembers: 50,\n    },\n  });\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"خطأ\",\n        description: \"يجب اختيار صورة فقط\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"خطأ\",\n        description: \"حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsUploading(true);\n      \n      // Create FormData\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', 'group');\n\n      // Upload to server\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'فشل رفع الصورة');\n      }\n\n      const { url } = await response.json();\n      \n      // Set preview\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setImagePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n\n      // Update form\n      form.setValue('groupImage', url);\n      \n      toast({\n        title: \"تم رفع الصورة\",\n        description: \"تم رفع صورة الجروب بنجاح\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء رفع الصورة\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const createGroupMutation = useMutation({\n    mutationFn: async (data: CreateGroupForm) => {\n      // Get user data from localStorage at the time of submission\n      const userDataStr = localStorage.getItem(\"user\");\n      if (!userDataStr) {\n        throw new Error(\"يجب تسجيل الدخول أولاً\");\n      }\n      \n      const userData = JSON.parse(userDataStr);\n      if (!userData || !userData.userId) {\n        throw new Error(\"بيانات المستخدم غير صحيحة. يرجى تسجيل الدخول مرة أخرى\");\n      }\n      \n      const groupData = {\n        ...data,\n        leaderId: userData.userId,\n      };\n      \n      return await apiRequest(\"/api/groups\", \"POST\", groupData);\n    },\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\"] });\n      toast({\n        title: \"تم إنشاء الجروب بنجاح\",\n        description: \"تم إنشاء الجروب وأنت الآن قائد الجروب\",\n      });\n      navigate(`/groups/${data.id}`);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CreateGroupForm) => {\n    createGroupMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(\"/groups\")}\n          className=\"mb-6\"\n          data-testid=\"button-back-to-groups\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة للجروبات\n        </Button>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center gap-4 mb-2\">\n              {/* Preview Image or Icon */}\n              {imagePreview ? (\n                <div className=\"relative w-20 h-20 rounded-lg overflow-hidden bg-muted flex-shrink-0\">\n                  <img\n                    src={imagePreview}\n                    alt=\"معاينة صورة الجروب\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                </div>\n              ) : (\n                <div className=\"p-3 rounded-lg bg-primary/10 flex-shrink-0\">\n                  <Users className=\"h-6 w-6 text-primary\" />\n                </div>\n              )}\n              \n              <div className=\"flex-1\">\n                <CardTitle className=\"text-2xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  إنشاء جروب جديد\n                </CardTitle>\n                <CardDescription>\n                  أنشئ جروب وابدأ باستقبال أعضاء والعمل على المشاريع\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                {/* Group Name */}\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>اسم الجروب *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"مثال: فريق التطبيقات المحترف\"\n                          {...field}\n                          data-testid=\"input-group-name\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اختر اسماً واضحاً وجذاباً للجروب\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Description */}\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>الوصف</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"وصف مختصر عن الجروب وأهدافه...\"\n                          className=\"resize-none min-h-[120px]\"\n                          {...field}\n                          value={field.value || \"\"}\n                          data-testid=\"input-group-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اشرح للأعضاء ما يميز جروبك\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Group Image */}\n                <FormField\n                  control={form.control}\n                  name=\"groupImage\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>صورة الجروب</FormLabel>\n                      <FormControl>\n                        <div className=\"space-y-4\">\n                          {/* Upload Button */}\n                          <div className=\"flex items-center gap-3\">\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              onClick={() => document.getElementById('group-image-input')?.click()}\n                              disabled={isUploading}\n                              className=\"flex items-center gap-2\"\n                              data-testid=\"button-upload-group-image\"\n                            >\n                              <Upload className=\"h-4 w-4\" />\n                              {isUploading ? \"جاري الرفع...\" : \"اختر صورة من المعرض\"}\n                            </Button>\n                            <input\n                              id=\"group-image-input\"\n                              type=\"file\"\n                              accept=\"image/*\"\n                              className=\"hidden\"\n                              onChange={handleImageUpload}\n                              data-testid=\"input-group-image-file\"\n                            />\n                          </div>\n\n                          {/* Preview */}\n                          {imagePreview && (\n                            <div className=\"relative w-full max-w-md\">\n                              <div className=\"relative w-full h-48 rounded-lg overflow-hidden bg-muted\">\n                                <img\n                                  src={imagePreview}\n                                  alt=\"معاينة صورة الجروب\"\n                                  className=\"w-full h-full object-cover\"\n                                />\n                              </div>\n                              <Button\n                                type=\"button\"\n                                variant=\"destructive\"\n                                size=\"sm\"\n                                className=\"absolute top-2 left-2\"\n                                onClick={() => {\n                                  setImagePreview(\"\");\n                                  form.setValue('groupImage', \"\");\n                                }}\n                                data-testid=\"button-remove-group-image\"\n                              >\n                                حذف الصورة\n                              </Button>\n                            </div>\n                          )}\n                        </div>\n                      </FormControl>\n                      <FormDescription>\n                        اختر صورة من معرض الصور (اختياري). الحد الأقصى 5 ميجابايت\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Max Members */}\n                <FormField\n                  control={form.control}\n                  name=\"maxMembers\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>الحد الأقصى للأعضاء *</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min={2}\n                          max={700}\n                          value={field.value}\n                          onChange={(e) => {\n                            const value = e.target.value;\n                            field.onChange(value === \"\" ? 0 : parseInt(value));\n                          }}\n                          data-testid=\"input-group-max-members\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        يمكنك استقبال حتى 700 عضو (الحد الأقصى للمنصة)\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Info Card */}\n                <Card className=\"bg-muted/50\">\n                  <CardContent className=\"pt-6\">\n                    <h4 className=\"font-semibold mb-3\">ملاحظات هامة:</h4>\n                    <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستصبح قائد الجروب تلقائياً بعد الإنشاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستحصل على عمولة 5% من كل مهمة يكملها أعضاء جروبك</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك قبول المشاريع وتوزيع المهام على الأعضاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك إزالة الأعضاء غير النشطين من الجروب</span>\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                {/* Submit Buttons */}\n                <div className=\"flex gap-3\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => navigate(\"/groups\")}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createGroupMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-submit\"\n                  >\n                    {createGroupMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء الجروب\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15162},"client/src/pages/Projects.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Briefcase, Search, Calendar, DollarSign, CheckCircle2, Users, MapPin } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Project, Group } from \"@shared/schema\";\n\nexport default function Projects() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedProject, setSelectedProject] = useState<Project | null>(null);\n  const [selectedGroupId, setSelectedGroupId] = useState<string>(\"\");\n  const [user, setUser] = useState<any>(() => {\n    const userData = localStorage.getItem(\"user\");\n    return userData ? JSON.parse(userData) : null;\n  });\n\n  // Fetch pending projects\n  const { data: projects = [], isLoading: projectsLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/pending\"],\n  });\n\n  // Fetch user's groups where they are leader\n  const { data: leaderGroups = [] } = useQuery<Group[]>({\n    queryKey: [\"/api/groups/my/leader\"],\n    enabled: !!user && user.userType === \"freelancer\",\n  });\n\n  // Accept project mutation\n  const acceptProjectMutation = useMutation({\n    mutationFn: async ({ projectId, groupId }: { projectId: string; groupId: string }) => {\n      return await apiRequest(`/api/projects/${projectId}/accept`, \"POST\", { groupId });\n    },\n    onSuccess: (_data, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/pending\"] });\n      // Invalidate the specific group's projects\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/group\", variables.groupId] });\n      // Also invalidate all group project queries\n      queryClient.invalidateQueries({ \n        predicate: (query) => {\n          const key = query.queryKey;\n          return Array.isArray(key) && key[0] === \"/api/projects/group\";\n        }\n      });\n      toast({\n        title: \"تم قبول المشروع\",\n        description: \"تم قبول المشروع بنجاح ويمكنك الآن البدء بتوزيع المهام\",\n      });\n      setSelectedProject(null);\n      setSelectedGroupId(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء قبول المشروع\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Filter projects\n  const filteredProjects = projects.filter((project) =>\n    project.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    project.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    project.targetCountry.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const handleAcceptProject = () => {\n    if (selectedProject && selectedGroupId) {\n      acceptProjectMutation.mutate({\n        projectId: selectedProject.id,\n        groupId: selectedGroupId,\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                المشاريع المتاحة\n              </h1>\n              <p className=\"text-muted-foreground\">\n                تصفح واقبل المشاريع المتاحة لجروبك\n              </p>\n            </div>\n\n            {user?.userType === \"productOwner\" && (\n              <Button\n                onClick={() => navigate(\"/projects/create\")}\n                size=\"lg\"\n                data-testid=\"button-create-project\"\n              >\n                <Briefcase className=\"ml-2 h-5 w-5\" />\n                إنشاء مشروع جديد\n              </Button>\n            )}\n          </div>\n\n          {/* Search */}\n          <div className=\"relative max-w-md\">\n            <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"ابحث عن مشروع...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pr-10\"\n              data-testid=\"input-search-projects\"\n            />\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">المشاريع المتاحة</CardTitle>\n              <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{projects.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">إجمالي الميزانيات</CardTitle>\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {projects.reduce((sum, p) => sum + parseFloat(p.budget as string), 0).toLocaleString()} ر.س\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">جروباتي (كقائد)</CardTitle>\n              <Users className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{leaderGroups.length}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Projects Grid */}\n        {projectsLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardHeader>\n                  <div className=\"h-6 bg-muted rounded w-3/4 mb-2\" />\n                  <div className=\"h-4 bg-muted rounded w-full\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-32 bg-muted rounded mb-4\" />\n                  <div className=\"h-10 bg-muted rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <Briefcase className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع</h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                {searchTerm ? \"لم يتم العثور على مشاريع تطابق البحث\" : \"لا توجد مشاريع متاحة حالياً\"}\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project) => (\n              <Card\n                key={project.id}\n                className=\"hover-elevate transition-all\"\n                data-testid={`card-project-${project.id}`}\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <CardTitle className=\"text-xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge>{project.status === \"pending\" ? \"متاح\" : project.status}</Badge>\n                  </div>\n                  <CardDescription className=\"line-clamp-3 min-h-[3.5rem]\">\n                    {project.description}\n                  </CardDescription>\n                </CardHeader>\n\n                <CardContent>\n                  <div className=\"space-y-3 mb-4\">\n                    {/* Budget */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <DollarSign className=\"ml-2 h-4 w-4\" />\n                        الميزانية\n                      </div>\n                      <span className=\"font-semibold text-green-600\">\n                        {parseFloat(project.budget as string).toLocaleString()} ر.س\n                      </span>\n                    </div>\n\n                    {/* Tasks Count */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n                        عدد المهام\n                      </div>\n                      <span className=\"font-semibold\">{project.tasksCount}</span>\n                    </div>\n\n                    {/* Target Country */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <MapPin className=\"ml-2 h-4 w-4\" />\n                        الدولة المستهدفة\n                      </div>\n                      <span className=\"font-semibold\">{project.targetCountry}</span>\n                    </div>\n\n                    {/* Deadline */}\n                    {project.deadline && (\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <div className=\"flex items-center text-muted-foreground\">\n                          <Calendar className=\"ml-2 h-4 w-4\" />\n                          الموعد النهائي\n                        </div>\n                        <span className=\"font-semibold\">\n                          {new Date(project.deadline).toLocaleDateString(\"ar\")}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n\n                  <Button\n                    className=\"w-full\"\n                    onClick={() => setSelectedProject(project)}\n                    disabled={leaderGroups.length === 0}\n                    data-testid={`button-accept-project-${project.id}`}\n                  >\n                    {leaderGroups.length === 0 ? \"يجب أن تكون قائد جروب\" : \"قبول المشروع\"}\n                  </Button>\n\n                  {leaderGroups.length === 0 && (\n                    <p className=\"text-xs text-muted-foreground text-center mt-2\">\n                      أنشئ جروب لتتمكن من قبول المشاريع\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Accept Project Dialog */}\n      <Dialog open={!!selectedProject} onOpenChange={() => {\n        setSelectedProject(null);\n        setSelectedGroupId(\"\");\n      }}>\n        <DialogContent data-testid=\"dialog-accept-project\">\n          <DialogHeader>\n            <DialogTitle>قبول المشروع</DialogTitle>\n            <DialogDescription>\n              اختر الجروب الذي سيعمل على هذا المشروع\n            </DialogDescription>\n          </DialogHeader>\n\n          {selectedProject && (\n            <div className=\"space-y-4\">\n              <div className=\"p-4 rounded-lg bg-muted/50\">\n                <h3 className=\"font-semibold mb-2\">{selectedProject.title}</h3>\n                <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                  <div>\n                    <span className=\"text-muted-foreground\">الميزانية:</span>\n                    <span className=\"font-semibold mr-2 text-green-600\">\n                      {parseFloat(selectedProject.budget as string).toLocaleString()} ر.س\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">المهام:</span>\n                    <span className=\"font-semibold mr-2\">{selectedProject.tasksCount}</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">اختر الجروب</label>\n                <Select value={selectedGroupId} onValueChange={setSelectedGroupId}>\n                  <SelectTrigger data-testid=\"select-group\">\n                    <SelectValue placeholder=\"اختر جروب...\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {leaderGroups.map((group) => (\n                      <SelectItem key={group.id} value={group.id}>\n                        {group.name} ({group.currentMembers}/{group.maxMembers} عضو)\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <Card className=\"bg-blue-500/10 border-blue-500/20\">\n                <CardContent className=\"pt-6\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    ملاحظة: بعد قبول المشروع، ستتمكن من إنشاء المهام وتوزيعها على أعضاء الجروب.\n                    ستحصل على عمولة 5% من كل مهمة يكملها الأعضاء.\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSelectedProject(null);\n                setSelectedGroupId(\"\");\n              }}\n              data-testid=\"button-cancel-accept\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleAcceptProject}\n              disabled={!selectedGroupId || acceptProjectMutation.isPending}\n              data-testid=\"button-confirm-accept\"\n            >\n              {acceptProjectMutation.isPending ? \"جاري القبول...\" : \"قبول المشروع\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":15152},"client/src/components/NotificationsDropdown.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport function NotificationsDropdown() {\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Fetch notifications\n  const { data: notifications = [] } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"PATCH\", `/api/notifications/${id}/read`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"PATCH\", \"/api/notifications/mark-all-read\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"relative rounded-xl\"\n          data-testid=\"button-notifications\"\n        >\n          <Bell className=\"h-5 w-5\" />\n          {unreadCount > 0 && (\n            <Badge\n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 rounded-full text-xs\"\n              data-testid=\"badge-unread-count\"\n            >\n              {unreadCount > 9 ? \"9+\" : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-80\" data-testid=\"dropdown-notifications\">\n        <DropdownMenuLabel className=\"flex items-center justify-between\">\n          <span>الإشعارات</span>\n          {unreadCount > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              className=\"h-auto p-1 text-xs\"\n              data-testid=\"button-mark-all-read\"\n            >\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <ScrollArea className=\"h-[400px]\">\n          {notifications.length === 0 ? (\n            <div className=\"py-8 text-center text-sm text-muted-foreground\" data-testid=\"text-no-notifications\">\n              <Bell className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n              <p>لا توجد إشعارات</p>\n            </div>\n          ) : (\n            notifications.map((notification) => (\n              <DropdownMenuItem\n                key={notification.id}\n                className=\"flex flex-col items-start gap-1 p-3 cursor-pointer\"\n                onClick={() => handleNotificationClick(notification)}\n                data-testid={`notification-${notification.id}`}\n              >\n                <div className=\"flex items-start gap-2 w-full\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <p className={`text-sm font-semibold ${!notification.isRead ? 'text-primary' : ''}`}>\n                        {notification.title}\n                      </p>\n                      {!notification.isRead && (\n                        <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread\" />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                      {notification.message}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {getTimeAgo(notification.createdAt)}\n                    </p>\n                  </div>\n                  {!notification.isRead && (\n                    <CheckCircle2 className=\"h-4 w-4 text-muted-foreground flex-shrink-0 mt-1\" />\n                  )}\n                </div>\n              </DropdownMenuItem>\n            ))\n          )}\n        </ScrollArea>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","size_bytes":5601},"client/src/components/FreelancerSidebar.tsx":{"content":"import { \n  Home, \n  ListTodo, \n  CheckSquare, \n  Users, \n  Wallet, \n  Download, \n  ShoppingBag, \n  Settings,\n  ChevronDown,\n  MessageCircle,\n  Bell\n} from \"lucide-react\";\nimport { useLocation, Link } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n} from \"@/components/ui/sidebar\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\n\nconst menuItems = [\n  {\n    title: \"الرئيسية\",\n    url: \"/freelancer-dashboard\",\n    icon: Home,\n  },\n  {\n    title: \"المهام\",\n    icon: ListTodo,\n    items: [\n      { title: \"المهام المتاحة\", url: \"/freelancer-dashboard/tasks/available\" },\n      { title: \"مهامي\", url: \"/freelancer-dashboard/tasks/my-tasks\" },\n    ],\n  },\n  {\n    title: \"الجروبات\",\n    url: \"/groups\",\n    icon: Users,\n  },\n  {\n    title: \"المالية\",\n    icon: Wallet,\n    items: [\n      { title: \"المحفظة\", url: \"/freelancer-dashboard/wallet\" },\n      { title: \"السحوبات\", url: \"/freelancer-dashboard/withdrawals\" },\n    ],\n  },\n  {\n    title: \"الطلبات الواردة\",\n    url: \"/freelancer-dashboard/orders\",\n    icon: ShoppingBag,\n  },\n  {\n    title: \"المحادثات\",\n    url: \"/freelancer-dashboard/conversations\",\n    icon: MessageCircle,\n  },\n  {\n    title: \"الإشعارات\",\n    url: \"/freelancer-dashboard/notifications\",\n    icon: Bell,\n  },\n  {\n    title: \"الإعدادات\",\n    url: \"/freelancer-dashboard/settings\",\n    icon: Settings,\n  },\n];\n\nexport function FreelancerSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar side=\"right\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-lg font-bold text-primary\">\n            لوحة التحكم - مستقل\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => {\n                const isActive = location === item.url || location.startsWith(item.url + \"/\");\n                \n                if (item.items) {\n                  return (\n                    <Collapsible\n                      key={item.title}\n                      defaultOpen={item.items.some((subItem) => location === subItem.url)}\n                      className=\"group/collapsible\"\n                    >\n                      <SidebarMenuItem>\n                        <CollapsibleTrigger asChild>\n                          <SidebarMenuButton data-testid={`sidebar-${item.title}`}>\n                            <item.icon className=\"ml-2\" />\n                            <span>{item.title}</span>\n                            <ChevronDown className=\"mr-auto transition-transform group-data-[state=open]/collapsible:rotate-180\" />\n                          </SidebarMenuButton>\n                        </CollapsibleTrigger>\n                        <CollapsibleContent>\n                          <SidebarMenuSub>\n                            {item.items.map((subItem) => (\n                              <SidebarMenuSubItem key={subItem.title}>\n                                <SidebarMenuSubButton\n                                  asChild\n                                  isActive={location === subItem.url}\n                                  data-testid={`sidebar-sub-${subItem.title}`}\n                                >\n                                  <Link href={subItem.url}>{subItem.title}</Link>\n                                </SidebarMenuSubButton>\n                              </SidebarMenuSubItem>\n                            ))}\n                          </SidebarMenuSub>\n                        </CollapsibleContent>\n                      </SidebarMenuItem>\n                    </Collapsible>\n                  );\n                }\n\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive}\n                      data-testid={`sidebar-${item.title}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"ml-2\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":4629},"client/src/pages/freelancer-dashboard/Withdrawals.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Download, Wallet as WalletIcon } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Wallet, Withdrawal } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function WithdrawalsPage() {\n  const { toast } = useToast();\n  const [showWithdrawalDialog, setShowWithdrawalDialog] = useState(false);\n  const [withdrawalAmount, setWithdrawalAmount] = useState(\"\");\n  const [withdrawalMethod, setWithdrawalMethod] = useState(\"\");\n  const [withdrawalAccount, setWithdrawalAccount] = useState(\"\");\n\n  const { data: wallet } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  const { data: withdrawals = [], isLoading } = useQuery<Withdrawal[]>({\n    queryKey: [\"/api/withdrawals/my\"],\n  });\n\n  const createWithdrawalMutation = useMutation({\n    mutationFn: async (data: { amount: number; paymentMethod: string; accountNumber: string }) => {\n      return apiRequest(\"POST\", \"/api/withdrawals\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/withdrawals/my\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/wallet\"] });\n      setShowWithdrawalDialog(false);\n      setWithdrawalAmount(\"\");\n      setWithdrawalMethod(\"\");\n      setWithdrawalAccount(\"\");\n      toast({\n        title: \"تم إرسال طلب السحب بنجاح\",\n        description: \"سيتم مراجعة طلبك وتحويل المبلغ قريباً\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء إنشاء طلب السحب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleWithdrawalSubmit = () => {\n    const amount = parseFloat(withdrawalAmount);\n    \n    if (!withdrawalAmount || amount <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال مبلغ صحيح\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalMethod) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار طريقة الدفع\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalAccount.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال رقم الحساب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const walletBalance = parseFloat(wallet?.balance || \"0\");\n    if (amount > walletBalance) {\n      toast({\n        title: \"خطأ\",\n        description: `الرصيد المتاح غير كافٍ. الرصيد الحالي: ${walletBalance} ر.س`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createWithdrawalMutation.mutate({\n      amount: Number(withdrawalAmount),\n      paymentMethod: withdrawalMethod,\n      accountNumber: withdrawalAccount,\n    });\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد المراجعة\", variant: \"outline\" },\n      processing: { label: \"جارٍ المعالجة\", variant: \"secondary\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n      rejected: { label: \"مرفوض\", variant: \"destructive\" },\n    };\n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  const getPaymentMethodLabel = (method: string) => {\n    const methods: Record<string, string> = {\n      vodafone_cash: \"فودافون كاش\",\n      etisalat_cash: \"اتصالات كاش\",\n      orange_cash: \"أورانج كاش\",\n      bank_card: \"البطاقة البنكية\",\n      bank_transfer: \"تحويل بنكي\",\n    };\n    return methods[method] || method;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-3xl font-bold\">السحوبات</h2>\n          <p className=\"text-muted-foreground mt-1\">\n            اطلب سحب أرباحك وتابع حالة الطلبات\n          </p>\n        </div>\n        <Button\n          onClick={() => setShowWithdrawalDialog(true)}\n          className=\"rounded-xl\"\n          data-testid=\"button-new-withdrawal\"\n        >\n          <Download className=\"ml-2 h-4 w-4\" />\n          طلب سحب جديد\n        </Button>\n      </div>\n\n      <Card className=\"rounded-2xl bg-gradient-to-br from-primary/10 to-primary/5\">\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <WalletIcon className=\"h-5 w-5 text-primary\" />\n            <CardTitle>رصيد المحفظة</CardTitle>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-4xl font-bold text-primary\">\n            {wallet?.balance || \"0\"} ر.س\n          </div>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            متاح للسحب\n          </p>\n        </CardContent>\n      </Card>\n\n      <div>\n        <h3 className=\"text-lg font-semibold mb-4\">سجل السحوبات</h3>\n        <div className=\"space-y-3\">\n          {withdrawals.map((withdrawal) => (\n            <Card key={withdrawal.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-withdrawal-${withdrawal.id}`}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"space-y-2 flex-1\">\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-lg font-bold\">{withdrawal.amount} ر.س</span>\n                      {getStatusBadge(withdrawal.status)}\n                    </div>\n                    <div className=\"text-sm text-muted-foreground space-y-1\">\n                      <div>\n                        <span>طريقة الدفع: </span>\n                        <span className=\"font-medium\">{getPaymentMethodLabel(withdrawal.paymentMethod)}</span>\n                      </div>\n                      <div>\n                        <span>رقم الحساب: </span>\n                        <span className=\"font-medium\">{withdrawal.accountNumber}</span>\n                      </div>\n                      <div>\n                        <span>التاريخ: </span>\n                        <span className=\"font-medium\">\n                          {format(new Date(withdrawal.createdAt), \"PPP\", { locale: ar })}\n                        </span>\n                      </div>\n                    </div>\n                    {withdrawal.adminNote && (\n                      <div className=\"p-3 bg-muted rounded-xl mt-2\">\n                        <p className=\"text-sm font-medium\">ملاحظة الإدارة:</p>\n                        <p className=\"text-sm text-muted-foreground\">{withdrawal.adminNote}</p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n        {withdrawals.length === 0 && (\n          <div className=\"text-center py-12\">\n            <p className=\"text-muted-foreground\">لا توجد طلبات سحب سابقة</p>\n          </div>\n        )}\n      </div>\n\n      <Dialog open={showWithdrawalDialog} onOpenChange={setShowWithdrawalDialog}>\n        <DialogContent className=\"rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle>طلب سحب جديد</DialogTitle>\n            <DialogDescription>\n              املأ البيانات المطلوبة لطلب سحب أرباحك\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"amount\">المبلغ (ر.س)</Label>\n              <Input\n                id=\"amount\"\n                type=\"number\"\n                value={withdrawalAmount}\n                onChange={(e) => setWithdrawalAmount(e.target.value)}\n                placeholder=\"أدخل المبلغ\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-amount\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                الرصيد المتاح: {wallet?.balance || \"0\"} ر.س\n              </p>\n            </div>\n\n            <div>\n              <Label htmlFor=\"payment-method\">طريقة الدفع</Label>\n              <Select value={withdrawalMethod} onValueChange={setWithdrawalMethod}>\n                <SelectTrigger className=\"rounded-xl mt-1\" data-testid=\"select-withdrawal-method\">\n                  <SelectValue placeholder=\"اختر طريقة الدفع\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"vodafone_cash\">فودافون كاش</SelectItem>\n                  <SelectItem value=\"etisalat_cash\">اتصالات كاش</SelectItem>\n                  <SelectItem value=\"orange_cash\">أورانج كاش</SelectItem>\n                  <SelectItem value=\"bank_card\">البطاقة البنكية</SelectItem>\n                  <SelectItem value=\"bank_transfer\">تحويل بنكي</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"account-number\">رقم الحساب / المحفظة</Label>\n              <Input\n                id=\"account-number\"\n                value={withdrawalAccount}\n                onChange={(e) => setWithdrawalAccount(e.target.value)}\n                placeholder=\"أدخل رقم الحساب\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-account\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                تأكد من صحة رقم الحساب لتجنب التأخير في التحويل\n              </p>\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowWithdrawalDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-withdrawal\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleWithdrawalSubmit}\n              disabled={createWithdrawalMutation.isPending}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-withdrawal\"\n            >\n              <Download className=\"h-4 w-4 ml-1\" />\n              إرسال الطلب\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":11608},"client/src/pages/freelancer-dashboard/Orders.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingBag } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function OrdersPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n      cancelled: { label: \"ملغي\", variant: \"destructive\" },\n    };\n    const statusInfo = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  const getServiceLabel = (serviceType: string) => {\n    const services: Record<string, string> = {\n      google_play_reviews: \"مراجعات Google Play\",\n      ios_reviews: \"مراجعات iOS\",\n      website_reviews: \"مراجعات المواقع\",\n      ux_testing: \"اختبار تجربة المستخدم\",\n      software_testing: \"اختبار البرمجيات\",\n      social_media: \"وسائل التواصل الاجتماعي\",\n      google_maps_reviews: \"مراجعات Google Maps\",\n    };\n    return services[serviceType] || serviceType;\n  };\n\n  const getPaymentMethodLabel = (method: string) => {\n    const methods: Record<string, string> = {\n      vodafone_cash: \"فودافون كاش\",\n      etisalat_cash: \"اتصالات كاش\",\n      orange_cash: \"أورانج كاش\",\n      bank_card: \"البطاقة البنكية\",\n    };\n    return methods[method] || method;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">الطلبات الواردة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تابع طلبات الخدمات الواردة من أصحاب المشاريع\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        {orders.map((order) => (\n          <Card key={order.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-order-${order.id}`}>\n            <CardHeader>\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex items-start gap-2\">\n                  <ShoppingBag className=\"h-5 w-5 text-primary mt-0.5\" />\n                  <div>\n                    <CardTitle className=\"text-lg\">{getServiceLabel(order.serviceType)}</CardTitle>\n                    <CardDescription>\n                      الكمية: {order.quantity} • المبلغ: ${order.totalAmount}\n                    </CardDescription>\n                  </div>\n                </div>\n                {getStatusBadge(order.status)}\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div>\n                  <p className=\"text-muted-foreground\">طريقة الدفع:</p>\n                  <p className=\"font-medium\">{getPaymentMethodLabel(order.paymentMethod)}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">التاريخ:</p>\n                  <p className=\"font-medium\">\n                    {format(new Date(order.createdAt), \"PPP\", { locale: ar })}\n                  </p>\n                </div>\n              </div>\n              {order.paymentDetails && (\n                <div className=\"p-3 bg-muted rounded-xl\">\n                  <p className=\"text-sm font-medium\">تفاصيل الدفع:</p>\n                  <p className=\"text-sm text-muted-foreground\">{order.paymentDetails}</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {orders.length === 0 && (\n        <div className=\"text-center py-12\">\n          <ShoppingBag className=\"h-12 w-12 text-muted-foreground mx-auto mb-3\" />\n          <p className=\"text-muted-foreground\">لا توجد طلبات واردة حالياً</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":4698},"client/src/components/FreelancerDashboardLayout.tsx":{"content":"import { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { FreelancerSidebar } from \"@/components/FreelancerSidebar\";\n\ninterface FreelancerDashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function FreelancerDashboardLayout({ children }: FreelancerDashboardLayoutProps) {\n  const style = {\n    \"--sidebar-width\": \"18rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\" dir=\"rtl\">\n        <FreelancerSidebar />\n        <div className=\"flex flex-col flex-1\">\n          <header className=\"flex items-center p-4 border-b\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":905},"client/src/pages/freelancer-dashboard/AvailableTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Search, CheckCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function AvailableTasks() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: availableTasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/available\"],\n  });\n\n  const acceptTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest(\"POST\", `/api/tasks/${taskId}/accept`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/available\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم قبول المهمة بنجاح\",\n        description: \"يمكنك الآن البدء بالعمل على هذه المهمة\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء قبول المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredTasks = availableTasks.filter((task) =>\n    task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.serviceType.includes(searchQuery)\n  );\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">المهام المتاحة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تصفح واختر المهام التي تناسب مهاراتك\n        </p>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"ابحث عن مهمة...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pr-10 rounded-xl\"\n            data-testid=\"input-search-tasks\"\n          />\n        </div>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n        {filteredTasks.map((task) => (\n          <Card key={task.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n              <CardDescription>{task.description}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">المكافأة:</span>\n                <span className=\"font-bold text-primary\">{task.reward} ر.س</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">نوع الخدمة:</span>\n                <Badge variant=\"outline\">{task.serviceType}</Badge>\n              </div>\n            </CardContent>\n            <CardFooter>\n              <Button\n                className=\"w-full rounded-xl\"\n                onClick={() => acceptTaskMutation.mutate(task.id)}\n                disabled={acceptTaskMutation.isPending}\n                data-testid={`button-accept-${task.id}`}\n              >\n                <CheckCircle className=\"ml-2 h-4 w-4\" />\n                قبول المهمة\n              </Button>\n            </CardFooter>\n          </Card>\n        ))}\n      </div>\n\n      {filteredTasks.length === 0 && (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">لا توجد مهام متاحة حالياً</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":4340},"client/src/pages/freelancer-dashboard/Overview.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { CheckCircle2, Clock, ListTodo, ShoppingBag } from \"lucide-react\";\nimport type { Task, Order } from \"@shared/schema\";\n\nexport default function FreelancerOverview() {\n  const { data: myTasks = [] } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const completedTasks = myTasks.filter((t) => t.status === \"approved\").length;\n  const activeTasks = myTasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\").length;\n  const pendingTasks = myTasks.filter((t) => t.status === \"submitted\").length;\n  const totalOrders = orders.length;\n\n  const stats = [\n    {\n      title: \"المهام المكتملة\",\n      value: completedTasks,\n      icon: CheckCircle2,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"المهام النشطة\",\n      value: activeTasks,\n      icon: Clock,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"المهام قيد المراجعة\",\n      value: pendingTasks,\n      icon: ListTodo,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"إجمالي الطلبات\",\n      value: totalOrders,\n      icon: ShoppingBag,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مرحباً بك في لوحة التحكم</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إليك نظرة عامة على أنشطتك وإحصائياتك\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>نشاطاتك الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد نشاطات حديثة\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>الإشعارات الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد إشعارات جديدة\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3520},"client/src/pages/product-owner-dashboard/Overview.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { FolderKanban, Clock, CheckCircle2, ShoppingCart } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\n\nexport default function ProductOwnerOverview() {\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const totalOrders = orders.length;\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\").length;\n  const completedOrders = orders.filter((o) => o.status === \"completed\").length;\n  const totalSpent = orders.reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const stats = [\n    {\n      title: \"إجمالي الطلبات\",\n      value: totalOrders,\n      icon: ShoppingCart,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"قيد المعالجة\",\n      value: pendingOrders,\n      icon: Clock,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"مكتملة\",\n      value: completedOrders,\n      icon: CheckCircle2,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"إجمالي الإنفاق\",\n      value: `$${totalSpent.toFixed(2)}`,\n      icon: FolderKanban,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مرحباً بك في لوحة التحكم</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إليك نظرة عامة على طلباتك ومشاريعك\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>نشاطاتك الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد نشاطات حديثة\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>الإشعارات الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد إشعارات جديدة\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3434},"client/src/pages/freelancer-dashboard/MyTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Play, Send } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function MyTasks() {\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submissionText, setSubmissionText] = useState(\"\");\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\n\n  const { data: myTasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  const startTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest(\"PATCH\", `/api/tasks/${taskId}/start`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم بدء المهمة\",\n        description: \"المهمة الآن قيد التنفيذ\",\n      });\n    },\n  });\n\n  const submitTaskMutation = useMutation({\n    mutationFn: async (data: { taskId: string; submission: string }) => {\n      return apiRequest(\"PATCH\", `/api/tasks/${data.taskId}/submit`, { submission: data.submission });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      setShowSubmitDialog(false);\n      setSubmissionText(\"\");\n      toast({\n        title: \"تم تسليم المهمة\",\n        description: \"تم إرسال المهمة للمراجعة بنجاح\",\n      });\n    },\n  });\n\n  const handleSubmitTask = (task: Task) => {\n    setSelectedTask(task);\n    setSubmissionText(task.submission || \"\");\n    setShowSubmitDialog(true);\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      assigned: { label: \"مقبولة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"تم التسليم\", variant: \"secondary\" },\n      approved: { label: \"موافق عليها\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n    \n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مهامي</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تتبع تقدمك في المهام المقبولة\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        {myTasks.map((task) => (\n          <Card key={task.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n            <CardHeader>\n              <div className=\"flex items-start justify-between gap-2\">\n                <div>\n                  <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                  <CardDescription>{task.description}</CardDescription>\n                </div>\n                {getStatusBadge(task.status)}\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">المكافأة:</span>\n                <span className=\"font-bold text-primary\">{task.reward} ر.س</span>\n              </div>\n              {task.feedback && task.status === \"rejected\" && (\n                <div className=\"p-3 bg-destructive/10 rounded-xl\">\n                  <p className=\"text-sm text-destructive font-medium\">سبب الرفض:</p>\n                  <p className=\"text-sm text-destructive\">{task.feedback}</p>\n                </div>\n              )}\n            </CardContent>\n            <CardFooter className=\"gap-2\">\n              {task.status === \"assigned\" && (\n                <Button\n                  className=\"flex-1 rounded-xl\"\n                  onClick={() => startTaskMutation.mutate(task.id)}\n                  disabled={startTaskMutation.isPending}\n                  data-testid={`button-start-${task.id}`}\n                >\n                  <Play className=\"ml-2 h-4 w-4\" />\n                  بدء العمل\n                </Button>\n              )}\n              {task.status === \"in_progress\" && (\n                <Button\n                  className=\"flex-1 rounded-xl\"\n                  onClick={() => handleSubmitTask(task)}\n                  data-testid={`button-submit-${task.id}`}\n                >\n                  <Send className=\"ml-2 h-4 w-4\" />\n                  تسليم المهمة\n                </Button>\n              )}\n            </CardFooter>\n          </Card>\n        ))}\n      </div>\n\n      {myTasks.length === 0 && (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">لا توجد مهام مقبولة حالياً</p>\n        </div>\n      )}\n\n      <Dialog open={showSubmitDialog} onOpenChange={setShowSubmitDialog}>\n        <DialogContent className=\"rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle>تسليم المهمة</DialogTitle>\n            <DialogDescription>\n              أضف تقريراً عن عملك وأي ملاحظات\n            </DialogDescription>\n          </DialogHeader>\n          <div>\n            <Label htmlFor=\"submission\">التقرير</Label>\n            <Textarea\n              id=\"submission\"\n              value={submissionText}\n              onChange={(e) => setSubmissionText(e.target.value)}\n              placeholder=\"اكتب تفاصيل ما أنجزته...\"\n              className=\"mt-2 rounded-xl\"\n              rows={5}\n              data-testid=\"textarea-submission\"\n            />\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowSubmitDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={() => selectedTask && submitTaskMutation.mutate({ taskId: selectedTask.id, submission: submissionText })}\n              disabled={submitTaskMutation.isPending || !submissionText.trim()}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-submit\"\n            >\n              <Send className=\"ml-2 h-4 w-4\" />\n              إرسال التقرير\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":7345},"client/src/pages/freelancer-dashboard/Settings.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { User, Lock, Save } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Freelancer } from \"@shared/schema\";\n\nexport default function SettingsPage() {\n  const { toast } = useToast();\n  const [fullName, setFullName] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [bio, setBio] = useState(\"\");\n  const [aboutMe, setAboutMe] = useState(\"\");\n  const [jobTitle, setJobTitle] = useState(\"\");\n\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user = userStr ? JSON.parse(userStr) : null;\n\n  // Fetch freelancer data\n  const { data: freelancer, isLoading } = useQuery<Freelancer>({\n    queryKey: [\"/api/freelancers\", user?.id],\n    enabled: !!user?.id,\n  });\n\n  // Populate form when data loads\n  useEffect(() => {\n    if (freelancer) {\n      setFullName(freelancer.fullName || \"\");\n      setPhone(freelancer.phone || \"\");\n      setBio(freelancer.bio || \"\");\n      setAboutMe(freelancer.aboutMe || \"\");\n      setJobTitle(freelancer.jobTitle || \"\");\n    }\n  }, [freelancer]);\n\n  // Update profile mutation\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: Partial<Freelancer>) => {\n      return await apiRequest(\"PATCH\", `/api/freelancers/${user?.id}`, data);\n    },\n    onSuccess: async (response) => {\n      // Update cache\n      queryClient.invalidateQueries({ queryKey: [\"/api/freelancers\", user?.id] });\n      \n      // Update localStorage\n      const currentUserStr = localStorage.getItem(\"user\");\n      const currentUser = currentUserStr ? JSON.parse(currentUserStr) : null;\n      \n      if (currentUser) {\n        const updatedUser = { ...currentUser, fullName, phone, bio, aboutMe, jobTitle };\n        localStorage.setItem(\"user\", JSON.stringify(updatedUser));\n        window.dispatchEvent(new Event(\"userLoggedIn\"));\n      }\n\n      toast({\n        title: \"تم التحديث\",\n        description: \"تم تحديث معلومات حسابك بنجاح\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تحديث معلوماتك\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Change password mutation\n  const changePasswordMutation = useMutation({\n    mutationFn: async (data: { currentPassword: string; newPassword: string }) => {\n      return await apiRequest(\"PATCH\", \"/api/auth/change-password\", data);\n    },\n    onSuccess: () => {\n      setCurrentPassword(\"\");\n      setNewPassword(\"\");\n      setConfirmPassword(\"\");\n      toast({\n        title: \"تم تغيير كلمة المرور\",\n        description: \"تم تحديث كلمة المرور بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء تغيير كلمة المرور\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUpdateProfile = () => {\n    if (!fullName.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء إدخال الاسم الكامل\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    updateProfileMutation.mutate({\n      fullName: fullName.trim(),\n      phone: phone.trim(),\n      bio: bio.trim(),\n      aboutMe: aboutMe.trim(),\n      jobTitle: jobTitle.trim(),\n    });\n  };\n\n  const handleChangePassword = () => {\n    if (!currentPassword || !newPassword || !confirmPassword) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء ملء جميع الحقول\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"خطأ\",\n        description: \"كلمة المرور الجديدة وتأكيدها غير متطابقين\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 6) {\n      toast({\n        title: \"خطأ\",\n        description: \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    changePasswordMutation.mutate({ currentPassword, newPassword });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">الإعدادات</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إدارة حسابك وتفضيلاتك\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        {/* Personal Information */}\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <div className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5 text-primary\" />\n              <CardTitle>المعلومات الشخصية</CardTitle>\n            </div>\n            <CardDescription>تحديث بياناتك الأساسية</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"fullName\">الاسم الكامل *</Label>\n              <Input\n                id=\"fullName\"\n                value={fullName}\n                onChange={(e) => setFullName(e.target.value)}\n                placeholder=\"أدخل اسمك الكامل\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-fullname\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={freelancer?.email || \"\"}\n                disabled\n                className=\"rounded-xl mt-1 bg-muted\"\n                data-testid=\"input-email\"\n              />\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                لا يمكن تغيير البريد الإلكتروني\n              </p>\n            </div>\n            <div>\n              <Label htmlFor=\"phone\">رقم الهاتف</Label>\n              <Input\n                id=\"phone\"\n                value={phone}\n                onChange={(e) => setPhone(e.target.value)}\n                placeholder=\"رقم الهاتف\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-phone\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"jobTitle\">المسمى الوظيفي</Label>\n              <Input\n                id=\"jobTitle\"\n                value={jobTitle}\n                onChange={(e) => setJobTitle(e.target.value)}\n                placeholder=\"مثال: مطور واجهات أمامية\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-jobtitle\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"bio\">نبذة مختصرة</Label>\n              <Textarea\n                id=\"bio\"\n                value={bio}\n                onChange={(e) => setBio(e.target.value)}\n                placeholder=\"اكتب نبذة مختصرة عنك...\"\n                className=\"rounded-xl mt-1\"\n                rows={3}\n                data-testid=\"textarea-bio\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"aboutMe\">عني</Label>\n              <Textarea\n                id=\"aboutMe\"\n                value={aboutMe}\n                onChange={(e) => setAboutMe(e.target.value)}\n                placeholder=\"اكتب تفاصيل أكثر عن خبراتك ومهاراتك...\"\n                className=\"rounded-xl mt-1\"\n                rows={4}\n                data-testid=\"textarea-aboutme\"\n              />\n            </div>\n            <Button\n              onClick={handleUpdateProfile}\n              disabled={updateProfileMutation.isPending}\n              className=\"rounded-xl w-full\"\n              data-testid=\"button-save-profile\"\n            >\n              {updateProfileMutation.isPending ? (\n                \"جاري الحفظ...\"\n              ) : (\n                <>\n                  <Save className=\"ml-2 h-4 w-4\" />\n                  حفظ التغييرات\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Security */}\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <div className=\"flex items-center gap-2\">\n              <Lock className=\"h-5 w-5 text-primary\" />\n              <CardTitle>الأمان</CardTitle>\n            </div>\n            <CardDescription>تغيير كلمة المرور</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"currentPassword\">كلمة المرور الحالية *</Label>\n              <Input\n                id=\"currentPassword\"\n                type=\"password\"\n                value={currentPassword}\n                onChange={(e) => setCurrentPassword(e.target.value)}\n                placeholder=\"أدخل كلمة المرور الحالية\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-current-password\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"newPassword\">كلمة المرور الجديدة *</Label>\n              <Input\n                id=\"newPassword\"\n                type=\"password\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                placeholder=\"أدخل كلمة مرور جديدة\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-new-password\"\n              />\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                يجب أن تكون 6 أحرف على الأقل\n              </p>\n            </div>\n            <div>\n              <Label htmlFor=\"confirmPassword\">تأكيد كلمة المرور *</Label>\n              <Input\n                id=\"confirmPassword\"\n                type=\"password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                placeholder=\"أعد إدخال كلمة المرور الجديدة\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-confirm-password\"\n              />\n            </div>\n            <Button\n              onClick={handleChangePassword}\n              disabled={changePasswordMutation.isPending}\n              variant=\"outline\"\n              className=\"rounded-xl w-full\"\n              data-testid=\"button-change-password\"\n            >\n              {changePasswordMutation.isPending ? (\n                \"جاري التحديث...\"\n              ) : (\n                <>\n                  <Lock className=\"ml-2 h-4 w-4\" />\n                  تغيير كلمة المرور\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11936},"client/src/components/ProductOwnerSidebar.tsx":{"content":"import {\n  Home,\n  FolderKanban,\n  Clock,\n  CheckCircle2,\n  CreditCard,\n  ShoppingCart,\n  Settings,\n  ChevronDown,\n  MessageCircle,\n  Bell,\n} from \"lucide-react\";\nimport { useLocation, Link } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n} from \"@/components/ui/sidebar\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\n\nconst menuItems = [\n  {\n    title: \"الرئيسية\",\n    url: \"/product-owner-dashboard\",\n    icon: Home,\n  },\n  {\n    title: \"المشاريع\",\n    icon: FolderKanban,\n    items: [\n      { title: \"جميع المشاريع\", url: \"/product-owner-dashboard/projects\" },\n      { title: \"قيد التنفيذ\", url: \"/product-owner-dashboard/projects/active\" },\n      { title: \"المكتملة\", url: \"/product-owner-dashboard/projects/completed\" },\n    ],\n  },\n  {\n    title: \"المدفوعات\",\n    url: \"/product-owner-dashboard/payments\",\n    icon: CreditCard,\n  },\n  {\n    title: \"طلباتي\",\n    url: \"/product-owner-dashboard/orders\",\n    icon: ShoppingCart,\n  },\n  {\n    title: \"المحادثات\",\n    url: \"/product-owner-dashboard/conversations\",\n    icon: MessageCircle,\n  },\n  {\n    title: \"الإشعارات\",\n    url: \"/product-owner-dashboard/notifications\",\n    icon: Bell,\n  },\n  {\n    title: \"الإعدادات\",\n    url: \"/product-owner-dashboard/settings\",\n    icon: Settings,\n  },\n];\n\nexport function ProductOwnerSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar side=\"right\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-lg font-bold text-primary\">\n            لوحة التحكم - صاحب مشروع\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => {\n                const isActive = location === item.url || location.startsWith(item.url + \"/\");\n                \n                if (item.items) {\n                  return (\n                    <Collapsible\n                      key={item.title}\n                      defaultOpen={item.items.some((subItem) => location === subItem.url)}\n                      className=\"group/collapsible\"\n                    >\n                      <SidebarMenuItem>\n                        <CollapsibleTrigger asChild>\n                          <SidebarMenuButton data-testid={`sidebar-${item.title}`}>\n                            <item.icon className=\"ml-2\" />\n                            <span>{item.title}</span>\n                            <ChevronDown className=\"mr-auto transition-transform group-data-[state=open]/collapsible:rotate-180\" />\n                          </SidebarMenuButton>\n                        </CollapsibleTrigger>\n                        <CollapsibleContent>\n                          <SidebarMenuSub>\n                            {item.items.map((subItem) => (\n                              <SidebarMenuSubItem key={subItem.title}>\n                                <SidebarMenuSubButton\n                                  asChild\n                                  isActive={location === subItem.url}\n                                  data-testid={`sidebar-sub-${subItem.title}`}\n                                >\n                                  <Link href={subItem.url}>{subItem.title}</Link>\n                                </SidebarMenuSubButton>\n                              </SidebarMenuSubItem>\n                            ))}\n                          </SidebarMenuSub>\n                        </CollapsibleContent>\n                      </SidebarMenuItem>\n                    </Collapsible>\n                  );\n                }\n\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive}\n                      data-testid={`sidebar-${item.title}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"ml-2\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":4542},"client/src/components/ProductOwnerDashboardLayout.tsx":{"content":"import { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { ProductOwnerSidebar } from \"@/components/ProductOwnerSidebar\";\n\ninterface ProductOwnerDashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function ProductOwnerDashboardLayout({ children }: ProductOwnerDashboardLayoutProps) {\n  const style = {\n    \"--sidebar-width\": \"18rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\" dir=\"rtl\">\n        <ProductOwnerSidebar />\n        <div className=\"flex flex-col flex-1\">\n          <header className=\"flex items-center p-4 border-b\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":917},"client/src/pages/freelancer-dashboard/Wallet.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Wallet as WalletIcon, TrendingUp, DollarSign } from \"lucide-react\";\nimport type { Wallet } from \"@shared/schema\";\n\nexport default function WalletPage() {\n  const { data: wallet, isLoading } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  const balance = parseFloat(wallet?.balance || \"0\");\n  const totalEarned = parseFloat(wallet?.totalEarned || \"0\");\n  const totalWithdrawn = parseFloat(wallet?.totalWithdrawn || \"0\");\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">المحفظة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تتبع أرباحك ورصيدك المتاح\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card className=\"rounded-2xl hover-elevate bg-gradient-to-br from-primary/10 to-primary/5\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                الرصيد المتاح\n              </CardTitle>\n              <WalletIcon className=\"h-5 w-5 text-primary\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold\">{balance.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              متاح للسحب\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl hover-elevate\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                إجمالي الأرباح\n              </CardTitle>\n              <TrendingUp className=\"h-5 w-5 text-green-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-green-600\">{totalEarned.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              منذ بداية الانضمام\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl hover-elevate\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                إجمالي المسحوبات\n              </CardTitle>\n              <DollarSign className=\"h-5 w-5 text-blue-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-blue-600\">{totalWithdrawn.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              إجمالي ما تم سحبه\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle>آخر المعاملات</CardTitle>\n          <CardDescription>سجل المعاملات الأخيرة</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            لا توجد معاملات حديثة\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3495},"client/src/pages/product-owner-dashboard/Settings.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { User, Mail, Save } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface ProductOwner {\n  id: string;\n  email: string;\n  fullName: string;\n}\n\nexport default function SettingsPage() {\n  const { toast } = useToast();\n  const [isEditing, setIsEditing] = useState(false);\n  const [fullName, setFullName] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user: ProductOwner | null = userStr ? JSON.parse(userStr) : null;\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: { fullName: string }) => {\n      if (!user?.id) throw new Error(\"User ID not found\");\n      const response = await apiRequest(\"PATCH\", `/api/product-owners/${user.id}`, data);\n      return { response, submittedData: data };\n    },\n    onSuccess: ({ response, submittedData }) => {\n      toast({\n        title: \"تم التحديث\",\n        description: \"تم تحديث معلومات حسابك بنجاح\",\n      });\n      setIsEditing(false);\n      // Read current user from localStorage (to avoid stale closure)\n      const currentUserStr = localStorage.getItem(\"user\");\n      const currentUser = currentUserStr ? JSON.parse(currentUserStr) : null;\n      \n      if (currentUser) {\n        // Update localStorage - use response data if available, otherwise use submitted data\n        const updatedData = response || submittedData;\n        const updatedUser = { ...currentUser, ...updatedData };\n        localStorage.setItem(\"user\", JSON.stringify(updatedUser));\n        console.log(\"Updated localStorage.user:\", updatedUser);\n        // Trigger userLoggedIn event to update Navbar\n        window.dispatchEvent(new Event(\"userLoggedIn\"));\n      }\n    },\n    onError: (error) => {\n      console.error(\"Profile update error:\", error);\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تحديث معلوماتك\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUpdateProfile = () => {\n    const newFullName = fullName.trim();\n    if (!newFullName) {\n      toast({\n        title: \"خطأ\",\n        description: \"الاسم الكامل مطلوب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateProfileMutation.mutate({ fullName: newFullName });\n  };\n\n  if (!user) {\n    return (\n      <div className=\"space-y-6\">\n        <h1 className=\"text-3xl font-bold\">الإعدادات</h1>\n        <Card>\n          <CardContent className=\"py-8\">\n            <p className=\"text-center text-muted-foreground\">\n              يرجى تسجيل الدخول أولاً\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div>\n        <h1 className=\"text-3xl font-bold\" data-testid=\"text-settings-title\">الإعدادات</h1>\n        <p className=\"text-muted-foreground\">إدارة معلومات حسابك وتفضيلاتك</p>\n      </div>\n\n      {/* Profile Information */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <User className=\"h-5 w-5\" />\n            معلومات الحساب\n          </CardTitle>\n          <CardDescription>\n            معلوماتك الشخصية الأساسية\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n            <div className=\"flex items-center gap-2\">\n              <Mail className=\"h-4 w-4 text-muted-foreground\" />\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={user.email}\n                disabled\n                className=\"bg-muted\"\n                data-testid=\"input-email\"\n              />\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              لا يمكن تغيير البريد الإلكتروني\n            </p>\n          </div>\n\n          <Separator />\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"fullName\">الاسم الكامل</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"fullName\"\n                type=\"text\"\n                value={isEditing ? fullName : user.fullName}\n                onChange={(e) => setFullName(e.target.value)}\n                disabled={!isEditing}\n                className={!isEditing ? \"bg-muted\" : \"\"}\n                data-testid=\"input-fullname\"\n              />\n              {!isEditing ? (\n                <Button\n                  onClick={() => {\n                    setIsEditing(true);\n                    setFullName(user.fullName);\n                  }}\n                  variant=\"outline\"\n                  data-testid=\"button-edit-profile\"\n                >\n                  تعديل\n                </Button>\n              ) : (\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={handleUpdateProfile}\n                    disabled={updateProfileMutation.isPending}\n                    data-testid=\"button-save-profile\"\n                  >\n                    <Save className=\"ml-2 h-4 w-4\" />\n                    {updateProfileMutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n                  </Button>\n                  <Button\n                    onClick={() => setIsEditing(false)}\n                    variant=\"outline\"\n                    data-testid=\"button-cancel-edit\"\n                  >\n                    إلغاء\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Account Type Badge */}\n      <Card>\n        <CardHeader>\n          <CardTitle>نوع الحساب</CardTitle>\n          <CardDescription>\n            معلومات عن نوع حسابك\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"px-3 py-1 bg-primary/10 text-primary rounded-md font-semibold\" data-testid=\"badge-account-type\">\n              صاحب مشروع\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6771},"client/src/pages/FreelancerInstructions.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { AlertCircle, CheckCircle2, ShieldAlert, ArrowRight, Wallet, Pin, XCircle, AlertTriangle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function FreelancerInstructions() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [agreed, setAgreed] = useState(false);\n\n  const acceptInstructionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"PATCH\", \"/api/freelancers/accept-instructions\", {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم التأكيد\",\n        description: \"تم حفظ موافقتك على التعليمات بنجاح\",\n      });\n      // Redirect to freelancer dashboard\n      setLocation(\"/freelancer-dashboard\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء حفظ الموافقة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleContinue = () => {\n    if (!agreed) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يجب الموافقة على التعليمات للمتابعة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    acceptInstructionsMutation.mutate();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background py-8 px-4\" dir=\"rtl\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <Card className=\"border-primary\">\n          <CardHeader>\n            <div className=\"flex items-center gap-3\">\n              <AlertCircle className=\"h-8 w-8 text-primary\" />\n              <div>\n                <CardTitle className=\"text-2xl\">تعليمات هامة لكل المستقلين داخل المنصة</CardTitle>\n                <CardDescription>\n                  يرجى قراءة التعليمات بعناية قبل البدء في العمل على المنصة\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Section 1: التقييمات */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              1. التقييمات – Google Map و Google Play و App Store\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2\">\n                <XCircle className=\"h-5 w-5 text-destructive\" />\n                <p className=\"font-bold text-destructive\">يُمنع تمامًا:</p>\n              </div>\n              <p className=\"mt-2\">تقييم أي خريطة Google Map أو تطبيق يحمل <strong>3.4 نجوم أو أقل</strong>.</p>\n            </div>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب عليك <strong>قراءة جميع المراجعات</strong> قبل تنفيذ أي تقييم، والتأكد من أن الشركة أو التطبيق ذو سمعة جيدة.</li>\n              <li>لا تعمل أبدًا بعشوائية أو \"بالخَش\".</li>\n              <li>لا تقم بتقييم أو رفع تقييم شركة سيئة السمعة أو لا تستحق ذلك.</li>\n              <li className=\"flex items-start gap-2 text-destructive font-semibold\">\n                <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                <span>أي مخالفة قد تؤدي لإيقاف حسابك داخل المنصة.</span>\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 2: التفاعل مع السوشيال ميديا */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-blue-500\" />\n              2. خدمة التفاعل مع منشورات السوشيال ميديا\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">قبل قبول أي طلب تفاعل، قم بالبحث عن الشركة أولًا:</p>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>سمعتها</li>\n              <li>نشاطها</li>\n              <li>تقييم العملاء السابقين</li>\n            </ul>\n\n            <div className=\"bg-amber-50 dark:bg-amber-950 border border-amber-300 dark:border-amber-700 rounded-lg p-4 mt-4\">\n              <div className=\"flex items-start gap-2 text-amber-800 dark:text-amber-200\">\n                <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                <p className=\"font-semibold\">\n                  إذا كانت الشركة سيئة السمعة أو يتعرض لها العملاء بشكاوى كثيرة، <strong>لا تقم بأي تفاعل معها</strong>.\n                </p>\n              </div>\n            </div>\n\n            <p className=\"mt-3 text-sm text-muted-foreground\">\n              <strong>الهدف:</strong> حماية المستقل والمنصة من التعامل مع جهات غير موثوقة.\n            </p>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Section 3: إخلاء المسؤولية */}\n        <Card className=\"border-amber-500\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-amber-600 dark:text-amber-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              إخلاء مسؤولية المنصة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <p>\n              نؤكد نحن كمنصّة أن <strong>هدفنا الأساسي</strong> هو دعم الشركات ذات السمعة الجيدة فعليًا، وتقديم خدمات تساعدها على الظهور بشكل أفضل، وتعزيز مكانتها الحقيقية في السوق.\n            </p>\n\n            <div className=\"bg-muted rounded-lg p-4\">\n              <p className=\"font-semibold\">\n                نحن <strong>لا نسمح بأي شكل من الأشكال</strong> بالتعامل مع شركات أو تطبيقات سيئة السمعة أو تقدم خدمات سيئة للناس، ثم يتم تحسين صورتها من خلال التقييمات أو التفاعل غير العادل.\n              </p>\n            </div>\n\n            <p className=\"font-bold text-lg mt-4\">\n              وحرصًا منّا على الأمانة والصدق أمام الله أولًا، وأمام المستخدمين ثانيًا:\n            </p>\n\n            <Card className=\"bg-primary/5 border-primary\">\n              <CardContent className=\"pt-6 space-y-3\">\n                <div className=\"flex items-center gap-2\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary\" />\n                  <p className=\"font-bold text-primary\">نحن كمنصّة نُبرئ ذمتنا أمام الله من:</p>\n                </div>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>أي تقييم يتم تنفيذه لصالح شركة سيئة السمعة أو غير مستحقة.</li>\n                  <li>أي محاولة لرفع تقييم شركة تقدم خدمات ضعيفة أو مضرة للناس.</li>\n                  <li>أي نشاط يقوم به المستقل دون التأكد من سمعة الجهة التي يتعامل معها.</li>\n                </ul>\n              </CardContent>\n            </Card>\n\n            <div className=\"mt-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                <p className=\"font-bold text-lg\">هدف المنصة الحقيقي:</p>\n              </div>\n              <p className=\"mb-2\">دعم الشركات الجيدة التي تقدم خدمة محترمة ولكن تعرضت لانخفاض تقييم بسبب:</p>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm\">\n                <li>منافسين مسيئين</li>\n                <li>حملات تشويه</li>\n                <li>سوء فهم من المستخدمين</li>\n              </ul>\n              <p className=\"mt-3\">\n                مساعدة هذه الشركات على <strong>إثبات مكانتها الحقيقية وجودة خدماتها</strong> أمام الجمهور.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 4: مسؤولية المستقل */}\n        <Card className=\"border-destructive\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-destructive\">\n              <AlertCircle className=\"h-6 w-6\" />\n              مسؤولية المستقل\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">قبل قبول أي طلب (تقييم – تفاعل – مراجعات):</p>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب عليك <strong>البحث عن الشركة جيدًا</strong>.</li>\n              <li><strong>التأكد</strong> من أنها جيدة وسمعتها محترمة.</li>\n            </ul>\n\n            <div className=\"bg-destructive/10 border-2 border-destructive rounded-lg p-4 mt-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <XCircle className=\"h-6 w-6 text-destructive\" />\n                <p className=\"font-bold text-destructive text-lg\">\n                  إذا كانت الشركة سيئة بالفعل أو لديها شكاوى حقيقية كثيرة...\n                </p>\n              </div>\n              <p className=\"font-bold text-xl mt-2 text-destructive\">\n                يُمنع تمامًا العمل معها أو تحسين تقييمها.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 5: نظام احتجاز الأموال لضمان الجودة */}\n        <Card className=\"border-blue-500 border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-blue-600 dark:text-blue-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              نظام احتجاز الأموال لضمان الجودة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <Wallet className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n                <p className=\"font-bold text-blue-800 dark:text-blue-200\">\n                  فترة احتجاز الأرباح\n                </p>\n              </div>\n              <p className=\"text-blue-900 dark:text-blue-100 leading-relaxed\">\n                يتم احتجاز الأموال في حسابك لمدة <strong>أسبوع واحد (7 أيام)</strong> بعد تنفيذ أي مهمة.\n              </p>\n            </div>\n\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Pin className=\"h-5 w-5 text-foreground\" />\n                <p className=\"font-semibold text-lg\">الهدف من فترة الاحتجاز:</p>\n              </div>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>التأكد من أن جميع التقييمات <strong>شرعية 100%</strong></li>\n                <li>التحقق من أن المهام نُفذت بواسطة <strong>أعضاء الجروب الحقيقيين</strong></li>\n                <li>حماية المنصة وأصحاب المنتجات من أي تلاعب</li>\n                <li>ضمان جودة الخدمة المقدمة</li>\n              </ul>\n            </div>\n\n            <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n                <p className=\"font-bold text-green-800 dark:text-green-200\">\n                  بعد انقضاء المدة (أسبوع واحد):\n                </p>\n              </div>\n              <p className=\"text-green-900 dark:text-green-100\">\n                يمكنك <strong>سحب الأرباح بالكامل</strong> من محفظتك إلى حسابك البنكي أو المحفظة الإلكترونية.\n              </p>\n            </div>\n\n            <div className=\"flex items-start gap-2 text-muted-foreground text-sm mt-3\">\n              <ShieldAlert className=\"h-4 w-4 flex-shrink-0 mt-0.5\" />\n              <p>هذا النظام يحمي كل من المستقلين وأصحاب المنتجات ويضمن شفافية العمليات على المنصة.</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Consent Checkbox */}\n        <Card className=\"border-primary border-2\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <Checkbox\n                id=\"agree\"\n                checked={agreed}\n                onCheckedChange={(checked) => setAgreed(checked as boolean)}\n                data-testid=\"checkbox-agree-instructions\"\n              />\n              <Label\n                htmlFor=\"agree\"\n                className=\"text-base font-semibold cursor-pointer leading-relaxed\"\n              >\n                أوافق على جميع التعليمات المذكورة أعلاه، وأتعهد بالالتزام بها بشكل كامل. وأدرك أن مخالفة هذه التعليمات قد تؤدي إلى إيقاف حسابي على المنصة.\n              </Label>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Buttons */}\n        <div className=\"flex justify-center gap-4 pb-8\">\n          <Button\n            size=\"lg\"\n            onClick={handleContinue}\n            disabled={!agreed || acceptInstructionsMutation.isPending}\n            className=\"px-8\"\n            data-testid=\"button-continue-to-dashboard\"\n          >\n            {acceptInstructionsMutation.isPending ? \"جاري الحفظ...\" : \"موافق - التالي\"}\n            <ArrowRight className=\"mr-2 h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15343},"client/src/pages/product-owner-dashboard/Projects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus, Briefcase, CheckCircle, Clock, XCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, icon: Clock },\n  accepted: { label: \"مقبول\", variant: \"default\" as const, icon: CheckCircle },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, icon: Briefcase },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, icon: CheckCircle },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, icon: XCircle },\n};\n\nexport default function ProjectsPage() {\n  const { data: projects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-3xl font-bold\">مشاريعي</h1>\n        </div>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-6 bg-muted rounded w-3/4\"></div>\n                <div className=\"h-4 bg-muted rounded w-1/2 mt-2\"></div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-4 bg-muted rounded w-full mb-2\"></div>\n                <div className=\"h-4 bg-muted rounded w-2/3\"></div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const pendingProjects = projects.filter((p) => p.status === \"pending\");\n  const activeProjects = projects.filter((p) => p.status === \"accepted\" || p.status === \"in_progress\");\n  const completedProjects = projects.filter((p) => p.status === \"completed\");\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-projects-title\">مشاريعي</h1>\n          <p className=\"text-muted-foreground\">إدارة جميع مشاريعك</p>\n        </div>\n        <Link href=\"/projects/create\">\n          <Button data-testid=\"button-create-project\">\n            <Plus className=\"ml-2 h-4 w-4\" />\n            مشروع جديد\n          </Button>\n        </Link>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">الإجمالي</CardTitle>\n            <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-projects\">{projects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-projects\">{pendingProjects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">النشطة</CardTitle>\n            <Briefcase className=\"h-4 w-4 text-blue-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-projects\">{activeProjects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-projects\">{completedProjects.length}</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Projects List */}\n      {projects.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع بعد</h3>\n            <p className=\"text-muted-foreground text-center mb-4\">\n              ابدأ بإنشاء مشروعك الأول\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                <Plus className=\"ml-2 h-4 w-4\" />\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {projects.map((project) => {\n            const config = statusConfig[project.status as keyof typeof statusConfig];\n            const StatusIcon = config?.icon || Briefcase;\n\n            return (\n              <Card key={project.id} className=\"hover-elevate\" data-testid={`card-project-${project.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <CardTitle className=\"text-lg\" data-testid={`text-project-title-${project.id}`}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge variant={config?.variant || \"secondary\"} data-testid={`badge-status-${project.id}`}>\n                      <StatusIcon className=\"ml-1 h-3 w-3\" />\n                      {config?.label || project.status}\n                    </Badge>\n                  </div>\n                  <CardDescription>{project.description}</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"text-muted-foreground\">الميزانية:</span>\n                    <span className=\"font-semibold\" data-testid={`text-budget-${project.id}`}>\n                      ${project.budget}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"text-muted-foreground\">عدد المهام:</span>\n                    <span className=\"font-semibold\" data-testid={`text-tasks-count-${project.id}`}>\n                      {project.tasksCount || 0}\n                    </span>\n                  </div>\n                  {project.createdAt && (\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"text-muted-foreground\">تاريخ الإنشاء:</span>\n                      <span className=\"text-xs\">\n                        {format(new Date(project.createdAt), \"dd MMM yyyy\", { locale: ar })}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"pt-2\">\n                    <Link href={`/projects/${project.id}`}>\n                      <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                        عرض التفاصيل\n                      </Button>\n                    </Link>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8173},"client/src/pages/product-owner-dashboard/Orders.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingBag, CheckCircle, Clock, XCircle, DollarSign } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, icon: Clock },\n  payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"default\" as const, icon: CheckCircle },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, icon: ShoppingBag },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, icon: CheckCircle },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, icon: XCircle },\n};\n\nconst serviceTypes: Record<string, string> = {\n  google_play_reviews: \"مراجعات Google Play\",\n  ios_reviews: \"مراجعات iOS\",\n  website_reviews: \"مراجعات المواقع\",\n  ux_testing: \"اختبار تجربة المستخدم\",\n  software_testing: \"اختبار البرمجيات\",\n  social_media_engagement: \"تفاعل وسائل التواصل\",\n  google_maps_reviews: \"مراجعات Google Maps\",\n};\n\nexport default function OrdersPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-3xl font-bold\">طلباتي</h1>\n        </div>\n        <div className=\"grid gap-4\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-6 bg-muted rounded w-3/4\"></div>\n                <div className=\"h-4 bg-muted rounded w-1/2 mt-2\"></div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-4 bg-muted rounded w-full mb-2\"></div>\n                <div className=\"h-4 bg-muted rounded w-2/3\"></div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\");\n  const activeOrders = orders.filter((o) => o.status === \"in_progress\");\n  const completedOrders = orders.filter((o) => o.status === \"completed\");\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-orders-title\">طلباتي</h1>\n          <p className=\"text-muted-foreground\">جميع طلبات الخدمات التي قمت بشرائها</p>\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">الإجمالي</CardTitle>\n            <ShoppingBag className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-orders\">{orders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-orders\">{pendingOrders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد التنفيذ</CardTitle>\n            <ShoppingBag className=\"h-4 w-4 text-blue-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-orders\">{activeOrders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-orders\">{completedOrders.length}</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Orders List */}\n      {orders.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <ShoppingBag className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد طلبات بعد</h3>\n            <p className=\"text-muted-foreground text-center\">\n              عندما تقوم بشراء خدمات من الجروبات، ستظهر هنا\n            </p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4\">\n          {orders.map((order) => {\n            const config = statusConfig[order.status as keyof typeof statusConfig];\n            const StatusIcon = config?.icon || ShoppingBag;\n\n            return (\n              <Card key={order.id} className=\"hover-elevate\" data-testid={`card-order-${order.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg\" data-testid={`text-order-service-${order.id}`}>\n                        {serviceTypes[order.serviceType] || order.serviceType}\n                      </CardTitle>\n                      <CardDescription>\n                        رقم الطلب: {order.id.slice(0, 8)}...\n                      </CardDescription>\n                    </div>\n                    <Badge variant={config?.variant || \"secondary\"} data-testid={`badge-status-${order.id}`}>\n                      <StatusIcon className=\"ml-1 h-3 w-3\" />\n                      {config?.label || order.status}\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">الكمية</span>\n                      <p className=\"font-semibold\" data-testid={`text-quantity-${order.id}`}>\n                        {order.quantity}\n                      </p>\n                    </div>\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">المبلغ الإجمالي</span>\n                      <div className=\"flex items-center gap-1\">\n                        <DollarSign className=\"h-4 w-4 text-green-500\" />\n                        <span className=\"font-bold text-lg\" data-testid={`text-total-${order.id}`}>\n                          ${order.totalAmount}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">طريقة الدفع</span>\n                      <p className=\"text-sm\" data-testid={`text-payment-method-${order.id}`}>\n                        {order.paymentMethod}\n                      </p>\n                    </div>\n                    {order.createdAt && (\n                      <div className=\"space-y-1\">\n                        <span className=\"text-sm text-muted-foreground\">تاريخ الطلب</span>\n                        <p className=\"text-sm\">\n                          {format(new Date(order.createdAt), \"dd MMM yyyy\", { locale: ar })}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n                  {order.paymentDetails && (\n                    <div className=\"pt-2 border-t\">\n                      <span className=\"text-sm text-muted-foreground\">تفاصيل الدفع:</span>\n                      <p className=\"text-sm mt-1\">{order.paymentDetails}</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8757},"client/src/pages/ProductOwnerInstructions.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { CheckCircle2, ShieldAlert, AlertCircle, ArrowRight, Lightbulb, AlertTriangle, XCircle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function ProductOwnerInstructions() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [agreed, setAgreed] = useState(false);\n\n  const acceptInstructionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"PATCH\", \"/api/product-owners/accept-instructions\", {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم التأكيد\",\n        description: \"تم حفظ موافقتك على الشروط والأحكام بنجاح\",\n      });\n      // Redirect to product owner dashboard\n      setLocation(\"/product-owner-dashboard\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء حفظ الموافقة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleContinue = () => {\n    if (!agreed) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يجب الموافقة على الشروط والأحكام للمتابعة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    acceptInstructionsMutation.mutate();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background py-8 px-4\" dir=\"rtl\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <Card className=\"border-primary\">\n          <CardHeader>\n            <div className=\"flex items-center gap-3\">\n              <ShieldAlert className=\"h-8 w-8 text-primary\" />\n              <div>\n                <CardTitle className=\"text-2xl\">تعليمات هامة للشركات المتعاملة مع المنصة</CardTitle>\n                <CardDescription>\n                  نرحّب بجميع الشركات التي ترغب في الاستفادة من خدمات المستقلين داخل منصّتنا، ولكن لضمان الشفافية وحماية الجميع، يجب الالتزام بالتعليمات التالية\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Section 1: الالتزام بالشفافية والسمعة الجيدة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              1. الالتزام بالشفافية والسمعة الجيدة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب أن تكون شركتك <strong>ذات سمعة جيدة</strong> في السوق.</li>\n              <li>إذا كانت لديك مشاكل حقيقية في الخدمة أو شكاوى كثيرة من العملاء، يرجى <strong>إصلاحها أولًا</strong> قبل طلب تقييمات أو تفاعل.</li>\n              <li className=\"text-destructive font-semibold\">\n                المنصّة لا تسمح لأي جهة سيئة السمعة باستخدام خدمات المستقلين لتحسين صورة غير حقيقية.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 2: عدم تقديم معلومات مضللة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-blue-500\" />\n              2. عدم تقديم معلومات مضللة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li><strong>يُمنع تقديم</strong> أي معلومات غير صحيحة أو مضللة للمستقلين.</li>\n              <li className=\"text-destructive font-semibold\">\n                أي محاولة لتزييف الحقائق أو إخفاء شكاوى العملاء ستؤدي إلى <strong>إيقاف حساب الشركة على الفور</strong>.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 3: قبول النقد البنّاء */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-amber-500\" />\n              3. قبول النقد البنّاء\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>إذا قام المستقل بقراءة المراجعات ووجد أن هناك مشاكل واضحة، <strong>يحق له رفض الطلب</strong>.</li>\n              <li>هذا الرفض <strong>لا يُعتبر إساءة</strong> بل جزء من سياسات المنصة للحفاظ على المصداقية.</li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 4: السماح للمستقل بالتحقق من الشركة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-purple-500\" />\n              4. السماح للمستقل بالتحقق من الشركة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">على الشركة أن تتفهّم أن المستقل سيقوم بـ:</p>\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>مراجعة التقييمات</li>\n              <li>الاطلاع على الشكاوى</li>\n              <li>البحث عن اسم الشركة</li>\n            </ul>\n            <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4 mt-4\">\n              <p className=\"font-semibold text-blue-800 dark:text-blue-200\">\n                هذا <strong>إجراء أساسي وضروري</strong> لحماية الطرفين.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 5: استخدام المنصة للجهات التي تستحق تحسين السمعة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              5. استخدام المنصة للجهات التي تستحق تحسين السمعة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                <p className=\"font-bold text-lg\">المنصة مخصصة لـ:</p>\n              </div>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm\">\n                <li>شركات خدمية جيدة لديها بعض المشاكل البسيطة.</li>\n                <li>شركات تضررت من هجمات منافسين أو تقييمات غير عادلة.</li>\n                <li>تطبيقات أو متاجر لديها جودة جيدة لكن تقييمها لا يعكس الحقيقة.</li>\n              </ul>\n            </div>\n\n            <div className=\"bg-destructive/10 border-2 border-destructive rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <XCircle className=\"h-5 w-5 text-destructive\" />\n                <p className=\"font-bold text-destructive\">وليست مخصصة لـ:</p>\n              </div>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm text-destructive\">\n                <li>شركات سيئة فعليًا</li>\n                <li>شركات تستغل العملاء</li>\n                <li>شركات تقدم خدمات مضرة أو تضليلية</li>\n              </ul>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 6: احترام المستقل وعدم إجباره على مهام غير شرعية */}\n        <Card className=\"border-destructive\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-destructive\">\n              <AlertCircle className=\"h-6 w-6\" />\n              6. احترام المستقل وعدم إجباره على مهام غير شرعية\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li><strong>لا يجوز مطالبة المستقل</strong> بعمل مخالف للسياسات أو للأمانة المهنية.</li>\n              <li className=\"text-destructive font-bold\">\n                أي محاولة للضغط على المستقل أو طلب رفع تقييمات لشركة سيئة ستؤدي لإيقاف حساب الشركة نهائيًا.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 7: هدف المنصة */}\n        <Card className=\"border-primary border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-primary\">\n              <CheckCircle2 className=\"h-6 w-6\" />\n              7. هدف المنصة\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-lg leading-relaxed\">\n              هدفنا هو <strong>تحسين سمعة الشركات التي تستحق فعلًا</strong>، ومساعدتها على الظهور بالشكل الصحيح، \n              وليس <span className=\"text-destructive font-bold\">\"تلميع\"</span> شركات غير جيدة أو مضللة.\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Section 8: آلية العمل وضمان التقييمات */}\n        <Card className=\"border-blue-500 border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-blue-600 dark:text-blue-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              8. آلية العمل لضمان تقييمات حقيقية\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n                <p className=\"font-bold text-green-800 dark:text-green-200 text-lg\">\n                  نوفر ضمان لمدة أسبوع\n                </p>\n              </div>\n              <p className=\"text-green-900 dark:text-green-100\">\n                إذا تم مسح التقييمات خلال أسبوع من تنفيذها، <strong>يتم استرداد كامل المبلغ إلى حسابك تلقائيًا</strong>.\n              </p>\n            </div>\n\n            <div className=\"bg-amber-50 dark:bg-amber-950 border border-amber-300 dark:border-amber-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <Lightbulb className=\"h-5 w-5 text-amber-600 dark:text-amber-400\" />\n                <p className=\"font-bold text-amber-800 dark:text-amber-200\">\n                  نصيحتنا لك لضمان بقاء التقييمات:\n                </p>\n              </div>\n              <ul className=\"space-y-2 mr-6 list-disc text-amber-900 dark:text-amber-100\">\n                <li className=\"font-semibold\">\n                  اختر مستقلين من <strong>نفس بلدك</strong>\n                </li>\n                <li>\n                  <strong>مثال:</strong> إذا كنت في مصر، اختر مستقلين من مصر لتقييم مطعمك أو شركتك\n                </li>\n                <li>\n                  <strong>مثال:</strong> إذا كنت في السعودية، اختر مستقلين من السعودية\n                </li>\n                <li className=\"flex items-start gap-2 text-amber-800 dark:text-amber-200 font-bold mt-2\">\n                  <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                  <span>هذا يقلل بشكل كبير من احتمالية مسح التقييمات من قبل المنصات (Google, App Store, إلخ)</span>\n                </li>\n              </ul>\n            </div>\n\n            <p className=\"text-muted-foreground text-sm mt-4\">\n              التقييمات من نفس المنطقة الجغرافية تبدو أكثر طبيعية ومصداقية للخوارزميات الآلية.\n            </p>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Consent Checkbox */}\n        <Card className=\"border-primary border-2\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <Checkbox\n                id=\"agree\"\n                checked={agreed}\n                onCheckedChange={(checked) => setAgreed(checked as boolean)}\n                data-testid=\"checkbox-agree-terms\"\n              />\n              <Label\n                htmlFor=\"agree\"\n                className=\"text-base font-semibold cursor-pointer leading-relaxed\"\n              >\n                أتعهد بعدم طلب تقييمات غير حقيقية، وجميع التجارب ستكون فعلية داخل المنصة. أوافق على جميع الشروط والأحكام المذكورة أعلاه، وأتعهد بالالتزام بها بشكل كامل. وأدرك أن مخالفة هذه التعليمات قد تؤدي إلى إيقاف حساب الشركة على المنصة.\n              </Label>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Button */}\n        <div className=\"flex justify-center gap-4 pb-8\">\n          <Button\n            size=\"lg\"\n            onClick={handleContinue}\n            disabled={!agreed || acceptInstructionsMutation.isPending}\n            className=\"px-8\"\n            data-testid=\"button-continue-to-dashboard\"\n          >\n            {acceptInstructionsMutation.isPending ? \"جاري الحفظ...\" : \"موافق - التالي\"}\n            <ArrowRight className=\"mr-2 h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15152},"client/src/pages/Services.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport googleMapsCard from \"@assets/generated_images/Google_Maps_Reviews_Card_d9574a88.png\";\nimport appReviewsCard from \"@assets/generated_images/App_Reviews_Card_1c7a7d75.png\";\nimport uxTestingCard from \"@assets/generated_images/UX_Testing_Card_843ea192.png\";\nimport socialMediaCard from \"@assets/generated_images/Social_Media_Engagement_Card_ced69d5b.png\";\n\nconst services = [\n  {\n    title: \"تقييمات خرائط Google Map\",\n    description: \"رفع تقييم نشاطك التجاري على الخرائط بطريقة احترافية مبنية على مخاطبة الفئة المستهدفة بذكاء.\",\n    image: googleMapsCard,\n    gradient: \"from-[#0a1628] to-[#1a2844]\",\n  },\n  {\n    title: \"تقييمات تطبيقات Android و iOS\",\n    description: \"تحسين تقييم تطبيقك عبر مراجعات حقيقية تساعد في رفع الثقة وزيادة التحميلات.\",\n    image: appReviewsCard,\n    gradient: \"from-[#1e3a8a] to-[#2563eb]\",\n  },\n  {\n    title: \"اختبار تجربة المستخدم قبل الإطلاق\",\n    description: \"تحليل شامل لتجربة المستخدم وتصميم رحلة واضحة تساعدك على نجاح مشروعك قبل طرحه للجمهور.\",\n    image: uxTestingCard,\n    gradient: \"from-[#2563eb] to-[#3b82f6]\",\n  },\n  {\n    title: \"التفاعل مع منشورات السوشيال ميديا\",\n    description: \"زيادة نسبة الوصول والمتابعة من خلال فريق متخصص بالتفاعل الحقيقي.\",\n    image: socialMediaCard,\n    gradient: \"from-[#3b82f6] to-[#60a5fa]\",\n  },\n];\n\nexport default function Services() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-[#030712]\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-16 px-4\" dir=\"rtl\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"text-center mb-12\">\n            <h1 className=\"text-4xl md:text-5xl font-bold text-white mb-4\">\n              خدماتنا المتميزة\n            </h1>\n            <p className=\"text-lg text-white/70 max-w-2xl mx-auto\">\n              نقدم مجموعة متكاملة من الخدمات الاحترافية لتحسين وجودك الرقمي\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {services.map((service, index) => (\n              <Card\n                key={index}\n                className={`bg-gradient-to-br ${service.gradient} border-none shadow-2xl rounded-3xl overflow-hidden hover-elevate transition-all duration-300`}\n                data-testid={`card-service-${index}`}\n              >\n                <CardContent className=\"p-6 flex flex-col h-full\">\n                  <div className=\"flex-1 flex flex-col items-center justify-center mb-6\">\n                    <div className=\"w-full aspect-square relative mb-6\">\n                      <img\n                        src={service.image}\n                        alt={service.title}\n                        className=\"w-full h-full object-contain\"\n                        data-testid={`img-service-${index}`}\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-4\">\n                    <h3 className=\"text-xl font-bold text-white leading-tight text-center\">\n                      {service.title}\n                    </h3>\n                    \n                    <p className=\"text-white/80 text-sm leading-relaxed text-center min-h-[4.5rem]\">\n                      {service.description}\n                    </p>\n\n                    <div className=\"flex justify-center pt-2\">\n                      <Button\n                        variant=\"outline\"\n                        className=\"border-2 border-white/80 text-white bg-transparent hover:bg-white/10 hover:border-white rounded-full px-8 py-2 font-semibold transition-all duration-300\"\n                        data-testid={`button-learn-more-${index}`}\n                      >\n                        يتعلّم أكثر\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":4528},"client/src/pages/PrivacyPolicy.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Shield, Eye, Lock, Database, AlertTriangle, CheckCircle2 } from \"lucide-react\";\n\nexport default function PrivacyPolicy() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">سياسة الخصوصية</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    نحن ملتزمون بحماية خصوصيتك وبياناتك الشخصية\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: المعلومات التي نجمعها */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-blue-600\" />\n                1. المعلومات التي نجمعها\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <p className=\"font-semibold mb-2\">المعلومات الشخصية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>الاسم الكامل</li>\n                  <li>عنوان البريد الإلكتروني</li>\n                  <li>رقم الهاتف</li>\n                  <li>البلد والمنطقة الجغرافية</li>\n                  <li>معلومات الدفع (يتم تخزينها بشكل آمن عبر بوابات الدفع المعتمدة)</li>\n                </ul>\n              </div>\n              \n              <div>\n                <p className=\"font-semibold mb-2\">المعلومات التقنية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>عنوان IP الخاص بك</li>\n                  <li>نوع المتصفح ونظام التشغيل</li>\n                  <li>سجلات النشاط على المنصة</li>\n                  <li>ملفات تعريف الارتباط (Cookies)</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: كيفية استخدام المعلومات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Eye className=\"h-6 w-6 text-green-600\" />\n                2. كيف نستخدم معلوماتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نستخدم المعلومات التي نجمعها للأغراض التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>تقديم خدماتنا وتحسينها</li>\n                <li>معالجة المعاملات المالية</li>\n                <li>التواصل معك بخصوص حسابك والخدمات</li>\n                <li>تحسين تجربة المستخدم على المنصة</li>\n                <li>منع الاحتيال وحماية أمان المنصة</li>\n                <li>الامتثال للمتطلبات القانونية</li>\n                <li>إرسال إشعارات مهمة حول المنصة</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: حماية البيانات */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Lock className=\"h-6 w-6\" />\n                3. حماية بياناتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4\">\n                <p className=\"font-semibold text-blue-800 dark:text-blue-200 mb-3\">\n                  إجراءات الأمان المتبعة:\n                </p>\n                <ul className=\"space-y-2 mr-6 list-disc text-blue-900 dark:text-blue-100\">\n                  <li>تشفير جميع البيانات الحساسة باستخدام SSL/TLS</li>\n                  <li>استخدام بوابات دفع آمنة ومعتمدة</li>\n                  <li>تخزين كلمات المرور بشكل مشفر (Hashed)</li>\n                  <li>مراقبة مستمرة للأنشطة المشبوهة</li>\n                  <li>تحديثات أمنية منتظمة للأنظمة</li>\n                  <li>الوصول المحدود للبيانات من قبل الموظفين المصرح لهم فقط</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: مشاركة المعلومات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"h-6 w-6 text-amber-600\" />\n                4. مشاركة معلوماتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحن <strong>لا نبيع</strong> معلوماتك الشخصية لأطراف ثالثة. قد نشارك معلوماتك فقط في الحالات التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>مع مزودي الخدمات:</strong> مثل بوابات الدفع ومزودي الاستضافة</li>\n                <li><strong>للامتثال القانوني:</strong> عند الطلب من الجهات الحكومية المختصة</li>\n                <li><strong>لحماية الحقوق:</strong> لحماية حقوقنا وحقوق المستخدمين الآخرين</li>\n                <li><strong>في حالة الاندماج:</strong> إذا تم الاستحواذ على الشركة أو دمجها مع شركة أخرى</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: ملفات تعريف الارتباط */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-primary\" />\n                5. ملفات تعريف الارتباط (Cookies)\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نستخدم ملفات تعريف الارتباط لتحسين تجربتك على المنصة:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>ملفات ضرورية:</strong> للحفاظ على تسجيل دخولك وتأمين جلساتك</li>\n                <li><strong>ملفات تحليلية:</strong> لفهم كيفية استخدامك للمنصة</li>\n                <li><strong>ملفات وظيفية:</strong> لتذكر تفضيلاتك وإعداداتك</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                يمكنك التحكم في ملفات تعريف الارتباط من خلال إعدادات المتصفح الخاص بك.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: حقوقك */}\n          <Card className=\"border-green-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-green-600 dark:text-green-400\">\n                <CheckCircle2 className=\"h-6 w-6\" />\n                6. حقوقك الخاصة بالبيانات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                لديك الحقوق التالية فيما يتعلق ببياناتك الشخصية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>الوصول:</strong> يمكنك طلب نسخة من بياناتك الشخصية</li>\n                <li><strong>التصحيح:</strong> يمكنك تحديث أو تصحيح معلوماتك</li>\n                <li><strong>الحذف:</strong> يمكنك طلب حذف حسابك وبياناتك</li>\n                <li><strong>الاعتراض:</strong> يمكنك الاعتراض على معالجة بياناتك لأغراض معينة</li>\n                <li><strong>نقل البيانات:</strong> يمكنك طلب نقل بياناتك إلى خدمة أخرى</li>\n                <li><strong>سحب الموافقة:</strong> يمكنك سحب موافقتك في أي وقت</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                للاستفادة من أي من هذه الحقوق، يرجى التواصل معنا عبر البريد الإلكتروني.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: الاحتفاظ بالبيانات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-primary\" />\n                7. مدة الاحتفاظ بالبيانات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بمعلوماتك الشخصية طالما كان حسابك نشطًا أو حسب الحاجة لتقديم خدماتنا. عند حذف حسابك:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>سيتم حذف بياناتك الشخصية خلال 30 يومًا</li>\n                <li>قد نحتفظ ببعض البيانات للامتثال القانوني</li>\n                <li>سيتم الاحتفاظ بسجلات المعاملات لأغراض محاسبية</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: خصوصية الأطفال */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <AlertTriangle className=\"h-6 w-6\" />\n                8. خصوصية الأطفال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                منصة سُمُوّ غير مخصصة للأشخاص تحت سن 18 عامًا. نحن لا نجمع معلومات شخصية من الأطفال عن قصد. إذا اكتشفنا أن طفلاً قد قدم معلومات شخصية، سنتخذ خطوات لحذف هذه المعلومات فورًا.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: التعديلات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Shield className=\"h-6 w-6 text-primary\" />\n                9. التعديلات على سياسة الخصوصية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                قد نقوم بتحديث سياسة الخصوصية هذه من وقت لآخر. سنخطرك بأي تغييرات جوهرية عبر البريد الإلكتروني أو من خلال إشعار على المنصة. يُنصح بمراجعة هذه الصفحة بشكل دوري للاطلاع على أي تحديثات.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6 space-y-3\">\n              <p className=\"text-center font-semibold\">\n                لأي أسئلة أو استفسارات حول سياسة الخصوصية\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground\">\n                يرجى التواصل معنا عبر البريد الإلكتروني أو من خلال نموذج الاتصال\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-4\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":13327},"client/src/pages/TermsConditions.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { FileText, CheckCircle2, XCircle, AlertTriangle } from \"lucide-react\";\n\nexport default function TermsConditions() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <FileText className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">الشروط والأحكام</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    يرجى قراءة هذه الشروط والأحكام بعناية قبل استخدام منصة سُمُوّ\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: القبول والموافقة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                1. القبول والموافقة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                باستخدامك لمنصة سُمُوّ، فإنك توافق على الالتزام بهذه الشروط والأحكام. إذا كنت لا توافق على أي جزء من هذه الشروط، يرجى عدم استخدام المنصة.\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يجب أن تكون بعمر 18 عامًا على الأقل لاستخدام المنصة</li>\n                <li>يجب تقديم معلومات دقيقة وصحيحة عند التسجيل</li>\n                <li>أنت مسؤول عن الحفاظ على سرية حسابك وكلمة المرور</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: استخدام المنصة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-blue-600\" />\n                2. استخدام المنصة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"font-semibold\">يُسمح باستخدام المنصة لـ:</p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>تحسين تقييمات المنتجات والخدمات ذات الجودة الحقيقية</li>\n                <li>اختبار تجربة المستخدم للمنتجات الرقمية</li>\n                <li>الحصول على تفاعل حقيقي على منصات التواصل الاجتماعي</li>\n                <li>تقديم خدمات مراجعة احترافية للتطبيقات والمواقع</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: الممنوعات */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                3. الممنوعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n                <p className=\"font-bold text-destructive mb-2\">يُمنع تمامًا:</p>\n                <ul className=\"space-y-2 mr-6 list-disc text-destructive\">\n                  <li>تحسين تقييم منتجات أو خدمات سيئة أو مضللة</li>\n                  <li>نشر محتوى كاذب أو مضلل</li>\n                  <li>انتحال شخصية الآخرين أو استخدام حسابات وهمية</li>\n                  <li>التلاعب بالنظام أو محاولة اختراق المنصة</li>\n                  <li>استخدام المنصة لأغراض غير قانونية</li>\n                  <li>إساءة استخدام بيانات المستخدمين الآخرين</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: حقوق الملكية الفكرية */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                4. حقوق الملكية الفكرية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                جميع الحقوق الخاصة بالمحتوى والتصميم والشعارات والعلامات التجارية على منصة سُمُوّ محفوظة. لا يجوز نسخ أو توزيع أو تعديل أي محتوى من المنصة دون إذن كتابي مسبق.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: المسؤولية */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <AlertTriangle className=\"h-6 w-6\" />\n                5. إخلاء المسؤولية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                منصة سُمُوّ هي وسيط بين المستقلين وأصحاب المنتجات. نحن غير مسؤولين عن:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>جودة الخدمات المقدمة من قبل المستقلين</li>\n                <li>صحة المعلومات المقدمة من قبل أصحاب المنتجات</li>\n                <li>أي نزاعات بين المستقلين وأصحاب المنتجات</li>\n                <li>أي خسائر مباشرة أو غير مباشرة ناتجة عن استخدام المنصة</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                المستخدم يتحمل المسؤولية الكاملة عن أفعاله واستخدامه للمنصة.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: الدفع والمعاملات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                6. الدفع والمعاملات المالية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يتم احتجاز أرباح المستقلين لمدة 7 أيام لضمان جودة الخدمة</li>\n                <li>نوفر ضمان استرداد كامل المبلغ إذا تم حذف التقييمات خلال 7 أيام</li>\n                <li>جميع الأسعار مذكورة بالدولار الأمريكي ما لم يُذكر خلاف ذلك</li>\n                <li>نحن نستخدم بوابات دفع آمنة لحماية معلوماتك المالية</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: إنهاء الحساب */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                7. إنهاء وإيقاف الحساب\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بالحق في إيقاف أو إنهاء أي حساب في الحالات التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>مخالفة أي من الشروط والأحكام</li>\n                <li>استخدام المنصة لأغراض غير قانونية أو غير أخلاقية</li>\n                <li>محاولة التلاعب بالنظام أو الاحتيال</li>\n                <li>تقديم معلومات كاذبة أو مضللة</li>\n                <li>إساءة استخدام المنصة بأي شكل من الأشكال</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: التعديلات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                8. التعديلات على الشروط\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بالحق في تعديل هذه الشروط والأحكام في أي وقت. سيتم إخطار المستخدمين بأي تغييرات جوهرية عبر البريد الإلكتروني أو من خلال إشعار على المنصة. استمرارك في استخدام المنصة بعد التعديلات يعني موافقتك على الشروط الجديدة.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: القانون الساري */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                9. القانون الساري وحل النزاعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                تخضع هذه الشروط والأحكام للقوانين المعمول بها في الدولة التي تعمل منها المنصة. في حالة نشوء أي نزاع، يتم حله عن طريق التفاوض الودي أولاً، وإذا تعذر ذلك، يتم اللجوء إلى المحاكم المختصة.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6\">\n              <p className=\"text-center text-sm text-muted-foreground\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-2\">\n                لأي استفسارات حول الشروط والأحكام، يرجى التواصل معنا عبر البريد الإلكتروني\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":11553},"client/src/pages/RefundPolicy.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Wallet, CheckCircle2, Clock, AlertTriangle, XCircle, Shield } from \"lucide-react\";\n\nexport default function RefundPolicy() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <Wallet className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">سياسة استرداد الأموال</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    نحن ملتزمون بتقديم خدمة عالية الجودة مع ضمان حقوقك المالية\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: ضمان 7 أيام */}\n          <Card className=\"border-green-500 border-2\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-green-600 dark:text-green-400\">\n                <CheckCircle2 className=\"h-6 w-6\" />\n                1. ضمان استرداد الأموال لمدة 7 أيام\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n                <p className=\"font-bold text-green-800 dark:text-green-200 mb-3\">\n                  نوفر ضمان استرداد كامل المبلغ في الحالات التالية:\n                </p>\n                <ul className=\"space-y-2 mr-6 list-disc text-green-900 dark:text-green-100\">\n                  <li>\n                    <strong>حذف التقييمات:</strong> إذا تم حذف التقييمات من قبل منصات مثل Google، App Store، أو Play Store خلال 7 أيام من تنفيذها\n                  </li>\n                  <li>\n                    <strong>عدم التنفيذ:</strong> إذا لم يتم تنفيذ الخدمة المتفق عليها خلال المدة المحددة\n                  </li>\n                  <li>\n                    <strong>خدمة غير مطابقة:</strong> إذا كانت الخدمة المقدمة لا تطابق المواصفات المتفق عليها\n                  </li>\n                </ul>\n              </div>\n              \n              <p className=\"text-sm text-muted-foreground\">\n                يتم معالجة طلبات الاسترداد خلال 3-5 أيام عمل من تاريخ التحقق من الطلب.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: نظام احتجاز الأموال للمستقلين */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Clock className=\"h-6 w-6\" />\n                2. نظام احتجاز الأموال (7 أيام)\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"leading-relaxed\">\n                لضمان جودة الخدمات وحماية أصحاب المنتجات، يتم احتجاز أرباح المستقلين لمدة <strong>7 أيام</strong> بعد إتمام المهمة:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>التأكد من أن التقييمات لا تزال موجودة ولم يتم حذفها</li>\n                <li>التحقق من أن الخدمة تمت بشكل صحيح وفقًا للمواصفات</li>\n                <li>منح فترة كافية لأصحاب المنتجات للتحقق من الجودة</li>\n                <li>حماية المنصة والمستخدمين من التلاعب أو الاحتيال</li>\n              </ul>\n              <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4 mt-3\">\n                <p className=\"text-blue-900 dark:text-blue-100\">\n                  بعد انقضاء فترة الـ 7 أيام، يمكن للمستقلين سحب أرباحهم بالكامل إلى حساباتهم البنكية أو محافظهم الإلكترونية.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: طلبات الاسترداد المؤهلة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                3. الحالات المؤهلة لاسترداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"font-semibold\">يمكنك طلب استرداد الأموال في الحالات التالية:</p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>حذف التقييمات خلال 7 أيام من التنفيذ</li>\n                <li>عدم تنفيذ المهام في الوقت المحدد (تأخير أكثر من 48 ساعة)</li>\n                <li>تقديم خدمة منخفضة الجودة أو غير احترافية</li>\n                <li>مخالفة المستقل للمواصفات المتفق عليها</li>\n                <li>مشاكل تقنية في المنصة منعت إتمام الخدمة</li>\n                <li>إلغاء الطلب قبل بدء التنفيذ</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: الحالات غير المؤهلة */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                4. الحالات غير المؤهلة لاسترداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n                <p className=\"font-bold text-destructive mb-2\">لا يمكن استرداد الأموال في الحالات التالية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc text-destructive\">\n                  <li>بعد مرور 7 أيام من تنفيذ الخدمة بنجاح</li>\n                  <li>إذا كانت المشكلة ناتجة عن معلومات خاطئة قدمها صاحب المنتج</li>\n                  <li>عدم الرضا عن النتائج دون سبب موضوعي</li>\n                  <li>تغيير رأيك بعد بدء تنفيذ المهمة</li>\n                  <li>إذا كان المنتج أو الخدمة سيئة بالفعل (تقييم أقل من 3.4 نجوم)</li>\n                  <li>استخدام الخدمة لأغراض غير قانونية أو غير أخلاقية</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: كيفية طلب الاسترداد */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Wallet className=\"h-6 w-6 text-primary\" />\n                5. كيفية طلب استرداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"font-semibold\">اتبع الخطوات التالية لطلب استرداد أموالك:</p>\n              <ol className=\"space-y-3 mr-6 list-decimal\">\n                <li>\n                  <strong>تسجيل الدخول إلى حسابك</strong>\n                  <p className=\"text-sm text-muted-foreground\">قم بتسجيل الدخول إلى لوحة التحكم الخاصة بك</p>\n                </li>\n                <li>\n                  <strong>الانتقال إلى الطلبات</strong>\n                  <p className=\"text-sm text-muted-foreground\">ابحث عن الطلب الذي تريد استرداد المال له</p>\n                </li>\n                <li>\n                  <strong>طلب الاسترداد</strong>\n                  <p className=\"text-sm text-muted-foreground\">انقر على زر \"طلب استرداد الأموال\" وحدد السبب</p>\n                </li>\n                <li>\n                  <strong>تقديم الدليل</strong>\n                  <p className=\"text-sm text-muted-foreground\">أرفق لقطات شاشة أو أي دليل يدعم طلبك</p>\n                </li>\n                <li>\n                  <strong>انتظار المراجعة</strong>\n                  <p className=\"text-sm text-muted-foreground\">سيتم مراجعة طلبك خلال 24-48 ساعة</p>\n                </li>\n              </ol>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: مدة معالجة الاسترداد */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <Clock className=\"h-6 w-6\" />\n                6. مدة معالجة طلبات الاسترداد\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>\n                  <strong>المراجعة:</strong> 24-48 ساعة من تقديم الطلب\n                </li>\n                <li>\n                  <strong>الموافقة:</strong> يتم إخطارك بالقرار عبر البريد الإلكتروني\n                </li>\n                <li>\n                  <strong>الاسترداد إلى المحفظة:</strong> فوري بعد الموافقة\n                </li>\n                <li>\n                  <strong>الاسترداد إلى البطاقة/البنك:</strong> 5-7 أيام عمل\n                </li>\n                <li>\n                  <strong>الاسترداد إلى المحافظ الإلكترونية:</strong> 1-3 أيام عمل\n                </li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: طرق الاسترداد */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Wallet className=\"h-6 w-6 text-green-600\" />\n                7. طرق استرداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                يتم استرداد الأموال بنفس طريقة الدفع الأصلية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>المحفظة داخل المنصة:</strong> استرداد فوري</li>\n                <li><strong>فودافون كاش / اتصالات كاش / أورنج كاش:</strong> 1-3 أيام</li>\n                <li><strong>بطاقة ائتمان / خصم:</strong> 5-7 أيام عمل</li>\n                <li><strong>حوالة بنكية:</strong> 3-5 أيام عمل</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: الحماية والضمان */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Shield className=\"h-6 w-6\" />\n                8. حمايتك مضمونة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحن نضمن لك:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>معالجة عادلة وشفافة لجميع طلبات الاسترداد</li>\n                <li>حماية معلوماتك المالية والشخصية</li>\n                <li>استرداد فوري في الحالات الواضحة</li>\n                <li>دعم فني متواصل للمساعدة في عملية الاسترداد</li>\n                <li>عدم فرض أي رسوم على عمليات الاسترداد</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: النزاعات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"h-6 w-6 text-amber-600\" />\n                9. حل النزاعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                في حالة رفض طلب الاسترداد:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يمكنك تقديم اعتراض مع أدلة إضافية</li>\n                <li>سيتم مراجعة الطلب من قبل فريق مختص</li>\n                <li>يمكنك التواصل مع فريق الدعم لحل ودي</li>\n                <li>في حالة عدم الوصول لحل، يمكن اللجوء للتحكيم</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6 space-y-3\">\n              <p className=\"text-center font-semibold\">\n                لأي استفسارات حول سياسة استرداد الأموال\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground\">\n                يرجى التواصل مع فريق الدعم عبر البريد الإلكتروني أو من خلال لوحة التحكم\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-4\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":14887},"client/src/pages/product-owner-dashboard/Conversations.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { MessageCircle, Send, Users } from \"lucide-react\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { Conversation, ConversationMessage } from \"@shared/schema\";\n\ntype ConversationWithDetails = Conversation & {\n  group?: {\n    id: string;\n    name: string;\n    leaderId: string;\n  };\n  leader?: {\n    id: string;\n    fullName: string;\n  };\n  productOwner?: {\n    id: string;\n    fullName: string;\n  };\n};\n\nexport default function Conversations() {\n  const { toast } = useToast();\n  const [location] = useLocation();\n  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);\n  const [messageText, setMessageText] = useState(\"\");\n\n  // Extract conversationId from query params\n  useEffect(() => {\n    const params = new URLSearchParams(location.split('?')[1] || '');\n    const conversationId = params.get('conversationId');\n    if (conversationId) {\n      setSelectedConversation(conversationId);\n    }\n  }, [location]);\n\n  // Fetch all conversations\n  const { data: conversations = [], isLoading: loadingConversations } = useQuery<ConversationWithDetails[]>({\n    queryKey: [\"/api/conversations\"],\n  });\n\n  // Fetch messages for selected conversation\n  const { data: messages = [], isLoading: loadingMessages } = useQuery<ConversationMessage[]>({\n    queryKey: [\"/api/conversations\", selectedConversation, \"messages\"],\n    enabled: !!selectedConversation,\n  });\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      return await apiRequest(\n        \"POST\",\n        `/api/conversations/${selectedConversation}/messages`,\n        { content }\n      );\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\", selectedConversation, \"messages\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\"] });\n      setMessageText(\"\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء إرسال الرسالة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSendMessage = () => {\n    if (!messageText.trim() || !selectedConversation) return;\n    sendMessageMutation.mutate(messageText);\n  };\n\n  const selectedConvData = conversations.find((c) => c.id === selectedConversation);\n\n  if (loadingConversations) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"text-muted-foreground\">جاري التحميل...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col p-4 gap-4\">\n      <div className=\"flex items-center gap-2\">\n        <MessageCircle className=\"h-6 w-6 text-primary\" />\n        <h1 className=\"text-2xl font-bold\">المحادثات</h1>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 flex-1 overflow-hidden\">\n        {/* Conversations List */}\n        <Card className=\"lg:col-span-1\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Users className=\"h-5 w-5\" />\n              قائمة المحادثات\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            <ScrollArea className=\"h-[calc(100vh-16rem)]\">\n              {conversations.length === 0 ? (\n                <div className=\"p-4 text-center text-muted-foreground\">\n                  لا توجد محادثات حالياً\n                </div>\n              ) : (\n                <div className=\"space-y-1 p-2\">\n                  {conversations.map((conv) => (\n                    <div\n                      key={conv.id}\n                      onClick={() => setSelectedConversation(conv.id)}\n                      className={`p-3 rounded-lg cursor-pointer transition-colors hover-elevate active-elevate-2 ${\n                        selectedConversation === conv.id\n                          ? \"bg-accent\"\n                          : \"\"\n                      }`}\n                      data-testid={`conversation-item-${conv.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar>\n                          <AvatarFallback>\n                            {conv.leader?.fullName?.charAt(0) || \"?\"}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-semibold truncate\">\n                            {conv.group?.name || \"جروب غير معروف\"}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground truncate\">\n                            {conv.leader?.fullName || \"قائد غير معروف\"}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n\n        {/* Chat Area */}\n        <Card className=\"lg:col-span-2\">\n          {selectedConversation && selectedConvData ? (\n            <>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <MessageCircle className=\"h-5 w-5\" />\n                  {selectedConvData.group?.name || \"جروب غير معروف\"}\n                </CardTitle>\n                <div className=\"text-sm text-muted-foreground\">\n                  محادثة مع: {selectedConvData.leader?.fullName || \"قائد غير معروف\"}\n                </div>\n              </CardHeader>\n              <Separator />\n              <CardContent className=\"p-0 flex flex-col h-[calc(100vh-20rem)]\">\n                {/* Messages */}\n                <ScrollArea className=\"flex-1 p-4\">\n                  {loadingMessages ? (\n                    <div className=\"text-center text-muted-foreground\">\n                      جاري تحميل الرسائل...\n                    </div>\n                  ) : messages.length === 0 ? (\n                    <div className=\"text-center text-muted-foreground\">\n                      لا توجد رسائل بعد. ابدأ المحادثة!\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {messages.map((msg) => {\n                        const isOwn = msg.senderType === \"product_owner\";\n                        return (\n                          <div\n                            key={msg.id}\n                            className={`flex ${isOwn ? \"justify-end\" : \"justify-start\"}`}\n                            data-testid={`message-${msg.id}`}\n                          >\n                            <div\n                              className={`max-w-[70%] rounded-lg p-3 ${\n                                isOwn\n                                  ? \"bg-primary text-primary-foreground\"\n                                  : \"bg-muted\"\n                              }`}\n                            >\n                              <div className=\"text-sm break-words\">{msg.content}</div>\n                              <div className={`text-xs mt-1 ${isOwn ? \"text-primary-foreground/70\" : \"text-muted-foreground\"}`}>\n                                {new Date(msg.createdAt).toLocaleTimeString(\"ar-EG\", {\n                                  hour: \"2-digit\",\n                                  minute: \"2-digit\",\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  )}\n                </ScrollArea>\n\n                {/* Message Input */}\n                <div className=\"p-4 border-t\">\n                  <div className=\"flex gap-2\">\n                    <Input\n                      placeholder=\"اكتب رسالتك...\"\n                      value={messageText}\n                      onChange={(e) => setMessageText(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === \"Enter\" && !e.shiftKey) {\n                          e.preventDefault();\n                          handleSendMessage();\n                        }\n                      }}\n                      data-testid=\"input-message\"\n                      className=\"flex-1\"\n                    />\n                    <Button\n                      onClick={handleSendMessage}\n                      disabled={!messageText.trim() || sendMessageMutation.isPending}\n                      data-testid=\"button-send-message\"\n                    >\n                      <Send className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </>\n          ) : (\n            <CardContent className=\"flex items-center justify-center h-full\">\n              <div className=\"text-center text-muted-foreground\">\n                <MessageCircle className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>اختر محادثة لعرضها</p>\n              </div>\n            </CardContent>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":9832},"client/src/pages/product-owner-dashboard/CompletedProjects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { CheckCircle2, Calendar, DollarSign, Users } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function CompletedProjectsPage() {\n  const { data: allProjects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  // Filter for completed projects only\n  const completedProjects = allProjects.filter((p) => p.status === \"completed\");\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-completed-projects-title\">\n            المشاريع المكتملة\n          </h1>\n          <p className=\"text-muted-foreground\">\n            المشاريع التي تم إنجازها بنجاح ({completedProjects.length})\n          </p>\n        </div>\n      </div>\n\n      {completedProjects.length === 0 ? (\n        <Card className=\"rounded-2xl\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <CheckCircle2 className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع مكتملة</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              لم تكمل أي مشاريع بعد\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {completedProjects.map((project) => (\n            <Card\n              key={project.id}\n              className=\"rounded-2xl hover-elevate\"\n              data-testid={`card-project-${project.id}`}\n            >\n              <CardHeader>\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1\">\n                    <CardTitle className=\"text-lg mb-2\" data-testid={`project-title-${project.id}`}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge variant=\"default\">\n                      <CheckCircle2 className=\"h-3 w-3 ml-1\" />\n                      مكتمل\n                    </Badge>\n                  </div>\n                  <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                </div>\n                <CardDescription className=\"line-clamp-2 mt-2\">\n                  {project.description}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <DollarSign className=\"h-4 w-4\" />\n                  <span>الميزانية: ${parseFloat(project.budget).toFixed(2)}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Users className=\"h-4 w-4\" />\n                  <span>عدد المهام: {project.tasksCount}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Calendar className=\"h-4 w-4\" />\n                  <span>\n                    تاريخ الإنشاء: {format(new Date(project.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                  </span>\n                </div>\n                {project.updatedAt && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600\">\n                    <CheckCircle2 className=\"h-4 w-4\" />\n                    <span>\n                      تاريخ الإكمال: {format(new Date(project.updatedAt), \"dd MMMM yyyy\", { locale: ar })}\n                    </span>\n                  </div>\n                )}\n                <div className=\"pt-2\">\n                  <Link href={`/projects/${project.id}`}>\n                    <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                      عرض التفاصيل\n                    </Button>\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5093},"client/src/pages/product-owner-dashboard/Payments.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CreditCard, TrendingUp, DollarSign, Calendar } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst paymentMethodLabels: Record<string, string> = {\n  vodafone_cash: \"فودافون كاش\",\n  etisalat_cash: \"اتصالات كاش\",\n  orange_cash: \"أورانج كاش\",\n  bank_card: \"بطاقة بنكية\",\n  bank_transfer: \"تحويل بنكي\",\n};\n\nconst statusLabels: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n  pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n  payment_confirmed: { label: \"تم الدفع\", variant: \"default\" },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"secondary\" },\n  completed: { label: \"مكتمل\", variant: \"default\" },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" },\n};\n\nexport default function PaymentsPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Calculate payment statistics\n  const totalPaid = orders\n    .filter((o) => o.status === \"payment_confirmed\" || o.status === \"in_progress\" || o.status === \"completed\")\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const pendingPayments = orders\n    .filter((o) => o.status === \"pending\")\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const thisMonthPayments = orders\n    .filter((o) => {\n      const orderDate = new Date(o.createdAt);\n      const now = new Date();\n      return orderDate.getMonth() === now.getMonth() && orderDate.getFullYear() === now.getFullYear();\n    })\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const stats = [\n    {\n      title: \"إجمالي المدفوعات\",\n      value: `$${totalPaid.toFixed(2)}`,\n      icon: DollarSign,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"المدفوعات المعلقة\",\n      value: `$${pendingPayments.toFixed(2)}`,\n      icon: CreditCard,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"هذا الشهر\",\n      value: `$${thisMonthPayments.toFixed(2)}`,\n      icon: Calendar,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"عدد المعاملات\",\n      value: orders.length,\n      icon: TrendingUp,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div>\n        <h1 className=\"text-3xl font-bold\" data-testid=\"text-payments-title\">المدفوعات</h1>\n        <p className=\"text-muted-foreground\">سجل جميع معاملاتك المالية</p>\n      </div>\n\n      {/* Statistics */}\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Payment History */}\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <CreditCard className=\"h-5 w-5\" />\n            سجل المعاملات\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {orders.length === 0 ? (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              <CreditCard className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n              <p>لا توجد معاملات مالية حتى الآن</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {orders\n                .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n                .map((order) => (\n                  <div\n                    key={order.id}\n                    className=\"flex items-center justify-between p-4 border rounded-xl hover-elevate\"\n                    data-testid={`payment-item-${order.id}`}\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <h3 className=\"font-semibold\" data-testid={`payment-id-${order.id}`}>\n                          #{order.id.slice(0, 8)}\n                        </h3>\n                        <Badge variant={statusLabels[order.status]?.variant || \"outline\"}>\n                          {statusLabels[order.status]?.label || order.status}\n                        </Badge>\n                      </div>\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                        <span className=\"flex items-center gap-1\">\n                          <CreditCard className=\"h-4 w-4\" />\n                          {paymentMethodLabels[order.paymentMethod] || order.paymentMethod}\n                        </span>\n                        <span className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-4 w-4\" />\n                          {format(new Date(order.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                        </span>\n                        <span>\n                          الكمية: {order.quantity}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"text-left\">\n                      <div className=\"text-2xl font-bold text-green-600\" data-testid={`payment-amount-${order.id}`}>\n                        ${parseFloat(order.totalAmount).toFixed(2)}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7007},"client/src/pages/product-owner-dashboard/ActiveProjects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Briefcase, Calendar, DollarSign, Users } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function ActiveProjectsPage() {\n  const { data: allProjects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  // Filter for active projects only\n  const activeProjects = allProjects.filter(\n    (p) => p.status === \"accepted\" || p.status === \"in_progress\"\n  );\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-active-projects-title\">\n            المشاريع النشطة\n          </h1>\n          <p className=\"text-muted-foreground\">\n            المشاريع قيد التنفيذ حالياً ({activeProjects.length})\n          </p>\n        </div>\n        <Link href=\"/projects/create\">\n          <Button data-testid=\"button-create-project\">\n            إنشاء مشروع جديد\n          </Button>\n        </Link>\n      </div>\n\n      {activeProjects.length === 0 ? (\n        <Card className=\"rounded-2xl\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع نشطة</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              ليس لديك مشاريع قيد التنفيذ في الوقت الحالي\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {activeProjects.map((project) => {\n            const statusConfig = {\n              accepted: { label: \"مقبول\", variant: \"default\" as const },\n              in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const },\n            };\n\n            const status = statusConfig[project.status as keyof typeof statusConfig];\n\n            return (\n              <Card\n                key={project.id}\n                className=\"rounded-2xl hover-elevate\"\n                data-testid={`card-project-${project.id}`}\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg mb-2\" data-testid={`project-title-${project.id}`}>\n                        {project.title}\n                      </CardTitle>\n                      {status && (\n                        <Badge variant={status.variant}>\n                          {status.label}\n                        </Badge>\n                      )}\n                    </div>\n                    <Briefcase className=\"h-5 w-5 text-muted-foreground\" />\n                  </div>\n                  <CardDescription className=\"line-clamp-2 mt-2\">\n                    {project.description}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <DollarSign className=\"h-4 w-4\" />\n                    <span>الميزانية: ${parseFloat(project.budget).toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Users className=\"h-4 w-4\" />\n                    <span>عدد المهام: {project.tasksCount}</span>\n                  </div>\n                  {project.deadline && (\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                      <Calendar className=\"h-4 w-4\" />\n                      <span>\n                        الموعد النهائي: {format(new Date(project.deadline), \"dd MMMM yyyy\", { locale: ar })}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Calendar className=\"h-4 w-4\" />\n                    <span>\n                      تاريخ الإنشاء: {format(new Date(project.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                    </span>\n                  </div>\n                  <div className=\"pt-2\">\n                    <Link href={`/projects/${project.id}`}>\n                      <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                        عرض التفاصيل\n                      </Button>\n                    </Link>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5774},"client/src/pages/ProjectDetails.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useParams, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  ArrowRight, \n  Calendar, \n  DollarSign, \n  Briefcase, \n  CheckCircle2, \n  Clock, \n  Plus,\n  User,\n  ListTodo\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Project, Task } from \"@shared/schema\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, color: \"text-yellow-600\" },\n  accepted: { label: \"مقبول\", variant: \"default\" as const, color: \"text-blue-600\" },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, color: \"text-purple-600\" },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, color: \"text-green-600\" },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, color: \"text-red-600\" },\n};\n\nconst taskStatusConfig = {\n  available: { label: \"متاحة\", variant: \"secondary\" as const },\n  assigned: { label: \"معينة\", variant: \"default\" as const },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const },\n  submitted: { label: \"مسلمة\", variant: \"default\" as const },\n  approved: { label: \"مقبولة\", variant: \"default\" as const },\n  rejected: { label: \"مرفوضة\", variant: \"destructive\" as const },\n};\n\nexport default function ProjectDetails() {\n  const { id } = useParams();\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [showCreateTask, setShowCreateTask] = useState(false);\n  const [taskTitle, setTaskTitle] = useState(\"\");\n  const [taskDescription, setTaskDescription] = useState(\"\");\n  const [taskReward, setTaskReward] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user = userStr ? JSON.parse(userStr) : null;\n  const userType = localStorage.getItem(\"userType\");\n\n  // Fetch project details\n  const { data: project, isLoading: projectLoading } = useQuery<Project>({\n    queryKey: [\"/api/projects\", id],\n    enabled: !!id,\n  });\n\n  // Fetch tasks for this project\n  const { data: tasks = [], isLoading: tasksLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\", \"project\", id],\n    enabled: !!id,\n  });\n\n  // Create task mutation\n  const createTaskMutation = useMutation({\n    mutationFn: async (data: { title: string; description: string; reward: string }) => {\n      return await apiRequest(\"POST\", \"/api/tasks\", {\n        ...data,\n        projectId: id,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks\", \"project\", id] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", id] });\n      setShowCreateTask(false);\n      setTaskTitle(\"\");\n      setTaskDescription(\"\");\n      setTaskReward(\"\");\n      toast({\n        title: \"تم إنشاء المهمة\",\n        description: \"تم إنشاء المهمة بنجاح ويمكن للأعضاء الآن قبولها\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateTask = () => {\n    if (!taskTitle.trim() || !taskDescription.trim() || !taskReward) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء ملء جميع الحقول المطلوبة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const rewardNumber = parseFloat(taskReward);\n    if (isNaN(rewardNumber) || rewardNumber <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء إدخال مكافأة صحيحة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createTaskMutation.mutate({\n      title: taskTitle,\n      description: taskDescription,\n      reward: rewardNumber.toString(),\n    });\n  };\n\n  if (projectLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!project) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Card className=\"w-full max-w-md\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">المشروع غير موجود</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              لم نتمكن من العثور على المشروع المطلوب\n            </p>\n            <Button onClick={() => navigate(\"/projects\")}>\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للمشاريع\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const config = statusConfig[project.status as keyof typeof statusConfig];\n  const availableTasks = tasks.filter((t) => t.status === \"available\");\n  const assignedTasks = tasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\");\n  const submittedTasks = tasks.filter((t) => t.status === \"submitted\");\n  const completedTasks = tasks.filter((t) => t.status === \"approved\");\n\n  // Check if user is the project leader (using acceptedByGroupId instead of groupId)\n  const isLeader = userType === \"freelancer\" && project.acceptedByGroupId;\n\n  return (\n    <div className=\"container max-w-6xl mx-auto py-8 px-4\" dir=\"rtl\">\n      {/* Back Button */}\n      <Button\n        variant=\"ghost\"\n        onClick={() => navigate(\"/projects\")}\n        className=\"mb-6\"\n        data-testid=\"button-back\"\n      >\n        <ArrowRight className=\"ml-2 h-4 w-4\" />\n        العودة للمشاريع\n      </Button>\n\n      {/* Project Header */}\n      <Card className=\"mb-6 rounded-2xl\">\n        <CardHeader>\n          <div className=\"flex items-start justify-between gap-4\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-3 mb-2\">\n                <CardTitle className=\"text-3xl\" data-testid=\"text-project-title\">\n                  {project.title}\n                </CardTitle>\n                <Badge variant={config.variant} data-testid=\"badge-status\">\n                  {config.label}\n                </Badge>\n              </div>\n              <CardDescription className=\"text-base mt-2\">\n                {project.description}\n              </CardDescription>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-green-50 dark:bg-green-950/30\">\n                <DollarSign className=\"h-5 w-5 text-green-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">الميزانية</p>\n                <p className=\"text-lg font-bold text-green-600\" data-testid=\"text-budget\">\n                  {parseFloat(project.budget as string).toLocaleString()} ر.س\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-blue-50 dark:bg-blue-950/30\">\n                <ListTodo className=\"h-5 w-5 text-blue-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">عدد المهام</p>\n                <p className=\"text-lg font-bold\" data-testid=\"text-tasks-count\">\n                  {tasks.length}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-purple-50 dark:bg-purple-950/30\">\n                <Calendar className=\"h-5 w-5 text-purple-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">تاريخ الإنشاء</p>\n                <p className=\"text-sm font-semibold\">\n                  {format(new Date(project.createdAt), \"d MMMM yyyy\", { locale: ar })}\n                </p>\n              </div>\n            </div>\n\n            {project.acceptedByGroupId && (\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-xl bg-yellow-50 dark:bg-yellow-950/30\">\n                  <User className=\"h-5 w-5 text-yellow-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">معين لجروب</p>\n                  <p className=\"text-sm font-semibold\">\n                    نعم\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tasks Section */}\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">المهام ({tasks.length})</h2>\n          {isLeader && project.status !== \"completed\" && (\n            <Button onClick={() => setShowCreateTask(true)} data-testid=\"button-create-task\">\n              <Plus className=\"ml-2 h-4 w-4\" />\n              إنشاء مهمة جديدة\n            </Button>\n          )}\n        </div>\n\n        {/* Task Stats */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-yellow-600\">{availableTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">متاحة</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-blue-600\">{assignedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">قيد التنفيذ</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-purple-600\">{submittedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">مسلمة</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-green-600\">{completedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">مكتملة</p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tasks List */}\n        {tasksLoading ? (\n          <div className=\"grid gap-4\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"animate-pulse rounded-xl\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"h-20 bg-muted rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : tasks.length === 0 ? (\n          <Card className=\"rounded-2xl\">\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <ListTodo className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد مهام</h3>\n              <p className=\"text-muted-foreground text-center mb-6\">\n                لم يتم إنشاء أي مهام لهذا المشروع بعد\n              </p>\n              {isLeader && (\n                <Button onClick={() => setShowCreateTask(true)} data-testid=\"button-create-first-task\">\n                  <Plus className=\"ml-2 h-4 w-4\" />\n                  إنشاء أول مهمة\n                </Button>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-4\">\n            {tasks.map((task) => {\n              const taskConfig = taskStatusConfig[task.status as keyof typeof taskStatusConfig];\n              return (\n                <Card key={task.id} className=\"rounded-xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                          <Badge variant={taskConfig.variant}>\n                            {taskConfig.label}\n                          </Badge>\n                        </div>\n                        <CardDescription>{task.description}</CardDescription>\n                      </div>\n                      <div className=\"text-left\">\n                        <p className=\"text-sm text-muted-foreground\">المكافأة</p>\n                        <p className=\"text-xl font-bold text-green-600\">\n                          {task.reward} ر.س\n                        </p>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  {task.freelancerId && (\n                    <CardContent>\n                      <Separator className=\"mb-4\" />\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                        <User className=\"h-4 w-4\" />\n                        <span>معينة لمستقل</span>\n                      </div>\n                    </CardContent>\n                  )}\n                </Card>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Create Task Dialog */}\n      <Dialog open={showCreateTask} onOpenChange={setShowCreateTask}>\n        <DialogContent data-testid=\"dialog-create-task\">\n          <DialogHeader>\n            <DialogTitle>إنشاء مهمة جديدة</DialogTitle>\n            <DialogDescription>\n              أنشئ مهمة جديدة وسيتمكن أعضاء الجروب من قبولها\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"task-title\">عنوان المهمة *</Label>\n              <Input\n                id=\"task-title\"\n                value={taskTitle}\n                onChange={(e) => setTaskTitle(e.target.value)}\n                placeholder=\"مثال: مراجعة التطبيق على Google Play\"\n                data-testid=\"input-task-title\"\n              />\n            </div>\n\n            <div>\n              <Label htmlFor=\"task-description\">وصف المهمة *</Label>\n              <Textarea\n                id=\"task-description\"\n                value={taskDescription}\n                onChange={(e) => setTaskDescription(e.target.value)}\n                placeholder=\"اشرح تفاصيل المهمة والمتطلبات...\"\n                rows={4}\n                data-testid=\"textarea-task-description\"\n              />\n            </div>\n\n            <div>\n              <Label htmlFor=\"task-reward\">المكافأة (ر.س) *</Label>\n              <Input\n                id=\"task-reward\"\n                type=\"number\"\n                value={taskReward}\n                onChange={(e) => setTaskReward(e.target.value)}\n                placeholder=\"مثال: 50\"\n                data-testid=\"input-task-reward\"\n              />\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowCreateTask(false)}\n              data-testid=\"button-cancel-task\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleCreateTask}\n              disabled={createTaskMutation.isPending}\n              data-testid=\"button-submit-task\"\n            >\n              {createTaskMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء المهمة\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17226},"client/src/pages/freelancer-dashboard/Conversations.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { MessageCircle, Send, Building2 } from \"lucide-react\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport type { Conversation, ConversationMessage } from \"@shared/schema\";\n\ntype ConversationWithDetails = Conversation & {\n  group?: {\n    id: string;\n    name: string;\n    leaderId: string;\n  };\n  productOwner?: {\n    id: string;\n    fullName: string;\n  };\n};\n\nexport default function FreelancerConversations() {\n  const { toast } = useToast();\n  const [location] = useLocation();\n  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);\n  const [messageText, setMessageText] = useState(\"\");\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  // Extract conversationId from query params\n  useEffect(() => {\n    const params = new URLSearchParams(location.split('?')[1] || '');\n    const conversationId = params.get('conversationId');\n    if (conversationId) {\n      setSelectedConversation(conversationId);\n    }\n  }, [location]);\n\n  // Fetch all conversations\n  const { data: conversations = [], isLoading: loadingConversations } = useQuery<ConversationWithDetails[]>({\n    queryKey: [\"/api/conversations\"],\n  });\n\n  // Fetch messages for selected conversation\n  const { data: messages = [], isLoading: loadingMessages } = useQuery<ConversationMessage[]>({\n    queryKey: [\"/api/conversations\", selectedConversation, \"messages\"],\n    enabled: !!selectedConversation,\n  });\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      return await apiRequest(\n        \"POST\",\n        `/api/conversations/${selectedConversation}/messages`,\n        { content }\n      );\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\", selectedConversation, \"messages\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\"] });\n      setMessageText(\"\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء إرسال الرسالة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSendMessage = () => {\n    if (messageText.trim() && selectedConversation) {\n      sendMessageMutation.mutate(messageText);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const selectedConvData = conversations.find((c) => c.id === selectedConversation);\n\n  if (loadingConversations) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center gap-2\">\n        <MessageCircle className=\"h-6 w-6 text-primary\" />\n        <h1 className=\"text-2xl font-bold\">المحادثات</h1>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 h-[calc(100vh-12rem)]\">\n        {/* Conversations List */}\n        <Card className=\"lg:col-span-1 rounded-2xl\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Building2 className=\"h-5 w-5\" />\n              قائمة المحادثات\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            <ScrollArea className=\"h-[calc(100vh-18rem)]\">\n              {conversations.length === 0 ? (\n                <div className=\"p-4 text-center text-muted-foreground\">\n                  لا توجد محادثات حالياً\n                </div>\n              ) : (\n                <div className=\"space-y-1 p-2\">\n                  {conversations.map((conv) => (\n                    <div\n                      key={conv.id}\n                      onClick={() => setSelectedConversation(conv.id)}\n                      className={`p-3 rounded-lg cursor-pointer transition-colors hover-elevate active-elevate-2 ${\n                        selectedConversation === conv.id\n                          ? \"bg-accent\"\n                          : \"\"\n                      }`}\n                      data-testid={`conversation-item-${conv.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar>\n                          <AvatarFallback>\n                            {conv.productOwner?.fullName?.charAt(0) || \"?\"}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-semibold truncate\">\n                            {conv.productOwner?.fullName || \"صاحب منتج\"}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground truncate\">\n                            {conv.group?.name || \"جروب غير معروف\"}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n\n        {/* Chat Area */}\n        <Card className=\"lg:col-span-2 rounded-2xl flex flex-col\">\n          {selectedConversation && selectedConvData ? (\n            <>\n              <CardHeader className=\"border-b\">\n                <div className=\"flex items-center gap-3\">\n                  <Avatar>\n                    <AvatarFallback>\n                      {selectedConvData.productOwner?.fullName?.charAt(0) || \"?\"}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div>\n                    <CardTitle className=\"text-lg\">\n                      {selectedConvData.productOwner?.fullName || \"صاحب منتج\"}\n                    </CardTitle>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedConvData.group?.name || \"جروب غير معروف\"}\n                    </p>\n                  </div>\n                </div>\n              </CardHeader>\n\n              <CardContent className=\"flex-1 flex flex-col p-0\">\n                {/* Messages Area */}\n                <ScrollArea className=\"flex-1 p-4\">\n                  {loadingMessages ? (\n                    <div className=\"flex items-center justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n                    </div>\n                  ) : messages.length === 0 ? (\n                    <div className=\"flex items-center justify-center py-8 text-muted-foreground\">\n                      لا توجد رسائل بعد. ابدأ المحادثة الآن!\n                    </div>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {messages.map((message) => {\n                        const isOwn = message.senderType === \"freelancer\";\n                        return (\n                          <div\n                            key={message.id}\n                            className={`flex ${isOwn ? \"justify-start\" : \"justify-end\"}`}\n                            data-testid={`message-${message.id}`}\n                          >\n                            <div\n                              className={`max-w-[70%] rounded-2xl px-4 py-3 ${\n                                isOwn\n                                  ? \"bg-primary text-primary-foreground\"\n                                  : \"bg-muted\"\n                              }`}\n                            >\n                              <p className=\"text-sm whitespace-pre-wrap break-words\">\n                                {message.content}\n                              </p>\n                              <p\n                                className={`text-xs mt-1 ${\n                                  isOwn\n                                    ? \"text-primary-foreground/70\"\n                                    : \"text-muted-foreground\"\n                                }`}\n                              >\n                                {format(new Date(message.createdAt), \"h:mm a\", { locale: ar })}\n                              </p>\n                            </div>\n                          </div>\n                        );\n                      })}\n                      <div ref={messagesEndRef} />\n                    </div>\n                  )}\n                </ScrollArea>\n\n                {/* Message Input */}\n                <div className=\"border-t p-4\">\n                  <div className=\"flex gap-2\">\n                    <Input\n                      value={messageText}\n                      onChange={(e) => setMessageText(e.target.value)}\n                      onKeyPress={handleKeyPress}\n                      placeholder=\"اكتب رسالتك هنا...\"\n                      disabled={sendMessageMutation.isPending}\n                      data-testid=\"input-message\"\n                    />\n                    <Button\n                      onClick={handleSendMessage}\n                      disabled={!messageText.trim() || sendMessageMutation.isPending}\n                      size=\"icon\"\n                      data-testid=\"button-send\"\n                    >\n                      <Send className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </>\n          ) : (\n            <CardContent className=\"flex items-center justify-center h-full\">\n              <div className=\"text-center text-muted-foreground\">\n                <MessageCircle className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>اختر محادثة لعرضها</p>\n              </div>\n            </CardContent>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10797},"client/src/pages/ChatWithLeader.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { \n  ArrowRight, \n  MapPin, \n  Clock, \n  Phone, \n  MessageCircle, \n  Send, \n  Star,\n  ShieldAlert,\n  CheckCircle2,\n  AlertTriangle,\n  Lightbulb\n} from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group, Freelancer, Conversation, ConversationMessage } from \"@shared/schema\";\n\nexport default function ChatWithLeader() {\n  const params = useParams();\n  const groupId = params.id as string;\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [messageContent, setMessageContent] = useState(\"\");\n  const [conversationId, setConversationId] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  \n  // Verify user authentication from backend\n  const { data: currentUser, isLoading: userLoading } = useQuery<any>({\n    queryKey: [\"/api/auth/user\"],\n  });\n\n  const isProductOwner = currentUser?.userType === \"product_owner\";\n\n  // Fetch group details\n  const { data: group, isLoading: groupLoading } = useQuery<Group>({\n    queryKey: [\"/api/groups\", groupId],\n    enabled: !!currentUser,\n  });\n\n  // Fetch leader details\n  const { data: leader } = useQuery<Freelancer>({\n    queryKey: [\"/api/freelancers\", group?.leaderId],\n    enabled: !!group?.leaderId,\n  });\n\n  // Get or create conversation\n  const getConversationMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/conversations\", { groupId });\n      return await res.json();\n    },\n    onSuccess: (data: Conversation) => {\n      setConversationId(data.id);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المحادثة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Fetch messages\n  const { data: messages = [] } = useQuery<ConversationMessage[]>({\n    queryKey: [\"/api/conversations\", conversationId, \"messages\"],\n    enabled: !!conversationId,\n    refetchInterval: 3000, // Refresh every 3 seconds\n  });\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      if (!conversationId) throw new Error(\"لا توجد محادثة\");\n      const res = await apiRequest(\"POST\", `/api/conversations/${conversationId}/messages`, { content });\n      return await res.json();\n    },\n    onSuccess: () => {\n      setMessageContent(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\", conversationId, \"messages\"] });\n      scrollToBottom();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إرسال الرسالة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  useEffect(() => {\n    if (group && isProductOwner && !conversationId && !getConversationMutation.isPending) {\n      getConversationMutation.mutate();\n    }\n  }, [group, isProductOwner]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  const handleSendMessage = () => {\n    if (!messageContent.trim() || sendMessageMutation.isPending) return;\n    sendMessageMutation.mutate(messageContent);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  if (userLoading || groupLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card className=\"animate-pulse\">\n            <CardContent className=\"py-12\">\n              <div className=\"h-64 bg-muted rounded\" />\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  if (!currentUser || !isProductOwner || !group) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <MessageCircle className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">\n                {!currentUser ? \"يجب تسجيل الدخول\" : \"غير متاح\"}\n              </h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                {!currentUser \n                  ? \"الرجاء تسجيل الدخول للوصول لهذه الصفحة\" \n                  : \"هذه الصفحة متاحة لأصحاب المنتجات فقط\"}\n              </p>\n              <Button \n                onClick={() => navigate(\"/groups\")}\n                data-testid=\"button-back-to-groups\"\n              >\n                العودة للجروبات\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-6\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(`/groups/${groupId}`)}\n          className=\"mb-4\"\n          data-testid=\"button-back\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة لتفاصيل الجروب\n        </Button>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Leader Profile Card - Right Side */}\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-6 z-50\">\n              <CardContent className=\"pt-6\">\n                {/* Leader Avatar and Name */}\n                <div className=\"flex flex-col items-center text-center mb-6\">\n                  <Avatar className=\"h-20 w-20 mb-3\">\n                    <AvatarImage src={leader?.profileImage || undefined} />\n                    <AvatarFallback className=\"text-2xl\">\n                      {leader?.fullName?.charAt(0) || \"ق\"}\n                    </AvatarFallback>\n                  </Avatar>\n                  <h2 className=\"text-xl font-bold mb-1\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                    {leader?.fullName || \"قائد الجروب\"}\n                  </h2>\n                  <Badge variant=\"default\" className=\"mb-2\">\n                    متصل\n                  </Badge>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Service Info */}\n                <div className=\"space-y-4\">\n                  <div>\n                    <p className=\"text-sm font-semibold text-muted-foreground mb-2\">الخدمة المطلوبة</p>\n                    <Badge variant=\"outline\" className=\"w-full justify-center py-2\">\n                      {group.name}\n                    </Badge>\n                  </div>\n\n                  {/* Rating */}\n                  <div>\n                    <p className=\"text-sm font-semibold text-muted-foreground mb-2\">التقييم</p>\n                    <div className=\"flex items-center justify-center gap-1\">\n                      <div className=\"flex gap-0.5\">\n                        {[1, 2, 3, 4, 5].map((star) => (\n                          <Star\n                            key={star}\n                            className=\"h-4 w-4 fill-yellow-400 text-yellow-400\"\n                          />\n                        ))}\n                      </div>\n                      <span className=\"text-sm font-bold mr-2\">4.8</span>\n                    </div>\n                  </div>\n\n                  {/* Location */}\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center text-muted-foreground\">\n                      <MapPin className=\"ml-2 h-4 w-4\" />\n                      <span className=\"text-sm\">الموقع</span>\n                    </div>\n                    <span className=\"text-sm font-semibold\">\n                      القاهرة\n                    </span>\n                  </div>\n\n                  {/* Response Time */}\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center text-green-600\">\n                      <Clock className=\"ml-2 h-4 w-4\" />\n                      <span className=\"text-sm\">وقت الاستجابة</span>\n                    </div>\n                    <span className=\"text-sm font-semibold text-green-600\">\n                      خلال دقائق\n                    </span>\n                  </div>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Safety Guidelines */}\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start gap-2\">\n                    <ShieldAlert className=\"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                    <p className=\"text-xs text-muted-foreground leading-relaxed\">\n                      إرشادات الأمان\n                    </p>\n                  </div>\n                  \n                  <div className=\"space-y-2 text-xs text-muted-foreground\">\n                    <div className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"h-3 w-3 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <p>لا تشارك معلومات شخصية حساسة</p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <AlertTriangle className=\"h-3 w-3 text-amber-600 mt-0.5 flex-shrink-0\" />\n                      <p>تأكد من متطلبات المشروع قبل البدء</p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Lightbulb className=\"h-3 w-3 text-blue-600 mt-0.5 flex-shrink-0\" />\n                      <p>استخدم وسائل الدفع الآمنة عبر المنصة</p>\n                    </div>\n                  </div>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Action Buttons */}\n                <div className=\"space-y-2\">\n                  <Button\n                    variant=\"outline\"\n                    className=\"w-full\"\n                    onClick={() => {\n                      toast({\n                        title: \"قريباً\",\n                        description: \"هذه الميزة ستكون متاحة قريباً\",\n                      });\n                    }}\n                    data-testid=\"button-voice-call\"\n                  >\n                    <Phone className=\"ml-2 h-4 w-4\" />\n                    طلب محادثة شفهية\n                  </Button>\n                  \n                  <Button\n                    className=\"w-full\"\n                    disabled\n                    data-testid=\"button-chat-active\"\n                  >\n                    <MessageCircle className=\"ml-2 h-4 w-4\" />\n                    المحادثة النصية نشطة\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Chat Area - Left Side */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"h-[calc(100vh-200px)] flex flex-col\">\n              <CardHeader className=\"border-b\">\n                <CardTitle className=\"text-xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  محادثة مع {leader?.fullName || \"قائد الجروب\"}\n                </CardTitle>\n                <CardDescription>\n                  {group.name}\n                </CardDescription>\n              </CardHeader>\n\n              {/* Messages Area */}\n              <CardContent className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n                {!conversationId ? (\n                  <div className=\"flex items-center justify-center h-full\">\n                    <div className=\"text-center text-muted-foreground\">\n                      <MessageCircle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground/50\" />\n                      <p>جاري تحميل المحادثة...</p>\n                    </div>\n                  </div>\n                ) : messages.length === 0 ? (\n                  <div className=\"flex items-center justify-center h-full\">\n                    <div className=\"text-center text-muted-foreground\">\n                      <MessageCircle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground/50\" />\n                      <p>ابدأ المحادثة بإرسال رسالة</p>\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    {messages.map((message) => {\n                      const isOwn = message.senderType === \"product_owner\";\n                      \n                      return (\n                        <div\n                          key={message.id}\n                          className={`flex ${isOwn ? \"justify-end\" : \"justify-start\"}`}\n                          data-testid={`message-${message.id}`}\n                        >\n                          <div\n                            className={`max-w-[70%] rounded-2xl px-4 py-3 ${\n                              isOwn\n                                ? \"bg-primary text-primary-foreground\"\n                                : \"bg-muted\"\n                            }`}\n                          >\n                            {!isOwn && (\n                              <p className=\"text-xs font-semibold mb-1 text-muted-foreground\">\n                                {leader?.fullName || \"قائد الجروب\"}\n                              </p>\n                            )}\n                            <p className=\"text-sm leading-relaxed\">{message.content}</p>\n                            <p className={`text-xs mt-1 ${isOwn ? \"text-primary-foreground/70\" : \"text-muted-foreground\"}`}>\n                              {new Date(message.createdAt).toLocaleTimeString(\"ar\", {\n                                hour: \"2-digit\",\n                                minute: \"2-digit\",\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      );\n                    })}\n                    <div ref={messagesEndRef} />\n                  </>\n                )}\n              </CardContent>\n\n              {/* Message Input */}\n              <div className=\"border-t p-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"اكتب رسالتك هنا...\"\n                    value={messageContent}\n                    onChange={(e) => setMessageContent(e.target.value)}\n                    onKeyPress={handleKeyPress}\n                    disabled={!conversationId || sendMessageMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"input-message\"\n                  />\n                  <Button\n                    onClick={handleSendMessage}\n                    disabled={!messageContent.trim() || !conversationId || sendMessageMutation.isPending}\n                    size=\"icon\"\n                    data-testid=\"button-send\"\n                  >\n                    <Send className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":16119},"client/src/pages/freelancer-dashboard/Notifications.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2, AlertCircle, DollarSign, ClipboardList, MessageCircle, Users, Package, Wallet as WalletIcon } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport default function FreelancerNotifications() {\n  // Fetch notifications\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"PATCH\", `/api/notifications/${id}/read`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"PATCH\", \"/api/notifications/mark-all-read\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case \"task_assigned\":\n      case \"task_approved\":\n      case \"task_rejected\":\n      case \"task_rejected_by_leader\":\n        return <ClipboardList className=\"h-5 w-5 text-primary\" />;\n      case \"payment_received\":\n      case \"withdrawal_approved\":\n      case \"withdrawal_rejected\":\n        return <DollarSign className=\"h-5 w-5 text-green-600\" />;\n      case \"new_message\":\n        return <MessageCircle className=\"h-5 w-5 text-blue-600\" />;\n      case \"group_member_joined\":\n      case \"group_member_removed\":\n        return <Users className=\"h-5 w-5 text-purple-600\" />;\n      case \"order_created\":\n      case \"order_completed\":\n        return <Package className=\"h-5 w-5 text-orange-600\" />;\n      case \"wallet_updated\":\n        return <WalletIcon className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <Bell className=\"h-5 w-5 text-muted-foreground\" />;\n    }\n  };\n\n  const getNotificationBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" => {\n    if (type.includes(\"approved\") || type.includes(\"completed\")) return \"default\";\n    if (type.includes(\"rejected\") || type.includes(\"removed\")) return \"destructive\";\n    return \"secondary\";\n  };\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-notifications\">الإشعارات</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            جميع إشعاراتك في مكان واحد\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {unreadCount > 0 && (\n            <Badge variant=\"default\" className=\"h-8\" data-testid=\"badge-unread-total\">\n              {unreadCount} غير مقروء\n            </Badge>\n          )}\n          {notifications.length > 0 && unreadCount > 0 && (\n            <Button\n              variant=\"outline\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              disabled={markAllAsReadMutation.isPending}\n              data-testid=\"button-mark-all-read-page\"\n            >\n              <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </div>\n      </div>\n\n      <Separator />\n\n      {isLoading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"text-center\">\n            <Bell className=\"h-12 w-12 mx-auto mb-4 opacity-20 animate-pulse\" />\n            <p className=\"text-muted-foreground\">جارٍ التحميل...</p>\n          </div>\n        </div>\n      ) : notifications.length === 0 ? (\n        <Card>\n          <CardContent className=\"py-12\">\n            <div className=\"text-center\">\n              <Bell className=\"h-16 w-16 mx-auto mb-4 opacity-20\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد إشعارات</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                ستظهر جميع الإشعارات الخاصة بك هنا\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-3\">\n          {notifications.map((notification) => (\n            <Card\n              key={notification.id}\n              className={`transition-all hover-elevate cursor-pointer ${\n                !notification.isRead ? 'border-primary/50 bg-primary/5' : ''\n              }`}\n              onClick={() => handleNotificationClick(notification)}\n              data-testid={`notification-card-${notification.id}`}\n            >\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"p-2 rounded-xl bg-background\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <CardTitle className=\"text-base\">\n                          {notification.title}\n                        </CardTitle>\n                        {!notification.isRead && (\n                          <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread-card\" />\n                        )}\n                      </div>\n                      <Badge variant={getNotificationBadgeVariant(notification.type)} className=\"flex-shrink-0\">\n                        {notification.type === \"task_approved\" && \"مُوافق عليها\"}\n                        {notification.type === \"task_rejected\" && \"مرفوضة\"}\n                        {notification.type === \"task_assigned\" && \"مهمة جديدة\"}\n                        {notification.type === \"payment_received\" && \"دفعة\"}\n                        {notification.type === \"new_message\" && \"رسالة\"}\n                        {notification.type === \"order_created\" && \"طلب جديد\"}\n                        {notification.type === \"withdrawal_approved\" && \"سحب مُوافق\"}\n                        {notification.type === \"withdrawal_rejected\" && \"سحب مرفوض\"}\n                        {![\"task_approved\", \"task_rejected\", \"task_assigned\", \"payment_received\", \"new_message\", \"order_created\", \"withdrawal_approved\", \"withdrawal_rejected\"].includes(notification.type) && \"إشعار\"}\n                      </Badge>\n                    </div>\n                    <CardDescription className=\"text-sm\">\n                      {notification.message}\n                    </CardDescription>\n                    <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                      <span>{getTimeAgo(notification.createdAt)}</span>\n                      {!notification.isRead && (\n                        <span className=\"flex items-center gap-1\">\n                          <AlertCircle className=\"h-3 w-3\" />\n                          جديد\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8796},"client/src/pages/product-owner-dashboard/Notifications.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2, AlertCircle, DollarSign, ClipboardList, MessageCircle, FolderKanban, Package, Users } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport default function ProductOwnerNotifications() {\n  // Fetch notifications\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"PATCH\", `/api/notifications/${id}/read`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"PATCH\", \"/api/notifications/mark-all-read\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case \"task_submitted\":\n      case \"task_assigned\":\n        return <ClipboardList className=\"h-5 w-5 text-primary\" />;\n      case \"payment_confirmed\":\n      case \"payment_pending\":\n        return <DollarSign className=\"h-5 w-5 text-green-600\" />;\n      case \"new_message\":\n        return <MessageCircle className=\"h-5 w-5 text-blue-600\" />;\n      case \"project_accepted\":\n      case \"project_completed\":\n        return <FolderKanban className=\"h-5 w-5 text-purple-600\" />;\n      case \"order_in_progress\":\n      case \"order_completed\":\n        return <Package className=\"h-5 w-5 text-orange-600\" />;\n      case \"review_submitted\":\n        return <Users className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <Bell className=\"h-5 w-5 text-muted-foreground\" />;\n    }\n  };\n\n  const getNotificationBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" => {\n    if (type.includes(\"completed\") || type.includes(\"confirmed\") || type.includes(\"accepted\")) return \"default\";\n    if (type.includes(\"rejected\") || type.includes(\"failed\")) return \"destructive\";\n    return \"secondary\";\n  };\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-notifications\">الإشعارات</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            جميع إشعاراتك في مكان واحد\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {unreadCount > 0 && (\n            <Badge variant=\"default\" className=\"h-8\" data-testid=\"badge-unread-total\">\n              {unreadCount} غير مقروء\n            </Badge>\n          )}\n          {notifications.length > 0 && unreadCount > 0 && (\n            <Button\n              variant=\"outline\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              disabled={markAllAsReadMutation.isPending}\n              data-testid=\"button-mark-all-read-page\"\n            >\n              <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </div>\n      </div>\n\n      <Separator />\n\n      {isLoading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"text-center\">\n            <Bell className=\"h-12 w-12 mx-auto mb-4 opacity-20 animate-pulse\" />\n            <p className=\"text-muted-foreground\">جارٍ التحميل...</p>\n          </div>\n        </div>\n      ) : notifications.length === 0 ? (\n        <Card>\n          <CardContent className=\"py-12\">\n            <div className=\"text-center\">\n              <Bell className=\"h-16 w-16 mx-auto mb-4 opacity-20\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد إشعارات</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                ستظهر جميع الإشعارات الخاصة بك هنا\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-3\">\n          {notifications.map((notification) => (\n            <Card\n              key={notification.id}\n              className={`transition-all hover-elevate cursor-pointer ${\n                !notification.isRead ? 'border-primary/50 bg-primary/5' : ''\n              }`}\n              onClick={() => handleNotificationClick(notification)}\n              data-testid={`notification-card-${notification.id}`}\n            >\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"p-2 rounded-xl bg-background\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <CardTitle className=\"text-base\">\n                          {notification.title}\n                        </CardTitle>\n                        {!notification.isRead && (\n                          <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread-card\" />\n                        )}\n                      </div>\n                      <Badge variant={getNotificationBadgeVariant(notification.type)} className=\"flex-shrink-0\">\n                        {notification.type === \"project_accepted\" && \"مقبول\"}\n                        {notification.type === \"project_completed\" && \"مكتمل\"}\n                        {notification.type === \"task_submitted\" && \"مُسلّم\"}\n                        {notification.type === \"payment_confirmed\" && \"مُؤكد\"}\n                        {notification.type === \"new_message\" && \"رسالة\"}\n                        {notification.type === \"order_completed\" && \"طلب مكتمل\"}\n                        {notification.type === \"review_submitted\" && \"تقييم\"}\n                        {![\"project_accepted\", \"project_completed\", \"task_submitted\", \"payment_confirmed\", \"new_message\", \"order_completed\", \"review_submitted\"].includes(notification.type) && \"إشعار\"}\n                      </Badge>\n                    </div>\n                    <CardDescription className=\"text-sm\">\n                      {notification.message}\n                    </CardDescription>\n                    <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                      <span>{getTimeAgo(notification.createdAt)}</span>\n                      {!notification.isRead && (\n                        <span className=\"flex items-center gap-1\">\n                          <AlertCircle className=\"h-3 w-3\" />\n                          جديد\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8534},"client/src/pages/GroupCommunity.tsx":{"content":"import { useState } from \"react\";\nimport { useParams, Link, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { \n  Users, \n  MessageSquare, \n  ThumbsUp, \n  Send, \n  Image as ImageIcon, \n  Trash2,\n  ArrowRight,\n  Star,\n  MapPin,\n  Calendar,\n  TrendingUp,\n  Info,\n  Upload,\n  X,\n  Home,\n  UserPlus,\n  Video,\n  FileText,\n  ShoppingBag,\n  UserCircle,\n  ChevronRight\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface Group {\n  id: string;\n  name: string;\n  description: string | null;\n  service: string;\n  maxMembers: number;\n  currentMembers: number;\n  leaderId: string;\n  country: string;\n  groupImage: string | null;\n  portfolioImages: string[] | null;\n  createdAt: Date;\n}\n\ninterface GroupMember {\n  id: string;\n  groupId: string;\n  freelancerId: string;\n  joinedAt: Date;\n}\n\ninterface Freelancer {\n  id: string;\n  fullName: string;\n  username: string;\n  profileImage: string | null;\n  lastSeen: Date | null;\n}\n\ninterface GroupPost {\n  id: string;\n  groupId: string;\n  authorId: string;\n  content: string;\n  imageUrl: string | null;\n  likesCount: number;\n  commentsCount: number;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\ninterface PostComment {\n  id: string;\n  postId: string;\n  authorId: string;\n  content: string;\n  imageUrl: string | null;\n  createdAt: Date;\n}\n\nexport default function GroupCommunity() {\n  const { id: groupId } = useParams<{ id: string }>();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  \n  // Post composer state\n  const [newPostContent, setNewPostContent] = useState(\"\");\n  const [newPostImage, setNewPostImage] = useState<string | null>(null);\n  const [isUploadingPostImage, setIsUploadingPostImage] = useState(false);\n  \n  // Comment state\n  const [commentInputs, setCommentInputs] = useState<Record<string, string>>({});\n  const [commentImages, setCommentImages] = useState<Record<string, string>>({});\n  const [expandedPosts, setExpandedPosts] = useState<Set<string>>(new Set());\n\n  // Get current user\n  const currentUser = localStorage.getItem(\"user\") \n    ? JSON.parse(localStorage.getItem(\"user\")!) \n    : null;\n  const currentUserId = currentUser?.id;\n\n  // Fetch group data\n  const { data: group, isLoading: groupLoading } = useQuery<Group>({\n    queryKey: [`/api/groups/${groupId}`],\n  });\n\n  // Fetch group members\n  const { data: members = [] } = useQuery<GroupMember[]>({\n    queryKey: [`/api/groups/${groupId}/members`],\n  });\n\n  // Fetch freelancers info for members\n  const { data: freelancers = [] } = useQuery<Freelancer[]>({\n    queryKey: [\"/api/freelancers\"],\n  });\n\n  // Fetch posts (all posts)\n  const { data: posts = [], isLoading: postsLoading } = useQuery<GroupPost[]>({\n    queryKey: ['/api/groups', groupId, 'posts'],\n  });\n\n  // Fetch popular posts\n  const { data: popularPosts = [] } = useQuery<GroupPost[]>({\n    queryKey: ['/api/groups', groupId, 'posts', 'popular'],\n    queryFn: async () => {\n      const response = await fetch(`/api/groups/${groupId}/posts?sort=popular`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n      if (!response.ok) throw new Error(\"Failed to fetch popular posts\");\n      return response.json();\n    },\n  });\n\n  // Fetch media posts\n  const { data: mediaPosts = [] } = useQuery<GroupPost[]>({\n    queryKey: ['/api/groups', groupId, 'posts', 'media'],\n    queryFn: async () => {\n      const response = await fetch(`/api/groups/${groupId}/posts?mediaOnly=true`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n      if (!response.ok) throw new Error(\"Failed to fetch media posts\");\n      return response.json();\n    },\n  });\n\n  // Helper functions\n  const getMemberInfo = (memberId: string) => {\n    return freelancers.find(f => f.id === memberId);\n  };\n\n  const isOnline = (lastSeen: Date | null) => {\n    if (!lastSeen) return false;\n    const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);\n    return new Date(lastSeen) > fiveMinutesAgo;\n  };\n\n  const isLeader = (userId: string) => {\n    return group?.leaderId === userId;\n  };\n\n  // Image upload handler\n  const handleImageUpload = async (file: File, type: 'post' | 'comment', postId?: string) => {\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"خطأ\",\n        description: \"يجب اختيار صورة فقط\",\n        variant: \"destructive\",\n      });\n      return null;\n    }\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"خطأ\",\n        description: \"حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت\",\n        variant: \"destructive\",\n      });\n      return null;\n    }\n\n    try {\n      if (type === 'post') setIsUploadingPostImage(true);\n\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', 'post');\n\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n        },\n        credentials: 'include',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || 'فشل رفع الصورة');\n      }\n\n      const { url } = await response.json();\n      \n      toast({\n        title: \"تم رفع الصورة\",\n        description: \"تم رفع الصورة بنجاح\",\n      });\n      \n      return url;\n    } catch (error: any) {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء رفع الصورة\",\n        variant: \"destructive\",\n      });\n      return null;\n    } finally {\n      if (type === 'post') setIsUploadingPostImage(false);\n    }\n  };\n\n  // Create post mutation\n  const createPostMutation = useMutation({\n    mutationFn: async ({ content, imageUrl }: { content: string; imageUrl: string | null }) => {\n      return await apiRequest(`/api/groups/${groupId}/posts`, \"POST\", {\n        content,\n        imageUrl,\n      });\n    },\n    onSuccess: () => {\n      // Invalidate all post-related queries\n      queryClient.invalidateQueries({ queryKey: ['/api/groups', groupId, 'posts'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/groups', groupId, 'posts', 'popular'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/groups', groupId, 'posts', 'media'] });\n      setNewPostContent(\"\");\n      setNewPostImage(null);\n      toast({\n        title: \"تم نشر المنشور\",\n        description: \"تم نشر منشورك بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء نشر المنشور\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreatePost = async () => {\n    if (!newPostContent.trim() && !newPostImage) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يرجى كتابة محتوى أو إضافة صورة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createPostMutation.mutate({\n      content: newPostContent,\n      imageUrl: newPostImage,\n    });\n  };\n\n  if (groupLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-white\">\n        <div className=\"text-center\">\n          <Users className=\"w-12 h-12 text-[#002e62] mx-auto mb-4 animate-pulse\" />\n          <p className=\"text-gray-600\">جاري تحميل المجتمع...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!group) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-white\">\n        <Card className=\"max-w-md\">\n          <CardContent className=\"pt-6 text-center\">\n            <p className=\"text-gray-600\">المجموعة غير موجودة</p>\n            <Button\n              variant=\"outline\"\n              onClick={() => navigate(\"/groups\")}\n              className=\"mt-4\"\n            >\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للجروبات\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const membersList = members\n    .map(m => getMemberInfo(m.freelancerId))\n    .filter(Boolean) as Freelancer[];\n\n  const postsCount = posts.length;\n  const mediaCount = mediaPosts.length;\n  const eventsCount = 0; // TODO: Implement events\n\n  return (\n    <div className=\"min-h-screen bg-white\" dir=\"rtl\">\n      {/* Header with Back Button */}\n      <div className=\"border-b bg-white sticky top-0 z-10\">\n        <div className=\"container mx-auto px-4 py-3\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(`/groups/${groupId}`)}\n            data-testid=\"button-back\"\n          >\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n            رجوع\n          </Button>\n        </div>\n      </div>\n\n      {/* Three Column Layout */}\n      <div className=\"container mx-auto px-4 py-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-[18rem,1fr,20rem] gap-6\">\n          {/* Left Sidebar - Navigation */}\n          <aside className=\"hidden lg:block\">\n            <Card>\n              <CardContent className=\"p-4 space-y-2\">\n                <NavItem icon={Home} label=\"الخلاصة\" active />\n                <NavItem icon={Users} label=\"الأصدقاء\" />\n                <NavItem icon={Calendar} label=\"الأحداث\" />\n                <NavItem icon={Video} label=\"مقاطع الفيديو\" />\n                <NavItem icon={ImageIcon} label=\"الصور\" />\n                <NavItem icon={FileText} label=\"الملفات\" />\n                <NavItem icon={ShoppingBag} label=\"المتجر\" />\n              </CardContent>\n            </Card>\n          </aside>\n\n          {/* Main Content */}\n          <main className=\"space-y-6\">\n            {/* Cover Section */}\n            <Card>\n              <div className=\"relative h-48 md:h-64 bg-gradient-to-br from-[#002e62] to-[#004a99] overflow-hidden rounded-t-lg\">\n                {group.groupImage ? (\n                  <img\n                    src={group.groupImage}\n                    alt={group.name}\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <Users className=\"w-24 h-24 text-white/30\" />\n                  </div>\n                )}\n              </div>\n              \n              <CardContent className=\"p-6\">\n                <div className=\"flex flex-col md:flex-row items-start md:items-center gap-4 mb-6\">\n                  {/* Group Avatar */}\n                  <div className=\"w-20 h-20 md:w-24 md:h-24 bg-[#002e62] rounded-lg flex items-center justify-center text-white text-3xl font-bold -mt-12 md:-mt-16 border-4 border-white shadow-lg\">\n                    {group.name.substring(0, 2).toUpperCase()}\n                  </div>\n                  \n                  <div className=\"flex-1\">\n                    <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\">\n                      {group.name}\n                    </h1>\n                    <p className=\"text-gray-600\">{group.service}</p>\n                  </div>\n                </div>\n\n                {/* Stats */}\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n                  <StatBox label=\"المنشورات\" value={postsCount} />\n                  <StatBox label=\"الأعضاء\" value={group.currentMembers} />\n                  <StatBox label=\"الوسائط\" value={mediaCount} />\n                  <StatBox label=\"الأحداث\" value={eventsCount} />\n                </div>\n\n                {/* Action Buttons */}\n                <div className=\"flex gap-3\">\n                  <Button className=\"flex-1\" disabled>\n                    <UserPlus className=\"ml-2 h-4 w-4\" />\n                    الانضمام للجروب\n                  </Button>\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={() => navigate(`/groups/${groupId}/chat`)}\n                  >\n                    <MessageSquare className=\"ml-2 h-4 w-4\" />\n                    إرسال رسالة\n                  </Button>\n                </div>\n\n                {/* Members Avatars */}\n                <div className=\"mt-6 flex items-center gap-2\">\n                  <span className=\"text-sm text-gray-600 ml-2\">الأعضاء × {group.currentMembers}</span>\n                  <div className=\"flex -space-x-2\">\n                    {membersList.slice(0, 8).map((member, idx) => (\n                      <Avatar key={member.id} className=\"border-2 border-white w-10 h-10\">\n                        <AvatarImage src={member.profileImage || undefined} />\n                        <AvatarFallback className=\"bg-[#002e62] text-white text-xs\">\n                          {member.fullName.substring(0, 2)}\n                        </AvatarFallback>\n                      </Avatar>\n                    ))}\n                    {membersList.length > 8 && (\n                      <div className=\"w-10 h-10 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs font-semibold text-gray-700\">\n                        +{membersList.length - 8}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Group Created By */}\n            {group.leaderId && getMemberInfo(group.leaderId) && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg flex items-center gap-2\">\n                    <Info className=\"h-5 w-5\" />\n                    تم إنشاء الجروب بواسطة\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center gap-4\">\n                    <Avatar className=\"w-12 h-12\">\n                      <AvatarImage src={getMemberInfo(group.leaderId)?.profileImage || undefined} />\n                      <AvatarFallback className=\"bg-[#002e62] text-white\">\n                        {getMemberInfo(group.leaderId)?.fullName.substring(0, 2)}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div>\n                      <p className=\"font-semibold\">{getMemberInfo(group.leaderId)?.fullName}</p>\n                      <p className=\"text-sm text-gray-600\">قائد الجروب</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* About Group */}\n            {group.description && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg flex items-center gap-2\">\n                    <Info className=\"h-5 w-5\" />\n                    حول الجروب\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-gray-700 leading-relaxed\">{group.description}</p>\n                  <div className=\"mt-4 space-y-2 text-sm text-gray-600\">\n                    <div className=\"flex items-center gap-2\">\n                      <MapPin className=\"h-4 w-4\" />\n                      <span>{group.country}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Users className=\"h-4 w-4\" />\n                      <span>{group.currentMembers} من {group.maxMembers} عضو</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Create Post Box */}\n            {currentUserId && (\n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <Avatar>\n                      <AvatarImage src={currentUser?.profileImage} />\n                      <AvatarFallback className=\"bg-[#002e62] text-white\">\n                        {currentUser?.fullName?.substring(0, 2) || \"Me\"}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1 space-y-3\">\n                      <Textarea\n                        placeholder=\"ما الذي تفكر فيه؟\"\n                        value={newPostContent}\n                        onChange={(e) => setNewPostContent(e.target.value)}\n                        className=\"resize-none min-h-[80px] border-gray-200\"\n                        data-testid=\"textarea-new-post\"\n                      />\n                      \n                      {newPostImage && (\n                        <div className=\"relative inline-block\">\n                          <img\n                            src={newPostImage}\n                            alt=\"معاينة\"\n                            className=\"max-h-48 rounded-lg border\"\n                          />\n                          <Button\n                            size=\"sm\"\n                            variant=\"destructive\"\n                            className=\"absolute top-2 left-2\"\n                            onClick={() => setNewPostImage(null)}\n                          >\n                            <X className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => document.getElementById('post-image-input')?.click()}\n                            disabled={isUploadingPostImage}\n                          >\n                            <ImageIcon className=\"h-4 w-4 ml-2\" />\n                            {isUploadingPostImage ? \"جاري الرفع...\" : \"صورة\"}\n                          </Button>\n                          <input\n                            id=\"post-image-input\"\n                            type=\"file\"\n                            accept=\"image/*\"\n                            className=\"hidden\"\n                            onChange={async (e) => {\n                              const file = e.target.files?.[0];\n                              if (file) {\n                                const url = await handleImageUpload(file, 'post');\n                                if (url) setNewPostImage(url);\n                              }\n                            }}\n                          />\n                        </div>\n\n                        <Button\n                          onClick={handleCreatePost}\n                          disabled={createPostMutation.isPending || (!newPostContent.trim() && !newPostImage)}\n                          data-testid=\"button-create-post\"\n                        >\n                          {createPostMutation.isPending ? \"جاري النشر...\" : \"نشر\"}\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Posts Feed */}\n            <div className=\"space-y-4\">\n              {postsLoading ? (\n                <Card>\n                  <CardContent className=\"py-12 text-center\">\n                    <p className=\"text-gray-600\">جاري تحميل المنشورات...</p>\n                  </CardContent>\n                </Card>\n              ) : posts.length === 0 ? (\n                <Card>\n                  <CardContent className=\"py-12 text-center\">\n                    <MessageSquare className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                    <p className=\"text-gray-600\">لا توجد منشورات بعد</p>\n                    <p className=\"text-sm text-gray-500 mt-2\">كن أول من ينشر في هذا المجتمع!</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                posts.map(post => (\n                  <PostCard\n                    key={post.id}\n                    post={post}\n                    groupId={groupId}\n                    currentUserId={currentUserId}\n                    getMemberInfo={getMemberInfo}\n                    isLeader={isLeader}\n                    commentInputs={commentInputs}\n                    setCommentInputs={setCommentInputs}\n                    expandedPosts={expandedPosts}\n                    setExpandedPosts={setExpandedPosts}\n                    toast={toast}\n                  />\n                ))\n              )}\n            </div>\n\n            {/* Popular Posts */}\n            {popularPosts.length > 0 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg flex items-center gap-2\">\n                    <TrendingUp className=\"h-5 w-5\" />\n                    المنشورات الشائعة\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  {popularPosts.slice(0, 3).map(post => {\n                    const author = getMemberInfo(post.authorId);\n                    return (\n                      <div key={post.id} className=\"flex items-start gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer\">\n                        <Avatar className=\"w-10 h-10\">\n                          <AvatarImage src={author?.profileImage || undefined} />\n                          <AvatarFallback className=\"bg-[#002e62] text-white text-xs\">\n                            {author?.fullName.substring(0, 2)}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2\">\n                            <p className=\"font-semibold text-sm\">{author?.fullName}</p>\n                            {isLeader(post.authorId) && (\n                              <Badge variant=\"secondary\" className=\"bg-amber-100 text-amber-700 text-xs\">\n                                <Star className=\"h-3 w-3 ml-1\" />\n                                قائد\n                              </Badge>\n                            )}\n                          </div>\n                          <p className=\"text-sm text-gray-700 line-clamp-2 mt-1\">{post.content}</p>\n                          <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500\">\n                            <span className=\"flex items-center gap-1\">\n                              <ThumbsUp className=\"h-3 w-3\" />\n                              {post.likesCount || 0}\n                            </span>\n                            <span className=\"flex items-center gap-1\">\n                              <MessageSquare className=\"h-3 w-3\" />\n                              {post.commentsCount || 0}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Media Gallery */}\n            {mediaPosts.length > 0 && (\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-lg flex items-center gap-2\">\n                      <ImageIcon className=\"h-5 w-5\" />\n                      الوسائط\n                    </CardTitle>\n                    <Button variant=\"ghost\" size=\"sm\">\n                      عرض الكل\n                      <ChevronRight className=\"mr-2 h-4 w-4\" />\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-3 md:grid-cols-4 gap-2\">\n                    {mediaPosts.slice(0, 8).map(post => (\n                      <div key={post.id} className=\"aspect-square relative overflow-hidden rounded-lg bg-gray-100 hover:opacity-90 cursor-pointer\">\n                        <img\n                          src={post.imageUrl!}\n                          alt=\"وسائط\"\n                          className=\"w-full h-full object-cover\"\n                        />\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </main>\n\n          {/* Right Sidebar - Members, Friends, Groups */}\n          <aside className=\"hidden lg:block space-y-6\">\n            {/* Members List */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">الأعضاء</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3 max-h-[500px] overflow-y-auto\">\n                {membersList.map(member => (\n                  <div key={member.id} className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                      <Avatar className=\"w-10 h-10\">\n                        <AvatarImage src={member.profileImage || undefined} />\n                        <AvatarFallback className=\"bg-[#002e62] text-white text-xs\">\n                          {member.fullName.substring(0, 2)}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div\n                        className={`absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white ${\n                          isOnline(member.lastSeen) ? \"bg-green-500\" : \"bg-gray-400\"\n                        }`}\n                      />\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm font-semibold truncate flex items-center gap-2\">\n                        {member.fullName}\n                        {isLeader(member.id) && (\n                          <Star className=\"h-3 w-3 text-amber-500 flex-shrink-0\" />\n                        )}\n                      </p>\n                      <p className=\"text-xs text-gray-600 truncate\">@{member.username}</p>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n\n            {/* Friends (Placeholder) */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">الأصدقاء</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-gray-600 text-center py-4\">قريباً...</p>\n              </CardContent>\n            </Card>\n\n            {/* Groups (Placeholder) */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">المجموعات</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <p className=\"text-sm text-gray-600 text-center py-4\">قريباً...</p>\n              </CardContent>\n            </Card>\n          </aside>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Subcomponents\n\nfunction NavItem({ icon: Icon, label, active = false }: { icon: any; label: string; active?: boolean }) {\n  return (\n    <button\n      className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${\n        active \n          ? \"bg-[#002e62] text-white\" \n          : \"text-gray-700 hover:bg-gray-100\"\n      }`}\n    >\n      <Icon className=\"h-5 w-5\" />\n      <span className=\"font-medium\">{label}</span>\n    </button>\n  );\n}\n\nfunction StatBox({ label, value }: { label: string; value: number }) {\n  return (\n    <div className=\"text-center p-4 bg-gray-50 rounded-lg\">\n      <p className=\"text-2xl font-bold text-[#002e62]\">{value.toLocaleString('ar')}</p>\n      <p className=\"text-sm text-gray-600 mt-1\">{label}</p>\n    </div>\n  );\n}\n\nfunction PostCard({\n  post,\n  groupId,\n  currentUserId,\n  getMemberInfo,\n  isLeader,\n  commentInputs,\n  setCommentInputs,\n  expandedPosts,\n  setExpandedPosts,\n  toast,\n}: {\n  post: GroupPost;\n  groupId: string;\n  currentUserId: string | null;\n  getMemberInfo: (id: string) => Freelancer | undefined;\n  isLeader: (id: string) => boolean;\n  commentInputs: Record<string, string>;\n  setCommentInputs: React.Dispatch<React.SetStateAction<Record<string, string>>>;\n  expandedPosts: Set<string>;\n  setExpandedPosts: React.Dispatch<React.SetStateAction<Set<string>>>;\n  toast: any;\n}) {\n  const author = getMemberInfo(post.authorId);\n  const isExpanded = expandedPosts.has(post.id);\n\n  // Fetch comments for this post\n  const { data: comments = [] } = useQuery<PostComment[]>({\n    queryKey: [`/api/posts/${post.id}/comments`],\n    enabled: isExpanded,\n  });\n\n  // Fetch reactions\n  const { data: reactions = [] } = useQuery<any[]>({\n    queryKey: [`/api/posts/${post.id}/reactions`],\n  });\n\n  const userReaction = reactions.find(r => r.userId === currentUserId);\n  const hasLiked = userReaction?.reactionType === 'like';\n\n  // Toggle like mutation\n  const toggleLikeMutation = useMutation({\n    mutationFn: async () => {\n      if (hasLiked) {\n        return await apiRequest(`/api/posts/${post.id}/reactions`, \"DELETE\", {});\n      } else {\n        return await apiRequest(`/api/posts/${post.id}/reactions`, \"POST\", {\n          reactionType: 'like',\n        });\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/posts/${post.id}/reactions`] });\n      queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/posts`] });\n    },\n  });\n\n  // Add comment mutation\n  const addCommentMutation = useMutation({\n    mutationFn: async (content: string) => {\n      return await apiRequest(`/api/posts/${post.id}/comments`, \"POST\", {\n        content,\n        imageUrl: null,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/posts/${post.id}/comments`] });\n      queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/posts`] });\n      setCommentInputs(prev => ({ ...prev, [post.id]: \"\" }));\n      toast({\n        title: \"تم إضافة التعليق\",\n        description: \"تم إضافة تعليقك بنجاح\",\n      });\n    },\n  });\n\n  // Delete post mutation\n  const deletePostMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/groups/${groupId}/posts/${post.id}`, \"DELETE\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/posts`] });\n      toast({\n        title: \"تم حذف المنشور\",\n        description: \"تم حذف المنشور بنجاح\",\n      });\n    },\n  });\n\n  const canDelete = currentUserId && (post.authorId === currentUserId || isLeader(currentUserId));\n\n  return (\n    <Card>\n      <CardContent className=\"p-6\">\n        {/* Post Header */}\n        <div className=\"flex items-start justify-between mb-4\">\n          <div className=\"flex items-start gap-3\">\n            <Avatar className=\"w-12 h-12\">\n              <AvatarImage src={author?.profileImage || undefined} />\n              <AvatarFallback className=\"bg-[#002e62] text-white\">\n                {author?.fullName.substring(0, 2)}\n              </AvatarFallback>\n            </Avatar>\n            <div>\n              <div className=\"flex items-center gap-2\">\n                <p className=\"font-semibold\">{author?.fullName}</p>\n                {isLeader(post.authorId) && (\n                  <Badge variant=\"secondary\" className=\"bg-amber-100 text-amber-700\">\n                    <Star className=\"h-3 w-3 ml-1\" />\n                    قائد\n                  </Badge>\n                )}\n              </div>\n              <p className=\"text-sm text-gray-600\">\n                {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true, locale: ar })}\n              </p>\n            </div>\n          </div>\n\n          {canDelete && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => deletePostMutation.mutate()}\n              disabled={deletePostMutation.isPending}\n            >\n              <Trash2 className=\"h-4 w-4 text-red-600\" />\n            </Button>\n          )}\n        </div>\n\n        {/* Post Content */}\n        <div className=\"mb-4\">\n          <p className=\"text-gray-800 whitespace-pre-wrap\">{post.content}</p>\n          {post.imageUrl && (\n            <img\n              src={post.imageUrl}\n              alt=\"صورة المنشور\"\n              className=\"mt-4 max-h-96 w-full object-contain rounded-lg border\"\n            />\n          )}\n        </div>\n\n        {/* Engagement Stats */}\n        <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-4\">\n          <span>{reactions.length} إعجاب</span>\n          <span>{post.commentsCount || 0} تعليق</span>\n        </div>\n\n        <Separator className=\"mb-4\" />\n\n        {/* Action Buttons */}\n        <div className=\"flex items-center gap-2 mb-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => toggleLikeMutation.mutate()}\n            className={hasLiked ? \"text-blue-600\" : \"\"}\n          >\n            <ThumbsUp className={`h-4 w-4 ml-2 ${hasLiked ? 'fill-current' : ''}`} />\n            إعجاب\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => {\n              const newExpanded = new Set(expandedPosts);\n              if (isExpanded) {\n                newExpanded.delete(post.id);\n              } else {\n                newExpanded.add(post.id);\n              }\n              setExpandedPosts(newExpanded);\n            }}\n          >\n            <MessageSquare className=\"h-4 w-4 ml-2\" />\n            تعليق\n          </Button>\n        </div>\n\n        {/* Comments Section */}\n        {isExpanded && (\n          <div className=\"space-y-4 mt-4 pt-4 border-t\">\n            {/* Add Comment */}\n            {currentUserId && (\n              <div className=\"flex items-start gap-3\">\n                <Avatar className=\"w-8 h-8\">\n                  <AvatarFallback className=\"bg-[#002e62] text-white text-xs\">\n                    Me\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1 flex gap-2\">\n                  <Input\n                    placeholder=\"اكتب تعليق...\"\n                    value={commentInputs[post.id] || \"\"}\n                    onChange={(e) => setCommentInputs(prev => ({ ...prev, [post.id]: e.target.value }))}\n                    onKeyPress={(e) => {\n                      if (e.key === 'Enter' && commentInputs[post.id]?.trim()) {\n                        addCommentMutation.mutate(commentInputs[post.id]);\n                      }\n                    }}\n                  />\n                  <Button\n                    size=\"sm\"\n                    onClick={() => {\n                      if (commentInputs[post.id]?.trim()) {\n                        addCommentMutation.mutate(commentInputs[post.id]);\n                      }\n                    }}\n                    disabled={addCommentMutation.isPending || !commentInputs[post.id]?.trim()}\n                  >\n                    <Send className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            {/* Comments List */}\n            {comments.length > 0 && (\n              <div className=\"space-y-3\">\n                {comments.map(comment => {\n                  const commentAuthor = getMemberInfo(comment.authorId);\n                  return (\n                    <div key={comment.id} className=\"flex items-start gap-3 bg-gray-50 p-3 rounded-lg\">\n                      <Avatar className=\"w-8 h-8\">\n                        <AvatarImage src={commentAuthor?.profileImage || undefined} />\n                        <AvatarFallback className=\"bg-[#002e62] text-white text-xs\">\n                          {commentAuthor?.fullName.substring(0, 2)}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <p className=\"font-semibold text-sm\">{commentAuthor?.fullName}</p>\n                          {isLeader(comment.authorId) && (\n                            <Badge variant=\"secondary\" className=\"bg-amber-100 text-amber-700 text-xs\">\n                              <Star className=\"h-2 w-2 ml-1\" />\n                              قائد\n                            </Badge>\n                          )}\n                          <span className=\"text-xs text-gray-600\">\n                            {formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true, locale: ar })}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-gray-800\">{comment.content}</p>\n                        {comment.imageUrl && (\n                          <img\n                            src={comment.imageUrl}\n                            alt=\"صورة التعليق\"\n                            className=\"mt-2 max-h-48 rounded-lg border\"\n                          />\n                        )}\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":38338}},"version":2}