{"file_contents":{"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { Server as SocketIOServer } from \"socket.io\";\nimport { storage } from \"./storage\";\nimport { insertFreelancerSchema, insertProductOwnerSchema, insertCampaignSchema, insertOrderSchema, type Campaign, postComments } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { verifyToken, type AuthPayload } from \"./middleware/auth\";\n// import OpenAI from \"openai\";\nimport multer from \"multer\";\nimport { writeFile, mkdir } from \"fs/promises\";\nimport { join } from \"path\";\nimport { existsSync } from \"fs\";\nimport bcrypt from \"bcrypt\";\nimport { generateToken, authMiddleware, requireRole, adminAuthMiddleware, requirePermission, type AuthRequest } from \"./middleware/auth\";\nimport { db } from \"./db\";\nimport { eq } from \"drizzle-orm\";\n\n// Initialize OpenAI client using Replit AI Integrations\n// This provides OpenAI-compatible API access without requiring your own OpenAI API key\n// Charges are billed to your Replit credits\n// const openai = new OpenAI({\n//   baseURL: process.env.AI_INTEGRATIONS_OPENAI_BASE_URL,\n//   apiKey: process.env.AI_INTEGRATIONS_OPENAI_API_KEY,\n// });\n\n// Configure multer for file uploads\nconst upload = multer({ storage: multer.memoryStorage() });\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  const httpServer = createServer(app);\n  \n  // Initialize Socket.IO\n  const io = new SocketIOServer(httpServer, {\n    cors: {\n      origin: process.env.CLIENT_URL || \"http://localhost:5173\",\n      credentials: true\n    }\n  });\n\n  // Socket.IO authentication middleware\n  io.use(async (socket, next) => {\n    try {\n      const token = socket.handshake.auth.token || socket.handshake.headers.authorization?.replace('Bearer ', '');\n      if (!token) {\n        return next(new Error('Authentication error'));\n      }\n\n      const payload = verifyToken(token);\n      if (!payload) {\n        return next(new Error('Invalid token'));\n      }\n\n      socket.data.user = payload;\n      next();\n    } catch (error) {\n      next(new Error('Authentication error'));\n    }\n  });\n\n  // Socket.IO connection handling\n  io.on('connection', (socket) => {\n    const user = socket.data.user as AuthPayload;\n    console.log(`User connected: ${user.userId} (${user.userType})`);\n\n    // Join user's personal room for notifications\n    socket.join(`user:${user.userId}`);\n\n    // Join group chat room\n    socket.on('join:group', async (groupId: string) => {\n      try {\n        // Verify user is member of group\n        const isMember = await storage.isGroupMember(groupId, user.userId);\n        const group = await storage.getGroup(groupId);\n        \n        if (isMember || (group && group.leaderId === user.userId)) {\n          socket.join(`group:${groupId}`);\n          console.log(`User ${user.userId} joined group chat: ${groupId}`);\n        }\n      } catch (error) {\n        console.error('Error joining group:', error);\n      }\n    });\n\n    // Leave group chat room\n    socket.on('leave:group', (groupId: string) => {\n      socket.leave(`group:${groupId}`);\n      console.log(`User ${user.userId} left group chat: ${groupId}`);\n    });\n\n    // Send group message\n    socket.on('group:message', async (data: { groupId: string; content: string }) => {\n      try {\n        const { groupId, content } = data;\n        \n        // Verify membership\n        const isMember = await storage.isGroupMember(groupId, user.userId);\n        if (!isMember) {\n          socket.emit('error', { message: 'غير مصرح' });\n          return;\n        }\n\n        // Save message to database\n        const message = await storage.createMessage({\n          groupId,\n          senderId: user.userId,\n          content: content.trim(),\n          type: 'text',\n          relatedProjectId: null,\n        });\n\n        // Get sender details\n        const sender = await storage.getFreelancer(user.userId);\n\n        // Broadcast to all group members\n        io.to(`group:${groupId}`).emit('group:message', {\n          ...message,\n          sender: {\n            id: sender?.id,\n            fullName: sender?.fullName,\n            profileImage: sender?.profileImage,\n          },\n        });\n      } catch (error) {\n        console.error('Error sending group message:', error);\n        socket.emit('error', { message: 'فشل إرسال الرسالة' });\n      }\n    });\n\n    // Join conversation room (product owner ↔ group leader)\n    socket.on('join:conversation', async (conversationId: string) => {\n      try {\n        const conversation = await storage.getConversation(conversationId);\n        if (!conversation) {\n          socket.emit('error', { message: 'المحادثة غير موجودة' });\n          return;\n        }\n\n        // Verify user is part of conversation\n        const isProductOwner = user.userType === 'product_owner' && conversation.productOwnerId === user.userId;\n        const isLeader = user.userType === 'freelancer' && conversation.leaderId === user.userId;\n\n        if (isProductOwner || isLeader) {\n          socket.join(`conversation:${conversationId}`);\n          console.log(`User ${user.userId} joined conversation: ${conversationId}`);\n        }\n      } catch (error) {\n        console.error('Error joining conversation:', error);\n      }\n    });\n\n    // Leave conversation room\n    socket.on('leave:conversation', (conversationId: string) => {\n      socket.leave(`conversation:${conversationId}`);\n      console.log(`User ${user.userId} left conversation: ${conversationId}`);\n    });\n\n    // Send conversation message\n    socket.on('conversation:message', async (data: { conversationId: string; content: string }) => {\n      try {\n        const { conversationId, content } = data;\n        \n        // Verify access\n        const conversation = await storage.getConversation(conversationId);\n        if (!conversation) {\n          socket.emit('error', { message: 'المحادثة غير موجودة' });\n          return;\n        }\n\n        const isProductOwner = user.userType === 'product_owner' && conversation.productOwnerId === user.userId;\n        const isLeader = user.userType === 'freelancer' && conversation.leaderId === user.userId;\n\n        if (!isProductOwner && !isLeader) {\n          socket.emit('error', { message: 'غير مصرح' });\n          return;\n        }\n\n        // Save message to database\n        const message = await storage.sendMessage(conversationId, user.userId, user.userType, content.trim());\n\n        // Get sender details\n        let senderDetails;\n        if (user.userType === 'product_owner') {\n          const sender = await storage.getProductOwner(user.userId);\n          senderDetails = {\n            id: sender?.id,\n            fullName: sender?.fullName,\n            type: 'product_owner',\n          };\n        } else {\n          const sender = await storage.getFreelancer(user.userId);\n          senderDetails = {\n            id: sender?.id,\n            fullName: sender?.fullName,\n            profileImage: sender?.profileImage,\n            type: 'freelancer',\n          };\n        }\n\n        // Broadcast to conversation participants\n        io.to(`conversation:${conversationId}`).emit('conversation:message', {\n          ...message,\n          sender: senderDetails,\n        });\n\n        // Send notification to recipient\n        const recipientId = isProductOwner ? conversation.leaderId : conversation.productOwnerId;\n        const recipientType = isProductOwner ? 'freelancer' : 'product_owner';\n        \n        io.to(`user:${recipientId}`).emit('notification', {\n          title: 'رسالة جديدة',\n          message: `لديك رسالة جديدة من ${senderDetails.fullName}`,\n          type: 'new_message',\n        });\n      } catch (error) {\n        console.error('Error sending conversation message:', error);\n        socket.emit('error', { message: 'فشل إرسال الرسالة' });\n      }\n    });\n\n    // Join direct chat room\n    socket.on('join:direct', (roomId: string) => {\n      socket.join(`direct:${roomId}`);\n      console.log(`User ${user.userId} joined direct chat: ${roomId}`);\n    });\n\n    // Leave direct chat room\n    socket.on('leave:direct', (roomId: string) => {\n      socket.leave(`direct:${roomId}`);\n      console.log(`User ${user.userId} left direct chat: ${roomId}`);\n    });\n\n    // Send direct message\n    socket.on('direct:message', async (data: { receiverId: string; receiverType: string; content: string; roomId: string }) => {\n      try {\n        const { receiverId, receiverType, content, roomId } = data;\n\n        // Save message to database\n        const message = await storage.sendDirectMessage(\n          user.userId,\n          user.userType,\n          receiverId,\n          receiverType,\n          content.trim()\n        );\n\n        // Get sender details\n        let senderDetails;\n        if (user.userType === 'product_owner') {\n          const sender = await storage.getProductOwner(user.userId);\n          senderDetails = {\n            id: sender?.id,\n            fullName: sender?.fullName,\n            type: 'product_owner',\n          };\n        } else {\n          const sender = await storage.getFreelancer(user.userId);\n          senderDetails = {\n            id: sender?.id,\n            fullName: sender?.fullName,\n            profileImage: sender?.profileImage,\n            type: 'freelancer',\n          };\n        }\n\n        // Broadcast to both users in the direct chat room\n        io.to(`direct:${roomId}`).emit('direct:message', {\n          ...message,\n          sender: senderDetails,\n        });\n\n        // Send notification to recipient\n        io.to(`user:${receiverId}`).emit('notification', {\n          title: 'رسالة جديدة',\n          message: `لديك رسالة جديدة من ${senderDetails.fullName}`,\n          type: 'new_message',\n        });\n      } catch (error) {\n        console.error('Error sending direct message:', error);\n        socket.emit('error', { message: 'فشل إرسال الرسالة' });\n      }\n    });\n\n    // Typing indicators\n    socket.on('typing:start', (data: { roomType: 'group' | 'conversation'; roomId: string }) => {\n      const room = `${data.roomType}:${data.roomId}`;\n      socket.to(room).emit('typing:start', { userId: user.userId });\n    });\n\n    socket.on('typing:stop', (data: { roomType: 'group' | 'conversation'; roomId: string }) => {\n      const room = `${data.roomType}:${data.roomId}`;\n      socket.to(room).emit('typing:stop', { userId: user.userId });\n    });\n\n    socket.on('disconnect', () => {\n      console.log(`User disconnected: ${user.userId}`);\n    });\n  });\n  \n  // ============================================\n  // FREELANCER ROUTES\n  // ============================================  // Create freelancer account\n  app.post(\"/api/freelancers\", async (req, res) => {\n    try {\n      const validatedData = insertFreelancerSchema.parse(req.body);\n      console.log(\"Validated Data:\", validatedData);\n      // Check if email already exists\n      const existingByEmail = await storage.getFreelancerByEmail(validatedData.email);\n      if (existingByEmail) {\n        return res.status(400).json({ error: \"البريد الإلكتروني مستخدم بالفعل\" });\n      }\n\n\n      // Check if username already exists\n      const existingByUsername = await storage.getFreelancerByUsername(validatedData.username);\n      if (existingByUsername) {\n        return res.status(400).json({ error: \"اسم المستخدم مستخدم بالفعل\" });\n      }\n\n      // Hash password before storing\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      const freelancerData = { ...validatedData, password: hashedPassword };\n\n      const freelancer = await storage.createFreelancer(freelancerData);\n\n      // Generate JWT token\n      const token = generateToken({\n        userId: freelancer.id,\n        userType: \"freelancer\",\n        email: freelancer.email,\n      });\n\n      // Don't send password back to client\n      const { password, ...freelancerWithoutPassword } = freelancer;\n\n      res.status(201).json({\n        user: freelancerWithoutPassword,\n        token,\n        message: \"تم إنشاء الحساب بنجاح\"\n      });\n    } catch (error) {\n      console.error(\"Error creating freelancer:\", error);\n\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحساب\" });\n    }\n  });\n\n  // Get all freelancers\n  app.get(\"/api/freelancers\", async (req, res) => {\n    try {\n      const freelancers = await storage.getAllFreelancers();\n\n      // Remove passwords from response\n      const freelancersWithoutPasswords = freelancers.map(({ password, ...f }) => f);\n\n      res.json(freelancersWithoutPasswords);\n    } catch (error) {\n      console.error(\"Error fetching freelancers:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Accept instructions (protected) - MUST be before :id route\n  app.patch(\"/api/freelancers/accept-instructions\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const userId = req.user?.userId;\n\n      if (!userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const updatedFreelancer = await storage.updateFreelancer(userId, { acceptedInstructions: true });\n\n      if (!updatedFreelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      res.json({ message: \"تم قبول التعليمات بنجاح\", acceptedInstructions: true });\n    } catch (error) {\n      console.error(\"Error accepting instructions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حفظ الموافقة\" });\n    }\n  });\n\n  // Get freelancer by ID\n  app.get(\"/api/freelancers/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const freelancer = await storage.getFreelancer(id);\n\n      if (!freelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      const { password, ...freelancerWithoutPassword } = freelancer;\n      res.json(freelancerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error fetching freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Update freelancer (protected)\n  app.patch(\"/api/freelancers/:id\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      // Verify user can only update their own profile\n      if (req.user?.userId !== id) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا الحساب\" });\n      }\n\n      // Don't allow password updates through this endpoint\n      delete updates.password;\n      delete updates.id;\n\n      const updatedFreelancer = await storage.updateFreelancer(id, updates);\n\n      if (!updatedFreelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      const { password, ...freelancerWithoutPassword } = updatedFreelancer;\n      res.json(freelancerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error updating freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التحديث\" });\n    }\n  });\n\n  // ============================================\n  // PRODUCT OWNER ROUTES\n  // ============================================\n\n  // Create product owner account\n  app.post(\"/api/product-owners\", async (req, res) => {\n    try {\n      const validatedData = insertProductOwnerSchema.parse(req.body);\n\n      // Check if email already exists\n      const existingByEmail = await storage.getProductOwnerByEmail(validatedData.email);\n      if (existingByEmail) {\n        return res.status(400).json({ error: \"البريد الإلكتروني مستخدم بالفعل\" });\n      }\n\n      // Hash password before storing\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      const ownerData = { ...validatedData, password: hashedPassword };\n\n      const productOwner = await storage.createProductOwner(ownerData);\n\n      // Generate JWT token\n      const token = generateToken({\n        userId: productOwner.id,\n        userType: \"product_owner\",\n        email: productOwner.email,\n      });\n\n      // Don't send password back to client\n      const { password, ...ownerWithoutPassword } = productOwner;\n\n      res.status(201).json({\n        user: ownerWithoutPassword,\n        token,\n        message: \"تم إنشاء الحساب بنجاح\"\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحساب\" });\n    }\n  });\n\n  // Get all product owners\n  app.get(\"/api/product-owners\", async (req, res) => {\n    try {\n      const owners = await storage.getAllProductOwners();\n\n      // Remove passwords from response\n      const ownersWithoutPasswords = owners.map(({ password, ...o }) => o);\n\n      res.json(ownersWithoutPasswords);\n    } catch (error) {\n      console.error(\"Error fetching product owners:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Accept instructions (protected) - MUST be before :id route\n  app.patch(\"/api/product-owners/accept-instructions\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const userId = req.user?.userId;\n\n      if (!userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const updatedOwner = await storage.updateProductOwner(userId, { acceptedInstructions: true });\n\n      if (!updatedOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      res.json({ message: \"تم قبول الشروط والأحكام بنجاح\", acceptedInstructions: true });\n    } catch (error) {\n      console.error(\"Error accepting instructions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حفظ الموافقة\" });\n    }\n  });\n\n  // Get product owner by ID\n  app.get(\"/api/product-owners/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const owner = await storage.getProductOwner(id);\n\n      if (!owner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      const { password, ...ownerWithoutPassword } = owner;\n      res.json(ownerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error fetching product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب البيانات\" });\n    }\n  });\n\n  // Update product owner (protected)\n  app.patch(\"/api/product-owners/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      // Verify user can only update their own profile\n      if (req.user?.userId !== id) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا الحساب\" });\n      }\n\n      // Don't allow password updates through this endpoint\n      delete updates.password;\n      delete updates.id;\n\n      const updatedOwner = await storage.updateProductOwner(id, updates);\n\n      if (!updatedOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      const { password, ...ownerWithoutPassword } = updatedOwner;\n      res.json(ownerWithoutPassword);\n    } catch (error) {\n      console.error(\"Error updating product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التحديث\" });\n    }\n  });\n\n  // ============================================\n  // AI SUGGESTIONS (OpenAI Integration)\n  // ============================================\n\n  // Generate AI suggestions for bio/description\n  app.post(\"/api/ai/suggestions\", async (req, res) => {\n    try {\n      const { text, type } = req.body;\n\n      if (!text || text.length < 10) {\n        return res.status(400).json({ error: \"النص قصير جدًا للحصول على اقتراحات\" });\n      }\n\n      let prompt = \"\";\n      if (type === \"freelancer-bio\") {\n        prompt = `أنت مساعد ذكي في منصة سُمُوّ، منصة عربية لربط المستقلين بأصحاب المنتجات. المستقل كتب الوصف التالي عن نفسه:\n\n\"${text}\"\n\nساعده في تحسين هذا الوصف ليكون أكثر احترافية وجاذبية للعملاء. اكتب نسخة محسّنة من الوصف بالعربية، في 2-3 جمل فقط، مع التركيز على الخبرة والمهارات والقيمة المضافة.`;\n      } else if (type === \"product-description\") {\n        prompt = `أنت مساعد ذكي في منصة سُمُوّ، منصة عربية لاختبار المنتجات الرقمية. صاحب المنتج كتب الوصف التالي عن منتجه:\n\n\"${text}\"\n\nساعده في تحسين هذا الوصف ليكون أكثر وضوحًا وجاذبية للمختبرين. اكتب نسخة محسّنة من الوصف بالعربية، في 2-3 جمل فقط، مع التركيز على الميزات الرئيسية والقيمة المضافة.`;\n      } else {\n        return res.status(400).json({ error: \"نوع الاقتراح غير صحيح\" });\n      }\n\n      // Using gpt-5 - the newest OpenAI model released August 7, 2025\n      // const completion = await openai.chat.completions.create({\n      //   model: \"gpt-5\",\n      //   messages: [\n      //     {\n      //       role: \"system\",\n      //       content: \"أنت مساعد ذكي متخصص في كتابة أوصاف احترافية باللغة العربية. تجيب دائمًا بالعربية الفصحى الواضحة.\"\n      //     },\n      //     {\n      //       role: \"user\",\n      //       content: prompt\n      //     }\n      //   ],\n      //   max_completion_tokens: 200,\n      // });\n\n      // const suggestion = completion.choices[0]?.message?.content?.trim();\n      const suggestion = \"نموذج اقتراح تم إنشاؤه بنجاح.\"; // Placeholder response\n      // if (!suggestion) {\n      //   return res.status(500).json({ error: \"فشل في توليد الاقتراح\" });\n      // }\n\n      res.json({ suggestion });\n    } catch (error) {\n      console.error(\"Error generating AI suggestion:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء توليد الاقتراح\" });\n    }\n  });\n\n  // ============================================\n  // FILE UPLOAD (Object Storage)\n  // ============================================\n\n  // Upload profile image or ID verification (public - used during signup)\n  // Security: File type and size validation enforced\n  app.post(\"/api/upload\", upload.single(\"file\"), async (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"لم يتم رفع أي ملف\" });\n      }\n\n      // Validate file size (max 5MB)\n      const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB in bytes\n      if (req.file.size > MAX_FILE_SIZE) {\n        return res.status(400).json({ error: \"حجم الملف كبير جداً. الحد الأقصى 5 ميجابايت\" });\n      }\n\n      // Validate file type (only images and PDFs)\n      const allowedMimeTypes = [\n        'image/jpeg',\n        'image/jpg',\n        'image/png',\n        'image/gif',\n        'image/webp',\n        'application/pdf'\n      ];\n\n      if (!allowedMimeTypes.includes(req.file.mimetype)) {\n        return res.status(400).json({ error: \"نوع الملف غير مدعوم. يسمح فقط بالصور (JPEG, PNG, GIF, WebP) و PDF\" });\n      }\n\n      const { type } = req.body; // 'profile', 'verification', 'group', 'post', or 'comment'\n      console.log(\"type\", type)\n      if (type !== \"profile\" && type !== \"verification\" && type !== \"group\" && type !== \"post\" && type !== \"comment\") {\n        return res.status(400).json({ error: \"نوع الملف غير صحيح\" });\n      }\n\n      // Create uploads directory if it doesn't exist\n      const uploadsDir = join(process.cwd(), \"uploads\", type);\n      if (!existsSync(uploadsDir)) {\n        await mkdir(uploadsDir, { recursive: true });\n      }\n\n      // Generate unique filename\n      const timestamp = Date.now();\n      const filename = `${timestamp}-${req.file.originalname}`;\n      const filePath = join(uploadsDir, filename);\n\n      // Save file\n      await writeFile(filePath, req.file.buffer);\n\n      // Return URL path\n      const fileUrl = `/uploads/${type}/${filename}`;\n\n      res.json({ url: fileUrl });\n    } catch (error) {\n      console.error(\"Error uploading file:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفع الملف\" });\n    }\n  });\n\n  // ============================================\n  // AUTHENTICATION ROUTES\n  // ============================================\n\n  // Login endpoint\n  app.post(\"/api/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ error: \"البريد الإلكتروني وكلمة المرور مطلوبان\" });\n      }\n\n      // Try to find freelancer first\n      let user = await storage.getFreelancerByEmail(email);\n      let userType: \"freelancer\" | \"product_owner\" = \"freelancer\";\n\n      // If not found, try product owner\n      if (!user) {\n        user = await storage.getProductOwnerByEmail(email);\n        userType = \"product_owner\";\n      }\n\n      // User not found\n      if (!user) {\n        return res.status(401).json({ error: \"البريد الإلكتروني أو كلمة المرور غير صحيحة\" });\n      }\n\n      // Verify password using bcrypt\n      const isPasswordValid = await bcrypt.compare(password, user.password);\n      if (!isPasswordValid) {\n        return res.status(401).json({ error: \"البريد الإلكتروني أو كلمة المرور غير صحيحة\" });\n      }\n\n      // Generate JWT token\n      const token = generateToken({\n        userId: user.id,\n        userType,\n        email: user.email,\n      });\n\n      // Don't send password back\n      const { password: _, ...userWithoutPassword } = user;\n\n      res.json({\n        user: userWithoutPassword,\n        userType,\n        token,\n        message: \"تم تسجيل الدخول بنجاح\"\n      });\n    } catch (error) {\n      console.error(\"Error during login:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسجيل الدخول\" });\n    }\n  });\n\n  // Change password endpoint\n  app.post(\"/api/auth/change-password\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { currentPassword, newPassword } = req.body;\n\n      if (!currentPassword || !newPassword) {\n        return res.status(400).json({ error: \"كلمة المرور الحالية والجديدة مطلوبة\" });\n      }\n\n      if (newPassword.length < 6) {\n        return res.status(400).json({ error: \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Get user based on type\n      let user;\n      if (userType === \"freelancer\") {\n        user = await storage.getFreelancer(userId);\n      } else {\n        user = await storage.getProductOwner(userId);\n      }\n\n      if (!user) {\n        return res.status(404).json({ error: \"المستخدم غير موجود\" });\n      }\n\n      // Verify current password\n      const isPasswordValid = await bcrypt.compare(currentPassword, user.password);\n      if (!isPasswordValid) {\n        return res.status(401).json({ error: \"كلمة المرور الحالية غير صحيحة\" });\n      }\n\n      // Hash new password\n      const hashedPassword = await bcrypt.hash(newPassword, 10);\n\n      // Update password\n      if (userType === \"freelancer\") {\n        await storage.updateFreelancer(userId, { password: hashedPassword });\n      } else {\n        await storage.updateProductOwner(userId, { password: hashedPassword });\n      }\n\n      res.json({ message: \"تم تغيير كلمة المرور بنجاح\" });\n    } catch (error) {\n      console.error(\"Error changing password:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تغيير كلمة المرور\" });\n    }\n  });\n\n  // ============================================\n  // CAMPAIGN ROUTES\n  // ============================================\n\n  // Create campaign (product owners only)\n  app.post(\"/api/campaigns\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const validatedData = insertCampaignSchema.parse(req.body);\n\n      // Ensure productOwnerId matches the authenticated user\n      if (validatedData.productOwnerId !== req.user?.userId) {\n        return res.status(403).json({ error: \"يمكنك فقط إنشاء حملات لحسابك الخاص\" });\n      }\n\n      const campaign = await storage.createCampaign(validatedData);\n      res.status(201).json(campaign);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الحملة\" });\n    }\n  });\n\n  // Get all campaigns (filtered based on user type)\n  app.get(\"/api/campaigns\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { status, productOwnerId } = req.query;\n\n      let campaigns;\n\n      if (req.user?.userType === \"product_owner\") {\n        // Product owners see only their campaigns\n        campaigns = await storage.getCampaignsByOwner(req.user.userId);\n      } else {\n        // Freelancers see only active campaigns (not drafts, paused, etc.)\n        const allCampaigns = await storage.getAllCampaigns();\n        campaigns = allCampaigns.filter(c => c.status === \"active\");\n      }\n\n      // Apply additional filters\n      if (status) {\n        campaigns = campaigns.filter(c => c.status === status);\n      }\n      if (productOwnerId && req.user?.userType === \"product_owner\") {\n        campaigns = campaigns.filter(c => c.productOwnerId === productOwnerId);\n      }\n\n      res.json(campaigns);\n    } catch (error) {\n      console.error(\"Error fetching campaigns:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الحملات\" });\n    }\n  });\n\n  // Get campaign by ID\n  app.get(\"/api/campaigns/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const campaign = await storage.getCampaign(id);\n\n      if (!campaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      // Product owners can only see their own campaigns\n      if (req.user?.userType === \"product_owner\" && campaign.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض هذه الحملة\" });\n      }\n\n      res.json(campaign);\n    } catch (error) {\n      console.error(\"Error fetching campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات الحملة\" });\n    }\n  });\n\n  // Update campaign (product owners only, own campaigns)\n  app.patch(\"/api/campaigns/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      // Get existing campaign to verify ownership\n      const existingCampaign = await storage.getCampaign(id);\n      if (!existingCampaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      if (existingCampaign.productOwnerId !== req.user?.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذه الحملة\" });\n      }\n\n      // Create update schema (partial of insert schema, excluding owner_id and id)\n      const updateCampaignSchema = insertCampaignSchema.partial().omit({ productOwnerId: true, id: true });\n\n      // Validate updates\n      const validatedUpdates = updateCampaignSchema.parse(req.body);\n\n      const updatedCampaign = await storage.updateCampaign(id, validatedUpdates);\n      res.json(updatedCampaign);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error updating campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الحملة\" });\n    }\n  });\n\n  // Delete campaign (product owners only, own campaigns)\n  app.delete(\"/api/campaigns/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      // Get existing campaign to verify ownership\n      const existingCampaign = await storage.getCampaign(id);\n      if (!existingCampaign) {\n        return res.status(404).json({ error: \"الحملة غير موجودة\" });\n      }\n\n      if (existingCampaign.productOwnerId !== req.user?.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لحذف هذه الحملة\" });\n      }\n\n      await storage.deleteCampaign(id);\n      res.json({ message: \"تم حذف الحملة بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting campaign:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف الحملة\" });\n    }\n  });\n\n  // ============================================\n  // TASK ROUTES\n  // ============================================\n\n  // Get available tasks (freelancers can browse)\n  app.get(\"/api/tasks/available\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const tasks = await storage.getAvailableTasks();\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching available tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام المتاحة\" });\n    }\n  });\n\n  // Get freelancer's tasks (assigned, in_progress, submitted, approved)\n  app.get(\"/api/tasks/my-tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      console.log(`[TASKS] Fetching my-tasks for user: ${req.user.userId}`);\n      const tasks = await storage.getTasksByFreelancer(req.user.userId);\n      console.log(`[TASKS] Found ${tasks.length} tasks for user ${req.user.userId}`);\n      console.log(`[TASKS] Task details:`, tasks.map(t => ({ id: t.id, title: t.title, status: t.status, groupId: t.groupId })));\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching freelancer tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب مهامك\" });\n    }\n  });\n\n  // Get single task details\n  app.get(\"/api/tasks/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const task = await storage.getTask(id);\n\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Check authorization: freelancer can only view their own tasks or available tasks\n      if (req.user?.userType === \"freelancer\") {\n        if (task.status !== \"available\" && task.freelancerId !== req.user.userId) {\n          return res.status(403).json({ error: \"ليس لديك صلاحية لعرض هذه المهمة\" });\n        }\n      }\n\n      res.json(task);\n    } catch (error) {\n      console.error(\"Error fetching task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهمة\" });\n    }\n  });\n\n  // Accept a task (freelancer assigns themselves)\n  app.post(\"/api/tasks/:id/accept\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Check if task exists and is available\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.status !== \"available\") {\n        return res.status(400).json({ error: \"هذه المهمة غير متاحة حالياً\" });\n      }\n\n      // Assign task to freelancer\n      const updatedTask = await storage.assignTask(id, req.user.userId);\n\n      if (!updatedTask) {\n        return res.status(400).json({ error: \"فشل قبول المهمة\" });\n      }\n\n      // Create notification for product owner\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (campaign) {\n        await storage.createNotification({\n          userId: campaign.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم قبول مهمة\",\n          message: `تم قبول المهمة \"${task.title}\" من قبل مستقل`,\n          type: \"task_assigned\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error accepting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء قبول المهمة\" });\n    }\n  });\n\n  // Submit task with report\n  app.patch(\"/api/tasks/:id/submit\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { submission } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!submission || !submission.trim()) {\n        return res.status(400).json({ error: \"التقرير مطلوب\" });\n      }\n\n      // Check if task exists and belongs to this freelancer\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتسليم هذه المهمة\" });\n      }\n\n      if (task.status !== \"assigned\" && task.status !== \"in_progress\") {\n        return res.status(400).json({ error: \"لا يمكن تسليم هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task with submission\n      const updatedTask = await storage.updateTask(id, {\n        submission,\n        status: \"submitted\",\n        submittedAt: new Date(),\n      });\n\n      if (!updatedTask) {\n        return res.status(500).json({ error: \"فشل تحديث المهمة\" });\n      }\n\n      // Create notification for product owner\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (campaign) {\n        await storage.createNotification({\n          userId: campaign.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم تسليم مهمة\",\n          message: `تم تسليم المهمة \"${task.title}\" من قبل المستقل`,\n          type: \"task_submitted\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error submitting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسليم المهمة\" });\n    }\n  });\n\n  // Update task status to in_progress (freelancer starts working)\n  app.patch(\"/api/tasks/:id/start\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لبدء هذه المهمة\" });\n      }\n\n      if (task.status !== \"assigned\") {\n        return res.status(400).json({ error: \"لا يمكن بدء هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error starting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء بدء المهمة\" });\n    }\n  });\n\n  // ============================================\n  // PRODUCT OWNER - TASKS MANAGEMENT\n  // ============================================\n\n  // Get all tasks for product owner's campaigns\n  app.get(\"/api/tasks/owner\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Get all campaigns for this product owner\n      const campaigns: Campaign[] = await storage.getCampaignsByOwner(req.user.userId);\n      const campaignIds = campaigns.map((c: Campaign) => c.id);\n\n      // Get all tasks for these campaigns\n      const allTasks: any[] = [];\n      for (const campaignId of campaignIds) {\n        const tasks = await storage.getTasksByCampaign(campaignId);\n        allTasks.push(...tasks);\n      }\n\n      res.json(allTasks);\n    } catch (error) {\n      console.error(\"Error fetching owner tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Approve a task (product owner)\n  app.patch(\"/api/tasks/:id/approve\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Verify ownership through campaign\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (!campaign || campaign.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية للموافقة على هذه المهمة\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن الموافقة على هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task\n      const updatedTask = await storage.updateTask(id, {\n        status: \"approved\",\n        feedback: feedback || \"\",\n        completedAt: new Date(),\n      });\n\n      if (!updatedTask) {\n        return res.status(500).json({ error: \"فشل تحديث المهمة\" });\n      }\n\n      // Create notification for freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على مهمتك\",\n          message: `تمت الموافقة على المهمة \"${task.title}\" وتم إضافة ${task.reward} ر.س إلى محفظتك`,\n          type: \"task_approved\",\n        });\n      }\n\n      // Update freelancer wallet - add reward to balance\n      if (task.freelancerId) {\n        const wallet = await storage.getWalletByFreelancer(task.freelancerId);\n        if (wallet) {\n          await storage.updateWallet(wallet.id, {\n            balance: (Number(wallet.balance) + Number(task.reward)).toString(),\n            totalEarned: (Number(wallet.totalEarned) + Number(task.reward)).toString(),\n          });\n\n          // Create transaction record\n          await storage.createTransaction({\n            walletId: wallet.id,\n            taskId: task.id,\n            type: \"earning\",\n            amount: task.reward.toString(),\n            status: \"completed\",\n            description: `مكافأة المهمة: ${task.title}`,\n          });\n        }\n\n        // Create notification for freelancer\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على المهمة\",\n          message: `تمت الموافقة على المهمة \"${task.title}\" وتم إضافة ${task.reward} ر.س لمحفظتك`,\n          type: \"task_approved\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error approving task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الموافقة على المهمة\" });\n    }\n  });\n\n  // Reject a task (product owner)\n  app.patch(\"/api/tasks/:id/reject\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!feedback || !feedback.trim()) {\n        return res.status(400).json({ error: \"يجب تقديم سبب الرفض\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      // Verify ownership through campaign\n      const campaign = await storage.getCampaign(task.campaignId);\n      if (!campaign || campaign.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لرفض هذه المهمة\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن رفض هذه المهمة في حالتها الحالية\" });\n      }\n\n      // Update task - return to in_progress for rework\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n        feedback,\n      });\n\n      if (!updatedTask) {\n        return res.status(500).json({ error: \"فشل تحديث المهمة\" });\n      }\n\n      // Create notification for freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم رفض المهمة\",\n          message: `تم رفض المهمة \"${task.title}\". يرجى مراجعة الملاحظات وإعادة التسليم`,\n          type: \"task_rejected\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error rejecting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفض المهمة\" });\n    }\n  });\n\n  // ============================================\n  // GROUP ROUTES - إدارة الجروبات\n  // ============================================\n\n  // Create a new group (freelancer only)\n  app.post(\"/api/groups\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { name, description, maxMembers = 700 } = req.body;\n\n      if (!name || !name.trim()) {\n        return res.status(400).json({ error: \"اسم الجروب مطلوب\" });\n      }\n\n      if (maxMembers < 1 || maxMembers > 700) {\n        return res.status(400).json({ error: \"الحد الأقصى للأعضاء يجب أن يكون بين 1 و 700\" });\n      }\n\n      // Just create the group - the storage method should handle everything\n      const group = await storage.createGroup({\n        name: name.trim(),\n        description: description?.trim() || \"\",\n        leaderId: req.user.userId,\n        maxMembers,\n        groupImage: req.body.groupImage || null,\n        status: \"active\",\n      });\n\n      // Remove these duplicate calls - they're already handled in createGroup\n      // await storage.addGroupMember({\n      //   groupId: group.id,\n      //   freelancerId: req.user.userId,\n      //   role: \"leader\",\n      // });\n      console.log(\"Group created with ID:\", group);\n\n      res.status(201).json(group);\n    } catch (error) {\n      console.error(\"Error creating group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء الجروب\" });\n    }\n  });\n\n  // Get all groups (for joining)\n  app.get(\"/api/groups\", async (req: AuthRequest, res) => {\n    try {\n      const groups = await storage.getAllGroups();\n      const finalGroups = await Promise.all(groups.map(async (group) => {\n        const leader = await storage.getFreelancer(group.leaderId);\n        const groupMembers = await storage.getGroupMembers(group.id);\n        const isJoined = req.user?.userId ? await storage.isGroupMember(group.id, req.user.userId) : false;\n\n        // Check if user has a pending or approved join request\n        let joinRequestStatus = null;\n        if (req.user?.userId && !isJoined) {\n          const joinRequest = await storage.getJoinRequestByFreelancer(group.id, req.user.userId);\n          if (joinRequest) {\n            joinRequestStatus = joinRequest.status; // pending, approved, rejected\n          }\n        }\n\n        // Get member details for the first 5 members\n        const membersToShow = await Promise.all(\n          groupMembers.slice(0, 5).map(async (member) => {\n            const memberDetails = await storage.getFreelancer(member.freelancerId);\n            return {\n              id: member.freelancerId,\n              name: memberDetails?.fullName || \"غير معروف\",\n              avatar: memberDetails?.profileImage || null,\n              role: member.role\n            };\n          })\n        );\n\n        return {\n          ...group,\n          leaderName: leader?.fullName || \"غير معروف\",\n          leaderImage: leader?.profileImage || null,\n          groupRating: await storage.getGroupRating(group.id),\n          isJoined: isJoined,\n          joinRequestStatus: joinRequestStatus,\n          memberCount: groupMembers.length,\n          membersToShow: membersToShow\n        };\n      }));\n      res.json(finalGroups);\n    } catch (error) {\n      console.error(\"Error fetching groups:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الجروبات\" });\n    }\n  });\n\n  // Get group by ID with details\n  app.get(\"/api/groups/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const group = await storage.getGroup(id);\n\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      const leader = await storage.getFreelancer(group.leaderId);\n\n      // Check if current user is a member of this group\n      const isMember = req.user?.userId ? await storage.isGroupMember(id, req.user.userId) : false;\n\n      // Get group projects statistics\n      const groupProjects = await storage.getProjectsByGroup(id);\n      const totalProjects = groupProjects.length;\n      const completedProjects = groupProjects.filter(project => project.status === 'completed').length;\n      const inProgressProjects = groupProjects.filter(project => project.status === 'in_progress').length;\n\n      const finalGroup = {\n        ...group,\n        leaderName: leader?.fullName || \"غير معروف\",\n        leaderImage: leader?.profileImage || null,\n        isMember: isMember,\n        totalProjects: totalProjects,\n        completedProjects: completedProjects,\n        inProgressProjects: inProgressProjects,\n        // You can also add other useful stats:\n        pendingProjects: groupProjects.filter(project => project.status === 'pending').length,\n        cancelledProjects: groupProjects.filter(project => project.status === 'cancelled').length,\n      };\n\n      res.json(finalGroup);\n    } catch (error) {\n      console.error(\"Error fetching group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات الجروب\" });\n    }\n  });\n\n  // Get groups where user is leader\n  app.get(\"/api/groups/my/leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const groups = await storage.getGroupsByLeader(req.user.userId);\n      res.json(groups);\n    } catch (error) {\n      console.error(\"Error fetching leader groups:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الجروبات\" });\n    }\n  });\n\n  // Join a group (freelancer only)\n  app.post(\"/api/groups/:id/join\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      if (group.status !== \"active\") {\n        return res.status(400).json({ error: \"هذا الجروب غير نشط\" });\n      }\n\n      // Check if already a member\n      const isMember = await storage.isGroupMember(id, req.user.userId);\n      if (isMember) {\n        return res.status(400).json({ error: \"أنت عضو بالفعل في هذا الجروب\" });\n      }\n\n      // Check if group is full\n      if (group.currentMembers >= group.maxMembers) {\n        return res.status(400).json({ error: \"الجروب ممتلئ (الحد الأقصى 700 عضو)\" });\n      }\n\n      // Check for existing join request\n      const existingRequest = await storage.getJoinRequestByFreelancer(id, req.user.userId);\n\n      if (group.privacy === \"private\") {\n        // For private groups, check if there's an approved request\n        if (existingRequest?.status === \"approved\") {\n          // Approved request exists, add member directly\n          const member = await storage.addGroupMember({\n            groupId: id,\n            freelancerId: req.user.userId,\n            role: \"member\",\n          });\n\n          await storage.updateGroup(id, { currentMembers: group.currentMembers + 1 });\n\n          // Mark request as completed by deleting it or updating status\n          // For now, we'll delete it as the user is now a member\n          // await storage.deleteJoinRequest(existingRequest.id);\n\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"عضو جديد انضم للجروب\",\n            message: `انضم عضو جديد إلى جروب \"${group.name}\"`,\n            type: \"group_member_joined\",\n          });\n\n          return res.status(201).json({ message: \"تم الانضمام للجروب بنجاح\", member });\n        } else if (existingRequest?.status === \"pending\") {\n          return res.status(400).json({ \n            error: \"لديك طلب انضمام قيد المراجعة بالفعل\",\n            request: existingRequest \n          });\n        } else {\n          // No approved request, create a new request\n          const request = await storage.createJoinRequest({\n            groupId: id,\n            freelancerId: req.user.userId,\n            status: \"pending\",\n            createdAt: new Date(),\n          });\n\n          // Notify group leader about the request\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"طلب انضمام جديد\",\n            message: `طلب انضمام جديد إلى مجموعة \"${group.name}\"`,\n            type: \"group_join_requested\",\n          });\n\n          return res.status(201).json({ message: \"تم إرسال طلب الانضمام للمراجعة\", request });\n        }\n      } else {\n        // Public group: add member directly (original logic)\n        const member = await storage.addGroupMember({\n          groupId: id,\n          freelancerId: req.user.userId,\n          role: \"member\",\n        });\n\n        await storage.updateGroup(id, { currentMembers: group.currentMembers + 1 });\n\n        await storage.createNotification({\n          userId: group.leaderId,\n          userType: \"freelancer\",\n          title: \"عضو جديد انضم للجروب\",\n          message: `انضم عضو جديد إلى جروب \"${group.name}\"`,\n          type: \"group_member_joined\",\n        });\n\n        return res.status(201).json({ message: \"تم الانضمام للجروب بنجاح\", member });\n      }\n    } catch (error: any) {\n      // Handle unique constraint violation\n      if (error?.code === \"23505\" || error?.message?.includes(\"unique\")) {\n        return res.status(400).json({ error: \"أنت عضو بالفعل في هذا الجروب\" });\n      }\n      console.error(\"Error joining group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الانضمام للجروب\" });\n    }\n  });\n\n  // Leave a group (freelancer only, not leader)\n  app.post(\"/api/groups/:id/leave\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Check if user is the leader\n      if (group.leaderId === req.user.userId) {\n        // If leader wants to leave, check if they're the only member\n        const groupMembers = await storage.getGroupMembers(id);\n\n        if (groupMembers.length === 1 && groupMembers[0].freelancerId === req.user.userId) {\n          // Leader is the only member - delete the entire group\n          await storage.removeGroupMember(id, req.user.userId);\n          return res.json({\n            message: \"تم حذف الجروب بنجاح حيث كنت العضو الوحيد\",\n            groupDeleted: true\n          });\n        } else {\n          return res.status(400).json({\n            error: \"لا يمكن لقائد الجروب المغادرة. يجب عليك نقل القيادة أولاً أو حذف الجروب\"\n          });\n        }\n      }\n\n      const isMember = await storage.isGroupMember(id, req.user.userId);\n      if (!isMember) {\n        return res.status(400).json({ error: \"أنت لست عضواً في هذا الجروب\" });\n      }\n\n      await storage.removeGroupMember(id, req.user.userId);\n\n      // Update member count\n      await storage.updateGroup(id, {\n        currentMembers: Math.max(0, group.currentMembers - 1),\n      });\n\n      res.json({\n        message: \"تم المغادرة من الجروب بنجاح\",\n        groupDeleted: false\n      });\n    } catch (error) {\n      console.error(\"Error leaving group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء المغادرة من الجروب\" });\n    }\n  });\n\n  // Get group members with freelancer details\n  app.get(\"/api/groups/:id/members\", async (req, res) => {\n    try {\n      const { id } = req.params;\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      const members = await storage.getGroupMembers(id);\n\n      // Enhance members with freelancer details\n      const enhancedMembers = await Promise.all(\n        members.map(async (member) => {\n          const freelancer = await storage.getFreelancer(member.freelancerId);\n          return {\n            ...member,\n            freelancer: {\n              id: freelancer?.id,\n              fullName: freelancer?.fullName || \"غير معروف\",\n              username: freelancer?.username,\n              email: freelancer?.email,\n              profileImage: freelancer?.profileImage,\n              jobTitle: freelancer?.jobTitle,\n              bio: freelancer?.bio,\n              services: freelancer?.services,\n              isVerified: freelancer?.isVerified,\n              lastSeen: freelancer?.lastSeen,\n              createdAt: freelancer?.createdAt,\n            }\n          };\n        })\n      );\n\n      res.json(enhancedMembers);\n    } catch (error) {\n      console.error(\"Error fetching group members:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب أعضاء الجروب\" });\n    }\n  });\n\n  // Remove member from group (leader only)\n  app.delete(\"/api/groups/:groupId/members/:freelancerId\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId, freelancerId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can remove members\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه إزالة الأعضاء\" });\n      }\n\n      // Can't remove the leader\n      if (freelancerId === group.leaderId) {\n        return res.status(400).json({ error: \"لا يمكن إزالة قائد الجروب\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, freelancerId);\n      if (!isMember) {\n        return res.status(404).json({ error: \"العضو غير موجود في الجروب\" });\n      }\n\n      await storage.removeGroupMember(groupId, freelancerId);\n\n      // Update member count\n      await storage.updateGroup(groupId, {\n        currentMembers: Math.max(1, group.currentMembers - 1),\n      });\n\n      // Notify removed member\n      await storage.createNotification({\n        userId: freelancerId,\n        userType: \"freelancer\",\n        title: \"تمت إزالتك من الجروب\",\n        message: `تمت إزالتك من جروب \"${group.name}\"`,\n        type: \"group_member_removed\",\n      });\n\n      res.json({ message: \"تم إزالة العضو من الجروب بنجاح\" });\n    } catch (error) {\n      console.error(\"Error removing group member:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إزالة العضو\" });\n    }\n  });\n\n  // Update group details (leader only)\n  app.patch(\"/api/groups/:id\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can update\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه تحديث البيانات\" });\n      }\n\n      // Don't allow certain fields to be updated\n      delete updates.id;\n      delete updates.leaderId;\n      delete updates.currentMembers;\n      delete updates.createdAt;\n\n      // Validate maxMembers if provided\n      if (updates.maxMembers !== undefined) {\n        if (updates.maxMembers < group.currentMembers) {\n          return res.status(400).json({\n            error: `لا يمكن تقليل الحد الأقصى إلى أقل من العدد الحالي (${group.currentMembers} عضو)`\n          });\n        }\n        if (updates.maxMembers > 700) {\n          return res.status(400).json({ error: \"الحد الأقصى للأعضاء هو 700\" });\n        }\n      }\n\n      const updatedGroup = await storage.updateGroup(id, updates);\n      res.json(updatedGroup);\n    } catch (error) {\n      console.error(\"Error updating group:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الجروب\" });\n    }\n  });\n\n  // Get group join requests (leader only)\n  app.get(\"/api/groups/:id/requests\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const group = await storage.getGroup(id);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can view requests\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه عرض طلبات الانضمام\" });\n      }\n\n      const requests = await storage.getJoinRequestsByGroup(id);\n\n      // Enhance requests with freelancer details\n      const enhancedRequests = await Promise.all(\n        requests.map(async (request) => {\n          const freelancer = await storage.getFreelancer(request.freelancerId);\n          return {\n            ...request,\n            freelancer: {\n              id: freelancer?.id,\n              fullName: freelancer?.fullName || \"غير معروف\",\n              username: freelancer?.username,\n              profileImage: freelancer?.profileImage,\n              jobTitle: freelancer?.jobTitle,\n            }\n          };\n        })\n      );\n\n      res.json(enhancedRequests);\n    } catch (error) {\n      console.error(\"Error fetching group requests:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب طلبات الانضمام\" });\n    }\n  });\n\n  // Approve/Reject group join request (leader only)\n  app.patch(\"/api/groups/:groupId/requests/:requestId\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId, requestId } = req.params;\n      const { status } = req.body; // approved, rejected\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (![\"approved\", \"rejected\"].includes(status)) {\n        return res.status(400).json({ error: \"حالة الطلب غير صحيحة\" });\n      }\n\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Only leader can manage requests\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه إدارة طلبات الانضمام\" });\n      }\n\n      // Get the request\n      const requests = await storage.getJoinRequestsByGroup(groupId);\n      const request = requests.find(r => r.id === requestId);\n\n      if (!request) {\n        return res.status(404).json({ error: \"طلب الانضمام غير موجود\" });\n      }\n\n      if (request.status !== \"pending\") {\n        return res.status(400).json({ error: \"تمت معالجة هذا الطلب مسبقاً\" });\n      }\n\n      // Update request status\n      const updatedRequest = await storage.updateJoinRequest(requestId, {\n        status,\n        reviewedAt: new Date(),\n      });\n\n      // If approved, just update status and notify - user will join when they click\n      if (status === \"approved\") {\n        // Notify user that their request was approved\n        await storage.createNotification({\n          userId: request.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم قبول طلب انضمامك\",\n          message: `تم قبول طلب انضمامك لجروب \"${group.name}\". يمكنك الآن الانضمام للجروب!`,\n          type: \"group_join_approved\",\n        });\n      } else {\n        // Notify user of rejection\n        await storage.createNotification({\n          userId: request.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم رفض طلب انضمامك\",\n          message: `عذراً، تم رفض طلب انضمامك لجروب \"${group.name}\"`,\n          type: \"group_join_rejected\",\n        });\n      }\n\n      res.json(updatedRequest);\n    } catch (error) {\n      console.error(\"Error updating group request:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث طلب الانضمام\" });\n    }\n  });\n\n  // ============================================\n  // PROJECT ROUTES - إدارة المشاريع\n  // ============================================\n\n  // Create a new project (product owner only)\n  app.post(\"/api/projects\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { title, description, targetCountry, tasksCount, budget, deadline, paid, groupId } = req.body;\n\n      if (!title || !title.trim()) {\n        return res.status(400).json({ error: \"عنوان المشروع مطلوب\" });\n      }\n\n      if (!tasksCount || tasksCount < 1) {\n        return res.status(400).json({ error: \"عدد المهام يجب أن يكون 1 على الأقل\" });\n      }\n\n      if (!budget || budget < 0) {\n        return res.status(400).json({ error: \"الميزانية غير صحيحة\" });\n      }\n\n      // Create project\n      const project = await storage.createProject({\n        productOwnerId: req.user.userId,\n        title: title.trim(),\n        description: description?.trim() || \"\",\n        targetCountry: targetCountry || \"\",\n        tasksCount,\n        budget,\n        deadline: deadline ? new Date(deadline) : null,\n        status: paid ? \"active\" : \"pending\",\n      });\n\n      // If paid, automatically create group and tasks\n      if (paid && project) {\n        try {\n          // Create a group for this project\n          const newGroup = await storage.createGroup({\n            name: `${title} - فريق العمل`,\n            description: `مجموعة لإدارة مشروع: ${title}`,\n            leaderId: req.user.userId, // Temporarily set owner as leader, will be updated when freelancer accepts\n            maxMembers: tasksCount,\n            status: \"active\",\n          });\n\n          // Update project with groupId\n          if (newGroup && groupId) {\n            await storage.acceptProject(project.id, newGroup.id);\n          }\n\n          // Create tasks for each member\n          const rewardPerTask = Math.floor(budget / tasksCount);\n          const taskPromises = [];\n          \n          for (let i = 1; i <= tasksCount; i++) {\n            taskPromises.push(\n              storage.createTask({\n                projectId: project.id,\n                groupId: newGroup.id,\n                title: `${title} - مهمة ${i}`,\n                description: description?.trim() || `مهمة رقم ${i} من مشروع ${title}`,\n                serviceType: \"app_reviews\", // Default, should be passed from frontend\n                targetCountry: targetCountry || \"all\",\n                reward: rewardPerTask.toString(),\n                status: \"available\",\n                deadline: deadline ? new Date(deadline) : null,\n              })\n            );\n          }\n\n          await Promise.all(taskPromises);\n\n          // Add product owner as spectator to view progress\n          await storage.addGroupSpectator({\n            groupId: newGroup.id,\n            productOwnerId: req.user.userId,\n            role: \"spectator\",\n          });\n\n          // Create notification for product owner\n          await storage.createNotification({\n            userId: req.user.userId,\n            userType: \"product_owner\",\n            title: \"تم إنشاء المشروع والمجموعة\",\n            message: `تم إنشاء مشروع \"${title}\" وإنشاء ${tasksCount} مهمة تلقائياً. المهام متاحة الآن للمستقلين.`,\n            type: \"project_created\",\n          });\n\n          res.status(201).json({\n            project,\n            group: newGroup,\n            tasksCreated: tasksCount,\n            message: \"تم إنشاء المشروع والمجموعة والمهام بنجاح\"\n          });\n        } catch (error) {\n          console.error(\"Error creating group and tasks:\", error);\n          // Project was created, return it even if group/tasks failed\n          res.status(201).json({\n            project,\n            error: \"تم إنشاء المشروع ولكن حدث خطأ في إنشاء المجموعة والمهام\"\n          });\n        }\n      } else {\n        res.status(201).json(project);\n      }\n    } catch (error) {\n      console.error(\"Error creating project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المشروع\" });\n    }\n  });\n\n  // Get all pending projects (for group leaders to browse)\n  app.get(\"/api/projects/pending\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const projects = await storage.getPendingProjects();\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching pending projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get projects by product owner\n  app.get(\"/api/projects/my\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const projects = await storage.getProjectsByOwner(req.user.userId);\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching owner projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get projects accepted by a group\n  app.get(\"/api/projects/group/:groupId\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض مشاريع هذا الجروب\" });\n      }\n\n      const projects = await storage.getProjectsByGroup(groupId);\n      res.json(projects);\n    } catch (error) {\n      console.error(\"Error fetching group projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المشاريع\" });\n    }\n  });\n\n  // Get single project details\n  app.get(\"/api/projects/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      res.json(project);\n    } catch (error) {\n      console.error(\"Error fetching project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب بيانات المشروع\" });\n    }\n  });\n\n  // Accept a project (group leader only)\n  app.post(\"/api/projects/:id/accept\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { groupId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!groupId) {\n        return res.status(400).json({ error: \"معرف الجروب مطلوب\" });\n      }\n\n      // Verify user is the group leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      if (group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه قبول المشاريع\" });\n      }\n\n      if (group.status !== \"active\") {\n        return res.status(400).json({ error: \"الجروب غير نشط\" });\n      }\n\n      // Verify project exists and is pending\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      if (project.status !== \"pending\") {\n        return res.status(400).json({ error: \"هذا المشروع تم قبوله بالفعل أو مكتمل\" });\n      }\n\n      // Accept the project\n      const updatedProject = await storage.acceptProject(id, groupId);\n\n      // Notify product owner\n      await storage.createNotification({\n        userId: project.productOwnerId,\n        userType: \"product_owner\",\n        title: \"تم قبول المشروع\",\n        message: `تم قبول مشروع \"${project.title}\" من قبل جروب \"${group.name}\"`,\n        type: \"project_accepted\",\n      });\n\n      res.json(updatedProject);\n    } catch (error) {\n      console.error(\"Error accepting project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء قبول المشروع\" });\n    }\n  });\n\n  // Update project status\n  app.patch(\"/api/projects/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      // Verify ownership\n      if (project.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لتحديث هذا المشروع\" });\n      }\n\n      // Don't allow certain fields to be updated\n      delete updates.id;\n      delete updates.productOwnerId;\n      delete updates.acceptedByGroupId;\n      delete updates.createdAt;\n\n      const updatedProject = await storage.updateProject(id, updates);\n      res.json(updatedProject);\n    } catch (error) {\n      console.error(\"Error updating project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث المشروع\" });\n    }\n  });\n\n  // Delete a project (product owner only, only if pending)\n  app.delete(\"/api/projects/:id\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const project = await storage.getProject(id);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      // Verify ownership\n      if (project.productOwnerId !== req.user.userId) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لحذف هذا المشروع\" });\n      }\n\n      // Only allow deletion if pending\n      if (project.status !== \"pending\") {\n        return res.status(400).json({ error: \"لا يمكن حذف مشروع تم قبوله أو جاري العمل عليه\" });\n      }\n\n      await storage.deleteProject(id);\n      res.json({ message: \"تم حذف المشروع بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting project:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف المشروع\" });\n    }\n  });\n\n  // ============================================\n  // TASK ROUTES (NEW - للمهام المرتبطة بالمشاريع والجروبات)\n  // ============================================\n\n  // Create tasks for a project (group leader only, after accepting project)\n  app.post(\"/api/projects/:projectId/tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { projectId } = req.params;\n      const { tasks } = req.body; // Array of task objects\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!tasks || !Array.isArray(tasks) || tasks.length === 0) {\n        return res.status(400).json({ error: \"يجب تحديد مهمة واحدة على الأقل\" });\n      }\n\n      // Verify project\n      const project = await storage.getProject(projectId);\n      if (!project) {\n        return res.status(404).json({ error: \"المشروع غير موجود\" });\n      }\n\n      if (!project.acceptedByGroupId) {\n        return res.status(400).json({ error: \"يجب قبول المشروع أولاً\" });\n      }\n\n      // Verify user is the group leader\n      const group = await storage.getGroup(project.acceptedByGroupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه إنشاء المهام\" });\n      }\n\n      // Create tasks\n      const createdTasks = [];\n      for (const taskData of tasks) {\n        // Calculate platform fee (10%) and net reward\n        const reward = parseFloat(taskData.reward || \"0\");\n        const platformFee = (reward * 0.10).toFixed(2);\n        const netReward = (reward - parseFloat(platformFee)).toFixed(2);\n\n        const task = await storage.createTask({\n          projectId,\n          groupId: project.acceptedByGroupId,\n          freelancerId: taskData.freelancerId || null,\n          title: taskData.title,\n          description: taskData.description || \"\",\n          taskUrl: taskData.taskUrl || \"\",\n          reward: taskData.reward || \"0\",\n          platformFee,\n          netReward,\n          status: taskData.freelancerId ? \"assigned\" : \"available\",\n          campaignId: \"\", // Not used in new system\n        });\n        createdTasks.push(task);\n\n        // Notify assigned freelancer if any\n        if (taskData.freelancerId) {\n          await storage.createNotification({\n            userId: taskData.freelancerId,\n            userType: \"freelancer\",\n            title: \"تم تعيين مهمة جديدة لك\",\n            message: `تم تعيين مهمة \"${task.title}\" لك في مشروع \"${project.title}\" بمكافأة $${netReward} (بعد خصم رسوم المنصة 10%)`,\n            type: \"task_assigned\",\n          });\n        }\n      }\n\n      res.status(201).json(createdTasks);\n    } catch (error) {\n      console.error(\"Error creating tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المهام\" });\n    }\n  });\n\n  // Get tasks for a project\n  app.get(\"/api/projects/:projectId/tasks\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { projectId } = req.params;\n\n      const tasks = await storage.getTasksByProject(projectId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching project tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Get tasks assigned to current user\n  app.get(\"/api/tasks/my/assigned\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const tasks = await storage.getTasksByFreelancer(req.user.userId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching assigned tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // Assign task to group member (leader only)\n  app.patch(\"/api/tasks/:id/assign\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { freelancerId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!freelancerId) {\n        return res.status(400).json({ error: \"معرف العضو مطلوب\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه تعيين المهام\" });\n      }\n\n      // Verify freelancer is group member\n      const isMember = await storage.isGroupMember(task.groupId, freelancerId);\n      if (!isMember) {\n        return res.status(400).json({ error: \"العضو المحدد ليس في الجروب\" });\n      }\n\n      if (task.status !== \"available\") {\n        return res.status(400).json({ error: \"هذه المهمة تم تعيينها بالفعل أو مكتملة\" });\n      }\n\n      // Assign task\n      const updatedTask = await storage.updateTask(id, {\n        freelancerId,\n        status: \"assigned\",\n      });\n\n      if (!updatedTask) {\n        return res.status(500).json({ error: \"فشل تحديث المهمة\" });\n      }\n\n      // Notify freelancer\n      await storage.createNotification({\n        userId: freelancerId,\n        userType: \"freelancer\",\n        title: \"تم تعيين مهمة جديدة لك\",\n        message: `تم تعيين مهمة \"${task.title}\" لك`,\n        type: \"task_assigned\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error assigning task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تعيين المهمة\" });\n    }\n  });\n\n  // Start working on task\n  app.patch(\"/api/tasks/:id/start-work\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"هذه المهمة غير معينة لك\" });\n      }\n\n      if (task.status !== \"assigned\") {\n        return res.status(400).json({ error: \"لا يمكن البدء بهذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\",\n      });\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error starting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء بدء المهمة\" });\n    }\n  });\n\n  // Submit task with proof image\n  app.patch(\"/api/tasks/:id/submit-proof\", authMiddleware, requireRole([\"freelancer\"]), upload.single(\"proofImage\"), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { report } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (task.freelancerId !== req.user.userId) {\n        return res.status(403).json({ error: \"هذه المهمة غير معينة لك\" });\n      }\n\n      if (task.status !== \"in_progress\") {\n        return res.status(400).json({ error: \"يجب أن تكون المهمة قيد التنفيذ للتسليم\" });\n      }\n\n      let proofImagePath: string | null = null;\n\n      // Handle proof image upload if provided\n      if (req.file) {\n        const uploadDir = join(process.cwd(), \"uploads\", \"task-proofs\");\n        if (!existsSync(uploadDir)) {\n          await mkdir(uploadDir, { recursive: true });\n        }\n\n        const filename = `proof-${id}-${Date.now()}.${req.file.originalname.split('.').pop()}`;\n        const filepath = join(uploadDir, filename);\n        await writeFile(filepath, req.file.buffer);\n        proofImagePath = `/uploads/task-proofs/${filename}`;\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"submitted\",\n        proofImage: proofImagePath,\n        report: report || \"\",\n      });\n\n      if (!updatedTask) {\n        return res.status(500).json({ error: \"فشل تحديث المهمة\" });\n      }\n\n      // Notify group leader\n      if (task.groupId) {\n        const group = await storage.getGroup(task.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم تسليم مهمة للمراجعة\",\n            message: `تم تسليم مهمة \"${task.title}\" من قبل أحد الأعضاء`,\n            type: \"task_submitted\",\n          });\n        }\n      }\n\n      // If this task references a group post via taskUrl (/posts/:postId), create a comment on that post\n      // If this task references a group post via taskUrl, create a comment on that post\n      try {\n        if (updatedTask.taskUrl && typeof updatedTask.taskUrl === 'string') {\n          // Match both old format (/posts/:id) and new format (?postId=:id)\n          let postId: string | null = null;\n\n          const urlObj = new URL(updatedTask.taskUrl, \"http://dummy.com\"); // Dummy base for relative URLs\n          const postIdParam = urlObj.searchParams.get(\"postId\");\n\n          if (postIdParam) {\n            postId = postIdParam;\n          } else {\n            const match = updatedTask.taskUrl.match(/\\/posts\\/(.+)$/);\n            if (match && match[1]) {\n              postId = match[1];\n            }\n          }\n\n          if (postId && updatedTask.freelancerId) {\n            // Check if comment already exists to avoid duplicates (optional but good)\n            // For now, just create it\n            const commentContent = `تم إكمال المهمة: ${updatedTask.title || ''}`;\n\n            await storage.createComment({\n              postId,\n              authorId: updatedTask.freelancerId,\n              content: commentContent,\n              imageUrl: updatedTask.proofImage || null,\n            });\n          }\n        }\n      } catch (err) {\n        console.error('Error auto-commenting on related post after task submission:', err);\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error submitting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسليم المهمة\" });\n    }\n  });\n\n  // Review and approve task (group leader only)\n  app.patch(\"/api/tasks/:id/approve-by-leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه الموافقة على المهام\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن الموافقة على هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"approved\",\n        feedback: feedback || \"تمت الموافقة\",\n      });\n\n      // Update freelancer earnings with net reward (after platform fee)\n      if (task.freelancerId && task.netReward) {\n        const freelancer = await storage.getFreelancer(task.freelancerId);\n        if (freelancer) {\n          const currentEarnings = parseFloat(freelancer.totalEarnings || \"0\");\n          const netReward = parseFloat(task.netReward);\n          const newEarnings = (currentEarnings + netReward).toFixed(2);\n\n          await storage.updateFreelancerEarnings(task.freelancerId, newEarnings);\n        }\n      }\n\n      // Notify freelancer\n      if (task.freelancerId) {\n        const netAmount = task.netReward || (parseFloat(task.reward) - parseFloat(task.platformFee || \"0\")).toFixed(2);\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تمت الموافقة على مهمتك\",\n          message: `تمت الموافقة على مهمة \"${task.title}\". تمت إضافة $${netAmount} إلى رصيدك (بعد خصم رسوم المنصة 10%)`,\n          type: \"task_approved_by_leader\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error approving task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء الموافقة على المهمة\" });\n    }\n  });\n\n  // Reject task and request rework (group leader only)\n  app.patch(\"/api/tasks/:id/reject-by-leader\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n      const { feedback } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!feedback || !feedback.trim()) {\n        return res.status(400).json({ error: \"يجب تقديم سبب الرفض\" });\n      }\n\n      const task = await storage.getTask(id);\n      if (!task) {\n        return res.status(404).json({ error: \"المهمة غير موجودة\" });\n      }\n\n      if (!task.groupId) {\n        return res.status(400).json({ error: \"هذه المهمة غير مرتبطة بجروب\" });\n      }\n\n      // Verify user is group leader\n      const group = await storage.getGroup(task.groupId);\n      if (!group || group.leaderId !== req.user.userId) {\n        return res.status(403).json({ error: \"فقط قائد الجروب يمكنه رفض المهام\" });\n      }\n\n      if (task.status !== \"submitted\") {\n        return res.status(400).json({ error: \"لا يمكن رفض هذه المهمة في حالتها الحالية\" });\n      }\n\n      const updatedTask = await storage.updateTask(id, {\n        status: \"in_progress\", // Return to in_progress for rework\n        feedback: feedback.trim(),\n      });\n\n      // Notify freelancer\n      if (task.freelancerId) {\n        await storage.createNotification({\n          userId: task.freelancerId,\n          userType: \"freelancer\",\n          title: \"تم رفض المهمة\",\n          message: `تم رفض مهمة \"${task.title}\". يرجى مراجعة الملاحظات وإعادة التسليم`,\n          type: \"task_rejected_by_leader\",\n        });\n      }\n\n      res.json(updatedTask);\n    } catch (error) {\n      console.error(\"Error rejecting task:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء رفض المهمة\" });\n    }\n  });\n\n  // Get tasks for group (leader and members)\n  app.get(\"/api/groups/:groupId/tasks\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض مهام هذا الجروب\" });\n      }\n\n      const tasks = await storage.getTasksByGroup(groupId);\n      res.json(tasks);\n    } catch (error) {\n      console.error(\"Error fetching group tasks:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المهام\" });\n    }\n  });\n\n  // ============================================\n  // MESSAGES ROUTES - الرسائل الداخلية\n  // ============================================\n\n  // Send a message to group\n  app.post(\"/api/groups/:groupId/messages\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { content, type, relatedProjectId } = req.body;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      if (!content || !content.trim()) {\n        return res.status(400).json({ error: \"محتوى الرسالة مطلوب\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في الجروب لإرسال رسالة\" });\n      }\n\n\n      const message = await storage.createMessage({\n        groupId,\n        senderId: req.user.userId,\n        content: content.trim(),\n        type: type || \"text\",\n        relatedProjectId: relatedProjectId || null,\n      });\n\n      res.status(201).json(message);\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إرسال الرسالة\" });\n    }\n  });\n\n  // Get messages for a group\n  app.get(\"/api/groups/:groupId/messages\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Verify user is member of the group\n      const isMember = await storage.isGroupMember(groupId, req.user.userId);\n      if (!isMember) {\n        return res.status(403).json({ error: \"ليس لديك صلاحية لعرض رسائل هذا الجروب\" });\n      }\n\n      const messages = await storage.getMessagesByGroup(groupId);\n      res.json(messages);\n    } catch (error) {\n      console.error(\"Error fetching messages:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الرسائل\" });\n    }\n  });\n\n  // Mark messages as read\n  app.patch(\"/api/messages/:id/read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      const message = await storage.markMessageAsRead(id);\n      res.json(message);\n    } catch (error) {\n      console.error(\"Error marking message as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الرسالة\" });\n    }\n  });\n\n  // ============================================\n  // WITHDRAWALS ROUTES - طلبات السحب\n  // ============================================\n\n  // Create withdrawal request\n  app.post(\"/api/withdrawals\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const { amount, paymentMethod, accountNumber } = req.body;\n\n      if (!amount || amount <= 0) {\n        return res.status(400).json({ error: \"المبلغ غير صحيح\" });\n      }\n\n      if (!paymentMethod || !accountNumber) {\n        return res.status(400).json({ error: \"طريقة الدفع ورقم الحساب مطلوبان\" });\n      }\n\n      // Get freelancer wallet balance\n      const freelancer = await storage.getFreelancer(req.user.userId);\n      if (!freelancer) {\n        return res.status(404).json({ error: \"المستقل غير موجود\" });\n      }\n\n      if (parseFloat(freelancer.walletBalance) < amount) {\n        return res.status(400).json({ error: \"الرصيد غير كافٍ\" });\n      }\n\n      const withdrawal = await storage.createWithdrawal({\n        freelancerId: req.user.userId,\n        amount: amount.toString(),\n        paymentMethod,\n        accountNumber,\n        status: \"pending\",\n      });\n\n      // Create notification for freelancer\n      await storage.createNotification({\n        userId: req.user.userId,\n        userType: \"freelancer\",\n        title: \"طلب سحب جديد\",\n        message: `تم إنشاء طلب سحب بقيمة ${amount} ر.س. سيتم مراجعة الطلب قريباً`,\n        type: \"withdrawal_created\",\n      });\n\n      res.status(201).json(withdrawal);\n    } catch (error) {\n      console.error(\"Error creating withdrawal:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء طلب السحب\" });\n    }\n  });\n\n  // Get withdrawal requests for current freelancer\n  app.get(\"/api/withdrawals/my\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const withdrawals = await storage.getWithdrawalsByFreelancer(req.user.userId);\n      res.json(withdrawals);\n    } catch (error) {\n      console.error(\"Error fetching withdrawals:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب طلبات السحب\" });\n    }\n  });\n\n  // ============================================\n  // WALLET ROUTES - المحفظة\n  // ============================================\n\n  // Get wallet for current freelancer\n  app.get(\"/api/wallet\", authMiddleware, requireRole([\"freelancer\"]), async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const wallet = await storage.getWalletByFreelancer(req.user.userId);\n      if (!wallet) {\n        return res.status(404).json({ error: \"المحفظة غير موجودة\" });\n      }\n\n      res.json(wallet);\n    } catch (error) {\n      console.error(\"Error fetching wallet:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المحفظة\" });\n    }\n  });\n\n  // ============================================\n  // NOTIFICATIONS ROUTES - الإشعارات\n  // ============================================\n\n  // Get notifications for current user\n  app.get(\"/api/notifications\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const notifications = await storage.getNotificationsByUser(req.user.userId, req.user.userType);\n      res.json(notifications);\n    } catch (error) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الإشعارات\" });\n    }\n  });\n\n  // Mark notification as read\n  app.patch(\"/api/notifications/:id/read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { id } = req.params;\n\n      if (!req.user?.userId) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      // Not implemented in storage, so just mark as read\n      await storage.markNotificationAsRead(id);\n      res.json({ message: \"تم تحديث الإشعار\" });\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الإشعار\" });\n    }\n  });\n\n  // Mark all notifications as read\n  app.patch(\"/api/notifications/mark-all-read\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      await storage.markAllNotificationsAsRead(req.user.userId, req.user.userType);\n      res.json({ message: \"تم تحديد جميع الإشعارات كمقروءة\" });\n    } catch (error) {\n      console.error(\"Error marking all notifications as read:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الإشعارات\" });\n    }\n  });\n\n  // Get unread notification count\n  app.get(\"/api/notifications/unread/count\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      if (!req.user?.userId || !req.user?.userType) {\n        return res.status(401).json({ error: \"غير مصرح\" });\n      }\n\n      const count = await storage.getUnreadNotificationCount(req.user.userId, req.user.userType);\n      res.json({ count });\n    } catch (error) {\n      console.error(\"Error fetching unread count:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب عدد الإشعارات\" });\n    }\n  });\n\n  // ============================================\n  // ORDERS MANAGEMENT\n  // ============================================\n\n  // Create new order\n  app.post(\"/api/orders\", authMiddleware, requireRole([\"product_owner\"]), async (req: AuthRequest, res) => {\n    try {\n      const validatedData = insertOrderSchema.parse(req.body);\n\n      // Get group info to know member count\n      const group = await storage.getGroupById(validatedData.groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      // Use fixed distribution: $10 to platform, $3 to group leader, remainder to members\n      const totalAmount = parseFloat(validatedData.totalAmount.toString());\n      const platformFee = 10.0; // fixed platform fee in currency units\n      const leaderCommission = 3.0; // fixed leader/admin commission\n\n      // Ensure platformFee + leaderCommission <= totalAmount\n      const remaining = Math.max(0, totalAmount - platformFee - leaderCommission);\n\n      const memberDistribution = remaining.toFixed(2);\n      const groupMembersCount = group.currentMembers || 1;\n      const perMemberAmount = (parseFloat(memberDistribution) / groupMembersCount).toFixed(2);\n\n      // Store platformFee and leaderCommission as strings for DB fields\n      const platformFeeStr = platformFee.toFixed(2);\n      const leaderCommissionStr = leaderCommission.toFixed(2);\n\n      const order = await storage.createOrder({\n        ...validatedData,\n        productOwnerId: req.user!.userId,\n        platformFee: platformFeeStr,\n        netAmount: (totalAmount - platformFee).toFixed(2),\n        leaderCommission: leaderCommissionStr,\n        memberDistribution,\n        groupMembersCount,\n        perMemberAmount,\n      });\n\n      // Create notification for group leader\n      await storage.createNotification({\n        userId: group.leaderId,\n        userType: \"freelancer\",\n        title: \"طلب خدمة جديد\",\n        message: `لديك طلب خدمة جديد بقيمة $${totalAmount}. صافي الجروب: $${netAmount}، عمولتك: $${leaderCommission}، للأعضاء: $${memberDistribution}`,\n        type: \"order_created\",\n      });\n\n      res.status(201).json(order);\n    } catch (error: any) {\n      console.error(\"Error creating order:\", error);\n      res.status(400).json({ error: error.message || \"فشل في إنشاء الطلب\" });\n    }\n  });\n\n  // Get all orders (filtered by user role)\n  app.get(\"/api/orders\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { userId, userType } = req.user!;\n\n      let orders;\n      if (userType === \"product_owner\") {\n        orders = await storage.getOrdersByProductOwner(userId);\n      } else if (userType === \"freelancer\") {\n        // Get orders for groups led by this freelancer\n        orders = await storage.getOrdersByGroupLeader(userId);\n      } else {\n        orders = [];\n      }\n\n      res.json(orders);\n    } catch (error) {\n      console.error(\"Error fetching orders:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الطلبات\" });\n    }\n  });\n\n  // Get specific order\n  app.get(\"/api/orders/:id\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const order = await storage.getOrderById(req.params.id);\n\n      if (!order) {\n        return res.status(404).json({ error: \"الطلب غير موجود\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      console.error(\"Error fetching order:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الطلب\" });\n    }\n  });\n\n  // Update order status\n  app.patch(\"/api/orders/:id/status\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { status } = req.body;\n\n      if (!status) {\n        return res.status(400).json({ error: \"الحالة مطلوبة\" });\n      }\n\n      const order = await storage.updateOrderStatus(req.params.id, status);\n\n      if (!order) {\n        return res.status(404).json({ error: \"الطلب غير موجود\" });\n      }\n\n      // Create notifications based on status\n      if (status === \"payment_confirmed\") {\n        // Add product owner as a spectator to the group so they can view progress\n        try {\n          const isSpectator = await storage.isGroupSpectator(order.groupId, order.productOwnerId);\n          if (!isSpectator) {\n            await storage.addGroupSpectator({\n              groupId: order.groupId,\n              productOwnerId: order.productOwnerId,\n              role: \"spectator\",\n            });\n          }\n        } catch (err) {\n          console.error(\"Error adding product owner as group spectator:\", err);\n        }\n\n        // Automatically create tasks for group members when payment is confirmed\n        try {\n          const group = await storage.getGroup(order.groupId);\n          if (group) {\n            // Get all group members\n            const members = await storage.getGroupMembers(order.groupId);\n            \n            // Create a task for each member\n            const rewardPerTask = Math.floor(order.totalAmount / order.quantity);\n            const taskPromises = members.map((member: any, index: number) => \n              storage.createTask({\n                projectId: null, // Orders don't have projectId\n                groupId: order.groupId,\n                title: `${order.serviceType} - مهمة ${index + 1}`,\n                description: `مهمة من طلب بقيمة $${order.totalAmount}. نوع الخدمة: ${order.serviceType}`,\n                serviceType: order.serviceType,\n                targetCountry: \"all\",\n                reward: rewardPerTask.toString(),\n                status: \"available\",\n                deadline: null,\n              })\n            );\n\n            await Promise.all(taskPromises);\n            \n            console.log(`Created ${members.length} tasks for order ${order.id}`);\n\n            // Notify all group members about new tasks\n            for (const member of members) {\n              await storage.createNotification({\n                userId: member.freelancerId,\n                userType: \"freelancer\",\n                title: \"مهام جديدة متاحة\",\n                message: `تم إنشاء مهام جديدة من طلب بقيمة $${order.totalAmount}. تحقق من لوحة التحكم`,\n                type: \"new_tasks\",\n              });\n            }\n          }\n        } catch (err) {\n          console.error(\"Error creating tasks for order:\", err);\n        }\n\n        // Notify group leader\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم تأكيد الدفع\",\n            message: `تم تأكيد دفع الطلب بقيمة $${order.totalAmount}. تم إنشاء المهام تلقائياً لأعضاء المجموعة`,\n            type: \"payment_confirmed\",\n          });\n        }\n\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم تأكيد الدفع\",\n          message: `تم تأكيد دفع طلبك بقيمة $${order.totalAmount} وتم توزيع المهام على الفريق`,\n          type: \"payment_confirmed\",\n        });\n      } else if (status === \"in_progress\") {\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"الطلب قيد التنفيذ\",\n          message: `بدأ الفريق بتنفيذ طلبك`,\n          type: \"order_in_progress\",\n        });\n\n        // Notify group leader (freelancer)\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"طلب قيد التنفيذ\",\n            message: `تم تحويل الطلب بقيمة $${order.totalAmount} إلى حالة \"قيد التنفيذ\"`,\n            type: \"order_in_progress\",\n          });\n        }\n      } else if (status === \"completed\") {\n        // Notify product owner\n        await storage.createNotification({\n          userId: order.productOwnerId,\n          userType: \"product_owner\",\n          title: \"تم إكمال الطلب\",\n          message: `تم إكمال طلبك بنجاح`,\n          type: \"order_completed\",\n        });\n\n        // Notify group leader\n        const group = await storage.getGroup(order.groupId);\n        if (group) {\n          await storage.createNotification({\n            userId: group.leaderId,\n            userType: \"freelancer\",\n            title: \"تم إكمال الطلب\",\n            message: `تم إكمال الطلب بنجاح بقيمة $${order.totalAmount}`,\n            type: \"order_completed\",\n          });\n        }\n      }\n\n      res.json(order);\n    } catch (error) {\n      console.error(\"Error updating order:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تحديث الطلب\" });\n    }\n  });\n\n  // ============================================\n  // CONVERSATION ROUTES\n  // ============================================\n\n  // Get or create conversation\n  // Get all conversations for current user\n  app.get(\"/api/conversations\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const userType = req.user!.userType;\n      const userId = req.user!.userId;\n\n      let conversations;\n      if (userType === \"product_owner\") {\n        conversations = await storage.getProductOwnerConversations(userId);\n      } else if (userType === \"freelancer\") {\n        conversations = await storage.getFreelancerConversations(userId);\n      } else {\n        return res.status(400).json({ error: \"نوع المستخدم غير صحيح\" });\n      }\n\n      // Fetch group details for each conversation\n      const conversationsWithDetails = await Promise.all(\n        conversations.map(async (conv) => {\n          const group = await storage.getGroup(conv.groupId);\n          const leader = await storage.getFreelancer(conv.leaderId);\n          const productOwner = await storage.getProductOwner(conv.productOwnerId);\n\n          return {\n            ...conv,\n            group,\n            leader,\n            productOwner,\n          };\n        })\n      );\n\n      res.json(conversationsWithDetails);\n    } catch (error) {\n      console.error(\"Error fetching conversations:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المحادثات\" });\n    }\n  });\n\n  // Find or get conversation with a specific user\n  app.get(\"/api/conversations/find/:userId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { userId: targetUserId } = req.params;\n      const currentUserId = req.user!.userId;\n      const currentUserType = req.user!.userType;\n\n      // Find existing conversation between these users\n      const conversations = await storage.getConversationsBetweenUsers(\n        currentUserId,\n        targetUserId,\n        currentUserType\n      );\n\n      if (conversations && conversations.length > 0) {\n        return res.json(conversations[0]);\n      }\n\n      // No conversation found\n      return res.status(404).json({ error: \"لا توجد محادثة\" });\n    } catch (error) {\n      console.error(\"Error finding conversation:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء البحث عن المحادثة\" });\n    }\n  });\n\n  // Create a new conversation\n  app.post(\"/api/conversations\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { participantId, participantType, groupId } = req.body;\n      const currentUserId = req.user!.userId;\n      const currentUserType = req.user!.userType;\n\n      if (!participantId) {\n        return res.status(400).json({ error: \"معرف المشارك مطلوب\" });\n      }\n\n      // Check if conversation already exists\n      const existing = await storage.getConversationsBetweenUsers(\n        currentUserId,\n        participantId,\n        currentUserType\n      );\n\n      if (existing && existing.length > 0) {\n        return res.json(existing[0]);\n      }\n\n      // Create new conversation\n      let conversationData: any = {};\n\n      // Determine roles based on current user type\n      if (currentUserType === \"product_owner\") {\n        conversationData = {\n          productOwnerId: currentUserId,\n          leaderId: participantId,\n          groupId: groupId || null,\n        };\n      } else if (currentUserType === \"freelancer\") {\n        // If current user is freelancer, participant must be product owner\n        conversationData = {\n          productOwnerId: participantId,\n          leaderId: currentUserId,\n          groupId: groupId || null,\n        };\n      } else {\n        return res.status(400).json({ error: \"نوع المستخدم غير صحيح\" });\n      }\n\n      const conversation = await storage.getOrCreateConversation(\n        conversationData.productOwnerId,\n        conversationData.groupId || null,\n        conversationData.leaderId\n      );\n      res.json(conversation);\n    } catch (error) {\n      console.error(\"Error creating conversation:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المحادثة\" });\n    }\n  });\n\n  // Get conversation messages\n  app.get(\"/api/conversations/:id/messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const conversationId = req.params.id;\n\n      // Verify user has access to this conversation\n      const conversation = await storage.getConversation(conversationId);\n      if (!conversation) {\n        return res.status(404).json({ error: \"المحادثة غير موجودة\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Check if user is part of conversation\n      if (userType === \"product_owner\" && conversation.productOwnerId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n      if (userType === \"freelancer\" && conversation.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n\n      const messages = await storage.getConversationMessages(conversationId);\n\n      // Mark messages as read\n      await storage.markMessagesAsRead(conversationId, userId);\n\n      res.json(messages);\n    } catch (error) {\n      console.error(\"Error fetching messages:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الرسائل\" });\n    }\n  });\n\n  // Direct Messages endpoints\n  // Get direct messages with a specific user\n  app.get(\"/api/direct-messages/:userId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { userId: otherUserId } = req.params;\n      const { userType: otherUserType } = req.query;\n      const currentUserId = req.user!.userId;\n      const currentUserType = req.user!.userType;\n\n      if (!otherUserType) {\n        return res.status(400).json({ error: \"نوع المستخدم الآخر مطلوب\" });\n      }\n\n      const messages = await storage.getDirectMessages(\n        currentUserId,\n        currentUserType,\n        otherUserId,\n        otherUserType as string\n      );\n\n      res.json(messages);\n    } catch (error) {\n      console.error(\"Error fetching direct messages:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب الرسائل\" });\n    }\n  });\n\n  // Send direct message\n  app.post(\"/api/direct-messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { receiverId, receiverType, content } = req.body;\n      const senderId = req.user!.userId;\n      const senderType = req.user!.userType;\n\n      if (!receiverId || !receiverType || !content) {\n        return res.status(400).json({ error: \"جميع الحقول مطلوبة\" });\n      }\n\n      const message = await storage.sendDirectMessage(\n        senderId,\n        senderType,\n        receiverId,\n        receiverType,\n        content\n      );\n\n      res.json(message);\n    } catch (error) {\n      console.error(\"Error sending direct message:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إرسال الرسالة\" });\n    }\n  });\n\n  // Get all direct message conversations\n  app.get(\"/api/direct-messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      const conversations = await storage.getDirectMessageHistory(userId, userType);\n\n      res.json(conversations);\n    } catch (error) {\n      console.error(\"Error fetching direct message history:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المحادثات\" });\n    }\n  });\n\n  // Send message\n  app.post(\"/api/conversations/:id/messages\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const conversationId = req.params.id;\n      const { content } = req.body;\n\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى الرسالة مطلوب\" });\n      }\n\n      // Verify user has access to this conversation\n      const conversation = await storage.getConversation(conversationId);\n      if (!conversation) {\n        return res.status(404).json({ error: \"المحادثة غير موجودة\" });\n      }\n\n      const userId = req.user!.userId;\n      const userType = req.user!.userType;\n\n      // Check if user is part of conversation\n      if (userType === \"product_owner\" && conversation.productOwnerId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n      if (userType === \"freelancer\" && conversation.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح بالوصول لهذه المحادثة\" });\n      }\n\n      const message = await storage.sendMessage(conversationId, userId, userType, content);\n\n      // Create notification for the recipient\n      const recipientId = userType === \"product_owner\" ? conversation.leaderId : conversation.productOwnerId;\n      const recipientType = userType === \"product_owner\" ? \"freelancer\" : \"product_owner\";\n\n      await storage.createNotification({\n        userId: recipientId,\n        userType: recipientType,\n        title: \"رسالة جديدة\",\n        message: `لديك رسالة جديدة في المحادثة`,\n        type: \"new_message\",\n      });\n\n      res.json(message);\n    } catch (error) {\n      console.error(\"Error sending message:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إرسال الرسالة\" });\n    }\n  });\n\n  // ============================================\n  // GROUP POSTS ROUTES (Community Feature)\n  // ============================================\n\n  // Get posts by group (with optional filtering and sorting)\n  app.get(\"/api/groups/:groupId/posts\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { sort, mediaOnly } = req.query;\n      const userId = req.user!.userId;\n\n      // Verify user is a group member or leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"المجموعة غير موجودة\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, userId);\n      const isLeader = group.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      let posts = await storage.getPostsByGroup(groupId);\n\n      // Filter media-only posts if requested\n      if (mediaOnly === 'true') {\n        posts = posts.filter(post => post.imageUrl);\n      }\n\n      // Sort posts if requested\n      if (sort === 'popular') {\n        posts = posts.sort((a, b) => {\n          const scoreA = (a.likesCount || 0) + (a.commentsCount || 0);\n          const scoreB = (b.likesCount || 0) + (b.commentsCount || 0);\n          return scoreB - scoreA;\n        });\n      }\n\n      res.json(posts);\n    } catch (error) {\n      console.error(\"Error fetching group posts:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب المنشورات\" });\n    }\n  });\n\n  // Create post\n  app.post(\"/api/groups/:groupId/posts\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { groupId } = req.params;\n      const { content, imageUrl, createTask, taskReward, taskTitle } = req.body;\n      const userId = req.user!.userId;\n\n      // Validate content\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى المنشور مطلوب\" });\n      }\n\n      // Verify user is a group member or leader\n      const group = await storage.getGroup(groupId);\n      if (!group) {\n        return res.status(404).json({ error: \"المجموعة غير موجودة\" });\n      }\n\n      const isMember = await storage.isGroupMember(groupId, userId);\n      const isLeader = group.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const newPost = await storage.createPost({\n        groupId,\n        authorId: userId,\n        content: content.trim(),\n        imageUrl: imageUrl || null,\n      });\n\n      // If the author is the group leader AND they requested task creation\n      console.log(`[DEBUG] Post created. isLeader: ${isLeader}, createTask: ${createTask}, groupId: ${groupId}`);\n\n      if (isLeader && createTask) {\n        try {\n          const members = await storage.getGroupMembers(groupId);\n          console.log(`[DEBUG] Found ${members.length} members for group ${groupId}`);\n\n          const rewardAmount = taskReward ? String(taskReward) : \"0\";\n          const title = taskTitle || `مهمة من منشور المجموعة: ${content.trim().slice(0, 60)}`;\n\n          let createdCount = 0;\n          for (const member of members) {\n            // Skip the leader themself\n            if (member.freelancerId === userId) continue;\n\n            console.log(`[TASK CREATION] Creating task for member ${member.freelancerId}`);\n            const createdTask = await storage.createTask({\n              projectId: null,\n              campaignId: null,\n              groupId: groupId,\n              freelancerId: member.freelancerId,\n              title: title,\n              description: content.trim(),\n              taskUrl: `/groups/${groupId}/community?postId=${newPost.id}`, // Point to community page with postId param\n              serviceType: \"community_post\",\n              reward: rewardAmount,\n              platformFee: \"0\",\n              netReward: rewardAmount, // No fee for internal group tasks usually, or logic can be added\n              status: \"assigned\",\n            });\n            console.log(`[TASK CREATION] Task created with ID: ${createdTask.id} for member ${member.freelancerId}`);\n            createdCount++;\n\n            // Notify the member about the new task\n            await storage.createNotification({\n              userId: member.freelancerId,\n              userType: \"freelancer\",\n              title: \"مهمة جديدة\",\n              message: `تم إنشاء مهمة جديدة لك من منشور قائد الجروب: ${group.name}`,\n              type: \"task_assigned\",\n            });\n          }\n          console.log(`[DEBUG] Created ${createdCount} tasks for members.`);\n        } catch (err) {\n          console.error(\"Error auto-creating tasks for group post:\", err);\n          // Don't fail the request if task creation fails, just log it\n        }\n      }\n\n      res.status(201).json(newPost);\n    } catch (error) {\n      console.error(\"Error creating post:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء المنشور\" });\n    }\n  });\n\n  // Delete post\n  app.delete(\"/api/posts/:postId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Only author or group leader can delete\n      const group = await storage.getGroup(post.groupId);\n      if (post.authorId !== userId && group?.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح لك بحذف هذا المنشور\" });\n      }\n\n      await storage.deletePost(postId);\n      res.json({ message: \"تم حذف المنشور بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting post:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف المنشور\" });\n    }\n  });\n\n  // Get comments for a post\n  app.get(\"/api/posts/:postId/comments\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const comments = await storage.getCommentsByPost(postId);\n      res.json(comments);\n    } catch (error) {\n      console.error(\"Error fetching comments:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب التعليقات\" });\n    }\n  });\n\n  // Create comment\n  app.post(\"/api/posts/:postId/comments\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const { content, imageUrl } = req.body;\n      const userId = req.user!.userId;\n\n      if (!content || content.trim() === \"\") {\n        return res.status(400).json({ error: \"محتوى التعليق مطلوب\" });\n      }\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      const newComment = await storage.createComment({\n        postId,\n        authorId: userId,\n        content: content.trim(),\n        imageUrl: imageUrl || null,\n      });\n\n      // Auto-complete task if comment has image\n      if (imageUrl) {\n        try {\n          // Find assigned tasks for this user related to this post\n          // We look for tasks where taskUrl contains the postId\n          const userTasks = await storage.getTasksByFreelancer(userId);\n          const relatedTask = userTasks.find(t =>\n            t.status === 'assigned' &&\n            t.taskUrl &&\n            (t.taskUrl.includes(`postId=${postId}`) || t.taskUrl.includes(`/posts/${postId}`))\n          );\n\n          if (relatedTask) {\n            await storage.updateTask(relatedTask.id, {\n              status: \"submitted\",\n              proofImage: imageUrl,\n              report: content.trim(),\n              submittedAt: new Date(),\n            });\n\n            // Notify leader\n            const group = await storage.getGroup(post.groupId);\n            if (group) {\n              await storage.createNotification({\n                userId: group.leaderId,\n                userType: \"freelancer\",\n                title: \"تم تسليم مهمة (عبر التعليق)\",\n                message: `تم تسليم مهمة \"${relatedTask.title}\" تلقائياً عبر تعليق من ${req.user?.username || 'عضو'}`,\n                type: \"task_submitted\",\n              });\n            }\n          }\n        } catch (err) {\n          console.error(\"Error auto-completing task from comment:\", err);\n        }\n      }\n\n      res.status(201).json(newComment);\n    } catch (error) {\n      console.error(\"Error creating comment:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء إنشاء التعليق\" });\n    }\n  });\n\n  // Delete comment\n  app.delete(\"/api/comments/:commentId\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { commentId } = req.params;\n      const userId = req.user!.userId;\n\n      const [comment] = await db.select().from(postComments).where(eq(postComments.id, commentId));\n\n      if (!comment) {\n        return res.status(404).json({ error: \"التعليق غير موجود\" });\n      }\n\n      const post = await storage.getPost(comment.postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Only author or group leader can delete\n      const group = await storage.getGroup(post.groupId);\n      if (comment.authorId !== userId && group?.leaderId !== userId) {\n        return res.status(403).json({ error: \"غير مصرح لك بحذف هذا التعليق\" });\n      }\n\n      await storage.deleteComment(commentId);\n      res.json({ message: \"تم حذف التعليق بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting comment:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء حذف التعليق\" });\n    }\n  });\n\n  // Get reactions for a post\n  app.get(\"/api/posts/:postId/reactions\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      const reactions = await storage.getReactionsByPost(postId);\n      const userReaction = await storage.getUserReaction(postId, userId);\n\n      res.json({ reactions, userReaction });\n    } catch (error) {\n      console.error(\"Error fetching reactions:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء جلب التفاعلات\" });\n    }\n  });\n\n  // Toggle reaction (like/unlike)\n  app.post(\"/api/posts/:postId/reactions\", authMiddleware, async (req: AuthRequest, res) => {\n    try {\n      const { postId } = req.params;\n      const { type = \"like\" } = req.body;\n      const userId = req.user!.userId;\n\n      const post = await storage.getPost(postId);\n      if (!post) {\n        return res.status(404).json({ error: \"المنشور غير موجود\" });\n      }\n\n      // Verify user is a group member\n      const isMember = await storage.isGroupMember(post.groupId, userId);\n      const group = await storage.getGroup(post.groupId);\n      const isLeader = group?.leaderId === userId;\n\n      if (!isMember && !isLeader) {\n        return res.status(403).json({ error: \"يجب أن تكون عضواً في المجموعة\" });\n      }\n\n      // Check if user already reacted\n      const existingReaction = await storage.getUserReaction(postId, userId);\n\n      if (existingReaction) {\n        // Remove reaction (unlike)\n        await storage.deleteReaction(postId, userId);\n        res.json({ message: \"تم إلغاء الإعجاب\", liked: false });\n      } else {\n        // Add reaction (like)\n        await storage.createReaction({\n          postId,\n          userId,\n          type,\n        });\n        res.json({ message: \"تم الإعجاب بالمنشور\", liked: true });\n      }\n    } catch (error) {\n      console.error(\"Error toggling reaction:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء التفاعل مع المنشور\" });\n    }\n  });\n\n  // ============================================\n  // ADMIN DASHBOARD ROUTES\n  // ============================================\n\n  // Admin Login\n  app.post(\"/api/admin/login\", async (req, res) => {\n    try {\n      const { email, password } = req.body;\n\n      if (!email || !password) {\n        return res.status(400).json({ error: \"البريد الإلكتروني وكلمة المرور مطلوبان\" });\n      }\n\n      const { adminUsers, roles } = await import(\"@shared/schema\");\n\n      // Find admin user\n      const [admin] = await db.select().from(adminUsers).where(eq(adminUsers.email, email));\n\n      if (!admin) {\n        return res.status(401).json({ error: \"بيانات تسجيل الدخول غير صحيحة\" });\n      }\n\n      if (!admin.isActive) {\n        return res.status(403).json({ error: \"الحساب غير نشط\" });\n      }\n\n      // Verify password\n      const isValidPassword = await bcrypt.compare(password, admin.password);\n      if (!isValidPassword) {\n        return res.status(401).json({ error: \"بيانات تسجيل الدخول غير صحيحة\" });\n      }\n\n      // Get role\n      const [role] = await db.select().from(roles).where(eq(roles.id, admin.roleId));\n\n      // Update last login\n      await db.update(adminUsers)\n        .set({ lastLogin: new Date() })\n        .where(eq(adminUsers.id, admin.id));\n\n      // Generate token\n      const token = generateToken({\n        userId: admin.id,\n        userType: \"admin\",\n        email: admin.email,\n        roleId: admin.roleId,\n      });\n\n      // Set HttpOnly cookie for security\n      res.cookie(\"adminToken\", token, {\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n        sameSite: \"strict\",\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n      });\n\n      const { password: _, ...adminWithoutPassword } = admin;\n\n      res.json({\n        user: { ...adminWithoutPassword, role },\n        message: \"تم تسجيل الدخول بنجاح\",\n      });\n    } catch (error) {\n      console.error(\"Admin login error:\", error);\n      res.status(500).json({ error: \"حدث خطأ أثناء تسجيل الدخول\" });\n    }\n  });\n\n  // Admin Logout\n  app.post(\"/api/admin/logout\", adminAuthMiddleware, (req, res) => {\n    // Clear the admin token cookie\n    res.clearCookie(\"adminToken\", {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"strict\",\n    });\n    res.json({ message: \"تم تسجيل الخروج بنجاح\" });\n  });\n\n  // Get current admin user info\n  app.get(\"/api/admin/me\", adminAuthMiddleware, async (req, res) => {\n    try {\n      const { adminUsers, roles, permissions, rolePermissions } = await import(\"@shared/schema\");\n\n      const [admin] = await db.select().from(adminUsers).where(eq(adminUsers.id, req.user!.userId));\n      if (!admin) {\n        return res.status(404).json({ error: \"المستخدم غير موجود\" });\n      }\n\n      const [role] = await db.select().from(roles).where(eq(roles.id, admin.roleId));\n\n      // Get user permissions\n      const userPermissions = await db\n        .select({\n          id: permissions.id,\n          name: permissions.name,\n          nameAr: permissions.nameAr,\n          resource: permissions.resource,\n          action: permissions.action,\n        })\n        .from(rolePermissions)\n        .innerJoin(permissions, eq(rolePermissions.permissionId, permissions.id))\n        .where(eq(rolePermissions.roleId, admin.roleId));\n\n      const { password: _, ...adminWithoutPassword } = admin;\n\n      res.json({\n        ...adminWithoutPassword,\n        role,\n        permissions: userPermissions,\n      });\n    } catch (error) {\n      console.error(\"Error fetching admin user:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب بيانات المستخدم\" });\n    }\n  });\n\n  // Get all admin users\n  app.get(\"/api/admin/users\", adminAuthMiddleware, requirePermission(\"admin_users:view\"), async (req, res) => {\n    try {\n      const { adminUsers, roles } = await import(\"@shared/schema\");\n\n      const users = await db\n        .select({\n          id: adminUsers.id,\n          email: adminUsers.email,\n          fullName: adminUsers.fullName,\n          phone: adminUsers.phone,\n          roleId: adminUsers.roleId,\n          isActive: adminUsers.isActive,\n          lastLogin: adminUsers.lastLogin,\n          createdAt: adminUsers.createdAt,\n          roleName: roles.name,\n          roleNameAr: roles.nameAr,\n        })\n        .from(adminUsers)\n        .leftJoin(roles, eq(adminUsers.roleId, roles.id));\n\n      res.json(users);\n    } catch (error) {\n      console.error(\"Error fetching admin users:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب المستخدمين\" });\n    }\n  });\n\n  // Create new admin user\n  app.post(\"/api/admin/users\", adminAuthMiddleware, requirePermission(\"admin_users:create\"), async (req, res) => {\n    try {\n      const { adminUsers, insertAdminUserSchema } = await import(\"@shared/schema\");\n      const validatedData = insertAdminUserSchema.parse(req.body);\n\n      // Check if email exists\n      const [existing] = await db.select().from(adminUsers).where(eq(adminUsers.email, validatedData.email));\n      if (existing) {\n        return res.status(400).json({ error: \"البريد الإلكتروني مستخدم بالفعل\" });\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n\n      const [newAdmin] = await db.insert(adminUsers).values({\n        ...validatedData,\n        password: hashedPassword,\n      }).returning();\n\n      const { password: _, ...adminWithoutPassword } = newAdmin;\n\n      res.status(201).json({\n        user: adminWithoutPassword,\n        message: \"تم إنشاء المستخدم بنجاح\",\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Error creating admin user:\", error);\n      res.status(500).json({ error: \"حدث خطأ في إنشاء المستخدم\" });\n    }\n  });\n\n  // Update admin user\n  app.patch(\"/api/admin/users/:id\", adminAuthMiddleware, requirePermission(\"admin_users:edit\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { adminUsers } = await import(\"@shared/schema\");\n\n      const { password, ...updateData } = req.body;\n\n      // If password is being updated, hash it\n      const dataToUpdate: any = updateData;\n      if (password) {\n        dataToUpdate.password = await bcrypt.hash(password, 10);\n      }\n\n      const [updated] = await db.update(adminUsers)\n        .set({ ...dataToUpdate, updatedAt: new Date() })\n        .where(eq(adminUsers.id, id))\n        .returning();\n\n      if (!updated) {\n        return res.status(404).json({ error: \"المستخدم غير موجود\" });\n      }\n\n      const { password: _, ...adminWithoutPassword } = updated;\n\n      res.json({\n        user: adminWithoutPassword,\n        message: \"تم تحديث المستخدم بنجاح\",\n      });\n    } catch (error) {\n      console.error(\"Error updating admin user:\", error);\n      res.status(500).json({ error: \"حدث خطأ في تحديث المستخدم\" });\n    }\n  });\n\n  // Delete admin user\n  app.delete(\"/api/admin/users/:id\", adminAuthMiddleware, requirePermission(\"admin_users:delete\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { adminUsers } = await import(\"@shared/schema\");\n\n      // Prevent deleting yourself\n      if (id === req.user!.userId) {\n        return res.status(400).json({ error: \"لا يمكنك حذف حسابك الخاص\" });\n      }\n\n      await db.delete(adminUsers).where(eq(adminUsers.id, id));\n\n      res.json({ message: \"تم حذف المستخدم بنجاح\" });\n    } catch (error) {\n      console.error(\"Error deleting admin user:\", error);\n      res.status(500).json({ error: \"حدث خطأ في حذف المستخدم\" });\n    }\n  });\n\n  // Get all roles\n  app.get(\"/api/admin/roles\", adminAuthMiddleware, requirePermission(\"roles:view\"), async (req, res) => {\n    try {\n      const { roles } = await import(\"@shared/schema\");\n\n      const allRoles = await db.select().from(roles);\n\n      res.json(allRoles);\n    } catch (error) {\n      console.error(\"Error fetching roles:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الأدوار\" });\n    }\n  });\n\n  // Get role with permissions\n  app.get(\"/api/admin/roles/:id\", adminAuthMiddleware, requirePermission(\"roles:view\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { roles, permissions, rolePermissions } = await import(\"@shared/schema\");\n\n      const [role] = await db.select().from(roles).where(eq(roles.id, id));\n\n      if (!role) {\n        return res.status(404).json({ error: \"الدور غير موجود\" });\n      }\n\n      const rolePerms = await db\n        .select({\n          id: permissions.id,\n          name: permissions.name,\n          nameAr: permissions.nameAr,\n          resource: permissions.resource,\n          action: permissions.action,\n          description: permissions.description,\n        })\n        .from(rolePermissions)\n        .innerJoin(permissions, eq(rolePermissions.permissionId, permissions.id))\n        .where(eq(rolePermissions.roleId, id));\n\n      res.json({\n        ...role,\n        permissions: rolePerms,\n      });\n    } catch (error) {\n      console.error(\"Error fetching role:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الدور\" });\n    }\n  });\n\n  // Get all permissions\n  app.get(\"/api/admin/permissions\", adminAuthMiddleware, requirePermission(\"roles:view\"), async (req, res) => {\n    try {\n      const { permissions } = await import(\"@shared/schema\");\n\n      const allPermissions = await db.select().from(permissions);\n\n      res.json(allPermissions);\n    } catch (error) {\n      console.error(\"Error fetching permissions:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الصلاحيات\" });\n    }\n  });\n\n  // Admin Dashboard Statistics\n  app.get(\"/api/admin/statistics\", adminAuthMiddleware, async (req, res) => {\n    try {\n      const { freelancers, productOwners, groups, projects, orders, tasks, withdrawals } = await import(\"@shared/schema\");\n      const { sql } = await import(\"drizzle-orm\");\n\n      // Get counts\n      const [freelancersCount] = await db.select({ count: sql<number>`count(*)::int` }).from(freelancers);\n      const [productOwnersCount] = await db.select({ count: sql<number>`count(*)::int` }).from(productOwners);\n      const [groupsCount] = await db.select({ count: sql<number>`count(*)::int` }).from(groups);\n      const [projectsCount] = await db.select({ count: sql<number>`count(*)::int` }).from(projects);\n      const [ordersCount] = await db.select({ count: sql<number>`count(*)::int` }).from(orders);\n      const [tasksCount] = await db.select({ count: sql<number>`count(*)::int` }).from(tasks);\n      const [withdrawalsCount] = await db.select({ count: sql<number>`count(*)::int` }).from(withdrawals);\n\n      // Get pending withdrawals\n      const [pendingWithdrawals] = await db\n        .select({ count: sql<number>`count(*)::int` })\n        .from(withdrawals)\n        .where(eq(withdrawals.status, \"pending\"));\n\n      // Get total revenue (sum of platform fees from orders)\n      const [revenue] = await db\n        .select({ total: sql<number>`COALESCE(SUM(platform_fee), 0)::numeric` })\n        .from(orders);\n\n      res.json({\n        freelancers: freelancersCount.count,\n        productOwners: productOwnersCount.count,\n        groups: groupsCount.count,\n        projects: projectsCount.count,\n        orders: ordersCount.count,\n        tasks: tasksCount.count,\n        withdrawals: withdrawalsCount.count,\n        pendingWithdrawals: pendingWithdrawals.count,\n        totalRevenue: Number(revenue.total),\n      });\n    } catch (error) {\n      console.error(\"Error fetching statistics:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الإحصائيات\" });\n    }\n  });\n\n  // ============================================\n  // FREELANCERS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all freelancers\n  app.get(\"/api/admin/freelancers\", adminAuthMiddleware, requirePermission(\"freelancers:view\"), async (req, res) => {\n    try {\n      const { freelancers, users } = await import(\"@shared/schema\");\n\n      const allFreelancers = await db\n        .select({\n          id: freelancers.id,\n          userId: freelancers.userId,\n          fullName: freelancers.fullName,\n          email: users.email,\n          country: freelancers.country,\n          rating: freelancers.rating,\n          totalEarnings: freelancers.totalEarnings,\n          availableBalance: freelancers.availableBalance,\n          pendingBalance: freelancers.pendingBalance,\n          tasksCompleted: freelancers.tasksCompleted,\n          isActive: freelancers.isActive,\n          createdAt: freelancers.createdAt,\n        })\n        .from(freelancers)\n        .leftJoin(users, eq(freelancers.userId, users.id));\n\n      res.json(allFreelancers);\n    } catch (error) {\n      console.error(\"Error fetching freelancers:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الفريلانسرز\" });\n    }\n  });\n\n  // Get freelancer details\n  app.get(\"/api/admin/freelancers/:id\", adminAuthMiddleware, requirePermission(\"freelancers:view\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { freelancers, users, groups, groupMembers } = await import(\"@shared/schema\");\n\n      const [freelancer] = await db\n        .select({\n          id: freelancers.id,\n          userId: freelancers.userId,\n          fullName: freelancers.fullName,\n          email: users.email,\n          country: freelancers.country,\n          phoneNumber: freelancers.phoneNumber,\n          profilePicture: freelancers.profilePicture,\n          rating: freelancers.rating,\n          totalEarnings: freelancers.totalEarnings,\n          availableBalance: freelancers.availableBalance,\n          pendingBalance: freelancers.pendingBalance,\n          tasksCompleted: freelancers.tasksCompleted,\n          isActive: freelancers.isActive,\n          acceptedInstructions: freelancers.acceptedInstructions,\n          createdAt: freelancers.createdAt,\n        })\n        .from(freelancers)\n        .leftJoin(users, eq(freelancers.userId, users.id))\n        .where(eq(freelancers.id, id));\n\n      if (!freelancer) {\n        return res.status(404).json({ error: \"الفريلانسر غير موجود\" });\n      }\n\n      // Get groups this freelancer is in\n      const freelancerGroups = await db\n        .select({\n          id: groups.id,\n          name: groups.name,\n          leaderId: groups.leaderId,\n          memberCount: groups.memberCount,\n        })\n        .from(groupMembers)\n        .innerJoin(groups, eq(groupMembers.groupId, groups.id))\n        .where(eq(groupMembers.freelancerId, id));\n\n      res.json({\n        ...freelancer,\n        groups: freelancerGroups,\n      });\n    } catch (error) {\n      console.error(\"Error fetching freelancer:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب بيانات الفريلانسر\" });\n    }\n  });\n\n  // Toggle freelancer active status\n  app.patch(\"/api/admin/freelancers/:id/toggle-status\", adminAuthMiddleware, requirePermission(\"freelancers:edit\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { freelancers } = await import(\"@shared/schema\");\n\n      const [freelancer] = await db.select().from(freelancers).where(eq(freelancers.id, id));\n\n      if (!freelancer) {\n        return res.status(404).json({ error: \"الفريلانسر غير موجود\" });\n      }\n\n      const [updated] = await db\n        .update(freelancers)\n        .set({ isActive: !freelancer.isActive })\n        .where(eq(freelancers.id, id))\n        .returning();\n\n      res.json({\n        freelancer: updated,\n        message: `تم ${updated.isActive ? 'تفعيل' : 'إيقاف'} الحساب بنجاح`,\n      });\n    } catch (error) {\n      console.error(\"Error toggling freelancer status:\", error);\n      res.status(500).json({ error: \"حدث خطأ في تعديل حالة الفريلانسر\" });\n    }\n  });\n\n  // ============================================\n  // PRODUCT OWNERS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all product owners\n  app.get(\"/api/admin/product-owners\", adminAuthMiddleware, requirePermission(\"product_owners:view\"), async (req, res) => {\n    try {\n      const { productOwners, users } = await import(\"@shared/schema\");\n\n      const allProductOwners = await db\n        .select({\n          id: productOwners.id,\n          userId: productOwners.userId,\n          fullName: productOwners.fullName,\n          email: users.email,\n          companyName: productOwners.companyName,\n          country: productOwners.country,\n          totalSpent: productOwners.totalSpent,\n          projectsCreated: productOwners.projectsCreated,\n          ordersPlaced: productOwners.ordersPlaced,\n          isActive: productOwners.isActive,\n          createdAt: productOwners.createdAt,\n        })\n        .from(productOwners)\n        .leftJoin(users, eq(productOwners.userId, users.id));\n\n      res.json(allProductOwners);\n    } catch (error) {\n      console.error(\"Error fetching product owners:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب أصحاب المنتجات\" });\n    }\n  });\n\n  // Get product owner details\n  app.get(\"/api/admin/product-owners/:id\", adminAuthMiddleware, requirePermission(\"product_owners:view\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { productOwners, users, projects, orders } = await import(\"@shared/schema\");\n\n      const [productOwner] = await db\n        .select({\n          id: productOwners.id,\n          userId: productOwners.userId,\n          fullName: productOwners.fullName,\n          email: users.email,\n          companyName: productOwners.companyName,\n          country: productOwners.country,\n          phoneNumber: productOwners.phoneNumber,\n          profilePicture: productOwners.profilePicture,\n          totalSpent: productOwners.totalSpent,\n          projectsCreated: productOwners.projectsCreated,\n          ordersPlaced: productOwners.ordersPlaced,\n          isActive: productOwners.isActive,\n          acceptedInstructions: productOwners.acceptedInstructions,\n          createdAt: productOwners.createdAt,\n        })\n        .from(productOwners)\n        .leftJoin(users, eq(productOwners.userId, users.id))\n        .where(eq(productOwners.id, id));\n\n      if (!productOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      // Get recent projects\n      const recentProjects = await db\n        .select({\n          id: projects.id,\n          title: projects.title,\n          status: projects.status,\n          totalBudget: projects.totalBudget,\n          createdAt: projects.createdAt,\n        })\n        .from(projects)\n        .where(eq(projects.productOwnerId, id))\n        .limit(5);\n\n      // Get recent orders\n      const recentOrders = await db\n        .select({\n          id: orders.id,\n          serviceType: orders.serviceType,\n          status: orders.status,\n          totalAmount: orders.totalAmount,\n          createdAt: orders.createdAt,\n        })\n        .from(orders)\n        .where(eq(orders.productOwnerId, id))\n        .limit(5);\n\n      res.json({\n        ...productOwner,\n        recentProjects,\n        recentOrders,\n      });\n    } catch (error) {\n      console.error(\"Error fetching product owner:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب بيانات صاحب المنتج\" });\n    }\n  });\n\n  // Toggle product owner active status\n  app.patch(\"/api/admin/product-owners/:id/toggle-status\", adminAuthMiddleware, requirePermission(\"product_owners:edit\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { productOwners } = await import(\"@shared/schema\");\n\n      const [productOwner] = await db.select().from(productOwners).where(eq(productOwners.id, id));\n\n      if (!productOwner) {\n        return res.status(404).json({ error: \"صاحب المنتج غير موجود\" });\n      }\n\n      const [updated] = await db\n        .update(productOwners)\n        .set({ isActive: !productOwner.isActive })\n        .where(eq(productOwners.id, id))\n        .returning();\n\n      res.json({\n        productOwner: updated,\n        message: `تم ${updated.isActive ? 'تفعيل' : 'إيقاف'} الحساب بنجاح`,\n      });\n    } catch (error) {\n      console.error(\"Error toggling product owner status:\", error);\n      res.status(500).json({ error: \"حدث خطأ في تعديل حالة صاحب المنتج\" });\n    }\n  });\n\n  // ============================================\n  // GROUPS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all groups\n  app.get(\"/api/admin/groups\", adminAuthMiddleware, requirePermission(\"groups:view\"), async (req, res) => {\n    try {\n      const { groups, freelancers } = await import(\"@shared/schema\");\n\n      const allGroups = await db\n        .select({\n          id: groups.id,\n          name: groups.name,\n          description: groups.description,\n          leaderId: groups.leaderId,\n          leaderName: freelancers.fullName,\n          memberCount: groups.memberCount,\n          maxMembers: groups.maxMembers,\n          country: groups.country,\n          projectsCompleted: groups.projectsCompleted,\n          rating: groups.rating,\n          isActive: groups.isActive,\n          createdAt: groups.createdAt,\n        })\n        .from(groups)\n        .leftJoin(freelancers, eq(groups.leaderId, freelancers.id));\n\n      res.json(allGroups);\n    } catch (error) {\n      console.error(\"Error fetching groups:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الجروبات\" });\n    }\n  });\n\n  // Toggle group active status\n  app.patch(\"/api/admin/groups/:id/toggle-status\", adminAuthMiddleware, requirePermission(\"groups:edit\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { groups } = await import(\"@shared/schema\");\n\n      const [group] = await db.select().from(groups).where(eq(groups.id, id));\n\n      if (!group) {\n        return res.status(404).json({ error: \"الجروب غير موجود\" });\n      }\n\n      const [updated] = await db\n        .update(groups)\n        .set({ isActive: !group.isActive })\n        .where(eq(groups.id, id))\n        .returning();\n\n      res.json({\n        group: updated,\n        message: `تم ${updated.isActive ? 'تفعيل' : 'إيقاف'} الجروب بنجاح`,\n      });\n    } catch (error) {\n      console.error(\"Error toggling group status:\", error);\n      res.status(500).json({ error: \"حدث خطأ في تعديل حالة الجروب\" });\n    }\n  });\n\n  // ============================================\n  // PROJECTS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all projects\n  app.get(\"/api/admin/projects\", adminAuthMiddleware, requirePermission(\"projects:view\"), async (req, res) => {\n    try {\n      const { projects, productOwners, groups } = await import(\"@shared/schema\");\n\n      const allProjects = await db\n        .select({\n          id: projects.id,\n          title: projects.title,\n          description: projects.description,\n          productOwnerId: projects.productOwnerId,\n          ownerName: productOwners.fullName,\n          groupId: projects.groupId,\n          groupName: groups.name,\n          status: projects.status,\n          totalBudget: projects.totalBudget,\n          platformFee: projects.platformFee,\n          tasksCount: projects.tasksCount,\n          completedTasksCount: projects.completedTasksCount,\n          createdAt: projects.createdAt,\n        })\n        .from(projects)\n        .leftJoin(productOwners, eq(projects.productOwnerId, productOwners.id))\n        .leftJoin(groups, eq(projects.groupId, groups.id));\n\n      res.json(allProjects);\n    } catch (error) {\n      console.error(\"Error fetching projects:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب المشاريع\" });\n    }\n  });\n\n  // ============================================\n  // ORDERS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all orders\n  app.get(\"/api/admin/orders\", adminAuthMiddleware, requirePermission(\"orders:view\"), async (req, res) => {\n    try {\n      const { orders, productOwners, groups } = await import(\"@shared/schema\");\n\n      const allOrders = await db\n        .select({\n          id: orders.id,\n          productOwnerId: orders.productOwnerId,\n          ownerName: productOwners.fullName,\n          groupId: orders.groupId,\n          groupName: groups.name,\n          serviceType: orders.serviceType,\n          status: orders.status,\n          totalAmount: orders.totalAmount,\n          platformFee: orders.platformFee,\n          leaderCommission: orders.leaderCommission,\n          quantity: orders.quantity,\n          createdAt: orders.createdAt,\n        })\n        .from(orders)\n        .leftJoin(productOwners, eq(orders.productOwnerId, productOwners.id))\n        .leftJoin(groups, eq(orders.groupId, groups.id));\n\n      res.json(allOrders);\n    } catch (error) {\n      console.error(\"Error fetching orders:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب الطلبات\" });\n    }\n  });\n\n  // ============================================\n  // WITHDRAWALS MANAGEMENT (ADMIN)\n  // ============================================\n\n  // Get all withdrawals\n  app.get(\"/api/admin/withdrawals\", adminAuthMiddleware, requirePermission(\"withdrawals:view\"), async (req, res) => {\n    try {\n      const { withdrawals, freelancers } = await import(\"@shared/schema\");\n\n      const allWithdrawals = await db\n        .select({\n          id: withdrawals.id,\n          freelancerId: withdrawals.freelancerId,\n          freelancerName: freelancers.fullName,\n          amount: withdrawals.amount,\n          status: withdrawals.status,\n          paymentMethod: withdrawals.paymentMethod,\n          accountDetails: withdrawals.accountDetails,\n          createdAt: withdrawals.createdAt,\n          processedAt: withdrawals.processedAt,\n        })\n        .from(withdrawals)\n        .leftJoin(freelancers, eq(withdrawals.freelancerId, freelancers.id));\n\n      res.json(allWithdrawals);\n    } catch (error) {\n      console.error(\"Error fetching withdrawals:\", error);\n      res.status(500).json({ error: \"حدث خطأ في جلب طلبات السحب\" });\n    }\n  });\n\n  // Approve withdrawal\n  app.patch(\"/api/admin/withdrawals/:id/approve\", adminAuthMiddleware, requirePermission(\"withdrawals:approve\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { withdrawals, freelancers } = await import(\"@shared/schema\");\n\n      const [withdrawal] = await db.select().from(withdrawals).where(eq(withdrawals.id, id));\n\n      if (!withdrawal) {\n        return res.status(404).json({ error: \"طلب السحب غير موجود\" });\n      }\n\n      if (withdrawal.status !== \"pending\") {\n        return res.status(400).json({ error: \"طلب السحب تمت معالجته مسبقاً\" });\n      }\n\n      const [updated] = await db\n        .update(withdrawals)\n        .set({\n          status: \"completed\",\n          processedAt: new Date(),\n        })\n        .where(eq(withdrawals.id, id))\n        .returning();\n\n      // Deduct from freelancer's available balance\n      await db\n        .update(freelancers)\n        .set({\n          availableBalance: sql`${freelancers.availableBalance} - ${withdrawal.amount}`,\n        })\n        .where(eq(freelancers.id, withdrawal.freelancerId));\n\n      res.json({\n        withdrawal: updated,\n        message: \"تم اعتماد طلب السحب بنجاح\",\n      });\n    } catch (error) {\n      console.error(\"Error approving withdrawal:\", error);\n      res.status(500).json({ error: \"حدث خطأ في اعتماد طلب السحب\" });\n    }\n  });\n\n  // Reject withdrawal\n  app.patch(\"/api/admin/withdrawals/:id/reject\", adminAuthMiddleware, requirePermission(\"withdrawals:approve\"), async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { withdrawals, freelancers } = await import(\"@shared/schema\");\n\n      const [withdrawal] = await db.select().from(withdrawals).where(eq(withdrawals.id, id));\n\n      if (!withdrawal) {\n        return res.status(404).json({ error: \"طلب السحب غير موجود\" });\n      }\n\n      if (withdrawal.status !== \"pending\") {\n        return res.status(400).json({ error: \"طلب السحب تمت معالجته مسبقاً\" });\n      }\n\n      const [updated] = await db\n        .update(withdrawals)\n        .set({\n          status: \"rejected\",\n          processedAt: new Date(),\n        })\n        .where(eq(withdrawals.id, id))\n        .returning();\n\n      // Return amount to freelancer's available balance\n      await db\n        .update(freelancers)\n        .set({\n          availableBalance: sql`${freelancers.availableBalance} + ${withdrawal.amount}`,\n        })\n        .where(eq(freelancers.id, withdrawal.freelancerId));\n\n      res.json({\n        withdrawal: updated,\n        message: \"تم رفض طلب السحب\",\n      });\n    } catch (error) {\n      console.error(\"Error rejecting withdrawal:\", error);\n      res.status(500).json({ error: \"حدث خطأ في رفض طلب السحب\" });\n    }\n  });\n\n  // ============================================\n  // HEALTH CHECK\n  // ============================================\n\n  app.get(\"/api/health\", (req, res) => {\n    res.json({ status: \"ok\", message: \"Sumou API is running\" });\n  });\n\n  return httpServer;\n}\n","size_bytes":168075},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\n// Serve uploaded files\napp.use('/uploads', express.static('uploads'));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '3000', 10);\n  server.listen({\n    port\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2240},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/Navbar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Menu, X, LogIn, UserPlus, User, LogOut, LayoutDashboard, Briefcase, Building2, Search, BookOpen } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { NotificationsDropdown } from \"@/components/NotificationsDropdown\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport function Navbar() {\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const [user, setUser] = useState<any>(null);\n  const [userType, setUserType] = useState<string | null>(null);\n  const [isScrolled, setIsScrolled] = useState(false);\n  const [, navigate] = useLocation();\n\n  useEffect(() => {\n    const handleScroll = () => {\n      setIsScrolled(window.scrollY > 20);\n    };\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  const loadUserData = () => {\n    const token = localStorage.getItem(\"token\");\n    const userData = localStorage.getItem(\"user\");\n    const type = localStorage.getItem(\"userType\");\n    \n    if (token && userData) {\n      try {\n        setUser(JSON.parse(userData));\n        setUserType(type);\n      } catch (e) {\n        console.error(\"Error parsing user data:\", e);\n        setUser(null);\n        setUserType(null);\n      }\n    } else {\n      setUser(null);\n      setUserType(null);\n    }\n  };\n\n  useEffect(() => {\n    loadUserData();\n\n    const handleStorageChange = (e: StorageEvent) => {\n      if (e.key === \"user\" || e.key === \"token\" || e.key === \"userType\") {\n        loadUserData();\n      }\n    };\n\n    const handleLoginEvent = () => {\n      loadUserData();\n    };\n\n    window.addEventListener(\"storage\", handleStorageChange);\n    window.addEventListener(\"userLoggedIn\", handleLoginEvent);\n\n    return () => {\n      window.removeEventListener(\"storage\", handleStorageChange);\n      window.removeEventListener(\"userLoggedIn\", handleLoginEvent);\n    };\n  }, []);\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    localStorage.removeItem(\"userType\");\n    setUser(null);\n    navigate(\"/\");\n  };\n\n  const getUserInitials = () => {\n    if (!user?.fullName) return \"م\";\n    const names = user.fullName.split(\" \");\n    if (names.length >= 2) {\n      return names[0][0] + names[1][0];\n    }\n    return names[0][0];\n  };\n\n  const getUserTypeBadge = () => {\n    if (userType === \"freelancer\") {\n      return (\n        <Badge \n          variant=\"secondary\" \n          className=\"text-xs gap-1 bg-gradient-to-r from-cyan-500 to-blue-500 text-white border-0 px-2 py-1\"\n          data-testid=\"badge-user-type\"\n        >\n          <Briefcase className=\"h-3 w-3\" />\n          مستقل\n        </Badge>\n      );\n    } else if (userType === \"product_owner\") {\n      return (\n        <Badge \n          variant=\"secondary\" \n          className=\"text-xs gap-1 bg-gradient-to-r from-purple-500 to-blue-600 text-white border-0 px-2 py-1\"\n          data-testid=\"badge-user-type\"\n        >\n          <Building2 className=\"h-3 w-3\" />\n          صاحب مشروع\n        </Badge>\n      );\n    }\n    return null;\n  };\n\n  const navItemClass = \"px-4 py-2 text-gray-700 hover:text-blue-600 font-medium transition-all duration-300 cursor-pointer relative group\";\n  const mobileNavItemClass = \"block px-4 py-3 text-gray-700 hover:text-blue-600 font-medium transition-all duration-300 cursor-pointer\";\n\n  return (\n    <nav className={`fixed top-0 left-0 right-0 max-w-screen z-50 transition-all duration-500 overflow-hidden ${\n      isScrolled \n        ? \"bg-white/90 backdrop-blur-xl shadow-lg border-b border-gray-200/50\" \n        : \"bg-transparent\"\n    }`}>\n      {/* Enhanced Background Elements */}\n      <div className=\"absolute inset-0 -z-10 overflow-hidden\">\n        <div className=\"absolute top-0 left-1/4 w-32 h-32 bg-blue-200/20 rounded-full blur-3xl\"></div>\n        <div className=\"absolute top-0 right-1/4 w-32 h-32 bg-purple-200/20 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"max-w-screen mx-auto px-6 sm:px-8 lg:px-10\">\n        <div className=\"flex justify-between items-center h-20\">\n          {/* Logo & Main Navigation */}\n          <div className=\"flex items-center gap-12\">\n            {/* Logo */}\n            <Link href=\"/\">\n              <div className=\"flex items-center gap-3 hover:scale-105 active:scale-95 transition-all duration-300 cursor-pointer group\" data-testid=\"link-home\">\n                <div className=\"w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-500\">\n                  <BookOpen className=\"h-5 w-5 text-white\" />\n                </div>\n                <div className=\"flex flex-col\">\n                  <div className=\"text-2xl font-bold bg-gradient-to-br from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n                    سُمُوّ\n                  </div>\n                  <div className=\"text-xs text-gray-500 font-light -mt-1\">منصة العمل الحر</div>\n                </div>\n              </div>\n            </Link>\n\n            {/* Desktop Navigation */}\n            <div className=\"hidden lg:flex items-center gap-8\">\n              <Link href=\"/\">\n                <div className={navItemClass} data-testid=\"link-home-nav\">\n                  الرئيسية\n                  <div className=\"absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 group-hover:w-full transition-all duration-300\"></div>\n                </div>\n              </Link>\n              <Link href=\"/services\">\n                <div className={navItemClass} data-testid=\"link-services-nav\">\n                  الخدمات\n                  <div className=\"absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 group-hover:w-full transition-all duration-300\"></div>\n                </div>\n              </Link>\n              <Link href=\"/groups\">\n                <div className={navItemClass} data-testid=\"link-groups-nav\">\n                  الجروبات\n                  <div className=\"absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 group-hover:w-full transition-all duration-300\"></div>\n                </div>\n              </Link>\n              <Link href=\"/projects\">\n                <div className={navItemClass} data-testid=\"link-projects-nav\">\n                  المشاريع\n                  <div className=\"absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 group-hover:w-full transition-all duration-300\"></div>\n                </div>\n              </Link>\n              <Link href=\"/freelancers\">\n                <div className={navItemClass} data-testid=\"link-freelancers-nav\">\n                  المستقلين\n                  <div className=\"absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 group-hover:w-full transition-all duration-300\"></div>\n                </div>\n              </Link>\n            </div>\n          </div>\n\n          {/* Right Section - Search, User Profile, CTA */}\n          <div className=\"flex items-center gap-6\">\n            {/* Search Bar */}\n            <div className=\"hidden md:flex items-center gap-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                <input \n                  type=\"text\" \n                  placeholder=\"ابحث عن خدمات، مشاريع...\" \n                  className=\"w-64 pr-10 pl-4 py-2.5 bg-white/80 backdrop-blur-sm border border-gray-300/80 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all duration-300\"\n                />\n              </div>\n            </div>\n\n            {/* User Profile / Auth Buttons */}\n            <div className=\"flex items-center gap-4\">\n              {user ? (\n                <>\n                  <NotificationsDropdown />\n                  <DropdownMenu>\n                    <DropdownMenuTrigger asChild>\n                      <button className=\"flex items-center gap-3 hover:bg-white/50 active:scale-95 rounded-2xl px-4 py-2 transition-all duration-300 border border-transparent hover:border-gray-300/50 group\" data-testid=\"button-user-menu\">\n                        <div className=\"flex flex-col items-end\">\n                          <span className=\"text-sm font-semibold text-gray-900\">{user.fullName}</span>\n                          <span className=\"text-xs text-gray-500\">{userType === 'freelancer' ? 'مستقل' : 'صاحب مشروع'}</span>\n                        </div>\n                        <div className=\"relative\">\n                          <Avatar className=\"h-10 w-10 ring-2 ring-white shadow-lg group-hover:ring-blue-100 transition-all duration-300\" data-testid=\"avatar-user\">\n                            <AvatarImage src={user.profileImage} alt={user.fullName} />\n                            <AvatarFallback className=\"bg-gradient-to-br from-blue-600 to-purple-600 text-white font-semibold\">\n                              {getUserInitials()}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"absolute -bottom-1 -right-1 bg-white rounded-full p-0.5 shadow-md\" data-testid=\"avatar-badge-container\">\n                            {userType === \"freelancer\" ? (\n                              <div className=\"bg-gradient-to-r from-cyan-500 to-blue-500 p-1 rounded-full\">\n                                <Briefcase className=\"h-2 w-2 text-white\" data-testid=\"icon-freelancer\" />\n                              </div>\n                            ) : (\n                              <div className=\"bg-gradient-to-r from-purple-500 to-blue-600 p-1 rounded-full\">\n                                <Building2 className=\"h-2 w-2 text-white\" data-testid=\"icon-product-owner\" />\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </button>\n                    </DropdownMenuTrigger>\n                    <DropdownMenuContent align=\"end\" className=\"w-64 rounded-2xl shadow-xl border border-gray-200/60 backdrop-blur-xl\">\n                      <DropdownMenuLabel className=\"font-normal p-4\">\n                        <div className=\"flex flex-col space-y-2\">\n                          <p className=\"text-sm font-semibold text-gray-900\">{user.fullName}</p>\n                          <p className=\"text-xs text-gray-500\">{user.email}</p>\n                          <div className=\"pt-1\">{getUserTypeBadge()}</div>\n                        </div>\n                      </DropdownMenuLabel>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem \n                        onClick={() => navigate(\"/dashboard\")} \n                        className=\"cursor-pointer rounded-xl m-1 transition-all duration-200 hover:bg-gradient-to-l hover:from-blue-50 hover:to-purple-50\"\n                        data-testid=\"menu-dashboard\"\n                      >\n                        <LayoutDashboard className=\"ml-2 h-4 w-4 text-blue-600\" />\n                        <span className=\"text-gray-700\">لوحة التحكم</span>\n                      </DropdownMenuItem>\n                      <DropdownMenuItem \n                        onClick={() => navigate(\"/profile\")} \n                        className=\"cursor-pointer rounded-xl m-1 transition-all duration-200 hover:bg-gradient-to-l hover:from-blue-50 hover:to-purple-50\"\n                        data-testid=\"menu-profile\"\n                      >\n                        <User className=\"ml-2 h-4 w-4 text-purple-600\" />\n                        <span className=\"text-gray-700\">الملف الشخصي</span>\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem \n                        onClick={handleLogout} \n                        className=\"cursor-pointer rounded-xl m-1 transition-all duration-200 hover:bg-red-50 text-red-600\"\n                        data-testid=\"menu-logout\"\n                      >\n                        <LogOut className=\"ml-2 h-4 w-4\" />\n                        تسجيل الخروج\n                      </DropdownMenuItem>\n                    </DropdownMenuContent>\n                  </DropdownMenu>\n                </>\n              ) : (\n                <>\n                  <Link href=\"/login\">\n                    <Button \n                      variant=\"ghost\" \n                      className=\"rounded-2xl text-gray-700 hover:text-blue-600 font-medium transition-all duration-300\"\n                      data-testid=\"button-login-header\"\n                    >\n                      <LogIn className=\"ml-2 h-4 w-4\" />\n                      تسجيل الدخول\n                    </Button>\n                  </Link>\n                  <Link href=\"/role-selection\">\n                    <Button \n                      variant=\"default\" \n                      className=\"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-300 border-0 px-6\"\n                      data-testid=\"button-signup\"\n                    >\n                      <UserPlus className=\"ml-2 h-4 w-4\" />\n                      إنشاء حساب\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n\n            {/* Mobile Menu Button */}\n            <button\n              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n              className=\"lg:hidden p-3 hover:bg-white/50 active:scale-95 rounded-2xl transition-all duration-300 border border-transparent hover:border-gray-300/50\"\n              data-testid=\"button-mobile-menu\"\n            >\n              {mobileMenuOpen ? (\n                <X className=\"h-5 w-5 text-gray-700\" />\n              ) : (\n                <Menu className=\"h-5 w-5 text-gray-700\" />\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Mobile Menu */}\n        {mobileMenuOpen && (\n          <div className=\"lg:hidden py-6 space-y-4 border-t border-gray-200/50 bg-white/95 backdrop-blur-xl rounded-b-3xl shadow-2xl\">\n            {/* Mobile Search */}\n            <div className=\"px-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                <input \n                  type=\"text\" \n                  placeholder=\"ابحث عن خدمات، مشاريع...\" \n                  className=\"w-full pr-10 pl-4 py-3 bg-white border border-gray-300/80 rounded-2xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all duration-300\"\n                />\n              </div>\n            </div>\n\n            {/* Mobile Navigation */}\n            <div className=\"space-y-2\">\n              <Link href=\"/\">\n                <div className={mobileNavItemClass} data-testid=\"link-home-mobile\">\n                  الرئيسية\n                </div>\n              </Link>\n              <Link href=\"/services\">\n                <div className={mobileNavItemClass} data-testid=\"link-services-mobile\">\n                  الخدمات\n                </div>\n              </Link>\n              <Link href=\"/groups\">\n                <div className={mobileNavItemClass} data-testid=\"link-groups-mobile\">\n                  الجروبات\n                </div>\n              </Link>\n              <Link href=\"/projects\">\n                <div className={mobileNavItemClass} data-testid=\"link-projects-mobile\">\n                  المشاريع\n                </div>\n              </Link>\n              <Link href=\"/freelancers\">\n                <div className={mobileNavItemClass} data-testid=\"link-freelancers-mobile\">\n                  المستقلين\n                </div>\n              </Link>\n            </div>\n            \n            {/* Mobile User Section */}\n            <div className=\"pt-4 flex flex-col gap-3\">\n              {user ? (\n                <>\n                  <div className=\"flex items-center gap-3 px-4 py-4 rounded-2xl border border-gray-200 bg-gradient-to-r from-blue-50/50 to-purple-50/50\" data-testid=\"mobile-user-info\">\n                    <div className=\"relative\">\n                      <Avatar className=\"h-12 w-12 ring-2 ring-white shadow-md\">\n                        <AvatarImage src={user.profileImage} alt={user.fullName} />\n                        <AvatarFallback className=\"bg-gradient-to-br from-blue-600 to-purple-600 text-white font-semibold\">\n                          {getUserInitials()}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"absolute -bottom-1 -right-1 bg-white rounded-full p-0.5 shadow-md\" data-testid=\"avatar-badge-container-mobile\">\n                        {userType === \"freelancer\" ? (\n                          <div className=\"bg-gradient-to-r from-cyan-500 to-blue-500 p-1 rounded-full\">\n                            <Briefcase className=\"h-2 w-2 text-white\" />\n                          </div>\n                        ) : (\n                          <div className=\"bg-gradient-to-r from-purple-500 to-blue-600 p-1 rounded-full\">\n                            <Building2 className=\"h-2 w-2 text-white\" />\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"text-sm font-semibold text-gray-900\">{user.fullName}</p>\n                      <p className=\"text-xs text-gray-500\">{user.email}</p>\n                      <div className=\"mt-2\">{getUserTypeBadge()}</div>\n                    </div>\n                  </div>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full rounded-2xl justify-start border-gray-300 hover:border-blue-500 hover:bg-gradient-to-l hover:from-blue-50 hover:to-purple-50 transition-all duration-300\" \n                    onClick={() => { navigate(\"/dashboard\"); setMobileMenuOpen(false); }} \n                    data-testid=\"button-dashboard-mobile\"\n                  >\n                    <LayoutDashboard className=\"ml-2 h-4 w-4 text-blue-600\" />\n                    لوحة التحكم\n                  </Button>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full rounded-2xl justify-start border-gray-300 hover:border-blue-500 hover:bg-gradient-to-l hover:from-blue-50 hover:to-purple-50 transition-all duration-300\" \n                    onClick={() => { navigate(\"/profile\"); setMobileMenuOpen(false); }} \n                    data-testid=\"button-profile-mobile\"\n                  >\n                    <User className=\"ml-2 h-4 w-4 text-purple-600\" />\n                    الملف الشخصي\n                  </Button>\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full rounded-2xl justify-start text-red-600 border-red-200 hover:border-red-500 hover:bg-red-50 transition-all duration-300\" \n                    onClick={() => { handleLogout(); setMobileMenuOpen(false); }} \n                    data-testid=\"button-logout-mobile\"\n                  >\n                    <LogOut className=\"ml-2 h-4 w-4\" />\n                    تسجيل الخروج\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Link href=\"/login\">\n                    <Button \n                      variant=\"outline\" \n                      className=\"w-full rounded-2xl border-gray-300 hover:border-blue-500 hover:bg-gradient-to-l hover:from-blue-50 hover:to-purple-50 transition-all duration-300\" \n                      data-testid=\"button-login-mobile\"\n                    >\n                      <LogIn className=\"ml-2 h-4 w-4\" />\n                      تسجيل الدخول\n                    </Button>\n                  </Link>\n                  <Link href=\"/role-selection\">\n                    <Button \n                      variant=\"default\" \n                      className=\"w-full rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-300 border-0\" \n                      data-testid=\"button-signup-mobile\"\n                    >\n                      <UserPlus className=\"ml-2 h-4 w-4\" />\n                      إنشاء حساب\n                    </Button>\n                  </Link>\n                </>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </nav>\n  );\n}","size_bytes":21241},"replit.md":{"content":"# منصة سُمُوّ - Sumou Platform\n\n## Overview\nSumou Platform is an Arabic digital platform connecting professional freelancers with digital product owners. Its primary purpose is to facilitate application, website, and system testing, provide authentic reviews, and enhance social media engagement. The platform aims to be a robust marketplace for digital product quality assurance and improvement, with a vision to become a leading hub for digital product enhancement services in the Arabic-speaking world.\n\n## User Preferences\nI prefer the AI to maintain a professional yet approachable tone. When suggesting code changes, provide clear, concise explanations for the rationale behind the changes. Prioritize iterative development, presenting changes in manageable chunks. For significant architectural decisions or major code overhauls, please ask for confirmation before proceeding. Ensure all communication is clear and directly addresses the task at hand. I prefer to maintain the existing file structure and naming conventions unless a strong, justified reason for alteration is presented.\n\n## System Architecture\nThe platform is built with a modern web stack, featuring a modular project structure with `client/`, `server/`, and `shared/` directories.\n\n**UI/UX Decisions:**\n- **Design Language:** Modern SaaS aesthetic with soft shadows, rounded edges, and a clean layout.\n- **Color Scheme:** Primary deep blue (#002e62), white background (#FAFAFA).\n- **Typography:** Tajawal Bold/Thick (Arabic), Inter (English).\n- **Responsiveness & RTL:** Fully responsive design with comprehensive Right-to-Left (RTL) support.\n- **Interactive Elements:** Hover effects, 3D elevations, and Framer Motion animations.\n- **Component Library:** Shadcn UI for consistent and rapid development.\n- **Icon System:** All UI elements use `lucide-react` icons exclusively.\n\n**Technical Implementations & Feature Specifications:**\n- **Frontend:** React with TypeScript, Wouter for routing, Tailwind CSS, Shadcn UI, React Hook Form with Zod for validation, and TanStack Query for data management.\n- **Backend:** Express.js.\n- **User Authentication:** JWT-based sessions and role-based authorization for both users and administrators.\n- **Admin Control Panel:** Comprehensive administrative system with separate authentication flow, permission-based access control (37 permissions across 5 default roles), and complete platform management capabilities including user management, financial oversight, and analytics dashboard.\n- **Admin Roles & Permissions:** Five predefined roles (مدير/Admin, مبرمج/Developer, مسوّق/Marketer, دعم فني/Support, شريك/Partner) with granular permissions using resource:action pattern (e.g., users:view, freelancers:edit, withdrawals:approve).\n- **Mandatory Instructions:** Both Freelancers and Product Owners must accept comprehensive guidelines covering ethical practices, platform policies, and financial terms (e.g., 7-day earnings hold for freelancers, 7-day guarantee for product owners). These are tracked in the database and presented during signup.\n- **Quality Assurance Features:** Includes a 7-day product owner guarantee for review deletion refunds and a 7-day freelancer earnings hold to ensure review legitimacy. Features a recommendation system for selecting freelancers from the same country.\n- **Platform Commission System:** A multi-tier commission structure automatically deducts 10% platform fee, 3% leader commission, and distributes the remainder among group members.\n- **Group-Based Work System:** Freelancers can form groups (up to 700 members) to accept projects from product owners. Includes project workflow (pending to completed), task assignment, and internal messaging.\n- **Direct Purchase System:** Product owners can purchase services directly from group leaders with defined pricing and various payment methods.\n- **Conversations System:** Real-time messaging between product owners and group leaders with dedicated chat pages, user profiles, and safety guidelines.\n- **Notifications System:** A comprehensive system for both user types, including database schema, dedicated notification pages, unread badges, and automated notifications for various platform activities (e.g., withdrawals, orders, messages).\n- **Product Owner Signup:** A simplified 3-step form for product owners to select services and calculate costs.\n- **Dashboards:** Dedicated Freelancer, Product Owner, and Admin dashboards with real-time stats and modular navigation.\n- **Services Showcase Page:** A public-facing page detailing four main platform services: Google Maps Reviews, App Reviews, UX Testing, and Social Media Engagement.\n- **API Request Layer:** Custom `apiRequest()` function automatically includes JWT tokens for authenticated requests.\n\n**System Design Choices:**\n- **Data Schemas:** Shared TypeScript data models for consistency.\n- **Layout Architecture:** Consistent dashboard layouts with fixed sidebars (RTL optimized) to prevent content overlay, ensuring the sidebar appears on the right for RTL users.\n\n## External Dependencies\n- **OpenAI (via Replit AI Integrations):** For AI-powered suggestions.\n- **Object Storage:** For file uploads (e.g., profile pictures, ID verifications).\n- **PostgreSQL:** For persistent data storage in production (Neon).","size_bytes":5316},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/pages/Login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useLocation } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { LogIn, Mail, Lock, Sparkles } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link } from \"wouter\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  password: z.string().min(1, \"كلمة المرور مطلوبة\"),\n  rememberMe: z.boolean().optional(),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n      rememberMe: false,\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginFormData) => {\n      const response = await fetch(\"/api/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"فشل تسجيل الدخول\");\n      }\n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      // Store token and user data in localStorage\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", data.userType);\n      \n      // Dispatch custom event to update Navbar\n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم تسجيل الدخول بنجاح!\",\n        description: \"مرحبًا بعودتك إلى منصة سُمُوّ\",\n      });\n      \n      // Navigate based on user type\n      if (data.userType === \"product_owner\") {\n        navigate(\"/campaigns\");\n      } else {\n        navigate(\"/dashboard\");\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ في تسجيل الدخول\",\n        description: error.message || \"البريد الإلكتروني أو كلمة المرور غير صحيحة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginFormData) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 flex items-center justify-center py-12 px-4\">\n        <div className=\"w-full max-w-md\">\n          {/* Header */}\n          <div className=\"text-center mb-8 space-y-3\">\n            <div className=\"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-2\">\n              <Sparkles className=\"h-4 w-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">مرحبًا بعودتك</span>\n            </div>\n            <h1 className=\"text-3xl font-bold\">تسجيل الدخول</h1>\n            <p className=\"text-muted-foreground\">\n              ادخل إلى حسابك في منصة سُمُوّ\n            </p>\n          </div>\n\n          {/* Login Card */}\n          <Card className=\"rounded-2xl shadow-xl border-2\">\n            <CardHeader className=\"space-y-2 pb-6\">\n              <CardTitle className=\"text-2xl text-center\">تسجيل الدخول</CardTitle>\n              <CardDescription className=\"text-center\">\n                ادخل بياناتك للوصول إلى حسابك\n              </CardDescription>\n            </CardHeader>\n\n            <CardContent className=\"space-y-6\">\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                  {/* Email Field */}\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"flex items-center gap-2\">\n                          <Mail className=\"h-4 w-4 text-primary\" />\n                          البريد الإلكتروني\n                        </FormLabel>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            type=\"email\"\n                            placeholder=\"example@email.com\" \n                            className=\"rounded-xl h-11\" \n                            data-testid=\"input-email\"\n                            autoComplete=\"email\"\n                            name=\"email\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Password Field */}\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"flex items-center gap-2\">\n                          <Lock className=\"h-4 w-4 text-primary\" />\n                          كلمة المرور\n                        </FormLabel>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            type=\"password\"\n                            placeholder=\"••••••••\" \n                            className=\"rounded-xl h-11\" \n                            data-testid=\"input-password\"\n                            autoComplete=\"current-password\"\n                            name=\"password\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Remember Me & Forgot Password */}\n                  <div className=\"flex items-center justify-between\">\n                    <FormField\n                      control={form.control}\n                      name=\"rememberMe\"\n                      render={({ field }) => (\n                        <FormItem className=\"flex items-center gap-2 space-y-0\">\n                          <FormControl>\n                            <Checkbox\n                              checked={field.value}\n                              onCheckedChange={field.onChange}\n                              data-testid=\"checkbox-remember\"\n                            />\n                          </FormControl>\n                          <FormLabel className=\"text-sm cursor-pointer mt-0\">\n                            تذكرني\n                          </FormLabel>\n                        </FormItem>\n                      )}\n                    />\n                    <a \n                      href=\"#forgot-password\" \n                      className=\"text-sm text-primary hover:underline\"\n                      data-testid=\"link-forgot-password\"\n                    >\n                      نسيت كلمة المرور؟\n                    </a>\n                  </div>\n\n                  {/* Submit Button */}\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full rounded-xl h-11 text-base\"\n                    disabled={loginMutation.isPending}\n                    data-testid=\"button-login\"\n                  >\n                    {loginMutation.isPending ? (\n                      \"جاري تسجيل الدخول...\"\n                    ) : (\n                      <>\n                        <LogIn className=\"ml-2 h-5 w-5\" />\n                        تسجيل الدخول\n                      </>\n                    )}\n                  </Button>\n\n                  {/* Divider */}\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-0 flex items-center\">\n                      <div className=\"w-full border-t\"></div>\n                    </div>\n                    <div className=\"relative flex justify-center text-xs\">\n                      <span className=\"bg-card px-3 text-muted-foreground\">\n                        أو\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* Sign Up Link */}\n                  <div className=\"text-center space-y-3\">\n                    <p className=\"text-sm text-muted-foreground\">\n                      ليس لديك حساب؟{\" \"}\n                      <Link href=\"/role-selection\" className=\"text-primary font-semibold hover:underline\" data-testid=\"link-signup\">\n                        أنشئ حسابًا جديدًا\n                      </Link>\n                    </p>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n\n          {/* Additional Info */}\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-xs text-muted-foreground\">\n              بتسجيل الدخول، أنت توافق على{\" \"}\n              <a href=\"#terms\" className=\"text-primary hover:underline\" data-testid=\"link-terms\">الشروط والأحكام</a>\n              {\" \"}و{\" \"}\n              <a href=\"#privacy\" className=\"text-primary hover:underline\" data-testid=\"link-privacy\">سياسة الخصوصية</a>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":10071},"client/src/pages/Freelancers.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { motion } from \"framer-motion\";\nimport { useLocation } from \"wouter\";\nimport {\n  Users,\n  MapPin,\n  Star,\n  Briefcase,\n  CheckCircle2,\n  Mail,\n  Phone,\n  Award,\n  TrendingUp,\n  Shield,\n  Search,\n  Filter,\n  MessageSquare,\n  Calendar,\n  Eye,\n  Sparkles,\n  Target,\n  Clock\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\ntype Freelancer = {\n  id: string;\n  email: string;\n  fullName: string;\n  username: string;\n  phone: string;\n  countryCode: string;\n  jobTitle?: string;\n  teamSize?: number;\n  services: string[];\n  bio?: string;\n  aboutMe?: string;\n  profileImage?: string;\n  isVerified?: boolean;\n  createdAt: string;\n  rating?: number;\n  completedProjects?: number;\n  responseTime?: string;\n  location?: string;\n};\n\nexport default function Freelancers() {\n  const [, navigate] = useLocation();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedService, setSelectedService] = useState<string>(\"all\");\n\n  const currentUserType = localStorage.getItem(\"userType\");\n\n  const { data: freelancers, isLoading } = useQuery<Freelancer[]>({\n    queryKey: [\"/api/freelancers\"],\n  });\n\n  // Enhanced freelancer data with additional fields\n  const enhancedFreelancers = freelancers?.map(freelancer => ({\n    ...freelancer,\n    rating: Math.random() * 1 + 4, // 4.0 - 5.0\n    completedProjects: Math.floor(Math.random() * 100) + 10,\n    responseTime: [\"فوري\", \"خلال ساعة\", \"خلال ٤ ساعات\"][Math.floor(Math.random() * 3)],\n    location: [\"الرياض\", \"جدة\", \"دبي\", \"القاهرة\", \"المنصور\"][Math.floor(Math.random() * 5)],\n  }));\n\n  // Filter freelancers based on search and service\n  const filteredFreelancers = enhancedFreelancers?.filter((freelancer) => {\n    const matchesSearch = \n      freelancer.fullName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      freelancer.username.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      (freelancer.jobTitle ?? \"\").toLowerCase().includes(searchTerm.toLowerCase()) ||\n      freelancer.services.some(service => service.toLowerCase().includes(searchTerm.toLowerCase()));\n\n    const matchesService = \n      selectedService === \"all\" || \n      freelancer.services.includes(selectedService);\n\n    return matchesSearch && matchesService;\n  });\n\n  // Get unique services from all freelancers\n  const allServices = Array.from(\n    new Set(enhancedFreelancers?.flatMap((f) => f.services) || [])\n  );\n\n  // Get initials for avatar fallback\n  const getInitials = (name: string) => {\n    return name\n      .split(\" \")\n      .map((n) => n[0])\n      .join(\"\")\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  // Format date\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return new Intl.DateTimeFormat(\"ar-SA\", {\n      year: \"numeric\",\n      month: \"long\",\n    }).format(date);\n  };\n\n  const getRatingColor = (rating: number) => {\n    if (rating >= 4.5) return \"from-amber-500 to-amber-600\";\n    if (rating >= 4.0) return \"from-green-500 to-green-600\";\n    return \"from-blue-500 to-blue-600\";\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-br from-gray-50/50 via-blue-50/30 to-purple-50/30\">\n      <Navbar />\n\n      {/* Enhanced Hero Section */}\n      <section className=\"relative bg-gradient-to-br from-blue-600/10 via-purple-600/10 to-cyan-500/10 py-20 border-b border-gray-200/50 overflow-hidden\">\n        {/* Background Elements */}\n        <div className=\"absolute inset-0\">\n          <div className=\"absolute top-10 left-10 w-72 h-72 bg-blue-200/20 rounded-full blur-3xl\"></div>\n          <div className=\"absolute bottom-10 right-10 w-96 h-96 bg-purple-200/20 rounded-full blur-3xl\"></div>\n          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-200/20 rounded-full blur-3xl\"></div>\n        </div>\n\n        <div className=\"max-w-7xl mx-auto px-6 sm:px-8 lg:px-10 relative\">\n          <div className=\"text-center space-y-8\">\n            <motion.div\n              initial={{ opacity: 0, y: 30 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n              className=\"space-y-6\"\n            >\n              {/* Premium Badge */}\n              <div className=\"inline-flex items-center gap-3 bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-3 rounded-2xl shadow-lg\">\n                <Sparkles className=\"h-5 w-5 text-white\" />\n                <span className=\"text-white font-semibold text-sm\" data-testid=\"text-freelancers-count\">\n                  {enhancedFreelancers?.length || 0}+ مستقل محترف\n                </span>\n              </div>\n              \n              {/* Main Title */}\n              <div className=\"space-y-4\">\n                <h1 className=\"text-5xl sm:text-6xl font-bold\" data-testid=\"text-page-title\">\n                  <span className=\"bg-gradient-to-br from-blue-600 via-purple-600 to-cyan-600 bg-clip-text text-transparent\">\n                    المستقلون المحترفون\n                  </span>\n                </h1>\n                \n                <p className=\"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed\" data-testid=\"text-page-description\">\n                  اكتشف أفضل المواهب العربية في مجال التطوير والتصميم. تواصل مع مستقلين موثوقين \n                  لتحويل أفكارك إلى واقع ملموس بمهارة واحترافية.\n                </p>\n              </div>\n            </motion.div>\n\n            {/* Enhanced Stats */}\n            <motion.div\n              initial={{ opacity: 0, y: 30 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, delay: 0.2 }}\n              className=\"grid grid-cols-2 lg:grid-cols-4 gap-6 max-w-5xl mx-auto mt-12\"\n            >\n              {[\n                { \n                  icon: Award, \n                  value: enhancedFreelancers?.filter(f => f.isVerified)?.length || 0, \n                  label: \"مستقل موثق\",\n                  color: \"from-amber-500 to-amber-600\",\n                  bgColor: \"bg-amber-500/10\"\n                },\n                { \n                  icon: Briefcase, \n                  value: allServices.length, \n                  label: \"خدمة متنوعة\",\n                  color: \"from-blue-500 to-blue-600\",\n                  bgColor: \"bg-blue-500/10\"\n                },\n                { \n                  icon: TrendingUp, \n                  value: \"98%\", \n                  label: \"نسبة النجاح\",\n                  color: \"from-green-500 to-green-600\",\n                  bgColor: \"bg-green-500/10\"\n                },\n                { \n                  icon: Shield, \n                  value: \"100%\", \n                  label: \"موثوقية\",\n                  color: \"from-purple-500 to-purple-600\",\n                  bgColor: \"bg-purple-500/10\"\n                },\n              ].map((stat, index) => (\n                <div \n                  key={index}\n                  className={`${stat.bgColor} backdrop-blur-sm rounded-3xl p-6 border border-gray-200/50 hover:shadow-xl transition-all duration-500 hover:-translate-y-2`}\n                >\n                  <div className=\"flex items-center justify-center gap-3 mb-3\">\n                    <div className={`p-3 rounded-2xl bg-gradient-to-r ${stat.color}`}>\n                      <stat.icon className=\"h-6 w-6 text-white\" />\n                    </div>\n                    <span className={`text-3xl font-bold bg-gradient-to-r ${stat.color} bg-clip-text text-transparent`}>\n                      {stat.value}\n                    </span>\n                  </div>\n                  <p className=\"text-sm font-semibold text-gray-700\">{stat.label}</p>\n                </div>\n              ))}\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced Filters Section */}\n      <section className=\"bg-white/80 backdrop-blur-xl border-b border-gray-200/50 sticky top-16 z-40 shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-6 sm:px-8 lg:px-10 py-8\">\n          <div className=\"flex flex-col lg:flex-row gap-6 items-start lg:items-center justify-between\">\n            {/* Search and Filters */}\n            <div className=\"flex flex-col sm:flex-row gap-4 flex-1 w-full\">\n              {/* Search */}\n              <div className=\"relative flex-1 max-w-2xl\">\n                <Search className=\"absolute right-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                <Input\n                  placeholder=\"ابحث عن مستقل، مهارة، أو تخصص...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"rounded-2xl border-2 border-gray-200 focus:border-blue-500 px-6 py-3 h-14 text-lg pr-12 transition-all duration-300\"\n                  data-testid=\"input-search\"\n                />\n              </div>\n\n              {/* Service Filter */}\n              <div className=\"flex items-center gap-3 sm:w-80\">\n                <div className=\"p-3 rounded-2xl bg-blue-50 border border-blue-200\">\n                  <Filter className=\"h-5 w-5 text-blue-600\" />\n                </div>\n                <Select value={selectedService} onValueChange={setSelectedService}>\n                  <SelectTrigger className=\"rounded-2xl border-2 border-gray-200 focus:border-blue-500 px-6 py-3 h-14 text-lg\" data-testid=\"select-service-filter\">\n                    <SelectValue placeholder=\"جميع الخدمات\" />\n                  </SelectTrigger>\n                  <SelectContent className=\"rounded-2xl border-2 border-gray-200\">\n                    <SelectItem value=\"all\" className=\"text-lg py-3\">جميع الخدمات</SelectItem>\n                    {allServices.map((service) => (\n                      <SelectItem key={service} value={service} className=\"text-lg py-3\">\n                        {service}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n\n            {/* Results Count */}\n            <div className=\"bg-white/50 backdrop-blur-sm rounded-2xl px-6 py-3 border border-gray-200/50\">\n              <p className=\"text-lg font-semibold text-gray-700\" data-testid=\"text-results-count\">\n                <span className=\"text-blue-600\">{filteredFreelancers?.length || 0}</span> من أصل{\" \"}\n                <span className=\"text-purple-600\">{enhancedFreelancers?.length || 0}</span> مستقل\n              </p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced Freelancers Grid */}\n      <section className=\"flex-1 py-16 bg-transparent\">\n        <div className=\"max-w-7xl mx-auto px-6 sm:px-8 lg:px-10\">\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8\">\n              {[...Array(6)].map((_, i) => (\n                <Card key={i} className=\"rounded-3xl border-2 border-gray-200/50 bg-white/50 backdrop-blur-sm overflow-hidden\">\n                  <CardHeader className=\"space-y-6 pb-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <Skeleton className=\"h-20 w-20 rounded-2xl\" />\n                      <div className=\"flex-1 space-y-3\">\n                        <Skeleton className=\"h-6 w-40\" />\n                        <Skeleton className=\"h-4 w-32\" />\n                        <Skeleton className=\"h-5 w-24\" />\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-6\">\n                    <Skeleton className=\"h-16 w-full rounded-2xl\" />\n                    <div className=\"flex gap-2\">\n                      <Skeleton className=\"h-8 w-20 rounded-full\" />\n                      <Skeleton className=\"h-8 w-24 rounded-full\" />\n                    </div>\n                    <Skeleton className=\"h-12 w-full rounded-2xl\" />\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredFreelancers && filteredFreelancers.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8\">\n              {filteredFreelancers.map((freelancer, index) => (\n                <motion.div\n                  key={freelancer.id}\n                  initial={{ opacity: 0, y: 30, scale: 0.95 }}\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\n                  transition={{ \n                    duration: 0.6, \n                    delay: index * 0.1,\n                    type: \"spring\",\n                    stiffness: 100\n                  }}\n                  whileHover={{ y: -8, scale: 1.02 }}\n                  className=\"group\"\n                >\n                  <Card \n                    className=\"rounded-3xl border-2 border-gray-200/50 bg-white/80 backdrop-blur-sm hover:border-blue-300/50 transition-all duration-500 overflow-hidden shadow-lg hover:shadow-2xl h-full\"\n                    data-testid={`card-freelancer-${freelancer.id}`}\n                  >\n                    {/* Premium Header */}\n                    <div className=\"bg-gradient-to-r from-blue-600/5 via-purple-600/5 to-cyan-500/5 border-b border-gray-200/50 p-1\">\n                      <div className=\"flex items-center justify-between px-6 py-3\">\n                        {/* Verified Badge */}\n                        {freelancer.isVerified && (\n                          <Badge className=\"bg-gradient-to-r from-green-500 to-green-600 text-white border-0 rounded-2xl px-4 py-2 shadow-lg\" data-testid={`badge-verified-${freelancer.id}`}>\n                            <CheckCircle2 className=\"h-4 w-4 ml-2\" />\n                            موثق\n                          </Badge>\n                        )}\n                        \n                        {/* Rating */}\n                        <div className=\"flex items-center gap-2 bg-white/80 backdrop-blur-sm rounded-2xl px-3 py-2 border border-gray-200/50\">\n                          <Star className=\"h-4 w-4 fill-amber-500 text-amber-500\" />\n                          <span className=\"font-bold text-gray-700\">{freelancer.rating?.toFixed(1)}</span>\n                          <span className=\"text-xs text-gray-500\">({freelancer.completedProjects})</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <CardHeader className=\"space-y-6 pb-6\">\n                      <div className=\"flex items-start gap-5\">\n                        {/* Enhanced Avatar */}\n                        <div className=\"relative\">\n                          <Avatar className=\"h-20 w-20 border-4 border-white shadow-2xl ring-2 ring-blue-500/20\">\n                            <AvatarImage src={freelancer.profileImage} alt={freelancer.fullName} />\n                            <AvatarFallback className=\"bg-gradient-to-br from-blue-600 to-purple-600 text-white font-bold text-xl\">\n                              {getInitials(freelancer.fullName)}\n                            </AvatarFallback>\n                          </Avatar>\n                          {/* Online Status */}\n                          <div className=\"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 border-2 border-white rounded-full shadow-lg\"></div>\n                        </div>\n\n                        {/* Name & Info */}\n                        <div className=\"flex-1 min-w-0 space-y-3\">\n                          <div>\n                            <h3 className=\"font-bold text-xl text-gray-900 mb-1 truncate\" data-testid={`text-freelancer-name-${freelancer.id}`}>\n                              {freelancer.fullName}\n                            </h3>\n                            <p className=\"text-sm text-gray-500 mb-2\" data-testid={`text-freelancer-username-${freelancer.id}`}>\n                              @{freelancer.username}\n                            </p>\n                            {freelancer.jobTitle && (\n                              <Badge variant=\"secondary\" className=\"bg-blue-50 text-blue-700 border-blue-200 rounded-2xl px-3 py-1\" data-testid={`badge-job-title-${freelancer.id}`}>\n                                <Briefcase className=\"h-3 w-3 ml-2\" />\n                                {freelancer.jobTitle}\n                              </Badge>\n                            )}\n                          </div>\n\n                          {/* Quick Stats */}\n                          <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n                            <div className=\"flex items-center gap-1\">\n                              <Target className=\"h-4 w-4 text-green-600\" />\n                              <span>{freelancer.completedProjects} مشروع</span>\n                            </div>\n                            <div className=\"flex items-center gap-1\">\n                              <Clock className=\"h-4 w-4 text-blue-600\" />\n                              <span>{freelancer.responseTime}</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </CardHeader>\n\n                    <CardContent className=\"space-y-6\">\n                      {/* Bio */}\n                      {freelancer.bio && (\n                        <p className=\"text-sm text-gray-600 leading-relaxed line-clamp-3 bg-gray-50/50 rounded-2xl p-4 border border-gray-200/50\" data-testid={`text-freelancer-bio-${freelancer.id}`}>\n                          {freelancer.bio}\n                        </p>\n                      )}\n\n                      {/* Services */}\n                      {freelancer.services.length > 0 && (\n                        <div className=\"space-y-3\">\n                          <p className=\"text-sm font-semibold text-gray-700 flex items-center gap-2\">\n                            <Sparkles className=\"h-4 w-4 text-purple-600\" />\n                            المهارات والتخصصات\n                          </p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {freelancer.services.slice(0, 4).map((service, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"text-xs bg-gradient-to-r from-blue-50 to-purple-50 border-blue-200 text-blue-700 rounded-2xl px-3 py-2 font-medium\"\n                                data-testid={`badge-service-${freelancer.id}-${i}`}\n                              >\n                                {service}\n                              </Badge>\n                            ))}\n                            {freelancer.services.length > 4 && (\n                              <Badge variant=\"outline\" className=\"text-xs bg-gray-50 text-gray-600 rounded-2xl px-3 py-2\" data-testid={`badge-more-services-${freelancer.id}`}>\n                                +{freelancer.services.length - 4}\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Location & Join Date */}\n                      <div className=\"flex items-center justify-between text-sm text-gray-500 border-t border-gray-200/50 pt-4\">\n                        <div className=\"flex items-center gap-2\" data-testid={`text-join-date-${freelancer.id}`}>\n                          <Calendar className=\"h-4 w-4\" />\n                          <span>انضم {formatDate(freelancer.createdAt)}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <MapPin className=\"h-4 w-4\" />\n                          <span>{freelancer.location}</span>\n                        </div>\n                      </div>\n\n                      {/* Enhanced Action Button */}\n                      {currentUserType === \"product_owner\" ? (\n                        <Button\n                          className=\"w-full rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-300 group-hover:scale-105 h-14 text-lg font-semibold\"\n                          onClick={() => navigate(`/chat/${freelancer.id}`)}\n                          data-testid={`button-contact-${freelancer.id}`}\n                        >\n                          <MessageSquare className=\"ml-3 h-5 w-5\" />\n                          بدء المحادثة\n                        </Button>\n                      ) : (\n                        <Button\n                          className=\"w-full rounded-2xl bg-gradient-to-r from-gray-600 to-gray-700 shadow-lg h-14 text-lg font-semibold\"\n                          onClick={() => navigate(`/profile/${freelancer.id}`)}\n                          data-testid={`button-contact-${freelancer.id}`}\n                        >\n                          <Eye className=\"ml-3 h-5 w-5\" />\n                          عرض الملف الشخصي\n                        </Button>\n                      )}\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          ) : (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.9 }}\n              animate={{ opacity: 1, scale: 1 }}\n              className=\"text-center py-20\"\n            >\n              <div className=\"inline-flex items-center justify-center w-24 h-24 rounded-3xl bg-gradient-to-br from-blue-100 to-purple-100 mb-6 shadow-lg\">\n                <Users className=\"h-12 w-12 text-gray-600\" />\n              </div>\n              <h3 className=\"text-2xl font-bold text-gray-800 mb-3\">لا توجد نتائج</h3>\n              <p className=\"text-gray-600 text-lg max-w-md mx-auto mb-8\">\n                جرب تغيير كلمات البحث أو اختر خدمة مختلفة من الفلتر\n              </p>\n              <Button \n                onClick={() => { setSearchTerm(\"\"); setSelectedService(\"all\"); }}\n                className=\"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 px-8 py-3 text-lg\"\n              >\n                عرض جميع المستقلين\n              </Button>\n            </motion.div>\n          )}\n        </div>\n      </section>\n\n      <Footer />\n    </div>\n  );\n}","size_bytes":23086},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/pages/RoleSelection.tsx":{"content":"import { Link } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Users, Briefcase, Sparkles } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\n\nexport default function RoleSelection() {\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n\n      <div className=\"flex-1 py-16 px-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"text-center mb-12\">\n            <div className=\"inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full mb-6\">\n              <Sparkles className=\"h-4 w-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">ابدأ رحلتك معنا</span>\n            </div>\n            <h1 className=\"text-4xl font-bold mb-4\" data-testid=\"text-role-title\">\n              اختر نوع حسابك\n            </h1>\n            <p className=\"text-lg text-muted-foreground\">\n              هل أنت مستقل تبحث عن فرص أم صاحب منتج تحتاج لاختباره؟\n            </p>\n          </div>\n\n          <div className=\"flex justify-center gap-4 flex-wrap\">\n            <Link href=\"/freelancer-signup\">\n              <motion.div\n                className=\"inline-flex items-center justify-center gap-2 rounded-full py-6 px-12 text-lg font-bold shadow-lg bg-primary text-primary-foreground hover-elevate active-elevate-2 cursor-pointer transition-all\"\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                transition={{ duration: 0.2 }}\n                data-testid=\"button-freelancer\"\n              >\n                <Users className=\"h-6 w-6\" />\n                <span>مستقل محترف</span>\n              </motion.div>\n            </Link>\n\n            <Link href=\"/product-owner-signup\">\n              <motion.div\n                className=\"inline-flex items-center justify-center gap-2 rounded-full py-6 px-12 text-lg font-bold shadow-lg bg-primary text-primary-foreground hover-elevate active-elevate-2 cursor-pointer transition-all\"\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                transition={{ duration: 0.2 }}\n                data-testid=\"button-owner\"\n              >\n                <Briefcase className=\"h-6 w-6\" />\n                <span>صاحب منتج رقمي</span>\n              </motion.div>\n            </Link>\n          </div>\n\n          <div className=\"text-center mt-8\">\n            <p className=\"text-sm text-muted-foreground\">\n              لديك حساب بالفعل؟{\" \"}\n              <Link href=\"/login\" className=\"text-primary font-medium hover:underline\" data-testid=\"link-login\">\n                تسجيل الدخول\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":2896},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"server/storage.ts":{"content":"\nimport {\n  type User,\n  type InsertUser,\n  type Freelancer,\n  type InsertFreelancer,\n  type ProductOwner,\n  type InsertProductOwner,\n  type Campaign,\n  type InsertCampaign,\n  type Task,\n  type InsertTask,\n  type Wallet,\n  type InsertWallet,\n  type Transaction,\n  type InsertTransaction,\n  type Payment,\n  type InsertPayment,\n  type Notification,\n  type InsertNotification,\n  type Group,\n  type InsertGroup,\n  type GroupMember,\n  type InsertGroupMember,\n  type Project,\n  type InsertProject,\n  type Message,\n  type InsertMessage,\n  type Withdrawal,\n  type InsertWithdrawal,\n  type Order,\n  type InsertOrder,\n  type Conversation,\n  type InsertConversation,\n  type ConversationMessage,\n  type InsertConversationMessage,\n  type GroupJoinRequest,\n  type InsertGroupJoinRequest,\n  type GroupSpectator,\n  type InsertGroupSpectator,\n  type GroupPost,\n  type InsertGroupPost,\n  type PostComment,\n  type InsertPostComment,\n  type PostReaction,\n  type InsertPostReaction,\n  users,\n  freelancers,\n  productOwners,\n  campaigns,\n  tasks,\n  wallets,\n  transactions,\n  payments,\n  notifications,\n  groups,\n  groupMembers,\n  projects,\n  messages,\n  withdrawals,\n  orders,\n  conversations,\n  conversationMessages,\n  groupJoinRequests,\n  groupPosts,\n  groupSpectators,\n  postComments,\n  postReactions,\n  directMessages,\n} from \"@shared/schema\";\nimport { isNotNull } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport { eq, and, or, desc, asc } from \"drizzle-orm\";\nimport { randomUUID } from \"crypto\";\nimport { sql } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // Legacy user methods (for compatibility)\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n\n  // Freelancer methods\n  getFreelancer(id: string): Promise<Freelancer | undefined>;\n  getFreelancerByEmail(email: string): Promise<Freelancer | undefined>;\n  getFreelancerByUsername(username: string): Promise<Freelancer | undefined>;\n  createFreelancer(freelancer: InsertFreelancer): Promise<Freelancer>;\n  updateFreelancer(\n    id: string,\n    updates: Partial<Freelancer>\n  ): Promise<Freelancer | undefined>;\n  getAllFreelancers(): Promise<Freelancer[]>;\n\n  // Product Owner methods\n  getProductOwner(id: string): Promise<ProductOwner | undefined>;\n  getProductOwnerByEmail(email: string): Promise<ProductOwner | undefined>;\n  createProductOwner(owner: InsertProductOwner): Promise<ProductOwner>;\n  updateProductOwner(\n    id: string,\n    updates: Partial<ProductOwner>\n  ): Promise<ProductOwner | undefined>;\n  getAllProductOwners(): Promise<ProductOwner[]>;\n\n  // Campaign methods\n  getCampaign(id: string): Promise<Campaign | undefined>;\n  getCampaignsByOwner(productOwnerId: string): Promise<Campaign[]>;\n  getAllCampaigns(): Promise<Campaign[]>;\n  getActiveCampaigns(): Promise<Campaign[]>;\n  createCampaign(campaign: InsertCampaign): Promise<Campaign>;\n  updateCampaign(\n    id: string,\n    updates: Partial<Campaign>\n  ): Promise<Campaign | undefined>;\n  deleteCampaign(id: string): Promise<void>;\n\n  // Task methods\n  getTask(id: string): Promise<Task | undefined>;\n  getTasksByCampaign(campaignId: string): Promise<Task[]>;\n  getTasksByFreelancer(freelancerId: string): Promise<Task[]>;\n  getTasksByProject(projectId: string): Promise<Task[]>;\n  getTasksByGroup(groupId: string): Promise<Task[]>;\n  getAvailableTasks(): Promise<Task[]>;\n  createTask(task: InsertTask): Promise<Task>;\n  updateTask(id: string, updates: Partial<Task>): Promise<Task | undefined>;\n  assignTask(taskId: string, freelancerId: string): Promise<Task | undefined>;\n\n  // Wallet methods\n  getWalletByFreelancer(freelancerId: string): Promise<Wallet | undefined>;\n  createWallet(freelancerId: string): Promise<Wallet>;\n  updateWallet(\n    id: string,\n    updates: Partial<Wallet>\n  ): Promise<Wallet | undefined>;\n\n  // Transaction methods\n  getTransactionsByWallet(walletId: string): Promise<Transaction[]>;\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n\n  // Payment methods\n  getPaymentsByCampaign(campaignId: string): Promise<Payment[]>;\n  getPaymentsByOwner(productOwnerId: string): Promise<Payment[]>;\n  createPayment(payment: InsertPayment): Promise<Payment>;\n  updatePayment(\n    id: string,\n    updates: Partial<Payment>\n  ): Promise<Payment | undefined>;\n\n  // Notification methods\n  getNotificationsByUser(\n    userId: string,\n    userType: string\n  ): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: string): Promise<void>;\n\n  // Group methods\n  getGroup(id: string): Promise<Group | undefined>;\n  getAllGroups(): Promise<Group[]>;\n  getGroupsByLeader(leaderId: string): Promise<Group[]>;\n  getGroupsByMember(freelancerId: string): Promise<Group[]>;\n  createGroup(group: InsertGroup): Promise<Group>;\n  updateGroup(id: string, updates: Partial<Group>): Promise<Group | undefined>;\n\n  // Group Member methods\n  getGroupMembers(groupId: string): Promise<GroupMember[]>;\n  addGroupMember(member: InsertGroupMember): Promise<GroupMember>;\n  removeGroupMember(groupId: string, freelancerId: string): Promise<void>;\n  isGroupMember(groupId: string, freelancerId: string): Promise<boolean>;\n\n  // Group Spectator methods (product owners who can spectate a group)\n  getGroupSpectators(groupId: string): Promise<GroupSpectator[]>;\n  addGroupSpectator(spectator: InsertGroupSpectator): Promise<GroupSpectator>;\n  removeGroupSpectator(groupId: string, productOwnerId: string): Promise<void>;\n  isGroupSpectator(groupId: string, productOwnerId: string): Promise<boolean>;\n\n  // Group Join Request methods\n  getJoinRequestsByGroup(groupId: string): Promise<GroupJoinRequest[]>;\n  getJoinRequestByFreelancer(\n    groupId: string,\n    freelancerId: string\n  ): Promise<GroupJoinRequest | undefined>;\n  createJoinRequest(request: InsertGroupJoinRequest): Promise<GroupJoinRequest>;\n  updateJoinRequest(\n    id: string,\n    updates: Partial<GroupJoinRequest>\n  ): Promise<GroupJoinRequest | undefined>;\n  deleteJoinRequest(id: string): Promise<void>;\n\n  // Project methods\n  getProject(id: string): Promise<Project | undefined>;\n  getProjectsByOwner(productOwnerId: string): Promise<Project[]>;\n  getPendingProjects(): Promise<Project[]>;\n  getProjectsByGroup(groupId: string): Promise<Project[]>;\n  createProject(project: InsertProject): Promise<Project>;\n  updateProject(\n    id: string,\n    updates: Partial<Project>\n  ): Promise<Project | undefined>;\n  acceptProject(\n    projectId: string,\n    groupId: string\n  ): Promise<Project | undefined>;\n\n  // Message methods\n  getMessagesByGroup(groupId: string): Promise<Message[]>;\n  createMessage(message: InsertMessage): Promise<Message>;\n\n  // Withdrawal methods\n  getWithdrawalsByFreelancer(freelancerId: string): Promise<Withdrawal[]>;\n  getAllWithdrawals(): Promise<Withdrawal[]>;\n  createWithdrawal(withdrawal: InsertWithdrawal): Promise<Withdrawal>;\n  updateWithdrawal(\n    id: string,\n    updates: Partial<Withdrawal>\n  ): Promise<Withdrawal | undefined>;\n\n  // Order methods\n  getOrderById(id: string): Promise<Order | undefined>;\n  getOrdersByProductOwner(productOwnerId: string): Promise<Order[]>;\n  getOrdersByGroupLeader(leaderId: string): Promise<Order[]>;\n  createOrder(order: InsertOrder): Promise<Order>;\n  updateOrderStatus(id: string, status: string): Promise<Order | undefined>;\n\n  // Helper methods for orders\n  getGroupById(id: string): Promise<Group | undefined>;\n  markAllNotificationsAsRead(userId: string, userType: string): Promise<void>;\n  getUnreadNotificationCount(userId: string, userType: string): Promise<number>;\n\n  // Conversation methods\n  getOrCreateConversation(\n    productOwnerId: string,\n    groupId: string,\n    leaderId: string\n  ): Promise<Conversation>;\n  getConversation(conversationId: string): Promise<Conversation | undefined>;\n  getConversationsBetweenUsers(\n    userId1: string,\n    userId2: string,\n    userType: string\n  ): Promise<Conversation[]>;\n  getConversationMessages(\n    conversationId: string\n  ): Promise<ConversationMessage[]>;\n  sendMessage(\n    conversationId: string,\n    senderId: string,\n    senderType: string,\n    content: string\n  ): Promise<ConversationMessage>;\n  getProductOwnerConversations(productOwnerId: string): Promise<Conversation[]>;\n  getFreelancerConversations(freelancerId: string): Promise<Conversation[]>;\n  markMessagesAsRead(conversationId: string, userId: string): Promise<void>;\n\n  // Direct Messages methods\n  getDirectMessages(userId: string, userType: string, otherUserId: string, otherUserType: string): Promise<any[]>;\n  sendDirectMessage(senderId: string, senderType: string, receiverId: string, receiverType: string, content: string): Promise<any>;\n  getDirectMessageHistory(userId: string, userType: string): Promise<any[]>;\n\n  // Group Posts methods\n  getPostsByGroup(groupId: string): Promise<GroupPost[]>;\n  getPost(postId: string): Promise<GroupPost | undefined>;\n  createPost(post: InsertGroupPost): Promise<GroupPost>;\n  deletePost(postId: string): Promise<void>;\n  updatePostCounts(\n    postId: string,\n    likesCount?: number,\n    commentsCount?: number\n  ): Promise<void>;\n\n  // Post Comments methods\n  getCommentsByPost(postId: string): Promise<PostComment[]>;\n  createComment(comment: InsertPostComment): Promise<PostComment>;\n  deleteComment(commentId: string): Promise<void>;\n\n  // Post Reactions methods\n  getReactionsByPost(postId: string): Promise<PostReaction[]>;\n  getUserReaction(\n    postId: string,\n    userId: string\n  ): Promise<PostReaction | undefined>;\n  createReaction(reaction: InsertPostReaction): Promise<PostReaction>;\n  deleteReaction(postId: string, userId: string): Promise<void>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private freelancers: Map<string, Freelancer>;\n  private productOwners: Map<string, ProductOwner>;\n\n  constructor() {\n    this.users = new Map();\n    this.freelancers = new Map();\n    this.productOwners = new Map();\n  }\n\n  // Legacy user methods\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n\n  // Freelancer methods\n  async getFreelancer(id: string): Promise<Freelancer | undefined> {\n    return this.freelancers.get(id);\n  }\n\n  async getFreelancerByEmail(email: string): Promise<Freelancer | undefined> {\n    return Array.from(this.freelancers.values()).find(\n      (freelancer) => freelancer.email === email\n    );\n  }\n\n  async getFreelancerByUsername(\n    username: string\n  ): Promise<Freelancer | undefined> {\n    return Array.from(this.freelancers.values()).find(\n      (freelancer) => freelancer.username === username\n    );\n  }\n\n  async createFreelancer(\n    insertFreelancer: InsertFreelancer\n  ): Promise<Freelancer> {\n    const id = randomUUID();\n    const freelancer: Freelancer = {\n      ...insertFreelancer,\n      id,\n      countryCode: insertFreelancer.countryCode || \"+966\",\n      jobTitle: insertFreelancer.jobTitle || null,\n      teamSize: insertFreelancer.teamSize || null,\n      services: insertFreelancer.services || null,\n      bio: insertFreelancer.bio || null,\n      aboutMe: insertFreelancer.aboutMe || null,\n      profileImage: insertFreelancer.profileImage || null,\n      idVerification: insertFreelancer.idVerification || null,\n      paymentMethod: insertFreelancer.paymentMethod || null,\n      accountNumber: insertFreelancer.accountNumber || null,\n      isVerified: false,\n      createdAt: new Date(),\n    };\n    this.freelancers.set(id, freelancer);\n    return freelancer;\n  }\n\n  async updateFreelancer(\n    id: string,\n    updates: Partial<Freelancer>\n  ): Promise<Freelancer | undefined> {\n    const existing = this.freelancers.get(id);\n    if (!existing) return undefined;\n\n    const updated = { ...existing, ...updates };\n    this.freelancers.set(id, updated);\n    return updated;\n  }\n\n  async getAllFreelancers(): Promise<Freelancer[]> {\n    return Array.from(this.freelancers.values());\n  }\n\n  // Product Owner methods\n  async getProductOwner(id: string): Promise<ProductOwner | undefined> {\n    return this.productOwners.get(id);\n  }\n\n  async getProductOwnerByEmail(\n    email: string\n  ): Promise<ProductOwner | undefined> {\n    return Array.from(this.productOwners.values()).find(\n      (owner) => owner.email === email\n    );\n  }\n\n  async createProductOwner(\n    insertOwner: InsertProductOwner\n  ): Promise<ProductOwner> {\n    const id = randomUUID();\n    const owner: ProductOwner = {\n      ...insertOwner,\n      id,\n      companyName: insertOwner.companyName || null,\n      productDescription: insertOwner.productDescription || null,\n      productUrl: insertOwner.productUrl || null,\n      services: insertOwner.services || null,\n      package: insertOwner.package || null,\n      budget: insertOwner.budget || null,\n      duration: insertOwner.duration || null,\n      createdAt: new Date(),\n    };\n    this.productOwners.set(id, owner);\n    return owner;\n  }\n\n  async updateProductOwner(\n    id: string,\n    updates: Partial<ProductOwner>\n  ): Promise<ProductOwner | undefined> {\n    const existing = this.productOwners.get(id);\n    if (!existing) return undefined;\n\n    const updated = { ...existing, ...updates };\n    this.productOwners.set(id, updated);\n    return updated;\n  }\n\n  async getAllProductOwners(): Promise<ProductOwner[]> {\n    return Array.from(this.productOwners.values());\n  }\n\n    // Project deletion\n  async deleteProject(id: string): Promise<void> {\n    await db.delete(projects).where(eq(projects.id, id));\n  }\n\n  // Get tasks by project\n  async getTasksByProject(projectId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.projectId, projectId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  // Get tasks by group\n  async getTasksByGroup(groupId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.groupId, groupId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  // Get notification by id (for patch route)\n  async getNotification(id: string): Promise<Notification | undefined> {\n    const [notification] = await db\n      .select()\n      .from(notifications)\n      .where(eq(notifications.id, id));\n    return notification || undefined;\n  }\n  // Stub implementations for new methods (not used since we're using DatabaseStorage)\n  async getCampaign(): Promise<Campaign | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getCampaignsByOwner(): Promise<Campaign[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getAllCampaigns(): Promise<Campaign[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getActiveCampaigns(): Promise<Campaign[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createCampaign(): Promise<Campaign> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateCampaign(): Promise<Campaign | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async deleteCampaign(): Promise<void> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getTask(): Promise<Task | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getTasksByCampaign(): Promise<Task[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getTasksByFreelancer(): Promise<Task[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getAvailableTasks(): Promise<Task[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createTask(): Promise<Task> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateTask(): Promise<Task | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async assignTask(): Promise<Task | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getWalletByFreelancer(): Promise<Wallet | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createWallet(): Promise<Wallet> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateWallet(): Promise<Wallet | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getTransactionsByWallet(): Promise<Transaction[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createTransaction(): Promise<Transaction> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getPaymentsByCampaign(): Promise<Payment[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getPaymentsByOwner(): Promise<Payment[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createPayment(): Promise<Payment> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updatePayment(): Promise<Payment | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getNotificationsByUser(): Promise<Notification[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createNotification(): Promise<Notification> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async markNotificationAsRead(): Promise<void> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getGroup(): Promise<Group | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getGroupsByLeader(): Promise<Group[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getGroupsByMember(): Promise<Group[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createGroup(): Promise<Group> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateGroup(): Promise<Group | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getGroupMembers(): Promise<GroupMember[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async addGroupMember(): Promise<GroupMember> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async removeGroupMember(): Promise<void> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async isGroupMember(): Promise<boolean> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getJoinRequestsByGroup(): Promise<GroupJoinRequest[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getJoinRequestByFreelancer(): Promise<GroupJoinRequest | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createJoinRequest(): Promise<GroupJoinRequest> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateJoinRequest(): Promise<GroupJoinRequest | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async deleteJoinRequest(): Promise<void> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getProject(): Promise<Project | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getProjectsByOwner(): Promise<Project[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getPendingProjects(): Promise<Project[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getProjectsByGroup(): Promise<Project[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createProject(): Promise<Project> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateProject(): Promise<Project | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async acceptProject(): Promise<Project | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getMessagesByGroup(): Promise<Message[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createMessage(): Promise<Message> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getWithdrawalsByFreelancer(): Promise<Withdrawal[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async getAllWithdrawals(): Promise<Withdrawal[]> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async createWithdrawal(): Promise<Withdrawal> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n  async updateWithdrawal(): Promise<Withdrawal | undefined> {\n    throw new Error(\"Not implemented in MemStorage\");\n  }\n}\n\n// Database Storage Implementation\nexport class DatabaseStorage implements IStorage {\n  // Legacy user methods\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db\n      .select()\n      .from(users)\n      .where(eq(users.username, username));\n    return user || undefined;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  // Freelancer methods\n  async getFreelancer(id: string): Promise<Freelancer | undefined> {\n    const [freelancer] = await db\n      .select()\n      .from(freelancers)\n      .where(eq(freelancers.id, id));\n    return freelancer || undefined;\n  }\n\n  async getFreelancerByEmail(email: string): Promise<Freelancer | undefined> {\n    const [freelancer] = await db\n      .select()\n      .from(freelancers)\n      .where(eq(freelancers.email, email));\n    return freelancer || undefined;\n  }\n\n  async getFreelancerByUsername(\n    username: string\n  ): Promise<Freelancer | undefined> {\n    const [freelancer] = await db\n      .select()\n      .from(freelancers)\n      .where(eq(freelancers.username, username));\n    return freelancer || undefined;\n  }\n\n  async createFreelancer(\n    insertFreelancer: InsertFreelancer\n  ): Promise<Freelancer> {\n    const [freelancer] = await db\n      .insert(freelancers)\n      .values(insertFreelancer)\n      .returning();\n    // Create wallet for the freelancer\n    await this.createWallet(freelancer.id);\n    return freelancer;\n  }\n\n  async updateFreelancer(\n    id: string,\n    updates: Partial<Freelancer>\n  ): Promise<Freelancer | undefined> {\n    const [updated] = await db\n      .update(freelancers)\n      .set(updates)\n      .where(eq(freelancers.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async getAllFreelancers(): Promise<Freelancer[]> {\n    return await db.select().from(freelancers);\n  }\n\n  // Product Owner methods\n  async getProductOwner(id: string): Promise<ProductOwner | undefined> {\n    const [owner] = await db\n      .select()\n      .from(productOwners)\n      .where(eq(productOwners.id, id));\n    return owner || undefined;\n  }\n\n  async getProductOwnerByEmail(\n    email: string\n  ): Promise<ProductOwner | undefined> {\n    const [owner] = await db\n      .select()\n      .from(productOwners)\n      .where(eq(productOwners.email, email));\n    return owner || undefined;\n  }\n\n  async createProductOwner(\n    insertOwner: InsertProductOwner\n  ): Promise<ProductOwner> {\n    const [owner] = await db\n      .insert(productOwners)\n      .values(insertOwner)\n      .returning();\n    return owner;\n  }\n\n  async updateProductOwner(\n    id: string,\n    updates: Partial<ProductOwner>\n  ): Promise<ProductOwner | undefined> {\n    const [updated] = await db\n      .update(productOwners)\n      .set(updates)\n      .where(eq(productOwners.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async getAllProductOwners(): Promise<ProductOwner[]> {\n    return await db.select().from(productOwners);\n  }\n\n  // Campaign methods\n  async getCampaign(id: string): Promise<Campaign | undefined> {\n    const [campaign] = await db\n      .select()\n      .from(campaigns)\n      .where(eq(campaigns.id, id));\n    return campaign || undefined;\n  }\n\n  async getCampaignsByOwner(productOwnerId: string): Promise<Campaign[]> {\n    return await db\n      .select()\n      .from(campaigns)\n      .where(eq(campaigns.productOwnerId, productOwnerId))\n      .orderBy(desc(campaigns.createdAt));\n  }\n\n  async getAllCampaigns(): Promise<Campaign[]> {\n    return await db.select().from(campaigns).orderBy(desc(campaigns.createdAt));\n  }\n\n  async getActiveCampaigns(): Promise<Campaign[]> {\n    return await db\n      .select()\n      .from(campaigns)\n      .where(\n        or(eq(campaigns.status, \"active\"), eq(campaigns.status, \"in_progress\"))\n      )\n      .orderBy(desc(campaigns.createdAt));\n  }\n\n  async createCampaign(insertCampaign: InsertCampaign): Promise<Campaign> {\n    const [campaign] = await db\n      .insert(campaigns)\n      .values(insertCampaign)\n      .returning();\n    return campaign;\n  }\n\n  async updateCampaign(\n    id: string,\n    updates: Partial<Campaign>\n  ): Promise<Campaign | undefined> {\n    const [updated] = await db\n      .update(campaigns)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(campaigns.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteCampaign(id: string): Promise<void> {\n    await db.delete(campaigns).where(eq(campaigns.id, id));\n  }\n\n  // Task methods\n  async getTask(id: string): Promise<Task | undefined> {\n    const [task] = await db.select().from(tasks).where(eq(tasks.id, id));\n    return task || undefined;\n  }\n\n  async getTasksByCampaign(campaignId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.campaignId, campaignId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  async getTasksByFreelancer(freelancerId: string): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.freelancerId, freelancerId))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  async getAvailableTasks(): Promise<Task[]> {\n    return await db\n      .select()\n      .from(tasks)\n      .where(eq(tasks.status, \"available\"))\n      .orderBy(desc(tasks.createdAt));\n  }\n\n  async createTask(insertTask: InsertTask): Promise<Task> {\n    const [task] = await db.insert(tasks).values(insertTask).returning();\n    return task;\n  }\n\n  async updateTask(\n    id: string,\n    updates: Partial<Task>\n  ): Promise<Task | undefined> {\n    const [updated] = await db\n      .update(tasks)\n      .set(updates)\n      .where(eq(tasks.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async assignTask(\n    taskId: string,\n    freelancerId: string\n  ): Promise<Task | undefined> {\n    const [updated] = await db\n      .update(tasks)\n      .set({\n        freelancerId,\n        status: \"assigned\",\n        assignedAt: new Date(),\n      })\n      .where(and(eq(tasks.id, taskId), eq(tasks.status, \"available\")))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Wallet methods\n  async getWalletByFreelancer(\n    freelancerId: string\n  ): Promise<Wallet | undefined> {\n    const [wallet] = await db\n      .select()\n      .from(wallets)\n      .where(eq(wallets.freelancerId, freelancerId));\n    return wallet || undefined;\n  }\n\n  async createWallet(freelancerId: string): Promise<Wallet> {\n    const [wallet] = await db\n      .insert(wallets)\n      .values({ freelancerId })\n      .returning();\n    return wallet;\n  }\n\n  async updateWallet(\n    id: string,\n    updates: Partial<Wallet>\n  ): Promise<Wallet | undefined> {\n    const [updated] = await db\n      .update(wallets)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(wallets.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Transaction methods\n  async getTransactionsByWallet(walletId: string): Promise<Transaction[]> {\n    return await db\n      .select()\n      .from(transactions)\n      .where(eq(transactions.walletId, walletId))\n      .orderBy(desc(transactions.createdAt));\n  }\n\n  async createTransaction(\n    transaction: InsertTransaction\n  ): Promise<Transaction> {\n    const [newTransaction] = await db\n      .insert(transactions)\n      .values(transaction)\n      .returning();\n    return newTransaction;\n  }\n\n  // Payment methods\n  async getPaymentsByCampaign(campaignId: string): Promise<Payment[]> {\n    return await db\n      .select()\n      .from(payments)\n      .where(eq(payments.campaignId, campaignId))\n      .orderBy(desc(payments.createdAt));\n  }\n\n  async getPaymentsByOwner(productOwnerId: string): Promise<Payment[]> {\n    return await db\n      .select()\n      .from(payments)\n      .where(eq(payments.productOwnerId, productOwnerId))\n      .orderBy(desc(payments.createdAt));\n  }\n\n  async createPayment(insertPayment: InsertPayment): Promise<Payment> {\n    const [payment] = await db\n      .insert(payments)\n      .values(insertPayment)\n      .returning();\n    return payment;\n  }\n\n  async updatePayment(\n    id: string,\n    updates: Partial<Payment>\n  ): Promise<Payment | undefined> {\n    const [updated] = await db\n      .update(payments)\n      .set(updates)\n      .where(eq(payments.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Notification methods\n  async getNotificationsByUser(\n    userId: string,\n    userType: string\n  ): Promise<Notification[]> {\n    return await db\n      .select()\n      .from(notifications)\n      .where(\n        and(\n          eq(notifications.userId, userId),\n          eq(notifications.userType, userType)\n        )\n      )\n      .orderBy(desc(notifications.createdAt));\n  }\n\n  async createNotification(\n    insertNotification: InsertNotification\n  ): Promise<Notification> {\n    const [notification] = await db\n      .insert(notifications)\n      .values(insertNotification)\n      .returning();\n    return notification;\n  }\n\n  async markNotificationAsRead(id: string): Promise<void> {\n    await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(eq(notifications.id, id));\n  }\n\n  // Group methods\n  async getGroup(id: string): Promise<Group | undefined> {\n    const [group] = await db.select().from(groups).where(eq(groups.id, id));\n    return group || undefined;\n  }\n\n  async getAllGroups(): Promise<Group[]> {\n  return await db.select().from(groups).orderBy(desc(groups.createdAt));\n}\n\n  async getGroupsByLeader(leaderId: string): Promise<Group[]> {\n    return await db\n      .select()\n      .from(groups)\n      .where(eq(groups.leaderId, leaderId))\n      .orderBy(desc(groups.createdAt));\n  }\n\n  async getGroupsByMember(freelancerId: string): Promise<Group[]> {\n    const memberGroups = await db\n      .select({ group: groups })\n      .from(groupMembers)\n      .innerJoin(groups, eq(groupMembers.groupId, groups.id))\n      .where(eq(groupMembers.freelancerId, freelancerId));\n    return memberGroups.map((mg) => mg.group);\n  }\n\n  async createGroup(insertGroup: InsertGroup): Promise<Group> {\n    const [group] = await db.insert(groups).values(insertGroup).returning();\n    // Add leader as a member\n    await this.addGroupMember({\n      groupId: group.id,\n      freelancerId: group.leaderId,\n      role: \"leader\",\n    });\n    return group;\n  }\n\n  async updateGroup(\n    id: string,\n    updates: Partial<Group>\n  ): Promise<Group | undefined> {\n    const [updated] = await db\n      .update(groups)\n      .set(updates)\n      .where(eq(groups.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Group Member methods\n  async getGroupMembers(groupId: string): Promise<GroupMember[]> {\n    return await db\n      .select()\n      .from(groupMembers)\n      .where(eq(groupMembers.groupId, groupId))\n      .orderBy(desc(groupMembers.joinedAt));\n  }\n\n  async addGroupMember(member: InsertGroupMember): Promise<GroupMember> {\n    const [newMember] = await db\n      .insert(groupMembers)\n      .values(member)\n      .returning();\n\n    // Simply increment the count by 1\n    await db\n      .update(groups)\n      .set({\n        currentMembers: sql<number>`${groups.currentMembers} + 1`,\n      })\n      .where(eq(groups.id, member.groupId));\n\n    return newMember;\n  }\n\n  async removeGroupMember(\n    groupId: string,\n    freelancerId: string\n  ): Promise<void> {\n    await db\n      .delete(groupMembers)\n      .where(\n        and(\n          eq(groupMembers.groupId, groupId),\n          eq(groupMembers.freelancerId, freelancerId)\n        )\n      );\n    // Update group's current members count\n    const count = await db\n      .select()\n      .from(groupMembers)\n      .where(eq(groupMembers.groupId, groupId));\n    await db\n      .update(groups)\n      .set({ currentMembers: count.length })\n      .where(eq(groups.id, groupId));\n  }\n\n  async isGroupMember(groupId: string, freelancerId: string): Promise<boolean> {\n    const [member] = await db\n      .select()\n      .from(groupMembers)\n      .where(\n        and(\n          eq(groupMembers.groupId, groupId),\n          eq(groupMembers.freelancerId, freelancerId)\n        )\n      );\n    return !!member;\n  }\n\n  // Group Spectator methods\n  async getGroupSpectators(groupId: string): Promise<GroupSpectator[]> {\n    return await db\n      .select()\n      .from(groupSpectators)\n      .where(eq(groupSpectators.groupId, groupId))\n      .orderBy(desc(groupSpectators.joinedAt));\n  }\n\n  async addGroupSpectator(spectator: InsertGroupSpectator): Promise<GroupSpectator> {\n    const [newSpectator] = await db\n      .insert(groupSpectators)\n      .values(spectator)\n      .returning();\n    return newSpectator;\n  }\n\n  async removeGroupSpectator(groupId: string, productOwnerId: string): Promise<void> {\n    await db\n      .delete(groupSpectators)\n      .where(\n        and(\n          eq(groupSpectators.groupId, groupId),\n          eq(groupSpectators.productOwnerId, productOwnerId)\n        )\n      );\n  }\n\n  async isGroupSpectator(groupId: string, productOwnerId: string): Promise<boolean> {\n    const [spect] = await db\n      .select()\n      .from(groupSpectators)\n      .where(\n        and(\n          eq(groupSpectators.groupId, groupId),\n          eq(groupSpectators.productOwnerId, productOwnerId)\n        )\n      );\n    return !!spect;\n  }\n\n  // Group Join Request methods\n  async getJoinRequestsByGroup(groupId: string): Promise<GroupJoinRequest[]> {\n    return await db\n      .select()\n      .from(groupJoinRequests)\n      .where(eq(groupJoinRequests.groupId, groupId));\n  }\n\n  // Get group's average rating\n  async getGroupRating(groupId: string): Promise<{\n    average: number;\n    total: number;\n    ratings: number[];\n  }> {\n    const group = await db\n      .select()\n      .from(groups)\n      .where(eq(groups.id, groupId))\n      .limit(1);\n\n    if (group.length === 0) {\n      throw new Error(\"Group not found\");\n    }\n\n    const ratedProjects = await db\n      .select({\n        groupRating: projects.groupRating,\n      })\n      .from(projects)\n      .where(\n        and(\n          eq(projects.acceptedByGroupId, groupId),\n          isNotNull(projects.groupRating),\n          eq(projects.status, \"completed\")\n        )\n      );\n\n    if (ratedProjects.length === 0) {\n      return { average: 0, total: 0, ratings: [] };\n    }\n\n    const ratings = ratedProjects.map((p) => Number(p.groupRating));\n    const total = ratings.reduce((sum, rating) => sum + rating, 0);\n    const average = total / ratings.length;\n\n    return {\n      average: Math.round(average * 100) / 100, // Round to 2 decimals\n      total: ratings.length,\n      ratings,\n    };\n  }\n\n  // Update group's average rating (internal method)\n  async updateGroupRating(groupId: string): Promise<void> {\n    const { average, total } = await this.getGroupRating(groupId);\n\n    await db\n      .update(groups)\n      .set({\n        averageRating: average.toString(),\n        totalRatings: total,\n      })\n      .where(eq(groups.id, groupId));\n  }\n\n  async getJoinRequestByFreelancer(\n    groupId: string,\n    freelancerId: string\n  ): Promise<GroupJoinRequest | undefined> {\n    const [request] = await db\n      .select()\n      .from(groupJoinRequests)\n      .where(\n        and(\n          eq(groupJoinRequests.groupId, groupId),\n          eq(groupJoinRequests.freelancerId, freelancerId)\n        )\n      );\n    return request || undefined;\n  }\n\n  async createJoinRequest(\n    request: InsertGroupJoinRequest\n  ): Promise<GroupJoinRequest> {\n    const [newRequest] = await db\n      .insert(groupJoinRequests)\n      .values(request)\n      .returning();\n    return newRequest;\n  }\n\n  async updateJoinRequest(\n    id: string,\n    updates: Partial<GroupJoinRequest>\n  ): Promise<GroupJoinRequest | undefined> {\n    const [updated] = await db\n      .update(groupJoinRequests)\n      .set(updates)\n      .where(eq(groupJoinRequests.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async deleteJoinRequest(id: string): Promise<void> {\n    await db.delete(groupJoinRequests).where(eq(groupJoinRequests.id, id));\n  }\n\n  // Project methods\n  async getProject(id: string): Promise<Project | undefined> {\n    const [project] = await db\n      .select()\n      .from(projects)\n      .where(eq(projects.id, id));\n    return project || undefined;\n  }\n\n  async getProjectsByOwner(productOwnerId: string): Promise<Project[]> {\n    return await db\n      .select()\n      .from(projects)\n      .where(eq(projects.productOwnerId, productOwnerId))\n      .orderBy(desc(projects.createdAt));\n  }\n\n  async getPendingProjects(): Promise<Project[]> {\n    return await db\n      .select()\n      .from(projects)\n      .where(eq(projects.status, \"pending\"))\n      .orderBy(desc(projects.createdAt));\n  }\n\n  async getProjectsByGroup(groupId: string): Promise<Project[]> {\n    return await db\n      .select()\n      .from(projects)\n      .where(eq(projects.acceptedByGroupId, groupId))\n      .orderBy(desc(projects.createdAt));\n  }\n\n  async createProject(insertProject: InsertProject): Promise<Project> {\n    const [project] = await db\n      .insert(projects)\n      .values(insertProject)\n      .returning();\n    return project;\n  }\n\n  async updateProject(\n    id: string,\n    updates: Partial<Project>\n  ): Promise<Project | undefined> {\n    const [updated] = await db\n      .update(projects)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(projects.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  async acceptProject(\n    projectId: string,\n    groupId: string\n  ): Promise<Project | undefined> {\n    const [updated] = await db\n      .update(projects)\n      .set({\n        status: \"accepted\",\n        acceptedByGroupId: groupId,\n        updatedAt: new Date(),\n      })\n      .where(and(eq(projects.id, projectId), eq(projects.status, \"pending\")))\n      .returning();\n    return updated || undefined;\n  }\n  // Get project rating\n  async getProjectRating(projectId: string): Promise<number | null> {\n    const [project] = await db\n      .select({\n        groupRating: projects.groupRating,\n      })\n      .from(projects)\n      .where(eq(projects.id, projectId))\n      .limit(1);\n\n    return project?.groupRating ? Number(project.groupRating) : null;\n  }\n  // Rate a project (called by product owner after completion)\n  async rateProject(projectId: string, rating: number): Promise<void> {\n    if (rating < 0 || rating > 5) {\n      throw new Error(\"Rating must be between 0 and 5\");\n    }\n\n    // Update the project with the rating\n    const [updatedProject] = await db\n      .update(projects)\n      .set({\n        groupRating: rating.toString(),\n        ratedAt: new Date(),\n      })\n      .where(eq(projects.id, projectId))\n      .returning();\n\n    if (!updatedProject || !updatedProject.acceptedByGroupId) {\n      throw new Error(\"Project not found or not assigned to a group\");\n    }\n\n    // Recalculate and update group's average rating\n    await this.updateGroupRating(updatedProject.acceptedByGroupId);\n  }\n\n  // Message methods\n  async getMessagesByGroup(groupId: string): Promise<Message[]> {\n    return await db\n      .select()\n      .from(messages)\n      .where(eq(messages.groupId, groupId))\n      .orderBy(desc(messages.createdAt));\n  }\n\n  async createMessage(insertMessage: InsertMessage): Promise<Message> {\n    const [message] = await db\n      .insert(messages)\n      .values(insertMessage)\n      .returning();\n    return message;\n  }\n\n  // Withdrawal methods\n  async getWithdrawalsByFreelancer(\n    freelancerId: string\n  ): Promise<Withdrawal[]> {\n    return await db\n      .select()\n      .from(withdrawals)\n      .where(eq(withdrawals.freelancerId, freelancerId))\n      .orderBy(desc(withdrawals.createdAt));\n  }\n\n  async getAllWithdrawals(): Promise<Withdrawal[]> {\n    return await db\n      .select()\n      .from(withdrawals)\n      .orderBy(desc(withdrawals.createdAt));\n  }\n\n  async createWithdrawal(\n    insertWithdrawal: InsertWithdrawal\n  ): Promise<Withdrawal> {\n    const [withdrawal] = await db\n      .insert(withdrawals)\n      .values(insertWithdrawal)\n      .returning();\n    return withdrawal;\n  }\n\n  async updateWithdrawal(\n    id: string,\n    updates: Partial<Withdrawal>\n  ): Promise<Withdrawal | undefined> {\n    const [updated] = await db\n      .update(withdrawals)\n      .set(updates)\n      .where(eq(withdrawals.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Order methods\n  async getOrderById(id: string): Promise<Order | undefined> {\n    const [order] = await db.select().from(orders).where(eq(orders.id, id));\n    return order || undefined;\n  }\n\n  async getOrdersByProductOwner(productOwnerId: string): Promise<Order[]> {\n    return await db\n      .select()\n      .from(orders)\n      .where(eq(orders.productOwnerId, productOwnerId))\n      .orderBy(desc(orders.createdAt));\n  }\n\n  async getOrdersByGroupLeader(leaderId: string): Promise<Order[]> {\n    // Get all groups led by this freelancer\n    const leaderGroups = await db\n      .select()\n      .from(groups)\n      .where(eq(groups.leaderId, leaderId));\n    const groupIds = leaderGroups.map((g) => g.id);\n\n    if (groupIds.length === 0) {\n      return [];\n    }\n\n    // Get all orders for these groups\n    const groupOrders: Order[] = [];\n    for (const groupId of groupIds) {\n      const ordersForGroup = await db\n        .select()\n        .from(orders)\n        .where(eq(orders.groupId, groupId))\n        .orderBy(desc(orders.createdAt));\n      groupOrders.push(...ordersForGroup);\n    }\n\n    return groupOrders;\n  }\n\n  async createOrder(insertOrder: InsertOrder): Promise<Order> {\n    const [order] = await db.insert(orders).values(insertOrder).returning();\n    return order;\n  }\n\n  async updateOrderStatus(\n    id: string,\n    status: string\n  ): Promise<Order | undefined> {\n    const now = new Date();\n    const updateData: any = { status, updatedAt: now };\n\n    if (status === \"payment_confirmed\") {\n      updateData.paidAt = now;\n    } else if (status === \"completed\") {\n      updateData.completedAt = now;\n    }\n\n    const [updated] = await db\n      .update(orders)\n      .set(updateData)\n      .where(eq(orders.id, id))\n      .returning();\n    return updated || undefined;\n  }\n\n  // Helper methods\n  async getGroupById(id: string): Promise<Group | undefined> {\n    return await this.getGroup(id);\n  }\n\n  async markAllNotificationsAsRead(\n    userId: string,\n    userType: string\n  ): Promise<void> {\n    await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(\n        and(\n          eq(notifications.userId, userId),\n          eq(notifications.userType, userType),\n          eq(notifications.isRead, false)\n        )\n      );\n  }\n\n  async getUnreadNotificationCount(\n    userId: string,\n    userType: string\n  ): Promise<number> {\n    const result = await db\n      .select()\n      .from(notifications)\n      .where(\n        and(\n          eq(notifications.userId, userId),\n          eq(notifications.userType, userType),\n          eq(notifications.isRead, false)\n        )\n      );\n    return result.length;\n  }\n\n  // Conversation methods\n  async getOrCreateConversation(\n    productOwnerId: string,\n    groupId: string,\n    leaderId: string\n  ): Promise<Conversation> {\n    // Check if conversation already exists\n    const [existing] = await db\n      .select()\n      .from(conversations)\n      .where(\n        and(\n          eq(conversations.productOwnerId, productOwnerId),\n          eq(conversations.groupId, groupId)\n        )\n      );\n\n    if (existing) {\n      return existing;\n    }\n\n    // Create new conversation\n    const [conversation] = await db\n      .insert(conversations)\n      .values({\n        productOwnerId,\n        groupId,\n        leaderId,\n        lastMessageAt: new Date(),\n      })\n      .returning();\n\n    return conversation;\n  }\n\n  async getConversation(\n    conversationId: string\n  ): Promise<Conversation | undefined> {\n    const [conversation] = await db\n      .select()\n      .from(conversations)\n      .where(eq(conversations.id, conversationId));\n    return conversation || undefined;\n  }\n\n  async getConversationsBetweenUsers(\n    userId1: string,\n    userId2: string,\n    userType: string\n  ): Promise<Conversation[]> {\n    if (userType === \"product_owner\") {\n      // userId1 is product owner, userId2 is leader\n      return await db\n        .select()\n        .from(conversations)\n        .where(\n          sql`${conversations.productOwnerId} = ${userId1} AND ${conversations.leaderId} = ${userId2}`\n        );\n    } else {\n      // userId1 is leader, userId2 is product owner\n      return await db\n        .select()\n        .from(conversations)\n        .where(\n          sql`${conversations.leaderId} = ${userId1} AND ${conversations.productOwnerId} = ${userId2}`\n        );\n    }\n  }\n\n  async getConversationMessages(\n    conversationId: string\n  ): Promise<ConversationMessage[]> {\n    return await db\n      .select()\n      .from(conversationMessages)\n      .where(eq(conversationMessages.conversationId, conversationId))\n      .orderBy(conversationMessages.createdAt);\n  }\n\n  async sendMessage(\n    conversationId: string,\n    senderId: string,\n    senderType: string,\n    content: string\n  ): Promise<ConversationMessage> {\n    // Insert message\n    const [message] = await db\n      .insert(conversationMessages)\n      .values({\n        conversationId,\n        senderId,\n        senderType,\n        content,\n        isRead: false,\n      })\n      .returning();\n\n    // Update conversation lastMessageAt\n    await db\n      .update(conversations)\n      .set({ lastMessageAt: new Date() })\n      .where(eq(conversations.id, conversationId));\n\n    return message;\n  }\n\n  async getProductOwnerConversations(\n    productOwnerId: string\n  ): Promise<Conversation[]> {\n    return await db\n      .select()\n      .from(conversations)\n      .where(eq(conversations.productOwnerId, productOwnerId))\n      .orderBy(desc(conversations.lastMessageAt));\n  }\n\n  async getFreelancerConversations(\n    freelancerId: string\n  ): Promise<Conversation[]> {\n    return await db\n      .select()\n      .from(conversations)\n      .where(eq(conversations.leaderId, freelancerId))\n      .orderBy(desc(conversations.lastMessageAt));\n  }\n\n  async markMessagesAsRead(\n    conversationId: string,\n    userId: string\n  ): Promise<void> {\n    await db\n      .update(conversationMessages)\n      .set({ isRead: true })\n      .where(\n        and(\n          eq(conversationMessages.conversationId, conversationId),\n          eq(conversationMessages.isRead, false)\n        )\n      );\n  }\n\n  // Direct Messages methods\n  async getDirectMessages(\n    userId: string,\n    userType: string,\n    otherUserId: string,\n    otherUserType: string\n  ): Promise<any[]> {\n    return await db\n      .select()\n      .from(directMessages)\n      .where(\n        or(\n          and(\n            eq(directMessages.senderId, userId),\n            eq(directMessages.senderType, userType),\n            eq(directMessages.receiverId, otherUserId),\n            eq(directMessages.receiverType, otherUserType)\n          ),\n          and(\n            eq(directMessages.senderId, otherUserId),\n            eq(directMessages.senderType, otherUserType),\n            eq(directMessages.receiverId, userId),\n            eq(directMessages.receiverType, userType)\n          )\n        )\n      )\n      .orderBy(asc(directMessages.createdAt));\n  }\n\n  async sendDirectMessage(\n    senderId: string,\n    senderType: string,\n    receiverId: string,\n    receiverType: string,\n    content: string\n  ): Promise<any> {\n    const [message] = await db\n      .insert(directMessages)\n      .values({\n        senderId,\n        senderType,\n        receiverId,\n        receiverType,\n        content,\n        isRead: false,\n      })\n      .returning();\n    return message;\n  }\n\n  async getDirectMessageHistory(\n    userId: string,\n    userType: string\n  ): Promise<any[]> {\n    // Get all unique conversations for this user\n    const sent = await db\n      .select({\n        otherUserId: directMessages.receiverId,\n        otherUserType: directMessages.receiverType,\n        lastMessage: directMessages.content,\n        lastMessageAt: directMessages.createdAt,\n      })\n      .from(directMessages)\n      .where(\n        and(\n          eq(directMessages.senderId, userId),\n          eq(directMessages.senderType, userType)\n        )\n      )\n      .orderBy(desc(directMessages.createdAt));\n\n    const received = await db\n      .select({\n        otherUserId: directMessages.senderId,\n        otherUserType: directMessages.senderType,\n        lastMessage: directMessages.content,\n        lastMessageAt: directMessages.createdAt,\n      })\n      .from(directMessages)\n      .where(\n        and(\n          eq(directMessages.receiverId, userId),\n          eq(directMessages.receiverType, userType)\n        )\n      )\n      .orderBy(desc(directMessages.createdAt));\n\n    // Combine and deduplicate\n    const allConversations = [...sent, ...received];\n    const uniqueMap = new Map();\n    \n    allConversations.forEach((conv) => {\n      const key = `${conv.otherUserId}-${conv.otherUserType}`;\n      if (!uniqueMap.has(key) || \n          new Date(conv.lastMessageAt) > new Date(uniqueMap.get(key).lastMessageAt)) {\n        uniqueMap.set(key, conv);\n      }\n    });\n\n    return Array.from(uniqueMap.values());\n  }\n\n  // Group Posts methods\n  async getPostsByGroup(groupId: string): Promise<GroupPost[]> {\n    return await db\n      .select()\n      .from(groupPosts)\n      .where(eq(groupPosts.groupId, groupId))\n      .orderBy(desc(groupPosts.createdAt));\n  }\n\n  async getPost(postId: string): Promise<GroupPost | undefined> {\n    const [post] = await db\n      .select()\n      .from(groupPosts)\n      .where(eq(groupPosts.id, postId));\n    return post || undefined;\n  }\n\n  async createPost(post: InsertGroupPost): Promise<GroupPost> {\n    const [newPost] = await db.insert(groupPosts).values(post).returning();\n    return newPost;\n  }\n\n  async deletePost(postId: string): Promise<void> {\n    await db.delete(groupPosts).where(eq(groupPosts.id, postId));\n  }\n\n  async updatePostCounts(\n    postId: string,\n    likesCount?: number,\n    commentsCount?: number\n  ): Promise<void> {\n    const updates: any = { updatedAt: new Date() };\n    if (likesCount !== undefined) updates.likesCount = likesCount;\n    if (commentsCount !== undefined) updates.commentsCount = commentsCount;\n\n    await db.update(groupPosts).set(updates).where(eq(groupPosts.id, postId));\n  }\n\n  // Post Comments methods\n  async getCommentsByPost(postId: string): Promise<PostComment[]> {\n    return await db\n      .select()\n      .from(postComments)\n      .where(eq(postComments.postId, postId))\n      .orderBy(postComments.createdAt);\n  }\n\n  async createComment(comment: InsertPostComment): Promise<PostComment> {\n    const [newComment] = await db\n      .insert(postComments)\n      .values(comment)\n      .returning();\n\n    // Increment comments count\n    const post = await this.getPost(comment.postId);\n    if (post) {\n      await this.updatePostCounts(\n        comment.postId,\n        undefined,\n        post.commentsCount + 1\n      );\n    }\n\n    return newComment;\n  }\n\n  async deleteComment(commentId: string): Promise<void> {\n    // Get comment first to update count\n    const [comment] = await db\n      .select()\n      .from(postComments)\n      .where(eq(postComments.id, commentId));\n\n    await db.delete(postComments).where(eq(postComments.id, commentId));\n\n    // Decrement comments count\n    if (comment) {\n      const post = await this.getPost(comment.postId);\n      if (post && post.commentsCount > 0) {\n        await this.updatePostCounts(\n          comment.postId,\n          undefined,\n          post.commentsCount - 1\n        );\n      }\n    }\n  }\n\n  // Post Reactions methods\n  async getReactionsByPost(postId: string): Promise<PostReaction[]> {\n    return await db\n      .select()\n      .from(postReactions)\n      .where(eq(postReactions.postId, postId));\n  }\n\n  async getUserReaction(\n    postId: string,\n    userId: string\n  ): Promise<PostReaction | undefined> {\n    const [reaction] = await db\n      .select()\n      .from(postReactions)\n      .where(\n        and(eq(postReactions.postId, postId), eq(postReactions.userId, userId))\n      );\n    return reaction || undefined;\n  }\n\n  async createReaction(reaction: InsertPostReaction): Promise<PostReaction> {\n    const [newReaction] = await db\n      .insert(postReactions)\n      .values(reaction)\n      .returning();\n\n    // Increment likes count\n    const post = await this.getPost(reaction.postId);\n    if (post) {\n      await this.updatePostCounts(\n        reaction.postId,\n        post.likesCount + 1,\n        undefined\n      );\n    }\n\n    return newReaction;\n  }\n\n  async deleteReaction(postId: string, userId: string): Promise<void> {\n    await db\n      .delete(postReactions)\n      .where(\n        and(eq(postReactions.postId, postId), eq(postReactions.userId, userId))\n      );\n\n    // Decrement likes count\n    const post = await this.getPost(postId);\n    if (post && post.likesCount > 0) {\n      await this.updatePostCounts(postId, post.likesCount - 1, undefined);\n    }\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":53816},"client/src/components/StepIndicator.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { Check } from \"lucide-react\";\n\ninterface Step {\n  id: number;\n  title: string;\n}\n\ninterface StepIndicatorProps {\n  steps: Step[];\n  currentStep: number;\n}\n\nexport function StepIndicator({ steps, currentStep }: StepIndicatorProps) {\n  return (\n    <div className=\"w-full py-8\" data-testid=\"step-indicator\">\n      <div className=\"flex items-center justify-between max-w-3xl mx-auto px-4\">\n        {steps.map((step, index) => (\n          <div key={step.id} className=\"flex items-center flex-1\">\n            {/* Step Circle */}\n            <div className=\"flex flex-col items-center\">\n              <div\n                className={cn(\n                  \"w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all shadow-md\",\n                  currentStep > step.id\n                    ? \"bg-primary text-primary-foreground\"\n                    : currentStep === step.id\n                    ? \"bg-primary text-primary-foreground ring-4 ring-primary/20\"\n                    : \"bg-muted text-muted-foreground\"\n                )}\n                data-testid={`step-${step.id}`}\n              >\n                {currentStep > step.id ? (\n                  <Check className=\"w-5 h-5\" />\n                ) : (\n                  <span>{step.id}</span>\n                )}\n              </div>\n              <p\n                className={cn(\n                  \"mt-2 text-xs sm:text-sm font-medium text-center whitespace-nowrap\",\n                  currentStep >= step.id ? \"text-foreground\" : \"text-muted-foreground\"\n                )}\n              >\n                {step.title}\n              </p>\n            </div>\n\n            {/* Connector Line */}\n            {index < steps.length - 1 && (\n              <div\n                className={cn(\n                  \"flex-1 h-0.5 mx-2 transition-all\",\n                  currentStep > step.id ? \"bg-primary\" : \"bg-muted\"\n                )}\n              />\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2034},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/pages/Campaigns.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Plus, Trash2, Edit, Eye, Filter } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\n\ntype Campaign = {\n  id: string;\n  owner_id: string;\n  title: string;\n  description: string | null;\n  service_type: string;\n  budget: number;\n  package_type: string;\n  target_testers: number;\n  duration_days: number | null;\n  requirements: string[] | null;\n  status: string;\n  created_at: string;\n  completed_at: string | null;\n};\n\nconst campaignFormSchema = z.object({\n  title: z.string().min(3, \"يجب أن يكون العنوان 3 أحرف على الأقل\"),\n  description: z.string().optional(),\n  service_type: z.string().min(1, \"نوع الخدمة مطلوب\"),\n  budget: z.number().min(1, \"الميزانية مطلوبة\"),\n  package_type: z.string().min(1, \"نوع الباقة مطلوب\"),\n  target_testers: z.number().min(1, \"عدد المختبرين مطلوب\"),\n  duration_days: z.number().optional(),\n  requirements: z.array(z.string()).optional(),\n});\n\ntype CampaignFormData = z.infer<typeof campaignFormSchema>;\n\nconst statusColors: Record<string, { bg: string; text: string; label: string }> = {\n  draft: { bg: \"bg-muted dark:bg-muted\", text: \"text-muted-foreground dark:text-muted-foreground\", label: \"مسودة\" },\n  active: { bg: \"bg-primary/10 dark:bg-primary/20\", text: \"text-primary dark:text-primary\", label: \"نشط\" },\n  paused: { bg: \"bg-secondary dark:bg-secondary\", text: \"text-secondary-foreground dark:text-secondary-foreground\", label: \"متوقف\" },\n  completed: { bg: \"bg-accent dark:bg-accent\", text: \"text-accent-foreground dark:text-accent-foreground\", label: \"مكتمل\" },\n  cancelled: { bg: \"bg-muted dark:bg-muted\", text: \"text-muted-foreground dark:text-muted-foreground\", label: \"ملغي\" },\n};\n\nconst packageTypes = [\n  { value: \"basic\", label: \"أساسي - 499 ر.س\", price: 499 },\n  { value: \"pro\", label: \"احترافي - 1299 ر.س\", price: 1299 },\n  { value: \"growth\", label: \"نمو - 2999 ر.س\", price: 2999 },\n];\n\nconst serviceTypes = [\n  \"اختبار تطبيقات\",\n  \"تقييم خرائط Google Maps\",\n  \"تقييم تطبيقات Android\",\n  \"تقييم تطبيقات iOS\",\n  \"تقييم مواقع إلكترونية\",\n  \"اختبار أنظمة Software\",\n  \"مراجعات تجربة المستخدم UX/UI\",\n  \"التفاعل مع منشورات السوشيال ميديا\",\n];\n\nexport default function Campaigns() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [filterStatus, setFilterStatus] = useState<string>(\"all\");\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\n\n  const form = useForm<CampaignFormData>({\n    resolver: zodResolver(campaignFormSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      service_type: \"\",\n      budget: 0,\n      package_type: \"\",\n      target_testers: 10,\n      duration_days: 7,\n      requirements: [],\n    },\n  });\n\n  const { data: campaigns = [], isLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  const createCampaignMutation = useMutation({\n    mutationFn: async (data: CampaignFormData) => {\n      const token = localStorage.getItem(\"token\");\n      const user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n      \n      const response = await fetch(\"/api/campaigns\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          ...data,\n          owner_id: user.id,\n          status: \"draft\",\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"حدث خطأ أثناء إنشاء الحملة\");\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      setIsCreateDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"تم إنشاء الحملة بنجاح\",\n        description: \"يمكنك الآن إدارة حملتك الجديدة\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الحملة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteCampaignMutation = useMutation({\n    mutationFn: async (campaignId: string) => {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch(`/api/campaigns/${campaignId}`, {\n        method: \"DELETE\",\n        headers: {\n          \"Authorization\": `Bearer ${token}`,\n        },\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"حدث خطأ أثناء حذف الحملة\");\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/campaigns\"] });\n      toast({\n        title: \"تم حذف الحملة\",\n        description: \"تم حذف الحملة بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء حذف الحملة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (data: CampaignFormData) => {\n    createCampaignMutation.mutate(data);\n  };\n\n  const handlePackageChange = (packageType: string) => {\n    const pkg = packageTypes.find(p => p.value === packageType);\n    if (pkg) {\n      form.setValue(\"budget\", pkg.price);\n      form.setValue(\"package_type\", packageType);\n    }\n  };\n\n  const filteredCampaigns = campaigns.filter(campaign => {\n    if (filterStatus === \"all\") return true;\n    return campaign.status === filterStatus;\n  });\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 container mx-auto px-4 py-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\">حملاتي</h1>\n              <p className=\"text-muted-foreground\">إدارة وإنشاء الحملات التسويقية والاختبارية</p>\n            </div>\n\n            <Dialog open={isCreateDialogOpen} onOpenChange={setIsCreateDialogOpen}>\n              <DialogTrigger asChild>\n                <Button size=\"lg\" data-testid=\"button-create-campaign\">\n                  <Plus className=\"w-5 h-5 ml-2\" />\n                  إنشاء حملة جديدة\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n                <DialogHeader>\n                  <DialogTitle>إنشاء حملة جديدة</DialogTitle>\n                  <DialogDescription>\n                    أنشئ حملة تسويقية أو اختبارية جديدة واختر الباقة المناسبة\n                  </DialogDescription>\n                </DialogHeader>\n\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"title\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>عنوان الحملة</FormLabel>\n                          <FormControl>\n                            <Input {...field} placeholder=\"مثال: اختبار تطبيق التوصيل الجديد\" data-testid=\"input-campaign-title\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"description\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>وصف الحملة (اختياري)</FormLabel>\n                          <FormControl>\n                            <Textarea {...field} placeholder=\"وصف تفصيلي للحملة والأهداف المرجوة...\" rows={3} data-testid=\"input-campaign-description\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"service_type\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>نوع الخدمة</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-service-type\">\n                                <SelectValue placeholder=\"اختر نوع الخدمة\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {serviceTypes.map((service) => (\n                                <SelectItem key={service} value={service}>\n                                  {service}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"package_type\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>الباقة</FormLabel>\n                          <Select onValueChange={(value) => {\n                            field.onChange(value);\n                            handlePackageChange(value);\n                          }} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-package-type\">\n                                <SelectValue placeholder=\"اختر الباقة المناسبة\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              {packageTypes.map((pkg) => (\n                                <SelectItem key={pkg.value} value={pkg.value}>\n                                  {pkg.label}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"target_testers\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>عدد المختبرين المطلوب</FormLabel>\n                            <FormControl>\n                              <Input\n                                type=\"number\"\n                                {...field}\n                                onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                                data-testid=\"input-target-testers\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"duration_days\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>المدة (أيام)</FormLabel>\n                            <FormControl>\n                              <Input\n                                type=\"number\"\n                                {...field}\n                                onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                                data-testid=\"input-duration-days\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <FormField\n                      control={form.control}\n                      name=\"budget\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>الميزانية (ر.س)</FormLabel>\n                          <FormControl>\n                            <Input\n                              type=\"number\"\n                              {...field}\n                              onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                              disabled\n                              data-testid=\"input-budget\"\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <DialogFooter>\n                      <Button type=\"button\" variant=\"outline\" onClick={() => setIsCreateDialogOpen(false)} data-testid=\"button-cancel\">\n                        إلغاء\n                      </Button>\n                      <Button type=\"submit\" disabled={createCampaignMutation.isPending} data-testid=\"button-submit-campaign\">\n                        {createCampaignMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء الحملة\"}\n                      </Button>\n                    </DialogFooter>\n                  </form>\n                </Form>\n              </DialogContent>\n            </Dialog>\n          </div>\n\n          <div className=\"mb-6 flex items-center gap-4\">\n            <Filter className=\"w-5 h-5 text-muted-foreground\" />\n            <Select value={filterStatus} onValueChange={setFilterStatus}>\n              <SelectTrigger className=\"w-48\" data-testid=\"select-filter-status\">\n                <SelectValue placeholder=\"تصفية حسب الحالة\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">جميع الحملات</SelectItem>\n                <SelectItem value=\"draft\">مسودات</SelectItem>\n                <SelectItem value=\"active\">نشطة</SelectItem>\n                <SelectItem value=\"paused\">متوقفة</SelectItem>\n                <SelectItem value=\"completed\">مكتملة</SelectItem>\n                <SelectItem value=\"cancelled\">ملغاة</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {[1, 2, 3].map((i) => (\n                <Card key={i} className=\"animate-pulse\">\n                  <CardHeader>\n                    <div className=\"h-6 bg-muted rounded w-3/4 mb-2\"></div>\n                    <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"h-20 bg-muted rounded\"></div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : filteredCampaigns.length === 0 ? (\n            <Card className=\"text-center py-12\">\n              <CardContent>\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"w-16 h-16 rounded-full bg-muted flex items-center justify-center\">\n                    <Plus className=\"w-8 h-8 text-muted-foreground\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-semibold mb-2\">لا توجد حملات بعد</h3>\n                    <p className=\"text-muted-foreground mb-4\">\n                      {filterStatus === \"all\" ? \"ابدأ بإنشاء حملتك الأولى\" : \"لا توجد حملات بهذه الحالة\"}\n                    </p>\n                    {filterStatus === \"all\" && (\n                      <Button onClick={() => setIsCreateDialogOpen(true)} data-testid=\"button-create-first-campaign\">\n                        <Plus className=\"w-5 h-5 ml-2\" />\n                        إنشاء حملة جديدة\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {filteredCampaigns.map((campaign) => (\n                <Card key={campaign.id} className=\"hover-elevate transition-all\" data-testid={`card-campaign-${campaign.id}`}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-start gap-2\">\n                      <div className=\"flex-1\">\n                        <CardTitle className=\"text-lg mb-2\">{campaign.title}</CardTitle>\n                        <CardDescription className=\"line-clamp-2\">\n                          {campaign.description || \"لا يوجد وصف\"}\n                        </CardDescription>\n                      </div>\n                      <Badge \n                        className={`${statusColors[campaign.status]?.bg} ${statusColors[campaign.status]?.text}`}\n                        data-testid={`badge-status-${campaign.id}`}\n                      >\n                        {statusColors[campaign.status]?.label || campaign.status}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">نوع الخدمة</p>\n                        <p className=\"font-medium\">{campaign.service_type}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">الميزانية</p>\n                        <p className=\"font-medium\">{campaign.budget} ر.س</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">المختبرين</p>\n                        <p className=\"font-medium\">{campaign.target_testers}</p>\n                      </div>\n                      <div>\n                        <p className=\"text-muted-foreground mb-1\">المدة</p>\n                        <p className=\"font-medium\">{campaign.duration_days || \"غير محدد\"} يوم</p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex gap-2 pt-4 border-t\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"flex-1\"\n                        onClick={() => navigate(`/campaigns/${campaign.id}`)}\n                        data-testid={`button-view-${campaign.id}`}\n                      >\n                        <Eye className=\"w-4 h-4 ml-2\" />\n                        عرض\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"flex-1\"\n                        onClick={() => navigate(`/campaigns/${campaign.id}/edit`)}\n                        data-testid={`button-edit-${campaign.id}`}\n                      >\n                        <Edit className=\"w-4 h-4 ml-2\" />\n                        تعديل\n                      </Button>\n                      <Button\n                        variant=\"destructive\"\n                        size=\"sm\"\n                        onClick={() => {\n                          if (confirm(\"هل أنت متأكد من حذف هذه الحملة؟\")) {\n                            deleteCampaignMutation.mutate(campaign.id);\n                          }\n                        }}\n                        data-testid={`button-delete-${campaign.id}`}\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":22062},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Tajawal Font as Primary */\n* {\n  font-family: 'Tajawal', 'Inter', system-ui, -apple-system, sans-serif;\n}\n\n/* Bold for headings */\nh1, h2, h3, h4, h5, h6, .font-bold {\n  font-weight: 800; /* Extra Bold (Thick) */\n}\n\n/* Medium for buttons and important text */\nbutton, .font-medium {\n  font-weight: 700; /* Bold */\n}\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 98%;\n\n  --foreground: 0 0% 13%;\n\n  --border: 0deg 53.85% 97.45%;\n\n  --card: 0 0% 96%;\n\n  --card-foreground: 0 0% 13%;\n\n  --card-border: 0 0% 88%;\n\n  --sidebar: 0 0% 94%;\n\n  --sidebar-foreground: 0 0% 13%;\n\n  --sidebar-border: 0 0% 86%;\n\n  --sidebar-primary: 212 100% 31%;\n\n  --sidebar-primary-foreground: 0 0% 100%;\n\n  --sidebar-accent: 212 15% 85%;\n\n  --sidebar-accent-foreground: 212 30% 25%;\n\n  --sidebar-ring: 212 100% 31%;\n\n  --popover: 0 0% 92%;\n\n  --popover-foreground: 0 0% 13%;\n\n  --popover-border: 0 0% 84%;\n\n  --primary: 212 100% 31%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 212 8% 88%;\n\n  --secondary-foreground: 212 15% 20%;\n\n  --muted: 212 20% 85%;\n\n  --muted-foreground: 212 12% 35%;\n\n  --accent: 212 12% 87%;\n\n  --accent-foreground: 212 20% 25%;\n\n  --destructive: 0 84% 42%;\n\n  --destructive-foreground: 0 0% 100%;\n\n  --input: 0deg 100% 97.45%;\n  --ring: 212 100% 31%;\n  --chart-1: 212 100% 31%;\n  --chart-2: 212 80% 40%;\n  --chart-3: 212 60% 50%;\n  --chart-4: 0 0% 40%;\n  --chart-5: 0 0% 60%;\n\n  --font-sans: Cairo, Inter, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 0 0% 8%;\n\n  --foreground: 0 0% 95%;\n\n  --border: 0 0% 18%;\n\n  --card: 0 0% 11%;\n\n  --card-foreground: 0 0% 95%;\n\n  --card-border: 0 0% 20%;\n\n  --sidebar: 0 0% 13%;\n\n  --sidebar-foreground: 0 0% 95%;\n\n  --sidebar-border: 0 0% 22%;\n\n  --sidebar-primary: 212 80% 45%;\n\n  --sidebar-primary-foreground: 0 0% 100%;\n\n  --sidebar-accent: 212 12% 18%;\n\n  --sidebar-accent-foreground: 212 30% 85%;\n\n  --sidebar-ring: 212 80% 45%;\n\n  --popover: 0 0% 15%;\n\n  --popover-foreground: 0 0% 95%;\n\n  --popover-border: 0 0% 24%;\n\n  --primary: 212 80% 45%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 212 8% 20%;\n\n  --secondary-foreground: 212 15% 90%;\n\n  --muted: 212 10% 17%;\n\n  --muted-foreground: 212 12% 75%;\n\n  --accent: 212 12% 19%;\n\n  --accent-foreground: 212 20% 85%;\n\n  --destructive: 0 84% 32%;\n\n  --destructive-foreground: 0 0% 100%;\n\n  --input: 0 0% 35%;\n  --ring: 212 80% 45%;\n  --chart-1: 212 80% 60%;\n  --chart-2: 212 60% 50%;\n  --chart-3: 212 40% 40%;\n  --chart-4: 0 0% 65%;\n  --chart-5: 0 0% 50%;\n\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* Marquee animation for scrolling logos */\n  @keyframes marquee {\n    0% {\n      transform: translateX(0);\n    }\n    100% {\n      transform: translateX(-50%);\n    }\n  }\n\n  .animate-marquee {\n    animation: marquee 25s linear infinite;\n  }\n}","size_bytes":12633},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"server/db.ts":{"content":"import pkg from 'pg';\nconst { Pool } = pkg;\n\n// Fix: Use named import for drizzle\nimport { drizzle } from 'drizzle-orm/node-postgres';\n\nimport * as schema from \"@shared/schema\";\n\nconst DATABASE_URL = process.env.DATABASE_URL || \"postgresql://neondb_owner:npg_P90xwNCOUqBA@ep-nameless-pond-ahtlko8p.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require\";\n\nif (!DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is not set\");\n}\n\n// Create a Postgres pool\nexport const pool = new Pool({\n  connectionString: DATABASE_URL,\n});\n\n// Initialize Drizzle ORM with the pool\nexport const db = drizzle(pool, {\n  schema,\n  logger: true, // simplified logger\n});\n","size_bytes":664},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/pages/Dashboard.tsx":{"content":"import { useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\n\nexport default function Dashboard() {\n  const [, navigate] = useLocation();\n\n  useEffect(() => {\n    const userType = localStorage.getItem(\"userType\");\n    const token = localStorage.getItem(\"token\");\n    \n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n\n    if (userType === \"freelancer\") {\n      navigate(\"/freelancer-dashboard\");\n    } else if (userType === \"product_owner\") {\n      navigate(\"/product-owner-dashboard\");\n    } else {\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-muted/20\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n        <p className=\"mt-4 text-muted-foreground\">جاري التحميل...</p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":919},"client/src/components/FileUpload.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Upload, X, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface FileUploadProps {\n  type: \"profile\" | \"verification\";\n  currentFile?: string;\n  onFileUploaded: (url: string) => void;\n  accept?: string;\n}\n\nexport function FileUpload({ type, currentFile, onFileUploaded, accept = \"image/*\" }: FileUploadProps) {\n  const [uploading, setUploading] = useState(false);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(currentFile || null);\n  const { toast } = useToast();\n\n  const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Create preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreviewUrl(reader.result as string);\n    };\n    reader.readAsDataURL(file);\n\n    // Upload file\n    setUploading(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      formData.append(\"type\", type);\n\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        throw new Error(\"فشل رفع الملف\");\n      }\n\n      const data = await response.json();\n      onFileUploaded(data.url);\n      \n      toast({\n        title: \"تم رفع الملف بنجاح\",\n        description: \"تم حفظ الملف على الخادم\",\n      });\n    } catch (error) {\n      toast({\n        title: \"خطأ في رفع الملف\",\n        description: \"حاول مرة أخرى\",\n        variant: \"destructive\",\n      });\n      setPreviewUrl(null);\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleRemove = () => {\n    setPreviewUrl(null);\n    onFileUploaded(\"\");\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      {previewUrl ? (\n        <div className=\"relative\">\n          {type === \"profile\" ? (\n            <div className=\"w-24 h-24 rounded-2xl overflow-hidden border-2\">\n              <img src={previewUrl} alt=\"Preview\" className=\"w-full h-full object-cover\" />\n            </div>\n          ) : (\n            <div className=\"p-4 rounded-xl border bg-muted/30\">\n              <p className=\"text-sm\">✓ تم رفع الملف</p>\n            </div>\n          )}\n          <Button\n            type=\"button\"\n            size=\"icon\"\n            variant=\"destructive\"\n            className=\"absolute -top-2 -right-2 h-6 w-6 rounded-full\"\n            onClick={handleRemove}\n            data-testid=\"button-remove-file\"\n          >\n            <X className=\"h-3 w-3\" />\n          </Button>\n        </div>\n      ) : (\n        <label className=\"block\">\n          <input\n            type=\"file\"\n            accept={accept}\n            onChange={handleFileChange}\n            className=\"hidden\"\n            disabled={uploading}\n            data-testid={`input-file-${type}`}\n          />\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            className=\"rounded-xl\"\n            disabled={uploading}\n            onClick={(e) => {\n              e.preventDefault();\n              e.currentTarget.previousElementSibling?.dispatchEvent(new MouseEvent('click'));\n            }}\n            data-testid={`button-upload-${type}`}\n          >\n            {uploading ? (\n              <>\n                <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />\n                جاري الرفع...\n              </>\n            ) : (\n              <>\n                <Upload className=\"ml-2 h-4 w-4\" />\n                {type === \"profile\" ? \"اختر صورة\" : \"رفع الملف\"}\n              </>\n            )}\n          </Button>\n        </label>\n      )}\n    </div>\n  );\n}\n","size_bytes":3784},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n   url: string,\n  method: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const token = localStorage.getItem(\"token\");\n  const headers: Record<string, string> = {};\n  \n  if (data) {\n    headers[\"Content-Type\"] = \"application/json\";\n  }\n  \n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n  \n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1572},"client/src/pages/ProductOwnerSignup.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { StepIndicator } from \"@/components/StepIndicator\";\nimport { PasswordStrength } from \"@/components/PasswordStrength\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { ArrowRight, ArrowLeft, DollarSign, Star } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst steps = [\n  { id: 1, title: \"المعلومات الأساسية\" },\n  { id: 2, title: \"اختيار الخدمة\" },\n  { id: 3, title: \"التأكيد\" },\n];\n\n// قائمة الخدمات المتاحة\nconst servicesList = [\n  { id: \"google_play_review\", name: \"تقييم تطبيقك على Google Play\", pricePerReview: 1 },\n  { id: \"ios_review\", name: \"تقييم تطبيقك على iOS\", pricePerReview: 1 },\n  { id: \"website_review\", name: \"تقييم موقعك الإلكتروني\", pricePerReview: 1 },\n  { id: \"ux_testing\", name: \"اختبار تجربة المستخدم لتطبيقك أو موقعك\", pricePerReview: 1 },\n  { id: \"software_testing\", name: \"اختبار أنظمة السوفت وير\", pricePerReview: 1 },\n  { id: \"social_media_engagement\", name: \"التفاعل مع منشورات السوشيال ميديا\", pricePerReview: 1 },\n  { id: \"google_maps_review\", name: \"تقييمات خرائط جوجل ماب (Google Maps Reviews)\", pricePerReview: 2 },\n];\n\nconst step1Schema = z.object({\n  fullName: z.string().min(3, \"الاسم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  password: z.string().min(8, \"كلمة المرور يجب أن تحتوي على 8 أحرف على الأقل\"),\n});\n\nconst step2Schema = z.object({\n  serviceType: z.string().min(1, \"اختر نوع الخدمة\"),\n  reviewsCount: z.number().min(1, \"عدد التقييمات يجب أن يكون 1 على الأقل\").max(1000, \"الحد الأقصى 1000 تقييم\"),\n});\n\nconst step3Schema = z.object({\n  acceptTerms: z.boolean().refine((val) => val === true, \"يجب الموافقة على الشروط والأحكام\"),\n});\n\ntype FormData = z.infer<typeof step1Schema> & \n  z.infer<typeof step2Schema> & \n  z.infer<typeof step3Schema>;\n\nexport default function ProductOwnerSignup() {\n  const [currentStep, setCurrentStep] = useState(1);\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<Partial<FormData>>({\n    reviewsCount: 50,\n  });\n\n  const createOwnerMutation = useMutation({\n    mutationFn: async (data: Partial<FormData>) => {\n      const response = await fetch(\"/api/product-owners\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          fullName: data.fullName,\n          email: data.email,\n          password: data.password,\n          services: [data.serviceType],\n        }),\n      });\n      \n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = \"فشل إنشاء الحساب\";\n        \n        if (typeof errorData.error === 'string') {\n          errorMessage = errorData.error;\n        } else if (Array.isArray(errorData.error)) {\n          errorMessage = errorData.error.map((e: any) => e.message || e.code).join(', ');\n        }\n        \n        throw new Error(errorMessage);\n      }\n      \n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", \"product_owner\");\n      \n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم إنشاء الحساب بنجاح!\",\n        description: \"يرجى قراءة الشروط والأحكام الهامة قبل البدء\",\n      });\n      // Redirect to instructions page first\n      navigate(\"/product-owner-instructions\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"حدث خطأ\",\n        description: error.message || \"فشل في إنشاء الحساب. حاول مرة أخرى.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getSchemaForStep = (step: number) => {\n    switch (step) {\n      case 1: return step1Schema;\n      case 2: return step2Schema;\n      case 3: return step3Schema;\n      default: return step1Schema;\n    }\n  };\n\n  const defaultFormValues = useMemo(() => ({\n    ...formData,\n  }), [currentStep]);\n\n  const form = useForm<FormData>({\n    resolver: zodResolver(getSchemaForStep(currentStep)),\n    values: defaultFormValues as any,\n    mode: \"onChange\",\n  });\n\n  // حساب التكلفة\n  const selectedService = servicesList.find(s => s.id === formData.serviceType);\n  const reviewsCount = formData.reviewsCount || 0;\n  const pricePerReview = selectedService?.pricePerReview || 0;\n  const totalCost = reviewsCount * pricePerReview;\n\n  const handleNext = async () => {\n    const isValid = await form.trigger();\n    if (isValid) {\n      const currentValues = form.getValues();\n      const updatedFormData = { ...formData, ...currentValues };\n      setFormData(updatedFormData);\n      \n      if (currentStep < 3) {\n        setCurrentStep(currentStep + 1);\n        form.clearErrors();\n      } else {\n        createOwnerMutation.mutate(updatedFormData);\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      const currentValues = form.getValues();\n      setFormData({ ...formData, ...currentValues });\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 py-8 px-4\">\n        <div className=\"max-w-3xl mx-auto\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold mb-2\">إنشاء حساب صاحب منتج</h1>\n            <p className=\"text-muted-foreground\">احصل على تقييمات واختبارات حقيقية لمنتجك</p>\n          </div>\n\n          <StepIndicator steps={steps} currentStep={currentStep} />\n\n          <Card className=\"rounded-2xl shadow-lg\">\n            <CardHeader className=\"border-b\">\n              <CardTitle className=\"text-2xl text-center\">\n                {steps[currentStep - 1].title}\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\"p-6 md:p-8\">\n              <Form {...form}>\n                <form className=\"space-y-6\">\n                  {/* Step 1: Basic Information */}\n                  {currentStep === 1 && (\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"fullName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>الاسم الكامل / اسم الشركة *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"أحمد محمد\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-fullname\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>البريد الإلكتروني *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"email\" \n                                placeholder=\"info@company.com\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-email\"\n                                autoComplete=\"email\"\n                                name=\"email\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>كلمة المرور *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"password\" \n                                placeholder=\"••••••••\" \n                                className=\"rounded-xl\" \n                                data-testid=\"input-password\"\n                                autoComplete=\"new-password\"\n                                name=\"password\"\n                              />\n                            </FormControl>\n                            <PasswordStrength password={field.value || \"\"} />\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Step 2: Service Selection */}\n                  {currentStep === 2 && (\n                    <div className=\"space-y-6\">\n                      <FormField\n                        control={form.control}\n                        name=\"serviceType\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>اختر نوع الخدمة *</FormLabel>\n                            <Select \n                              onValueChange={(value) => {\n                                field.onChange(value);\n                                setFormData({ ...formData, serviceType: value });\n                              }} \n                              defaultValue={field.value}\n                            >\n                              <FormControl>\n                                <SelectTrigger className=\"rounded-xl\" data-testid=\"select-service-type\">\n                                  <SelectValue placeholder=\"اختر الخدمة المطلوبة\" />\n                                </SelectTrigger>\n                              </FormControl>\n                              <SelectContent>\n                                {servicesList.map((service) => (\n                                  <SelectItem key={service.id} value={service.id}>\n                                    {service.name}\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      {formData.serviceType && (\n                        <>\n                          <FormField\n                            control={form.control}\n                            name=\"reviewsCount\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>أدخل عدد التقييمات المطلوبة *</FormLabel>\n                                <FormControl>\n                                  <Input \n                                    {...field} \n                                    type=\"number\"\n                                    min=\"1\"\n                                    max=\"1000\"\n                                    placeholder=\"50\" \n                                    className=\"rounded-xl\" \n                                    data-testid=\"input-reviews-count\"\n                                    onChange={(e) => {\n                                      const value = parseInt(e.target.value) || 0;\n                                      field.onChange(value);\n                                      setFormData({ ...formData, reviewsCount: value });\n                                    }}\n                                  />\n                                </FormControl>\n                                <FormDescription>\n                                  أدخل عدد التقييمات التي تحتاجها (من 1 إلى 1000)\n                                </FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          {/* عرض ملخص التكلفة */}\n                          <div className=\"bg-primary/5 border border-primary/20 p-6 rounded-2xl space-y-4\">\n                            <div className=\"flex items-center gap-2 mb-4\">\n                              <DollarSign className=\"h-5 w-5 text-primary\" />\n                              <h3 className=\"font-bold text-lg\">ملخص التكلفة</h3>\n                            </div>\n                            \n                            <div className=\"space-y-3\">\n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">نوع الخدمة:</span>\n                                <span className=\"font-medium\">{selectedService?.name}</span>\n                              </div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">عدد التقييمات:</span>\n                                <span className=\"font-medium flex items-center gap-1\">\n                                  <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n                                  {reviewsCount} تقييم\n                                </span>\n                              </div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-muted-foreground\">سعر التقييم الواحد:</span>\n                                <span className=\"font-medium\">{pricePerReview} دولار</span>\n                              </div>\n                              \n                              <div className=\"h-px bg-border my-3\"></div>\n                              \n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"font-bold text-lg\">التكلفة الإجمالية:</span>\n                                <span className=\"font-bold text-2xl text-primary\">\n                                  ${totalCost}\n                                </span>\n                              </div>\n                            </div>\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  )}\n\n                  {/* Step 3: Confirmation */}\n                  {currentStep === 3 && (\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-accent/10 p-6 rounded-2xl space-y-4\">\n                        <h3 className=\"font-semibold text-lg\">ملخص الطلب</h3>\n                        <div className=\"space-y-3 text-sm\">\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">الاسم:</span>\n                            <span className=\"font-medium\">{formData.fullName}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">البريد الإلكتروني:</span>\n                            <span className=\"font-medium\">{formData.email}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">الخدمة:</span>\n                            <span className=\"font-medium\">{selectedService?.name}</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-muted-foreground\">عدد التقييمات:</span>\n                            <span className=\"font-medium\">{reviewsCount} تقييم</span>\n                          </div>\n                          <div className=\"h-px bg-border my-2\"></div>\n                          <div className=\"flex justify-between\">\n                            <span className=\"font-bold\">التكلفة الإجمالية:</span>\n                            <span className=\"font-bold text-primary text-lg\">${totalCost}</span>\n                          </div>\n                        </div>\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"acceptTerms\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex items-start gap-2 space-y-0 p-4 bg-muted/30 rounded-xl\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-terms\"\n                              />\n                            </FormControl>\n                            <div className=\"flex-1\">\n                              <FormLabel className=\"text-sm leading-relaxed cursor-pointer\">\n                                أتعهد بعدم طلب تقييمات غير حقيقية، وجميع التجارب ستكون فعلية داخل المنصة. أوافق على{\" \"}\n                                <a href=\"#terms\" className=\"text-primary hover:underline\">الشروط والأحكام</a>\n                              </FormLabel>\n                              <FormMessage />\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Navigation Buttons */}\n                  <div className=\"flex gap-3 pt-4\">\n                    {currentStep > 1 && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={handleBack}\n                        className=\"flex-1 rounded-2xl\"\n                        data-testid=\"button-back\"\n                      >\n                        <ArrowLeft className=\"ml-2 h-4 w-4\" />\n                        رجوع\n                      </Button>\n                    )}\n                    \n                    <Button \n                      type=\"button\"\n                      onClick={handleNext}\n                      disabled={createOwnerMutation.isPending}\n                      className=\"flex-1 rounded-2xl\"\n                      data-testid=\"button-next\"\n                    >\n                      {currentStep === 3 ? (\n                        createOwnerMutation.isPending ? \"جارٍ إنشاء الحساب...\" : \"إنشاء الحساب\"\n                      ) : (\n                        <>\n                          التالي\n                          <ArrowRight className=\"mr-2 h-4 w-4\" />\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n\n          {/* Sign in link */}\n          <div className=\"text-center mt-6\">\n            <p className=\"text-sm text-muted-foreground\">\n              هل لديك حساب بالفعل؟{\" \"}\n              <a href=\"/login\" className=\"text-primary hover:underline font-medium\">\n                تسجيل الدخول\n              </a>\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":21096},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/PasswordStrength.tsx":{"content":"import { useMemo } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface PasswordStrengthProps {\n  password: string;\n}\n\nexport function PasswordStrength({ password }: PasswordStrengthProps) {\n  const strength = useMemo(() => {\n    if (!password) return { level: 0, text: \"\", color: \"\" };\n\n    let score = 0;\n    \n    // Length check\n    if (password.length >= 8) score += 1;\n    if (password.length >= 12) score += 1;\n    \n    // Character variety checks\n    if (/[a-z]/.test(password)) score += 1;\n    if (/[A-Z]/.test(password)) score += 1;\n    if (/[0-9]/.test(password)) score += 1;\n    if (/[^a-zA-Z0-9]/.test(password)) score += 1;\n\n    if (score <= 2) return { level: 1, text: \"ضعيفة\", color: \"bg-destructive\" };\n    if (score <= 4) return { level: 2, text: \"متوسطة\", color: \"bg-yellow-500\" };\n    return { level: 3, text: \"قوية\", color: \"bg-primary\" };\n  }, [password]);\n\n  if (!password) return null;\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"password-strength\">\n      <div className=\"flex gap-1\">\n        {[1, 2, 3].map((level) => (\n          <div\n            key={level}\n            className={cn(\n              \"h-1.5 flex-1 rounded-full transition-all\",\n              level <= strength.level ? strength.color : \"bg-muted\"\n            )}\n          />\n        ))}\n      </div>\n      <p className=\"text-xs text-muted-foreground\">\n        قوة كلمة المرور: <span className=\"font-medium\">{strength.text}</span>\n      </p>\n    </div>\n  );\n}\n","size_bytes":1494},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport jwt from \"jsonwebtoken\";\n\n// JWT secret from environment - REQUIRED for production\n// if (!process.env.JWT_SECRET && process.env.NODE_ENV === \"production\") {\n//   throw new Error(\"JWT_SECRET environment variable must be set in production\");\n// }\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"development-secret-key-DO-NOT-USE-IN-PRODUCTION\";\nconst JWT_EXPIRES_IN = \"7d\"; // Token expires in 7 days\n\nexport interface AuthPayload {\n  userId: string;\n  userType: \"freelancer\" | \"product_owner\" | \"admin\";\n  email: string;\n  roleId?: string; // For admin users\n}\n\nexport interface AuthRequest extends Request {\n  user?: AuthPayload;\n}\n\n// Generate JWT token\nexport function generateToken(payload: AuthPayload): string {\n  return jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n}\n\n// Verify JWT token\nexport function verifyToken(token: string): AuthPayload | null {\n  try {\n    return jwt.verify(token, JWT_SECRET) as AuthPayload;\n  } catch (error) {\n    return null;\n  }\n}\n\n// Authentication middleware\nexport function authMiddleware(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    // Check for token in Authorization header or cookie\n    const authHeader = req.headers.authorization;\n    const token = authHeader?.startsWith(\"Bearer \") \n      ? authHeader.substring(7) \n      : req.cookies?.token;\n\n    if (!token) {\n      return res.status(401).json({ error: \"غير مصرح - يرجى تسجيل الدخول\" });\n    }\n\n    const payload = verifyToken(token);\n    if (!payload) {\n      return res.status(401).json({ error: \"رمز غير صالح - يرجى تسجيل الدخول مرة أخرى\" });\n    }\n\n    req.user = payload;\n    next();\n  } catch (error) {\n    return res.status(401).json({ error: \"خطأ في المصادقة\" });\n  }\n}\n\n// Optional auth middleware (doesn't fail if no token)\nexport function optionalAuthMiddleware(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    const authHeader = req.headers.authorization;\n    const token = authHeader?.startsWith(\"Bearer \")\n      ? authHeader.substring(7)\n      : req.cookies?.token;\n\n    if (token) {\n      const payload = verifyToken(token);\n      if (payload) {\n        req.user = payload;\n      }\n    }\n    next();\n  } catch (error) {\n    next();\n  }\n}\n\n// Role-based authorization middleware\nexport function requireRole(allowedRoles: (\"freelancer\" | \"product_owner\" | \"admin\")[]) {\n  return (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user) {\n      return res.status(401).json({ error: \"غير مصرح - يرجى تسجيل الدخول\" });\n    }\n\n    if (!allowedRoles.includes(req.user.userType)) {\n      return res.status(403).json({ error: \"ممنوع - ليس لديك صلاحية للوصول\" });\n    }\n\n    next();\n  };\n}\n\n// Admin authentication middleware\nexport function adminAuthMiddleware(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    // Check for admin token in cookie first, then fallback to Authorization header\n    const token = req.cookies?.adminToken \n      || (req.headers.authorization?.startsWith(\"Bearer \") \n          ? req.headers.authorization.substring(7) \n          : null);\n\n    if (!token) {\n      return res.status(401).json({ error: \"غير مصرح - يرجى تسجيل الدخول\" });\n    }\n\n    const payload = verifyToken(token);\n    if (!payload || payload.userType !== \"admin\") {\n      return res.status(403).json({ error: \"ممنوع - هذه الصفحة للمسؤولين فقط\" });\n    }\n\n    req.user = payload;\n    next();\n  } catch (error) {\n    return res.status(401).json({ error: \"خطأ في المصادقة\" });\n  }\n}\n\n// Permission-based authorization middleware for admin users\nexport function requirePermission(permission: string) {\n  return async (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user || req.user.userType !== \"admin\") {\n      return res.status(403).json({ error: \"ممنوع - ليس لديك صلاحية للوصول\" });\n    }\n\n    try {\n      // Import here to avoid circular dependencies\n      const { db } = await import(\"../db\");\n      const { adminUsers, roles, permissions, rolePermissions } = await import(\"@shared/schema\");\n      const { eq } = await import(\"drizzle-orm\");\n\n      // Get admin user with role\n      const [admin] = await db.select().from(adminUsers).where(eq(adminUsers.id, req.user.userId));\n      if (!admin || !admin.isActive) {\n        return res.status(403).json({ error: \"حساب غير نشط\" });\n      }\n\n      // Get role\n      const [role] = await db.select().from(roles).where(eq(roles.id, admin.roleId));\n      if (!role) {\n        return res.status(403).json({ error: \"دور غير موجود\" });\n      }\n\n      // Get role permissions\n      const userPermissions = await db\n        .select({\n          name: permissions.name,\n        })\n        .from(rolePermissions)\n        .innerJoin(permissions, eq(rolePermissions.permissionId, permissions.id))\n        .where(eq(rolePermissions.roleId, role.id));\n\n      const permissionNames = userPermissions.map(p => p.name);\n\n      // Check if user has the required permission\n      if (!permissionNames.includes(permission)) {\n        return res.status(403).json({ error: `ليس لديك صلاحية: ${permission}` });\n      }\n\n      next();\n    } catch (error) {\n      console.error(\"Error checking permission:\", error);\n      return res.status(500).json({ error: \"خطأ في التحقق من الصلاحيات\" });\n    }\n  };\n}\n","size_bytes":5566},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"design_guidelines.md":{"content":"# Sumou Platform Design Guidelines (سُمُوّ)\n\n## Design Philosophy\n\n**Reference-Based Approach**: Modern SaaS aesthetic inspired by Figma/Notion—clean interfaces, clear hierarchy, professional presentation, RTL-first with seamless LTR adaptation.\n\n**Core Principles**: Spacious layouts, professional yet approachable, clear visual hierarchy, breathing room between elements.\n\n## Brand Identity\n\n**Primary Color**: Deep Blue (#002e62 - HSL: 212, 100%, 31%) - A professional, trustworthy deep blue that conveys stability, professionalism, and reliability.\n\n**Color Psychology**: The deep blue color represents trust, stability, and professionalism, perfectly suited for a platform connecting professionals and digital product owners.\n\n## Typography\n\n**Fonts**: Cairo (Arabic primary, RTL-optimized) + Inter (Latin fallback) via Google Fonts CDN\n\n**Scale**:\n- Hero: 3.5-4.5rem, weight 700-800\n- Page Titles: 2.5-3rem, weight 700\n- Section Headers: 1.875-2.25rem, weight 600\n- Card Titles: 1.25-1.5rem, weight 600\n- Body: 1rem, weight 400\n- Small/Captions: 0.875rem, weight 400-500\n\n**RTL/LTR**: Use `dir=\"rtl\"` for Arabic, mirror spacing/padding/margins, flip directional icons, right-align RTL text.\n\n## Layout & Spacing\n\n**Spacing Units**: 2, 4, 6, 8, 12, 16, 20, 24, 32 (Tailwind)\n\n**Common Patterns**:\n- Component padding: p-6/p-8\n- Section spacing: py-16 to py-24 (desktop), py-12 (mobile)\n- Card gaps: gap-6/gap-8\n- Form fields: space-y-6\n- Buttons: px-8 py-3 (large), px-6 py-2.5 (medium)\n\n**Grids**:\n- Features: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Dashboard: grid-cols-1 md:grid-cols-2 xl:grid-cols-3\n- Pricing: grid-cols-1 lg:grid-cols-3\n\n**Containers**: Full-width with max-w-7xl mx-auto px-6 | Forms: max-w-2xl mx-auto | Modals: max-w-lg to max-w-3xl\n\n**Breakpoints**: Mobile <768px | Tablet 768-1024px | Desktop >1024px | Wide >1440px\n\n## Components\n\n### Navigation\n\n**Landing Header**: Fixed/sticky, backdrop-blur, logo right (RTL)/left (LTR), nav links gap-8 weight-500, CTA rounded-2xl shadow-sm\n\n**Dashboard Sidebar**: 280px fixed, icons from Heroicons, active state with deep blue accent strip, collapsible mobile overlay\n\n### Forms & Inputs\n\n**Text Inputs**: 1px border, rounded-xl, px-4 py-3, deep blue ring on focus, red border for errors, icons right (RTL) with mr-3\n\n**Multi-Step Forms**: Progress indicator with step numbers/connecting lines, current step deep blue, completed with checkmarks, max-w-2xl centered, prev/next buttons at bottom\n\n**File Upload**: Dashed border rounded-xl, drag-drop zone, uploaded files list with remove button, circular preview (profile), rectangular (docs)\n\n**Select/Multi-Select**: Custom styled matching inputs, multi-select with checkboxes, selected tags as rounded-full chips with close icon, gap-2 wrapping\n\n**Password**: Toggle icon right (RTL), strength bar below (weak/medium/strong), requirements checklist on focus\n\n**OTP**: 6 squared boxes rounded corners, auto-focus next, centered modal with backdrop-blur, resend timer\n\n### Cards\n\n**Primary Card**: White bg, rounded-2xl, shadow-md, p-6/p-8, hover: shadow-lg + scale-105\n\n**Feature Cards**: Large circular icon (light blue bg), title weight-600 text-lg, 2-3 line description, optional \"Learn more\" link\n\n**Pricing Cards**: Vertical layout, badge for \"Popular\", bold package name, large price, checkmark feature list, full-width CTA at bottom\n\n**Dashboard Stats**: Large number (2.5rem, weight 700), label below, circular icon corner, trend arrow with %\n\n### Buttons\n\n**Primary**: Deep Blue (#002e62) bg, white text weight-600, rounded-2xl, px-8 py-3/px-6 py-2.5, shadow-md, hover: scale-105 transition-all 200ms\n\n**On Hero Images**: backdrop-blur-md, semi-transparent bg, rounded-2xl, shadow\n\n**Secondary**: 2px deep blue border, transparent/white bg, deep blue text, same sizing\n\n**Icon**: p-2/p-3, rounded-xl, hover bg treatment\n\n### Dashboard Elements\n\n**Sidebar Items**: Icon + label gap-3, px-4 py-3, rounded-xl, active: deep blue tint bg + deep blue text, hover: light bg\n\n**Data Tables**: Header row bg tint weight-600, subtle row dividers, row hover light bg, icon buttons for actions, centered pagination\n\n**Empty States**: Centered icon/illustration, \"No [items] yet\" headline, descriptive text, primary CTA\n\n### AI Suggestions\n\n**Card Style**: Light blue tint bg, lightbulb/sparkle icon, medium weight text, \"Apply\"/\"Dismiss\" buttons, close icon, positioned contextually\n\n### Modals\n\n**Structure**: Semi-transparent dark backdrop, centered rounded-2xl container, close button top-right (RTL: top-left), bold title, comfortable padding, action buttons aligned right (RTL: left)\n\n**Confirmations**: Circular deep blue checkmark icon, centered message, single primary button\n\n## Landing Page Sections\n\n**Hero**: Full-width min-h-85vh, large bg image (diverse users/digital marketplace), centered content with z-index, extra-large 2-line headline, max-w-2xl subheadline, dual CTAs (side-by-side desktop/stacked mobile) with backdrop-blur-md semi-transparent bg\n\n**How It Works**: Centered title/subtitle, 3-col grid (desktop)/single (mobile), numbered icons with titles/descriptions, connecting lines optional\n\n**Features**: 6 cards in 2x3 grid (desktop), equal height flex layout\n\n**Freelancer/Product Owner**: Alternating left-right image-text, headline + bullets + CTA, background alternates white/subtle tint\n\n**Pricing**: Centered header, 3 cards side-by-side (desktop), center card elevated as \"Popular\"\n\n**Social Proof**: Testimonial cards with photo/quote/name/role, 2-col grid or carousel, star ratings\n\n**Footer**: 4-col (desktop)/stacked (mobile): About, Services, Support, Legal + logo/tagline right (RTL), social icons, language switcher, copyright\n\n## Registration Flows\n\n**Account Selection**: Minimal centered layout, 2 large cards side-by-side (desktop), icon + role + 3-4 bullets + button, equal weight\n\n**Freelancer Steps**:\n1. Name, email, password (strength indicator), phone (country code), terms checkbox\n2. Job title (icon), bio textarea (4-5 rows), team size, services multi-select\n3. Profile pic (circular preview), ID upload (rectangular), verification badges\n4. Payment method dropdown, account details, info card\n\n**Product Owner Steps**:\n1. Company name, website, product type, category\n2. Product URL (live) or file upload (unreleased APK/TestFlight), target audience\n3. Service checkbox grid, package cards (Basic/Pro/Growth) with comparison\n4. Budget input/package selection, timeline, campaign objectives textarea\n\n## Dashboard Layouts\n\n**Freelancer**: 280px sidebar, full-width main content, top bar (welcome + notifications + profile), 4 metric cards, filterable tasks list/grid, activity feed\n\n**Product Owner**: Similar sidebar, campaign overview cards, active campaigns table, analytics charts, prominent wallet balance\n\n## Images\n\n- **Hero**: High-quality photo/illustration of diverse people collaborating in digital workspace, bright/optimistic/professional\n- **Features**: Platform screenshots/illustrations showing functionality\n- **Account Cards**: Icon illustrations (freelancer: person+tools, owner: person+product/chart)\n- **Empty States**: Friendly, simple, guiding custom illustrations\n\n## Accessibility\n\n- Clear focus indicators, sufficient contrast ratios\n- Full keyboard navigation, ARIA labels for RTL screen readers\n- Clear form validation errors, loading states for async actions\n\n---\n\n**Quick Reference**: Deep Blue primary (#002e62 / HSL: 212, 100%, 31%), rounded-2xl standard radius, Cairo/Inter fonts, RTL-first mirroring, shadow-md standard elevation, transition-all duration-200ms standard animation\n\n## Color Palette\n\n**Primary Colors**:\n- Deep Blue: `hsl(212, 100%, 31%)` - Main brand color\n- Deep Blue Light (for dark mode): `hsl(212, 80%, 45%)` - Lighter variant for dark backgrounds\n\n**Accent Colors**:\n- Blue Light: `hsl(212, 15%, 85%)` - For subtle backgrounds\n- Blue Muted: `hsl(212, 10%, 90%)` - For muted elements\n\n**Usage Guidelines**:\n- Use primary deep blue for CTAs, active states, links, and key UI elements\n- Use blue accents for hover states, focus rings, and highlights\n- Maintain sufficient contrast ratios for accessibility (WCAG AA minimum)\n- Pair with neutral grays for backgrounds and text\n- Use sparingly to maintain visual hierarchy","size_bytes":8257},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"shared/schema.ts":{"content":"import { sql, relations } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, timestamp, decimal, boolean, uniqueIndex } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Freelancer schema\nexport const freelancers = pgTable(\"freelancers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  username: text(\"username\").notNull().unique(),\n  phone: text(\"phone\").notNull(),\n  countryCode: text(\"country_code\").notNull().default(\"+966\"),\n  jobTitle: text(\"job_title\"),\n  teamSize: integer(\"team_size\").default(1),\n  services: text(\"services\").array().default(sql`ARRAY[]::text[]`),\n  bio: text(\"bio\"),\n  aboutMe: text(\"about_me\"),\n  profileImage: text(\"profile_image\"),\n  idVerification: text(\"id_verification\"),\n  paymentMethod: text(\"payment_method\"),\n  accountNumber: text(\"account_number\"),\n  isVerified: boolean(\"is_verified\").default(false),\n  acceptedInstructions: boolean(\"accepted_instructions\").default(false),\n  lastSeen: timestamp(\"last_seen\"), // آخر ظهور (للحالة أونلاين/أوفلاين)\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Product Owner schema\nexport const productOwners = pgTable(\"product_owners\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  companyName: text(\"company_name\"),\n  phone: text(\"phone\"),\n  productName: text(\"product_name\"),\n  productType: text(\"product_type\"),\n  productDescription: text(\"product_description\"),\n  productUrl: text(\"product_url\"),\n  services: text(\"services\").array().default(sql`ARRAY[]::text[]`),\n  package: text(\"package\"),\n  budget: text(\"budget\"),\n  duration: text(\"duration\"),\n  acceptedInstructions: boolean(\"accepted_instructions\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Campaigns schema\nexport const campaigns = pgTable(\"campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  productType: text(\"product_type\").notNull(),\n  productUrl: text(\"product_url\"),\n  services: text(\"services\").array().notNull(),\n  package: text(\"package\").notNull(),\n  budget: decimal(\"budget\", { precision: 10, scale: 2 }).notNull(),\n  testersNeeded: integer(\"testers_needed\").notNull(),\n  testersAssigned: integer(\"testers_assigned\").default(0).notNull(),\n  status: text(\"status\").notNull().default(\"draft\"), // draft, active, in_progress, completed, cancelled\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Groups schema - الجروبات (MOVED BEFORE TASKS)\nexport const groups = pgTable(\"groups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  groupImage: text(\"group_image\"), // صورة الجروب\n  portfolioImages: text(\"portfolio_images\").array().default(sql`ARRAY[]::text[]`), // صور البورتفوليو (قبل وبعد)\n  leaderId: varchar(\"leader_id\").notNull().references(() => freelancers.id),\n  maxMembers: integer(\"max_members\").default(700).notNull(),\n  currentMembers: integer(\"current_members\").default(1).notNull(),\n  status: text(\"status\").notNull().default(\"active\"), // active, inactive*\n  privacy: text(\"privacy\").notNull().default(\"public\"), // public, private\n  averageRating: decimal(\"average_rating\", { precision: 3, scale: 2 }).default(\"0\"),\n  totalRatings: integer(\"total_ratings\").default(0),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Projects schema - المشاريع من أصحاب المشاريع (MOVED BEFORE TASKS)\nexport const projects = pgTable(\"projects\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  targetCountry: text(\"target_country\").notNull(),\n  tasksCount: integer(\"tasks_count\").notNull(), // عدد المهام المطلوبة\n  budget: decimal(\"budget\", { precision: 10, scale: 2 }).notNull(),\n  deadline: timestamp(\"deadline\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, accepted, in_progress, completed, cancelled\n  acceptedByGroupId: varchar(\"accepted_by_group_id\").references(() => groups.id),\n  groupRating: decimal(\"group_rating\", { precision: 3, scale: 2 }), // Rating from 0.00 to 5.00\n  ratedAt: timestamp(\"rated_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Tasks schema (individual testing tasks assigned to freelancers)\nexport const tasks = pgTable(\"tasks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").references(() => campaigns.id),\n  projectId: varchar(\"project_id\").references(() => projects.id),\n  groupId: varchar(\"group_id\").references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").references(() => freelancers.id),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  serviceType: text(\"service_type\").notNull(),\n  reward: decimal(\"reward\", { precision: 10, scale: 2 }).notNull(),\n  platformFee: decimal(\"platform_fee\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // رسوم المنصة 10%\n  netReward: decimal(\"net_reward\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // المكافأة الصافية للفريلانسر بعد خصم رسوم المنصة\n  status: text(\"status\").notNull().default(\"available\"), // available, assigned, in_progress, submitted, approved, rejected\n  assignedAt: timestamp(\"assigned_at\"),\n  submittedAt: timestamp(\"submitted_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  submission: text(\"submission\"), // Freelancer's submission/report\n  proofImage: text(\"proof_image\"), // صورة الإثبات\n  taskUrl: text(\"task_url\"), // رابط المهمة\n  feedback: text(\"feedback\"), // Product owner's or leader's feedback\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Wallets schema (freelancer wallets)\nexport const wallets = pgTable(\"wallets\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  freelancerId: varchar(\"freelancer_id\").notNull().unique().references(() => freelancers.id),\n  balance: decimal(\"balance\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  pendingBalance: decimal(\"pending_balance\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  totalEarned: decimal(\"total_earned\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  totalWithdrawn: decimal(\"total_withdrawn\", { precision: 10, scale: 2 }).default(\"0\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Transactions schema (wallet transactions)\nexport const transactions = pgTable(\"transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  walletId: varchar(\"wallet_id\").notNull().references(() => wallets.id),\n  taskId: varchar(\"task_id\").references(() => tasks.id),\n  type: text(\"type\").notNull(), // earning, withdrawal, refund\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, completed, failed\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Payments schema (product owner payments)\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  campaignId: varchar(\"campaign_id\").notNull().references(() => campaigns.id),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\").notNull(), // stripe, paypal, stc_pay\n  paymentIntentId: text(\"payment_intent_id\"),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, completed, failed, refunded\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Notifications schema\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull(), // can be freelancer or product owner\n  userType: text(\"user_type\").notNull(), // freelancer or product_owner\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  type: text(\"type\").notNull(), // task_assigned, payment_received, campaign_update, etc.\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Group Members schema - أعضاء الجروبات\nexport const groupMembers = pgTable(\"group_members\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  role: text(\"role\").notNull().default(\"member\"), // leader, member\n  joinedAt: timestamp(\"joined_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueGroupMember: uniqueIndex(\"unique_group_member_idx\").on(table.groupId, table.freelancerId),\n}));\n\n// Group Spectators schema - product owners who can spectate a group after payment\nexport const groupSpectators = pgTable(\"group_spectators\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  role: text(\"role\").notNull().default(\"spectator\"),\n  joinedAt: timestamp(\"joined_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueGroupSpectator: uniqueIndex(\"unique_group_spectator_idx\").on(table.groupId, table.productOwnerId),\n}));\n\n// Messages schema - الرسائل الداخلية\nexport const messages = pgTable(\"messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  senderId: varchar(\"sender_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  type: text(\"type\").notNull().default(\"text\"), // text, task_post, image\n  relatedProjectId: varchar(\"related_project_id\").references(() => projects.id),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Withdrawals schema - طلبات السحب\nexport const withdrawals = pgTable(\"withdrawals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentMethod: text(\"payment_method\").notNull(),\n  accountNumber: text(\"account_number\").notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // pending, processing, completed, rejected\n  processedAt: timestamp(\"processed_at\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Orders schema - الطلبات المباشرة من أصحاب المشاريع للجروبات\nexport const orders = pgTable(\"orders\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  serviceType: text(\"service_type\").notNull(), // google_play_reviews, ios_reviews, website_reviews, ux_testing, software_testing, social_media, google_maps\n  quantity: integer(\"quantity\").notNull(), // عدد المراجعات/المهام المطلوبة\n  pricePerUnit: decimal(\"price_per_unit\", { precision: 10, scale: 2 }).notNull(), // السعر لكل وحدة\n  totalAmount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(), // الإجمالي\n  platformFee: decimal(\"platform_fee\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // رسوم المنصة 10%\n  netAmount: decimal(\"net_amount\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // المبلغ الصافي للجروب بعد خصم رسوم المنصة\n  leaderCommission: decimal(\"leader_commission\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // عمولة قائد الجروب 3% من netAmount\n  memberDistribution: decimal(\"member_distribution\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // المبلغ المتبقي للتوزيع على الأعضاء (netAmount - leaderCommission)\n  groupMembersCount: integer(\"group_members_count\").notNull().default(1), // عدد أعضاء الجروب وقت الطلب\n  perMemberAmount: decimal(\"per_member_amount\", { precision: 10, scale: 2 }).notNull().default(\"0\"), // نصيب كل عضو (memberDistribution / groupMembersCount)\n  paymentMethod: text(\"payment_method\").notNull(), // vodafone_cash, etisalat_cash, orange_cash, bank_card\n  paymentDetails: text(\"payment_details\"), // رقم الهاتف أو بيانات البطاقة\n  status: text(\"status\").notNull().default(\"pending\"), // pending, payment_confirmed, in_progress, completed, cancelled\n  paidAt: timestamp(\"paid_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Group Join Requests schema - طلبات الانضمام للجروبات\nexport const groupJoinRequests = pgTable(\"group_join_requests\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  freelancerId: varchar(\"freelancer_id\").notNull().references(() => freelancers.id),\n  message: text(\"message\"), // رسالة من المتقدم\n  status: text(\"status\").notNull().default(\"pending\"), // pending, approved, rejected\n  reviewedAt: timestamp(\"reviewed_at\"),\n  reviewNotes: text(\"review_notes\"), // ملاحظات من قائد الجروب\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueJoinRequest: uniqueIndex(\"unique_join_request_idx\").on(table.groupId, table.freelancerId),\n}));\n\n// Conversations schema - المحادثات المباشرة\nexport const conversations = pgTable(\"conversations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  productOwnerId: varchar(\"product_owner_id\").notNull().references(() => productOwners.id),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  leaderId: varchar(\"leader_id\").notNull().references(() => freelancers.id),\n  lastMessageAt: timestamp(\"last_message_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueConversation: uniqueIndex(\"unique_conversation_idx\").on(table.productOwnerId, table.groupId),\n}));\n\n// Conversation Messages schema - رسائل المحادثة المباشرة\nexport const conversationMessages = pgTable(\"conversation_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  conversationId: varchar(\"conversation_id\").notNull().references(() => conversations.id),\n  senderId: varchar(\"sender_id\").notNull(), // يمكن أن يكون product owner أو freelancer\n  senderType: text(\"sender_type\").notNull(), // product_owner, freelancer\n  content: text(\"content\").notNull(),\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Direct Messages schema - رسائل مباشرة بين أي مستخدمين\nexport const directMessages = pgTable(\"direct_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  senderId: varchar(\"sender_id\").notNull(),\n  senderType: text(\"sender_type\").notNull(), // product_owner, freelancer\n  receiverId: varchar(\"receiver_id\").notNull(),\n  receiverType: text(\"receiver_type\").notNull(), // product_owner, freelancer\n  content: text(\"content\").notNull(),\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Group Posts schema - منشورات الجروب (Community Posts)\nexport const groupPosts = pgTable(\"group_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  groupId: varchar(\"group_id\").notNull().references(() => groups.id),\n  authorId: varchar(\"author_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"), // صورة المنشور (اختيارية)\n  likesCount: integer(\"likes_count\").default(0).notNull(),\n  commentsCount: integer(\"comments_count\").default(0).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Post Comments schema - تعليقات المنشورات\nexport const postComments = pgTable(\"post_comments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => groupPosts.id),\n  authorId: varchar(\"author_id\").notNull().references(() => freelancers.id),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"), // صورة التعليق (اختيارية)\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Post Reactions schema - تفاعلات المنشورات (لايكات)\nexport const postReactions = pgTable(\"post_reactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => groupPosts.id),\n  userId: varchar(\"user_id\").notNull().references(() => freelancers.id),\n  type: text(\"type\").notNull().default(\"like\"), // like, love, etc.\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueReaction: uniqueIndex(\"unique_reaction_idx\").on(table.postId, table.userId),\n}));\n\n// Relations\nexport const freelancersRelations = relations(freelancers, ({ one, many }) => ({\n  wallet: one(wallets, { fields: [freelancers.id], references: [wallets.freelancerId] }),\n  tasks: many(tasks),\n  groupsLeading: many(groups),\n  groupMemberships: many(groupMembers),\n  withdrawals: many(withdrawals),\n  messages: many(messages),\n  groupJoinRequests: many(groupJoinRequests),\n}));\n\nexport const productOwnersRelations = relations(productOwners, ({ many }) => ({\n  campaigns: many(campaigns),\n  payments: many(payments),\n  projects: many(projects),\n  orders: many(orders),\n  conversations: many(conversations),\n}));\n\nexport const campaignsRelations = relations(campaigns, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [campaigns.productOwnerId], references: [productOwners.id] }),\n  tasks: many(tasks),\n  payments: many(payments),\n}));\n\nexport const tasksRelations = relations(tasks, ({ one, many }) => ({\n  campaign: one(campaigns, { fields: [tasks.campaignId], references: [campaigns.id] }),\n  project: one(projects, { fields: [tasks.projectId], references: [projects.id] }),\n  group: one(groups, { fields: [tasks.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [tasks.freelancerId], references: [freelancers.id] }),\n  transactions: many(transactions),\n}));\n\nexport const walletsRelations = relations(wallets, ({ one, many }) => ({\n  freelancer: one(freelancers, { fields: [wallets.freelancerId], references: [freelancers.id] }),\n  transactions: many(transactions),\n}));\n\nexport const transactionsRelations = relations(transactions, ({ one }) => ({\n  wallet: one(wallets, { fields: [transactions.walletId], references: [wallets.id] }),\n  task: one(tasks, { fields: [transactions.taskId], references: [tasks.id] }),\n}));\n\nexport const paymentsRelations = relations(payments, ({ one }) => ({\n  campaign: one(campaigns, { fields: [payments.campaignId], references: [campaigns.id] }),\n  productOwner: one(productOwners, { fields: [payments.productOwnerId], references: [productOwners.id] }),\n}));\n\nexport const groupsRelations = relations(groups, ({ one, many }) => ({\n  leader: one(freelancers, { fields: [groups.leaderId], references: [freelancers.id] }),\n  members: many(groupMembers),\n  tasks: many(tasks),\n  messages: many(messages),\n  posts: many(groupPosts),\n  acceptedProjects: many(projects),\n  orders: many(orders),\n  joinRequests: many(groupJoinRequests),\n  conversations: many(conversations),\n}));\n\nexport const groupMembersRelations = relations(groupMembers, ({ one }) => ({\n  group: one(groups, { fields: [groupMembers.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [groupMembers.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const projectsRelations = relations(projects, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [projects.productOwnerId], references: [productOwners.id] }),\n  acceptedByGroup: one(groups, { fields: [projects.acceptedByGroupId], references: [groups.id] }),\n  tasks: many(tasks),\n  messages: many(messages),\n}));\n\nexport const messagesRelations = relations(messages, ({ one }) => ({\n  group: one(groups, { fields: [messages.groupId], references: [groups.id] }),\n  sender: one(freelancers, { fields: [messages.senderId], references: [freelancers.id] }),\n  relatedProject: one(projects, { fields: [messages.relatedProjectId], references: [projects.id] }),\n}));\n\nexport const withdrawalsRelations = relations(withdrawals, ({ one }) => ({\n  freelancer: one(freelancers, { fields: [withdrawals.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const ordersRelations = relations(orders, ({ one }) => ({\n  productOwner: one(productOwners, { fields: [orders.productOwnerId], references: [productOwners.id] }),\n  group: one(groups, { fields: [orders.groupId], references: [groups.id] }),\n}));\n\nexport const groupJoinRequestsRelations = relations(groupJoinRequests, ({ one }) => ({\n  group: one(groups, { fields: [groupJoinRequests.groupId], references: [groups.id] }),\n  freelancer: one(freelancers, { fields: [groupJoinRequests.freelancerId], references: [freelancers.id] }),\n}));\n\nexport const conversationsRelations = relations(conversations, ({ one, many }) => ({\n  productOwner: one(productOwners, { fields: [conversations.productOwnerId], references: [productOwners.id] }),\n  group: one(groups, { fields: [conversations.groupId], references: [groups.id] }),\n  leader: one(freelancers, { fields: [conversations.leaderId], references: [freelancers.id] }),\n  messages: many(conversationMessages),\n}));\n\nexport const conversationMessagesRelations = relations(conversationMessages, ({ one }) => ({\n  conversation: one(conversations, { fields: [conversationMessages.conversationId], references: [conversations.id] }),\n}));\n\nexport const groupPostsRelations = relations(groupPosts, ({ one, many }) => ({\n  group: one(groups, { fields: [groupPosts.groupId], references: [groups.id] }),\n  author: one(freelancers, { fields: [groupPosts.authorId], references: [freelancers.id] }),\n  comments: many(postComments),\n  reactions: many(postReactions),\n}));\n\nexport const postCommentsRelations = relations(postComments, ({ one }) => ({\n  post: one(groupPosts, { fields: [postComments.postId], references: [groupPosts.id] }),\n  author: one(freelancers, { fields: [postComments.authorId], references: [freelancers.id] }),\n}));\n\nexport const postReactionsRelations = relations(postReactions, ({ one }) => ({\n  post: one(groupPosts, { fields: [postReactions.postId], references: [groupPosts.id] }),\n  user: one(freelancers, { fields: [postReactions.userId], references: [freelancers.id] }),\n}));\n\n// Insert schemas for validation\nexport const insertFreelancerSchema = createInsertSchema(freelancers).omit({\n  id: true,\n  isVerified: true,\n  createdAt: true,\n});\n\nexport const insertProductOwnerSchema = createInsertSchema(productOwners).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCampaignSchema = createInsertSchema(campaigns).omit({\n  id: true,\n  testersAssigned: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTaskSchema = createInsertSchema(tasks).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWalletSchema = createInsertSchema(wallets).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGroupSchema = createInsertSchema(groups).omit({\n  id: true,\n  currentMembers: true,\n  createdAt: true,\n});\n\nexport const insertGroupMemberSchema = createInsertSchema(groupMembers).omit({\n  id: true,\n  joinedAt: true,\n});\n\nexport const insertProjectSchema = createInsertSchema(projects).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWithdrawalSchema = createInsertSchema(withdrawals).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertOrderSchema = createInsertSchema(orders).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertGroupJoinRequestSchema = createInsertSchema(groupJoinRequests).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGroupSpectatorSchema = createInsertSchema(groupSpectators).omit({\n  id: true,\n  joinedAt: true,\n});\n\nexport const insertConversationSchema = createInsertSchema(conversations).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertConversationMessageSchema = createInsertSchema(conversationMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGroupPostSchema = createInsertSchema(groupPosts).omit({\n  id: true,\n  likesCount: true,\n  commentsCount: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPostCommentSchema = createInsertSchema(postComments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPostReactionSchema = createInsertSchema(postReactions).omit({\n  id: true,\n  createdAt: true,\n});\n\n// TypeScript types\nexport type Freelancer = typeof freelancers.$inferSelect;\nexport type InsertFreelancer = z.infer<typeof insertFreelancerSchema>;\nexport type ProductOwner = typeof productOwners.$inferSelect;\nexport type InsertProductOwner = z.infer<typeof insertProductOwnerSchema>;\nexport type Campaign = typeof campaigns.$inferSelect;\nexport type InsertCampaign = z.infer<typeof insertCampaignSchema>;\nexport type Task = typeof tasks.$inferSelect;\nexport type InsertTask = z.infer<typeof insertTaskSchema>;\nexport type Wallet = typeof wallets.$inferSelect;\nexport type InsertWallet = z.infer<typeof insertWalletSchema>;\nexport type Transaction = typeof transactions.$inferSelect;\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\nexport type Notification = typeof notifications.$inferSelect;\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Group = typeof groups.$inferSelect;\nexport type InsertGroup = z.infer<typeof insertGroupSchema>;\nexport type GroupMember = typeof groupMembers.$inferSelect;\nexport type InsertGroupMember = z.infer<typeof insertGroupMemberSchema>;\nexport type Project = typeof projects.$inferSelect;\nexport type InsertProject = z.infer<typeof insertProjectSchema>;\nexport type Message = typeof messages.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type Withdrawal = typeof withdrawals.$inferSelect;\nexport type InsertWithdrawal = z.infer<typeof insertWithdrawalSchema>;\nexport type Order = typeof orders.$inferSelect;\nexport type InsertOrder = z.infer<typeof insertOrderSchema>;\nexport type GroupJoinRequest = typeof groupJoinRequests.$inferSelect;\nexport type InsertGroupJoinRequest = z.infer<typeof insertGroupJoinRequestSchema>;\nexport type GroupSpectator = typeof groupSpectators.$inferSelect;\nexport type InsertGroupSpectator = z.infer<typeof insertGroupSpectatorSchema>;\nexport type Conversation = typeof conversations.$inferSelect;\nexport type InsertConversation = z.infer<typeof insertConversationSchema>;\nexport type ConversationMessage = typeof conversationMessages.$inferSelect;\nexport type InsertConversationMessage = z.infer<typeof insertConversationMessageSchema>;\nexport type GroupPost = typeof groupPosts.$inferSelect;\nexport type InsertGroupPost = z.infer<typeof insertGroupPostSchema>;\nexport type PostComment = typeof postComments.$inferSelect;\nexport type InsertPostComment = z.infer<typeof insertPostCommentSchema>;\nexport type PostReaction = typeof postReactions.$inferSelect;\nexport type InsertPostReaction = z.infer<typeof insertPostReactionSchema>;\n\n// Service options\nexport const serviceOptions = [\n  \"اختبار تطبيقات\",\n  \"تقييم خرائط Google Maps\",\n  \"تقييم تطبيقات Android\",\n  \"تقييم تطبيقات iOS\",\n  \"تقييم مواقع إلكترونية\",\n  \"اختبار أنظمة Software\",\n  \"مراجعات تجربة المستخدم UX/UI\",\n  \"التفاعل مع منشورات السوشيال ميديا\",\n] as const;\n\n// Product types\nexport const productTypes = [\n  \"تطبيق موبايل\",\n  \"موقع إلكتروني\",\n  \"نظام سوفت وير\",\n  \"متجر إلكتروني\",\n] as const;\n\n// Payment methods\nexport const paymentMethods = [\n  \"فودافون كاش\",\n  \"اتصالات كاش\",\n  \"أورانج كاش\",\n  \"التحويل البنكي\",\n  \"محفظة سُمُوّ\",\n] as const;\n\n// Payment method details configuration\nexport const paymentMethodDetails: Record<string, { label: string; placeholder: string; inputType: string }> = {\n  \"فودافون كاش\": {\n    label: \"رقم محفظة فودافون كاش\",\n    placeholder: \"مثال: 01012345678\",\n    inputType: \"tel\",\n  },\n  \"اتصالات كاش\": {\n    label: \"رقم محفظة اتصالات كاش\",\n    placeholder: \"مثال: 01112345678\",\n    inputType: \"tel\",\n  },\n  \"أورانج كاش\": {\n    label: \"رقم محفظة أورانج كاش\",\n    placeholder: \"مثال: 01212345678\",\n    inputType: \"tel\",\n  },\n  \"التحويل البنكي\": {\n    label: \"رقم الحساب البنكي (IBAN)\",\n    placeholder: \"مثال: SA1234567890123456789012\",\n    inputType: \"text\",\n  },\n  \"محفظة سُمُوّ\": {\n    label: \"معرف محفظة سُمُوّ\",\n    placeholder: \"سيتم إنشاؤه تلقائيًا\",\n    inputType: \"text\",\n  },\n};\n\n// Packages\nexport const packages = [\n  {\n    id: \"basic\",\n    name: \"Basic\",\n    nameAr: \"أساسي\",\n    testers: 10,\n    features: [\n      \"10 مختبرين متخصصين\",\n      \"تقرير أساسي عن التجربة\",\n      \"مدة التنفيذ: 3-5 أيام\",\n      \"دعم فني أساسي\",\n    ],\n    price: \"499\",\n  },\n  {\n    id: \"pro\",\n    name: \"Pro\",\n    nameAr: \"احترافي\",\n    testers: 30,\n    features: [\n      \"30 مختبرًا متخصصًا\",\n      \"تحليل UX/UI مفصل\",\n      \"تقرير شامل مع توصيات\",\n      \"مدة التنفيذ: 5-7 أيام\",\n      \"دعم فني ذو أولوية\",\n    ],\n    price: \"1299\",\n    recommended: true,\n  },\n  {\n    id: \"growth\",\n    name: \"Growth\",\n    nameAr: \"نمو\",\n    testers: 50,\n    features: [\n      \"50+ مختبرًا من مختلف الفئات\",\n      \"اختبار + تقييم + تفاعل سوشيال\",\n      \"تحليل ذكي بالـ AI\",\n      \"تقارير تفصيلية أسبوعية\",\n      \"مدة التنفيذ: 7-14 يوم\",\n      \"مدير حساب مخصص\",\n      \"دعم فني على مدار الساعة\",\n    ],\n    price: \"2999\",\n  },\n] as const;\n\n// Keep the existing users table for compatibility\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\n// ============================================\n// Admin Dashboard System\n// ============================================\n\n// Roles table - أدوار المستخدمين الإداريين\nexport const roles = pgTable(\"roles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull().unique(),\n  nameAr: text(\"name_ar\").notNull(),\n  description: text(\"description\"),\n  isSystemRole: boolean(\"is_system_role\").default(false).notNull(), // الأدوار النظامية لا يمكن حذفها\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Permissions table - الصلاحيات\nexport const permissions = pgTable(\"permissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull().unique(), // مثل users:view, users:create\n  nameAr: text(\"name_ar\").notNull(),\n  resource: text(\"resource\").notNull(), // users, freelancers, groups, etc.\n  action: text(\"action\").notNull(), // view, create, edit, delete, approve\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Role Permissions table - ربط الأدوار بالصلاحيات\nexport const rolePermissions = pgTable(\"role_permissions\", {\n  roleId: varchar(\"role_id\").notNull().references(() => roles.id, { onDelete: 'cascade' }),\n  permissionId: varchar(\"permission_id\").notNull().references(() => permissions.id, { onDelete: 'cascade' }),\n}, (table) => ({\n  pk: uniqueIndex(\"role_permission_pk\").on(table.roleId, table.permissionId),\n}));\n\n// Admin Users table - المستخدمون الإداريون\nexport const adminUsers = pgTable(\"admin_users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  phone: text(\"phone\"),\n  roleId: varchar(\"role_id\").notNull().references(() => roles.id),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n  lastLogin: timestamp(\"last_login\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Insert schemas and types\nexport const insertRoleSchema = createInsertSchema(roles).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPermissionSchema = createInsertSchema(permissions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertAdminUserSchema = createInsertSchema(adminUsers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n  lastLogin: true,\n});\n\nexport type Role = typeof roles.$inferSelect;\nexport type InsertRole = z.infer<typeof insertRoleSchema>;\n\nexport type Permission = typeof permissions.$inferSelect;\nexport type InsertPermission = z.infer<typeof insertPermissionSchema>;\n\nexport type AdminUser = typeof adminUsers.$inferSelect;\nexport type InsertAdminUser = z.infer<typeof insertAdminUserSchema>;\n\nexport type RolePermission = typeof rolePermissions.$inferSelect;\n","size_bytes":35864},"client/src/pages/Home.tsx":{"content":"﻿import { Link } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { motion } from \"framer-motion\";\nimport { \n  ArrowRight, \n  Star, \n  MapPin,\n  Smartphone,\n  Users,\n  Shield,\n  Zap,\n  TrendingUp,\n  CheckCircle2,\n  Play,\n  MessageCircle,\n  ThumbsUp,\n  Target,\n  Award,\n  Clock,\n  Quote,\n  Rocket\n} from \"lucide-react\";\nimport LightRays from '../components/Ballpit';\n\nexport default function Home() {\n  const features = [\n    {\n      icon: MapPin,\n      title: \"تقييمات خرائط جوجل\",\n      description: \"تعزيز وجودك على خرائط جوجل بتقييمات حقيقية وموثوقة\"\n    },\n    {\n      icon: Smartphone,\n      title: \"تقييمات متاجر التطبيقات\",\n      description: \"تحسين تصنيف تطبيقك في متجري App Store و Google Play\"\n    },\n    {\n      icon: Users,\n      title: \"مختبرون محترفون\",\n      description: \"فريق من المختبرين المؤهلين لتقييم تجربة المستخدم\"\n    },\n    {\n      icon: TrendingUp,\n      title: \"تحليلات مفصلة\",\n      description: \"تقارير شاملة تساعدك في فهم أداء منتجك الرقمي\"\n    }\n  ];\n\n  const services = [\n    {\n      icon: Star,\n      title: \"تقييمات جوجل\",\n      stats: \"2,500+ تقييم\",\n      description: \"تقييمات موثوقة لتحسين تصنيفك على خرائط جوجل\",\n      gradient: \"from-blue-500 to-cyan-500\"\n    },\n    {\n      icon: Smartphone,\n      title: \"تقييمات التطبيقات\",\n      stats: \"1,800+ تقييم\",\n      description: \"تعزيز وجود تطبيقك في متاجر التطبيقات\",\n      gradient: \"from-purple-500 to-pink-500\"\n    },\n    {\n      icon: Users,\n      title: \"اختبار UX/UI\",\n      stats: \"950+ اختبار\",\n      description: \"تحسين تجربة المستخدم من خلال اختبارات احترافية\",\n      gradient: \"from-green-500 to-emerald-500\"\n    },\n    {\n      icon: ThumbsUp,\n      title: \"مراجعات وسائل التواصل\",\n      stats: \"3,200+ مراجعة\",\n      description: \"زيادة التفاعل والمصداقية على المنصات الاجتماعية\",\n      gradient: \"from-orange-500 to-red-500\"\n    }\n  ];\n\n  const testimonials = [\n    {\n      name: \"أحمد محمد\",\n      role: \"مدير مطعم\",\n      content: \"ساعدتني سومو في زيادة تقييم مطعمي على جوجل من 3.2 إلى 4.8 في شهرين فقط!\",\n      rating: 5\n    },\n    {\n      name: \"فاطمة العلي\",\n      role: \"مطور تطبيقات\",\n      content: \"التقييمات الحقيقية ساعدت تطبيقي على الصعود إلى المراكز الأولى في المتجر\",\n      rating: 5\n    },\n    {\n      name: \"خالد السعيد\",\n      role: \"صاحب شركة\",\n      content: \"الخدمة احترافية والمختبرون يقدمون ملاحظات قيمة ساعدت في تطوير خدماتنا\",\n      rating: 5\n    }\n  ];\n\n  const stats = [\n    { number: \"10,000\", label: \"تقييم مكتمل\" },\n    { number: \"2,500\", label: \"عميل راضي\" },\n    { number: \"4.9\", label: \"تقييم متوسط\" },\n    { number: \"98%\", label: \"رضا العملاء\" }\n  ];\n\n  const process = [\n    {\n      step: \"01\",\n      title: \"اختر الخدمة\",\n      description: \"اختر من بين خدماتنا المتنوعة للتقييم والاختبار\"\n    },\n    {\n      step: \"02\",\n      title: \"حدد المتطلبات\",\n      description: \"أخبرنا باحتياجاتك ومتطلباتك الخاصة\"\n    },\n    {\n      step: \"03\",\n      title: \"تنفيذ المهمة\",\n      description: \"فريقنا المحترف ينفذ المهمة بدقة واحترافية\"\n    },\n    {\n      step: \"04\",\n      title: \"تسليم النتائج\",\n      description: \"احصل على تقرير مفصل ونتائج ملموسة\"\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      <Navbar />\n\n      {/* Full Screen Hero Section with LightRays Background */}\n{/* Full Screen Hero Section with LightRays on White Background */}\n{/* Full Screen Hero Section with Multiple Visible LightRays */}\n<section className=\"relative h-screen flex items-center justify-center overflow-hidden bg-white\">\n  {/* Multiple LightRays Background with Strong Colors */}\n  {/* Ultra Visible LightRays */}\n<div className=\"absolute inset-0 z-0\">\n  {/* Strong Blue Rays */}\n  <LightRays\n    raysOrigin=\"top-left\"\n    raysColor=\"#1D4ED8\"\n    raysSpeed={1.0}\n    lightSpread={0.3}\n    rayLength={2.5}\n    followMouse={true}\n    mouseInfluence={0.12}\n    noiseAmount={0.05}\n    distortion={0.03}\n    pulsating={true}\n    fadeDistance={0.8}\n    saturation={1.5}\n    className=\"w-full h-full opacity-90\"\n  />\n  {/* Strong Purple Rays */}\n  <LightRays\n    raysOrigin=\"top-right\"\n    raysColor=\"#6D28D9\"\n    raysSpeed={1.5}\n    lightSpread={0.25}\n    rayLength={2.8}\n    followMouse={true}\n    mouseInfluence={0.18}\n    noiseAmount={0.03}\n    distortion={0.025}\n    pulsating={true}\n    fadeDistance={0.7}\n    saturation={1.6}\n    className=\"w-full h-full opacity-85\"\n  />\n  {/* Strong Cyan Rays */}\n  <LightRays\n    raysOrigin=\"bottom-center\"\n    raysColor=\"#0E7490\"\n    raysSpeed={0.7}\n    lightSpread={0.4}\n    rayLength={2.2}\n    followMouse={true}\n    mouseInfluence={0.08}\n    noiseAmount={0.06}\n    distortion={0.015}\n    pulsating={true}\n    fadeDistance={1.0}\n    saturation={1.4}\n    className=\"w-full h-full opacity-75\"\n  />\n</div>\n\n{/* Stronger Color Overlay */}\n<div className=\"absolute inset-0 bg-gradient-to-br from-blue-200/50 via-white/80 to-purple-200/40 z-1\"></div>\n  {/* Enhanced Background Elements */}\n  <div className=\"absolute inset-0 overflow-hidden\">\n    <div className=\"absolute top-1/4 left-1/4 w-80 h-80 bg-blue-200/30 rounded-full blur-3xl animate-pulse\"></div>\n    <div className=\"absolute bottom-1/3 right-1/3 w-96 h-96 bg-purple-200/30 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n    <div className=\"absolute top-2/3 left-1/3 w-72 h-72 bg-cyan-200/25 rounded-full blur-3xl animate-pulse delay-500\"></div>\n  </div>\n\n  {/* Hero Content */}\n  <div className=\"relative z-10 max-w-6xl mx-auto px-6 text-center\">\n    <motion.div\n      initial={{ opacity: 0, y: 30 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.8 }}\n    >\n      <Badge className=\"bg-white/90 text-blue-600 border border-blue-200 backdrop-blur-lg mb-6 px-6 py-3 text-lg font-medium shadow-lg\">\n        <Star className=\"w-5 h-5 ml-2\" />\n        المنصة الرائدة للتقييمات والاختبارات\n      </Badge>\n      \n      <h1 className=\"text-5xl lg:text-7xl font-bold text-gray-900 mb-8 leading-tight\">\n        <span className=\"block\">ارتقِ بتقييماتك</span>\n        <span className=\"block bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 bg-clip-text text-transparent mt-4\">\n          الرقمية\n        </span>\n      </h1>\n      \n      <p className=\"text-xl text-gray-700 mb-12 max-w-3xl mx-auto leading-relaxed backdrop-blur-lg bg-white/80 rounded-2xl p-8 border border-white shadow-xl\">\n        نوفر لك تقييمات حقيقية واختبارات احترافية لتعزيز وجودك الرقمي على \n        خرائط جوجل، متاجر التطبيقات، ومنصات التواصل الاجتماعي\n      </p>\n      \n      <div className=\"flex flex-col sm:flex-row gap-6 justify-center items-center mb-16\">\n        <Link href=\"/role-selection\">\n          <Button size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-12 py-6 text-xl rounded-2xl shadow-2xl hover:shadow-3xl transition-all duration-300 transform hover:-translate-y-1\">\n            ابدأ رحلتك الآن\n            <Rocket className=\"mr-3 h-6 w-6\" />\n          </Button>\n        </Link>\n        <Button size=\"lg\" variant=\"outline\" className=\"border-2 border-gray-300 text-gray-700 hover:border-blue-500 hover:text-blue-600 px-12 py-6 text-xl rounded-2xl backdrop-blur-lg bg-white/90 shadow-lg hover:shadow-xl transition-all duration-300\">\n          <Play className=\"mr-3 h-6 w-6\" />\n          شاهد التجارب\n        </Button>\n      </div>\n\n      {/* Stats Preview */}\n      <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-8 max-w-2xl mx-auto\">\n        {stats.map((stat, index) => (\n          <motion.div\n            key={index}\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ duration: 0.5, delay: index * 0.1 + 0.5 }}\n            className=\"text-center backdrop-blur-lg bg-white/90 rounded-2xl p-6 border border-white shadow-lg hover:shadow-xl transition-all duration-300\"\n          >\n            <div className=\"text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2\">\n              {stat.number}\n            </div>\n            <div className=\"text-gray-600 font-medium\">{stat.label}</div>\n          </motion.div>\n        ))}\n      </div>\n    </motion.div>\n  </div>\n\n  {/* Scroll Indicator */}\n  <motion.div\n    initial={{ opacity: 0 }}\n    animate={{ opacity: 1 }}\n    transition={{ duration: 1, delay: 1.5 }}\n    className=\"absolute bottom-8 left-1/2 transform -translate-x-1/2 z-10\"\n  >\n    <div className=\"animate-bounce\">\n      <div className=\"w-6 h-10 border-2 border-blue-400 rounded-full flex justify-center shadow-lg\">\n        <div className=\"w-1 h-3 bg-blue-500 rounded-full mt-2\"></div>\n      </div>\n    </div>\n  </motion.div>\n</section>\n      {/* Rest of your sections remain the same */}\n      {/* Features Section */}\n      <section className=\"py-24 bg-white relative\">\n        <div className=\"max-w-6xl mx-auto px-6\">\n          <div className=\"text-center mb-20\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\">\n                خدماتنا <span className=\"text-blue-600\">المتميزة</span>\n              </h2>\n              <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n                نقدم مجموعة متكاملة من خدمات التقييم والاختبارات لتعزيز وجودك الرقمي\n              </p>\n            </motion.div>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {features.map((feature, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 30 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: index * 0.1 }}\n                whileHover={{ y: -5 }}\n                className=\"group text-center p-8 rounded-3xl bg-gradient-to-br from-white to-gray-50 border border-gray-200 hover:border-blue-300 hover:shadow-xl transition-all duration-300\"\n              >\n                <div className=\"bg-blue-50 p-4 rounded-2xl w-fit mx-auto mb-6 group-hover:scale-110 transition-transform duration-300\">\n                  <feature.icon className=\"h-8 w-8 text-blue-600\" />\n                </div>\n                <h3 className=\"text-xl font-bold text-gray-900 mb-4\">{feature.title}</h3>\n                <p className=\"text-gray-600 leading-relaxed\">{feature.description}</p>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Services Section */}\n      <section className=\"py-24 bg-gray-50 relative\">\n        <div className=\"max-w-6xl mx-auto px-6\">\n          <div className=\"text-center mb-20\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <Badge className=\"bg-purple-100 text-purple-600 border-0 mb-6 px-4 py-2\">\n                حلول متكاملة\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\">\n                كيف يمكننا <span className=\"text-purple-600\">مساعدتك؟</span>\n              </h2>\n            </motion.div>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-8\">\n            {services.map((service, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, x: index % 2 === 0 ? -30 : 30 }}\n                whileInView={{ opacity: 1, x: 0 }}\n                transition={{ duration: 0.6, delay: index * 0.1 }}\n                whileHover={{ y: -5 }}\n                className=\"group bg-white rounded-3xl p-8 border border-gray-200 hover:shadow-xl transition-all duration-300\"\n              >\n                <div className=\"flex items-start gap-6\">\n                  <div className={`p-4 rounded-2xl bg-gradient-to-r ${service.gradient} group-hover:scale-110 transition-transform duration-300`}>\n                    <service.icon className=\"h-8 w-8 text-white\" />\n                  </div>\n                  <div className=\"flex-1 text-right\">\n                    <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">{service.title}</h3>\n                    <p className=\"text-gray-600 mb-6 leading-relaxed\">{service.description}</p>\n                    <Badge className=\"bg-gray-100 text-gray-700 border-0 px-4 py-2 font-semibold\">\n                      {service.stats}\n                    </Badge>\n                  </div>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Process Section */}\n      <section className=\"py-24 bg-white relative\">\n        <div className=\"max-w-6xl mx-auto px-6\">\n          <div className=\"text-center mb-20\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <Badge className=\"bg-green-100 text-green-600 border-0 mb-6 px-4 py-2\">\n                خطوات العمل\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\">\n                <span className=\"text-green-600\">4 خطوات</span> بسيطة للنتيجة\n              </h2>\n            </motion.div>\n          </div>\n\n          <div className=\"grid md:grid-cols-4 gap-8 relative\">\n            {/* Connection Line */}\n            <div className=\"hidden md:block absolute top-12 left-8 right-8 h-1 bg-gradient-to-r from-blue-200 via-purple-200 to-green-200 rounded-full\"></div>\n            \n            {process.map((step, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 30 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: index * 0.1 }}\n                className=\"text-center relative\"\n              >\n                <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2 w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg shadow-lg\">\n                  {step.step}\n                </div>\n                <div className=\"bg-gradient-to-br from-blue-50 to-purple-50 p-6 rounded-2xl mt-4\">\n                  <h3 className=\"text-xl font-bold text-gray-900 mb-4\">{step.title}</h3>\n                  <p className=\"text-gray-600 leading-relaxed\">{step.description}</p>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Testimonials Section */}\n      <section className=\"py-24 bg-gray-50 relative\">\n        <div className=\"max-w-6xl mx-auto px-6\">\n          <div className=\"text-center mb-20\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6 }}\n            >\n              <Badge className=\"bg-yellow-100 text-yellow-600 border-0 mb-6 px-4 py-2\">\n                <Quote className=\"w-4 h-4 ml-1\" />\n                آراء العملاء\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\">\n                يثق بنا <span className=\"text-yellow-600\">آلاف العملاء</span>\n              </h2>\n            </motion.div>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            {testimonials.map((testimonial, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 30 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: index * 0.1 }}\n                whileHover={{ y: -5 }}\n                className=\"bg-white rounded-3xl p-8 border border-gray-200 hover:shadow-xl transition-all duration-300\"\n              >\n                <div className=\"flex gap-1 mb-6\">\n                  {[...Array(testimonial.rating)].map((_, i) => (\n                    <Star key={i} className=\"h-5 w-5 text-yellow-400 fill-yellow-400\" />\n                  ))}\n                </div>\n                <p className=\"text-gray-700 mb-8 leading-relaxed text-lg\">\n                  \"{testimonial.content}\"\n                </p>\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center text-white font-bold\">\n                    {testimonial.name.split(' ').map(n => n[0]).join('')}\n                  </div>\n                  <div className=\"flex-1 text-right\">\n                    <div className=\"font-bold text-gray-900\">{testimonial.name}</div>\n                    <div className=\"text-gray-600 text-sm\">{testimonial.role}</div>\n                  </div>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Final CTA Section */}\n      <section className=\"py-24 bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 text-white relative\">\n        <div className=\"max-w-4xl mx-auto px-6 text-center\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n          >\n            <h2 className=\"text-4xl lg:text-5xl font-bold mb-8\">\n              مستعد لتحسين تقييماتك الرقمية؟\n            </h2>\n            <p className=\"text-xl text-blue-100 mb-12 max-w-2xl mx-auto leading-relaxed\">\n              انضم إلى آلاف الشركات والأفراد الذين حققوا نجاحات مذهلة في تعزيز وجودهم الرقمي\n            </p>\n            <div className=\"flex flex-col sm:flex-row gap-6 justify-center\">\n              <Link href=\"/role-selection\">\n                <Button size=\"lg\" className=\"bg-white text-blue-600 hover:bg-gray-100 px-12 py-6 text-xl rounded-2xl shadow-2xl\">\n                  ابدأ مجاناً الآن\n                  <ArrowRight className=\"mr-3 h-6 w-6\" />\n                </Button>\n              </Link>\n              <Button size=\"lg\" variant=\"outline\" className=\"border-2 border-white text-white hover:bg-white/10 px-12 py-6 text-xl rounded-2xl backdrop-blur-sm\">\n                <MessageCircle className=\"mr-3 h-6 w-6\" />\n                تواصل معنا\n              </Button>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      <Footer />\n    </div>\n  );\n}","size_bytes":19845},"client/src/pages/FreelancerSignup.tsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { StepIndicator } from \"@/components/StepIndicator\";\nimport { PasswordStrength } from \"@/components/PasswordStrength\";\nimport { FileUpload } from \"@/components/FileUpload\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Briefcase, Users as UsersIcon, Puzzle, Edit3, Camera, CreditCard, ArrowRight, ArrowLeft, Upload } from \"lucide-react\";\nimport { serviceOptions, paymentMethods, paymentMethodDetails } from \"@shared/schema\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst steps = [\n  { id: 1, title: \"المعلومات الأساسية\" },\n  { id: 2, title: \"المهارات والخدمات\" },\n  { id: 3, title: \"التوثيق\" },\n  { id: 4, title: \"إعدادات الدفع\" },\n];\n\n// Form schemas for each step\nconst step1Schema = z.object({\n  fullName: z.string().min(3, \"الاسم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  username: z.string().min(3, \"اسم المستخدم يجب أن يحتوي على 3 أحرف على الأقل\"),\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  phone: z.string().min(9, \"رقم الهاتف غير صحيح\"),\n  countryCode: z.string(),\n  password: z.string().min(8, \"كلمة المرور يجب أن تحتوي على 8 أحرف على الأقل\"),\n});\n\nconst step2Schema = z.object({\n  bio: z.string().min(20, \"الوصف يجب أن يحتوي على 20 حرفًا على الأقل\"),\n  jobTitle: z.string().min(3, \"المسمى المهني مطلوب\"),\n  teamSize: z.string(),\n  services: z.array(z.string()).min(1, \"اختر خدمة واحدة على الأقل\"),\n  aboutMe: z.string().min(50, \"الوصف التفصيلي يجب أن يحتوي على 50 حرفًا على الأقل\"),\n});\n\nconst step3Schema = z.object({\n  profileImage: z.string().optional(),\n  idVerification: z.string().optional(),\n});\n\nconst step4Schema = z.object({\n  paymentMethod: z.string().min(1, \"اختر وسيلة الدفع\"),\n  accountNumber: z.string().optional(),\n});\n\ntype FormData = z.infer<typeof step1Schema> & \n  z.infer<typeof step2Schema> & \n  z.infer<typeof step3Schema> & \n  z.infer<typeof step4Schema>;\n\nexport default function FreelancerSignup() {\n  const [currentStep, setCurrentStep] = useState(1);\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [formData, setFormData] = useState<Partial<FormData>>({\n    countryCode: \"+966\",\n    teamSize: \"1\",\n    services: [],\n  });\n\n  const createFreelancerMutation = useMutation({\n    mutationFn: async (data: Partial<FormData>) => {\n      const response = await fetch(\"/api/freelancers\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          ...data,\n          teamSize: parseInt(data.teamSize || \"1\", 10),\n        }),\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || \"فشل إنشاء الحساب\");\n      }\n      \n      return await response.json();\n    },\n    onSuccess: (data: any) => {\n      // Store token and user data in localStorage\n      localStorage.setItem(\"token\", data.token);\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      localStorage.setItem(\"userType\", \"freelancer\");\n      \n      // Dispatch custom event to update Navbar\n      window.dispatchEvent(new Event(\"userLoggedIn\"));\n      \n      toast({\n        title: \"تم إنشاء الحساب بنجاح!\",\n        description: \"مرحبًا بك في منصة سُمُوّ. يرجى قراءة التعليمات الهامة قبل البدء\",\n      });\n      // Redirect to instructions page first\n      navigate(\"/freelancer-instructions\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"حدث خطأ\",\n        description: error.message || \"فشل في إنشاء الحساب. حاول مرة أخرى.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getSchemaForStep = (step: number) => {\n    switch (step) {\n      case 1: return step1Schema;\n      case 2: return step2Schema;\n      case 3: return step3Schema;\n      case 4: return step4Schema;\n      default: return step1Schema;\n    }\n  };\n\n  // Memoize default values to prevent re-initialization\n  const defaultFormValues = useMemo(() => ({\n    fullName: formData.fullName || \"\",\n    username: formData.username || \"\",\n    email: formData.email || \"\",\n    phone: formData.phone || \"\",\n    countryCode: formData.countryCode || \"+966\",\n    password: formData.password || \"\",\n    bio: formData.bio || \"\",\n    jobTitle: formData.jobTitle || \"\",\n    teamSize: formData.teamSize || \"1\",\n    services: formData.services || [],\n    aboutMe: formData.aboutMe || \"\",\n    profileImage: formData.profileImage || \"\",\n    idVerification: formData.idVerification || \"\",\n    paymentMethod: formData.paymentMethod || \"\",\n    accountNumber: formData.accountNumber || \"\",\n  }), [currentStep, formData]);\n\n  const form = useForm<FormData>({\n    resolver: zodResolver(getSchemaForStep(currentStep)),\n    values: defaultFormValues as any,\n    mode: \"onChange\",\n  });\n\n  const handleNext = async () => {\n    const isValid = await form.trigger();\n    if (isValid) {\n      const currentValues = form.getValues();\n      const updatedFormData = { ...formData, ...currentValues };\n      setFormData(updatedFormData);\n      \n      if (currentStep < 4) {\n        setCurrentStep(currentStep + 1);\n        form.clearErrors();\n      } else {\n        // Submit form to backend\n        createFreelancerMutation.mutate(updatedFormData);\n      }\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 1) {\n      const currentValues = form.getValues();\n      setFormData({ ...formData, ...currentValues });\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  // Watch payment method value outside of JSX to avoid hook call issues\n  const selectedPaymentMethod = form.watch(\"paymentMethod\");\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1 py-8 px-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          <StepIndicator steps={steps} currentStep={currentStep} />\n\n          <Card className=\"rounded-2xl shadow-lg\">\n            <CardHeader className=\"border-b\">\n              <CardTitle className=\"text-2xl text-center\">\n                {steps[currentStep - 1].title}\n              </CardTitle>\n            </CardHeader>\n\n            <CardContent className=\"p-6 md:p-8\">\n              <Form {...form}>\n                <form className=\"space-y-6\">\n                  {/* Step 1: Basic Information */}\n                  {currentStep === 1 && (\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"fullName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>الاسم الكامل *</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"أحمد محمد\" className=\"rounded-xl\" data-testid=\"input-fullname\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"username\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>اسم المستخدم *</FormLabel>\n                            <FormControl>\n                              <Input {...field} placeholder=\"ahmed_tester\" className=\"rounded-xl\" data-testid=\"input-username\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>البريد الإلكتروني *</FormLabel>\n                            <FormControl>\n                              <Input {...field} type=\"email\" placeholder=\"ahmed@example.com\" className=\"rounded-xl\" data-testid=\"input-email\" autoComplete=\"email\" name=\"email\" />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"grid grid-cols-3 gap-3\">\n                        <FormField\n                          control={form.control}\n                          name=\"countryCode\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>كود الدولة</FormLabel>\n                              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                                <FormControl>\n                                  <SelectTrigger className=\"rounded-xl\" data-testid=\"select-country-code\">\n                                    <SelectValue />\n                                  </SelectTrigger>\n                                </FormControl>\n                                <SelectContent>\n                                  <SelectItem value=\"+966\">🇸🇦 السعودية +966</SelectItem>\n                                  <SelectItem value=\"+971\">🇦🇪 الإمارات +971</SelectItem>\n                                  <SelectItem value=\"+965\">🇰🇼 الكويت +965</SelectItem>\n                                  <SelectItem value=\"+973\">🇧🇭 البحرين +973</SelectItem>\n                                  <SelectItem value=\"+974\">🇶🇦 قطر +974</SelectItem>\n                                  <SelectItem value=\"+968\">🇴🇲 عمان +968</SelectItem>\n                                  <SelectItem value=\"+20\">🇪🇬 مصر +20</SelectItem>\n                                  <SelectItem value=\"+962\">🇯🇴 الأردن +962</SelectItem>\n                                  <SelectItem value=\"+961\">🇱🇧 لبنان +961</SelectItem>\n                                  <SelectItem value=\"+963\">🇸🇾 سوريا +963</SelectItem>\n                                  <SelectItem value=\"+964\">🇮🇶 العراق +964</SelectItem>\n                                  <SelectItem value=\"+970\">🇵🇸 فلسطين +970</SelectItem>\n                                  <SelectItem value=\"+212\">🇲🇦 المغرب +212</SelectItem>\n                                  <SelectItem value=\"+213\">🇩🇿 الجزائر +213</SelectItem>\n                                  <SelectItem value=\"+216\">🇹🇳 تونس +216</SelectItem>\n                                  <SelectItem value=\"+218\">🇱🇾 ليبيا +218</SelectItem>\n                                  <SelectItem value=\"+249\">🇸🇩 السودان +249</SelectItem>\n                                  <SelectItem value=\"+967\">🇾🇪 اليمن +967</SelectItem>\n                                  <SelectItem value=\"+222\">🇲🇷 موريتانيا +222</SelectItem>\n                                  <SelectItem value=\"+253\">🇩🇯 جيبوتي +253</SelectItem>\n                                  <SelectItem value=\"+252\">🇸🇴 الصومال +252</SelectItem>\n                                  <SelectItem value=\"+269\">🇰🇲 جزر القمر +269</SelectItem>\n                                </SelectContent>\n                              </Select>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={form.control}\n                          name=\"phone\"\n                          render={({ field }) => (\n                            <FormItem className=\"col-span-2\">\n                              <FormLabel>رقم الهاتف *</FormLabel>\n                              <FormControl>\n                                <Input {...field} placeholder=\"501234567\" className=\"rounded-xl\" data-testid=\"input-phone\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>كلمة المرور *</FormLabel>\n                            <FormControl>\n                              <Input {...field} type=\"password\" placeholder=\"••••••••\" className=\"rounded-xl\" data-testid=\"input-password\" autoComplete=\"new-password\" name=\"password\" />\n                            </FormControl>\n                            <PasswordStrength password={field.value || \"\"} />\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )}\n\n                  {/* Step 2: Skills & Services */}\n                  {currentStep === 2 && (\n                    <div className=\"space-y-6\">\n                      <FormField\n                        control={form.control}\n                        name=\"bio\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>وصف قصير عن نفسك *</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                {...field} \n                                placeholder=\"مثال: أنا محمد، مختبر تطبيقات وخرائط Google لدي 40 شخصًا قادرين على الاختبار من فريقي...\" \n                                className=\"rounded-xl min-h-[100px]\" \n                                data-testid=\"input-bio\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <Card className=\"rounded-xl bg-muted/30\">\n                        <CardContent className=\"p-6 space-y-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"jobTitle\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Briefcase className=\"h-4 w-4\" />\n                                  المسمى المهني *\n                                </FormLabel>\n                                <FormControl>\n                                  <Input {...field} placeholder=\"مثال: مختبر تطبيقات - مسوّق تقييمات - مدير فريق مراجعين\" className=\"rounded-xl\" data-testid=\"input-job-title\" />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"teamSize\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <UsersIcon className=\"h-4 w-4\" />\n                                  عدد أعضاء الفريق *\n                                </FormLabel>\n                                <FormControl>\n                                  <Input {...field} type=\"number\" min=\"1\" className=\"rounded-xl\" data-testid=\"input-team-size\" />\n                                </FormControl>\n                                <FormDescription className=\"text-xs\">\n                                  أدخل عدد الأشخاص الذين يعملون معك في تنفيذ المهام\n                                </FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"services\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Puzzle className=\"h-4 w-4\" />\n                                  المجالات التي تقدمها *\n                                </FormLabel>\n                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2\">\n                                  {serviceOptions.map((service) => (\n                                    <FormField\n                                      key={service}\n                                      control={form.control}\n                                      name=\"services\"\n                                      render={({ field }) => (\n                                        <FormItem className=\"flex items-start gap-2 p-3 rounded-xl border hover-elevate transition-all\">\n                                          <FormControl>\n                                            <Checkbox\n                                              checked={(field.value || []).includes(service)}\n                                              onCheckedChange={(checked) => {\n                                                const current = field.value || [];\n                                                const updated = checked\n                                                  ? [...current, service]\n                                                  : current.filter((s) => s !== service);\n                                                field.onChange(updated);\n                                              }}\n                                              className=\"mt-0.5\"\n                                              data-testid={`checkbox-service-${service}`}\n                                            />\n                                          </FormControl>\n                                          <FormLabel className=\"text-sm font-normal cursor-pointer\">\n                                            {service}\n                                          </FormLabel>\n                                        </FormItem>\n                                      )}\n                                    />\n                                  ))}\n                                </div>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"aboutMe\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Edit3 className=\"h-4 w-4\" />\n                                  الوصف المهني (نبذة تفصيلية) *\n                                </FormLabel>\n                                <FormControl>\n                                  <Textarea \n                                    {...field} \n                                    placeholder=\"اكتب نبذة عنك توضح كيف تنفذ المهام مع فريقك، وما يميزك عن الآخرين...\" \n                                    className=\"rounded-xl min-h-[150px]\" \n                                    data-testid=\"input-about-me\"\n                                  />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </CardContent>\n                      </Card>\n                    </div>\n                  )}\n\n                  {/* Step 3: Verification */}\n                  {currentStep === 3 && (\n                    <div className=\"space-y-6\">\n                      <Card className=\"rounded-xl bg-muted/30\">\n                        <CardContent className=\"p-6 space-y-6\">\n                          <FormField\n                            control={form.control}\n                            name=\"profileImage\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <Camera className=\"h-4 w-4\" />\n                                  صورة الملف الشخصي\n                                </FormLabel>\n                                <FormControl>\n                                  <div className=\"flex items-center gap-4\">\n                                    <FileUpload\n                                      type=\"profile\"\n                                      currentFile={field.value}\n                                      onFileUploaded={(url) => field.onChange(url)}\n                                      accept=\"image/*\"\n                                    />\n                                    <div className=\"flex-1\">\n                                      <p className=\"text-xs text-muted-foreground\">\n                                        اختر صورة واضحة لزيادة الثقة بينك وبين العملاء\n                                      </p>\n                                    </div>\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"idVerification\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>إثبات الهوية (اختياري)</FormLabel>\n                                <FormControl>\n                                  <div>\n                                    <FileUpload\n                                      type=\"verification\"\n                                      currentFile={field.value}\n                                      onFileUploaded={(url) => field.onChange(url)}\n                                      accept=\"image/*,application/pdf\"\n                                    />\n                                    <p className=\"text-xs text-muted-foreground mt-2\">\n                                      PDF أو صورة - سيتم مراجعتها يدويًا من قبل الإدارة\n                                    </p>\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </CardContent>\n                      </Card>\n                    </div>\n                  )}\n\n                  {/* Step 4: Payment Settings */}\n                  {currentStep === 4 && (\n                    <div className=\"space-y-4\">\n                      <Card className=\"rounded-xl bg-accent/10\">\n                        <CardContent className=\"p-6 space-y-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"paymentMethod\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"flex items-center gap-2\">\n                                  <CreditCard className=\"h-4 w-4\" />\n                                  وسيلة الدفع المفضلة *\n                                </FormLabel>\n                                <Select onValueChange={field.onChange} defaultValue={field.value}>\n                                  <FormControl>\n                                    <SelectTrigger className=\"rounded-xl\" data-testid=\"select-payment-method\">\n                                      <SelectValue placeholder=\"اختر وسيلة الدفع\" />\n                                    </SelectTrigger>\n                                  </FormControl>\n                                  <SelectContent>\n                                    {paymentMethods.map((method) => (\n                                      <SelectItem key={method} value={method}>\n                                        {method}\n                                      </SelectItem>\n                                    ))}\n                                  </SelectContent>\n                                </Select>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          {selectedPaymentMethod && selectedPaymentMethod !== \"محفظة سُمُوّ\" && (\n                            <FormField\n                              control={form.control}\n                              name=\"accountNumber\"\n                              render={({ field }) => {\n                                const methodDetails = paymentMethodDetails[selectedPaymentMethod];\n                                \n                                return (\n                                  <FormItem>\n                                    <FormLabel>{methodDetails?.label || \"رقم الحساب أو المحفظة\"}</FormLabel>\n                                    <FormControl>\n                                      <Input \n                                        {...field} \n                                        type={methodDetails?.inputType || \"text\"}\n                                        placeholder={methodDetails?.placeholder || \"مثال: 1234 5678 9012 3456\"} \n                                        className=\"rounded-xl\" \n                                        data-testid=\"input-account-number\" \n                                      />\n                                    </FormControl>\n                                    <FormDescription className=\"text-xs\">\n                                      {selectedPaymentMethod === \"التحويل البنكي\" && \"أدخل رقم الحساب البنكي الدولي (IBAN)\"}\n                                      {selectedPaymentMethod.includes(\"كاش\") && \"أدخل رقم هاتف المحفظة\"}\n                                    </FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                );\n                              }}\n                            />\n                          )}\n                          \n                          {selectedPaymentMethod === \"محفظة سُمُوّ\" && (\n                            <div className=\"p-4 bg-primary/10 rounded-xl border border-primary/20\">\n                              <p className=\"text-sm text-muted-foreground\">\n                                ℹ️ سيتم إنشاء محفظة سُمُوّ تلقائيًا لك عند إنشاء الحساب. يمكنك استخدامها لاستلام المدفوعات مباشرة في المنصة.\n                              </p>\n                            </div>\n                          )}\n                        </CardContent>\n                      </Card>\n\n                      <div className=\"flex items-start gap-2 p-4 bg-muted/30 rounded-xl\">\n                        <Checkbox id=\"terms\" data-testid=\"checkbox-terms\" />\n                        <label htmlFor=\"terms\" className=\"text-sm leading-relaxed cursor-pointer\">\n                          أوافق على{\" \"}\n                          <a href=\"#terms\" className=\"text-primary hover:underline\">الشروط والأحكام</a>\n                          {\" \"}و{\" \"}\n                          <a href=\"#privacy\" className=\"text-primary hover:underline\">سياسة الخصوصية</a>\n                        </label>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Navigation Buttons */}\n                  <div className=\"flex gap-3 pt-4\">\n                    {currentStep > 1 && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={handleBack}\n                        className=\"flex-1 rounded-2xl\"\n                        data-testid=\"button-back\"\n                      >\n                        <ArrowLeft className=\"ml-2 h-4 w-4\" />\n                        السابق\n                      </Button>\n                    )}\n                    <Button \n                      type=\"button\" \n                      onClick={handleNext}\n                      className=\"flex-1 rounded-2xl\"\n                      data-testid=\"button-next\"\n                      disabled={createFreelancerMutation.isPending}\n                    >\n                      {createFreelancerMutation.isPending ? \"جاري الإنشاء...\" : currentStep === 4 ? \"إنشاء الحساب\" : \"التالي\"}\n                      {currentStep < 4 && !createFreelancerMutation.isPending && <ArrowRight className=\"mr-2 h-4 w-4\" />}\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":31084},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useEffect } from \"react\";\nimport { initializeSocket, disconnectSocket } from \"@/lib/socket\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/Home\";\nimport RoleSelection from \"@/pages/RoleSelection\";\nimport FreelancerSignup from \"@/pages/FreelancerSignup\";\nimport ProductOwnerSignup from \"@/pages/ProductOwnerSignup\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport FreelancerDashboard from \"@/pages/FreelancerDashboard\";\nimport ProductOwnerDashboard from \"@/pages/ProductOwnerDashboard\";\nimport Login from \"@/pages/Login\";\nimport Campaigns from \"@/pages/Campaigns\";\nimport Freelancers from \"@/pages/Freelancers\";\nimport Profile from \"@/pages/Profile\";\nimport Groups from \"@/pages/Groups\";\nimport CreateGroup from \"@/pages/CreateGroup\";\nimport GroupDetails from \"@/pages/GroupDetails\";\nimport GroupCommunity from \"@/pages/GroupCommunity\";\nimport ChatWithLeader from \"@/pages/ChatWithLeader\";\nimport Projects from \"@/pages/Projects\";\nimport ProjectDetails from \"@/pages/ProjectDetails\";\nimport CreateProject from \"@/pages/CreateProject\";\nimport MyTasks from \"@/pages/MyTasks\";\nimport PurchaseService from \"@/pages/PurchaseService\";\nimport GroupLeaderDashboard from \"@/pages/GroupLeaderDashboard\";\nimport { FreelancerDashboardLayout } from \"@/components/FreelancerDashboardLayout\";\nimport FreelancerOverview from \"@/pages/freelancer-dashboard/Overview\";\nimport FreelancerGroups from \"@/pages/freelancer-dashboard/Groups\";\nimport AvailableTasks from \"@/pages/freelancer-dashboard/AvailableTasks\";\nimport MyTasksPage from \"@/pages/freelancer-dashboard/MyTasks\";\nimport WalletPage from \"@/pages/freelancer-dashboard/Wallet\";\nimport WithdrawalsPage from \"@/pages/freelancer-dashboard/Withdrawals\";\nimport OrdersPage from \"@/pages/freelancer-dashboard/Orders\";\nimport SettingsPage from \"@/pages/freelancer-dashboard/Settings\";\nimport FreelancerConversations from \"@/pages/freelancer-dashboard/Conversations\";\nimport FreelancerNotifications from \"@/pages/freelancer-dashboard/Notifications\";\nimport { ProductOwnerDashboardLayout } from \"@/components/ProductOwnerDashboardLayout\";\nimport ProductOwnerOverview from \"@/pages/product-owner-dashboard/Overview\";\nimport ProductOwnerProjects from \"@/pages/product-owner-dashboard/Projects\";\nimport ActiveProjects from \"@/pages/product-owner-dashboard/ActiveProjects\";\nimport CompletedProjects from \"@/pages/product-owner-dashboard/CompletedProjects\";\nimport ProductOwnerOrders from \"@/pages/product-owner-dashboard/Orders\";\nimport PaymentsPage from \"@/pages/product-owner-dashboard/Payments\";\nimport ProductOwnerSettings from \"@/pages/product-owner-dashboard/Settings\";\nimport ProductOwnerConversations from \"@/pages/product-owner-dashboard/Conversations\";\nimport ProductOwnerNotifications from \"@/pages/product-owner-dashboard/Notifications\";\nimport FreelancerInstructions from \"@/pages/FreelancerInstructions\";\nimport ProductOwnerInstructions from \"@/pages/ProductOwnerInstructions\";\nimport Services from \"@/pages/Services\";\nimport TermsConditions from \"@/pages/TermsConditions\";\nimport PrivacyPolicy from \"@/pages/PrivacyPolicy\";\nimport RefundPolicy from \"@/pages/RefundPolicy\";\nimport AdminLogin from \"@/pages/AdminLogin\";\nimport GroupChatPage from \"@/pages/GroupChatPage\";\nimport DirectChat from \"@/pages/DirectChat\";\nimport { AdminDashboardLayout } from \"@/components/AdminDashboardLayout\";\nimport AdminDashboard from \"@/pages/admin/Dashboard\";\nimport AdminUsers from \"@/pages/admin/Users\";\nimport CreateAdminUser from \"@/pages/admin/CreateUser\";\nimport AdminFreelancers from \"@/pages/admin/Freelancers\";\nimport AdminProductOwners from \"@/pages/admin/ProductOwners\";\nimport AdminGroups from \"@/pages/admin/Groups\";\nimport AdminOrders from \"@/pages/admin/Orders\";\nimport AdminWithdrawals from \"@/pages/admin/Withdrawals\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/services\" component={Services} />\n      <Route path=\"/terms-conditions\" component={TermsConditions} />\n      <Route path=\"/privacy-policy\" component={PrivacyPolicy} />\n      <Route path=\"/refund-policy\" component={RefundPolicy} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/role-selection\" component={RoleSelection} />\n      <Route path=\"/freelancer-signup\" component={FreelancerSignup} />\n      <Route path=\"/freelancer-instructions\" component={FreelancerInstructions} />\n      <Route path=\"/product-owner-signup\" component={ProductOwnerSignup} />\n      <Route path=\"/product-owner-instructions\" component={ProductOwnerInstructions} />\n      <Route path=\"/dashboard\" component={Dashboard} />\n\n      {/* Freelancer Dashboard with Sidebar */}\n      <Route path=\"/freelancer-dashboard\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerOverview />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/tasks/available\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <AvailableTasks />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/tasks/my-tasks\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <MyTasksPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/groups\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerGroups />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/wallet\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <WalletPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/withdrawals\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <WithdrawalsPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/orders\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <OrdersPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/conversations\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerConversations />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/settings\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <SettingsPage />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/freelancer-dashboard/notifications\">\n        {() => (\n          <FreelancerDashboardLayout>\n            <FreelancerNotifications />\n          </FreelancerDashboardLayout>\n        )}\n      </Route>\n\n      {/* Product Owner Dashboard with Sidebar */}\n      <Route path=\"/product-owner-dashboard\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerOverview />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects/active\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ActiveProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/projects/completed\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <CompletedProjects />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/payments\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <PaymentsPage />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/orders\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerOrders />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/settings\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerSettings />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/notifications\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerNotifications />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/product-owner-dashboard/conversations\">\n        {() => (\n          <ProductOwnerDashboardLayout>\n            <ProductOwnerConversations />\n          </ProductOwnerDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/profile\" component={Profile} />\n      <Route path=\"/campaigns\" component={Campaigns} />\n      <Route path=\"/freelancers\" component={Freelancers} />\n      <Route path=\"/groups\" component={Groups} />\n      <Route path=\"/groups/create\" component={CreateGroup} />\n      <Route path=\"/groups/:id/community\" component={GroupCommunity} />\n      <Route path=\"/groups/:id/chat\" component={GroupChatPage} />\n      <Route path=\"/chat/:userId\" component={DirectChat} />\n      <Route path=\"/groups/:id\" component={GroupDetails} />\n      <Route path=\"/groups/:id/dashboard\" component={GroupLeaderDashboard} />\n      <Route path=\"/purchase/:groupId\" component={PurchaseService} />\n      <Route path=\"/projects\" component={Projects} />\n      <Route path=\"/projects/create\" component={CreateProject} />\n      <Route path=\"/projects/:id\" component={ProjectDetails} />\n      <Route path=\"/my-tasks\" component={MyTasks} />\n\n      {/* Admin Dashboard Routes */}\n      <Route path=\"/admin/login\" component={AdminLogin} />\n      <Route path=\"/admin\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminDashboard />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/users\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminUsers />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/users/create\">\n        {() => (\n          <AdminDashboardLayout>\n            <CreateAdminUser />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/freelancers\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminFreelancers />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/product-owners\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminProductOwners />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/groups\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminGroups />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/orders\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminOrders />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n      <Route path=\"/admin/withdrawals\">\n        {() => (\n          <AdminDashboardLayout>\n            <AdminWithdrawals />\n          </AdminDashboardLayout>\n        )}\n      </Route>\n\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  // Initialize socket connection when user is logged in\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      const socket = initializeSocket(token);\n      \n      return () => {\n        disconnectSocket();\n      };\n    }\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":11974},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/Footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { Facebook, Twitter, Instagram, Linkedin, Mail, Phone, MapPin, ArrowLeft } from \"lucide-react\";\n\nexport function Footer() {\n  const currentYear = new Date().getFullYear();\n\n  return (\n    <footer className=\"bg-gradient-to-b from-gray-50/50 to-white border-t border-gray-200/50 mt-auto relative overflow-hidden\">\n      {/* Background Elements */}\n      <div className=\"absolute inset-0 -z-10\">\n        <div className=\"absolute bottom-0 left-10 w-64 h-64 bg-blue-200/20 rounded-full blur-3xl\"></div>\n        <div className=\"absolute bottom-0 right-10 w-64 h-64 bg-purple-200/20 rounded-full blur-3xl\"></div>\n        <div className=\"absolute top-10 left-1/2 transform -translate-x-1/2 w-32 h-32 bg-cyan-200/20 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-6 sm:px-8 lg:px-10 py-16\">\n        {/* Main Footer Content */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12 mb-12\">\n          {/* Brand & Description */}\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg\">\n                <div className=\"text-white font-bold text-lg\">س</div>\n              </div>\n              <div>\n                <div className=\"text-3xl font-bold bg-gradient-to-br from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n                  سُمُوّ\n                </div>\n                <div className=\"text-sm text-gray-500 -mt-1\">منصة العمل الحر</div>\n              </div>\n            </div>\n            \n            <p className=\"text-lg text-gray-700 leading-relaxed max-w-md\">\n              منصة رائدة تربط المستقلين المحترفين بأصحاب المنتجات الرقمية، \n              لنقدم معًا حلولاً إبداعية تلبي طموحاتك وتتجاوز توقعاتك.\n            </p>\n\n            {/* Contact Info */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-3 text-gray-600\">\n                <Mail className=\"h-4 w-4 text-blue-600\" />\n                <span className=\"text-sm\">info@somo.com</span>\n              </div>\n              <div className=\"flex items-center gap-3 text-gray-600\">\n                <Phone className=\"h-4 w-4 text-green-600\" />\n                <span className=\"text-sm\">+966 123 456 789</span>\n              </div>\n              <div className=\"flex items-center gap-3 text-gray-600\">\n                <MapPin className=\"h-4 w-4 text-red-600\" />\n                <span className=\"text-sm\">المملكة العربية السعودية</span>\n              </div>\n            </div>\n\n            {/* Social Media */}\n            <div className=\"flex items-center gap-4 pt-4\">\n              <a \n                href=\"#\" \n                className=\"w-10 h-10 bg-white border border-gray-300 rounded-2xl flex items-center justify-center hover:bg-blue-600 hover:border-blue-600 hover:text-white transition-all duration-300 group shadow-sm hover:shadow-lg\"\n              >\n                <Facebook className=\"h-4 w-4 group-hover:scale-110 transition-transform\" />\n              </a>\n              <a \n                href=\"#\" \n                className=\"w-10 h-10 bg-white border border-gray-300 rounded-2xl flex items-center justify-center hover:bg-sky-500 hover:border-sky-500 hover:text-white transition-all duration-300 group shadow-sm hover:shadow-lg\"\n              >\n                <Twitter className=\"h-4 w-4 group-hover:scale-110 transition-transform\" />\n              </a>\n              <a \n                href=\"#\" \n                className=\"w-10 h-10 bg-white border border-gray-300 rounded-2xl flex items-center justify-center hover:bg-pink-600 hover:border-pink-600 hover:text-white transition-all duration-300 group shadow-sm hover:shadow-lg\"\n              >\n                <Instagram className=\"h-4 w-4 group-hover:scale-110 transition-transform\" />\n              </a>\n              <a \n                href=\"#\" \n                className=\"w-10 h-10 bg-white border border-gray-300 rounded-2xl flex items-center justify-center hover:bg-blue-700 hover:border-blue-700 hover:text-white transition-all duration-300 group shadow-sm hover:shadow-lg\"\n              >\n                <Linkedin className=\"h-4 w-4 group-hover:scale-110 transition-transform\" />\n              </a>\n            </div>\n          </div>\n\n          {/* Links Grid */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-8\">\n            {/* Quick Links */}\n            <div>\n              <h3 className=\"font-bold text-gray-900 mb-6 text-lg relative inline-block\">\n                الروابط السريعة\n                <div className=\"absolute bottom-0 right-0 w-8 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full\"></div>\n              </h3>\n              <ul className=\"space-y-4\">\n                <li>\n                  <Link href=\"/\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-footer-home\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      الرئيسية\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/services\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-footer-services\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      الخدمات\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/projects\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      المشاريع\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/freelancers\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      المستقلين\n                    </span>\n                  </Link>\n                </li>\n              </ul>\n            </div>\n\n            {/* Legal */}\n            <div>\n              <h3 className=\"font-bold text-gray-900 mb-6 text-lg relative inline-block\">\n                قانوني\n                <div className=\"absolute bottom-0 right-0 w-8 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full\"></div>\n              </h3>\n              <ul className=\"space-y-4\">\n                <li>\n                  <Link href=\"/privacy-policy\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-privacy\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      سياسة الخصوصية\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/terms-conditions\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-terms\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      الشروط والأحكام\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/refund-policy\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-refund\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      سياسة الاسترداد\n                    </span>\n                  </Link>\n                </li>\n              </ul>\n            </div>\n\n            {/* Support */}\n            <div>\n              <h3 className=\"font-bold text-gray-900 mb-6 text-lg relative inline-block\">\n                الدعم\n                <div className=\"absolute bottom-0 right-0 w-8 h-0.5 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full\"></div>\n              </h3>\n              <ul className=\"space-y-4\">\n                <li>\n                  <Link href=\"/help\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-support\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      مركز المساعدة\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/contact\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\" data-testid=\"link-contact\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      تواصل معنا\n                    </span>\n                  </Link>\n                </li>\n                <li>\n                  <Link href=\"/faq\">\n                    <span className=\"text-gray-600 hover:text-blue-600 transition-all duration-300 cursor-pointer flex items-center gap-2 group text-sm font-medium\">\n                      <ArrowLeft className=\"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                      الأسئلة الشائعة\n                    </span>\n                  </Link>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n\n        {/* Bottom Section */}\n        <div className=\"pt-8 border-t border-gray-300/50\">\n          <div className=\"flex flex-col lg:flex-row justify-between items-center gap-6\">\n            {/* Copyright */}\n            <div className=\"text-center lg:text-right\">\n              <p className=\"text-gray-600 text-sm\">\n                © {currentYear} <span className=\"font-semibold text-gray-900\">سُمُوّ</span>. جميع الحقوق محفوظة.\n              </p>\n            </div>\n\n            {/* Additional Links */}\n            <div className=\"flex items-center gap-6 text-sm\">\n              <Link href=\"/sitemap\">\n                <span className=\"text-gray-500 hover:text-gray-700 transition-colors cursor-pointer text-xs font-medium\">\n                  خريطة الموقع\n                </span>\n              </Link>\n              <Link href=\"/accessibility\">\n                <span className=\"text-gray-500 hover:text-gray-700 transition-colors cursor-pointer text-xs font-medium\">\n                  إمكانية الوصول\n                </span>\n              </Link>\n              <Link href=\"/cookies\">\n                <span className=\"text-gray-500 hover:text-gray-700 transition-colors cursor-pointer text-xs font-medium\">\n                  سياسة الكوكيز\n                </span>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}","size_bytes":12098},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/pages/FreelancerDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from \"@/components/ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Task, Wallet, Order, Withdrawal } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\nimport { \n  Wallet as WalletIcon, \n  FileCheck, \n  TrendingUp, \n  Search, \n  Star, \n  Clock, \n  CheckCircle2,\n  AlertCircle,\n  Send,\n  Play,\n  ShoppingCart,\n  Calendar,\n  Package,\n  CreditCard,\n  Download,\n  Plus,\n  Sparkles,\n  Target,\n  Award,\n  BarChart3,\n  Zap,\n  ArrowUp,\n  DollarSign\n} from \"lucide-react\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\nexport default function FreelancerDashboard() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submissionText, setSubmissionText] = useState(\"\");\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\n  \n  // Withdrawal form state\n  const [showWithdrawalDialog, setShowWithdrawalDialog] = useState(false);\n  const [withdrawalAmount, setWithdrawalAmount] = useState(\"\");\n  const [withdrawalMethod, setWithdrawalMethod] = useState(\"\");\n  const [withdrawalAccount, setWithdrawalAccount] = useState(\"\");\n\n  // Fetch available tasks\n  const { data: availableTasks = [], isLoading: loadingAvailable } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/available\"],\n  });\n\n  // Fetch freelancer's tasks\n  const { data: myTasks = [], isLoading: loadingMyTasks } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  // Fetch wallet\n  const { data: wallet } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  // Fetch orders for groups led by this freelancer\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Fetch withdrawals\n  const { data: withdrawals = [], isLoading: loadingWithdrawals } = useQuery<Withdrawal[]>({\n    queryKey: [\"/api/withdrawals/my\"],\n  });\n\n  // Accept task mutation\n  const acceptTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest( `/api/tasks/${taskId}/accept`,\"POST\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/available\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم قبول المهمة بنجاح\",\n        description: \"يمكنك الآن البدء بالعمل على هذه المهمة\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء قبول المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Start task mutation\n  const startTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest( `/api/tasks/${taskId}/start`,\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم بدء المهمة\",\n        description: \"المهمة الآن قيد التنفيذ\",\n      });\n    },\n  });\n\n  // Submit task mutation\n  const submitTaskMutation = useMutation({\n    mutationFn: async ({ taskId, submission }: { taskId: string; submission: string }) => {\n      return apiRequest( `/api/tasks/${taskId}/submit`,\"PATCH\", { submission });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      setShowSubmitDialog(false);\n      setSubmissionText(\"\");\n      setSelectedTask(null);\n      toast({\n        title: \"تم تسليم المهمة بنجاح\",\n        description: \"سيتم مراجعة عملك من قبل صاحب المنتج\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تسليم المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAcceptTask = (task: Task) => {\n    acceptTaskMutation.mutate(task.id);\n  };\n\n  const handleStartTask = (task: Task) => {\n    startTaskMutation.mutate(task.id);\n  };\n\n  const handleSubmitTask = () => {\n    if (!selectedTask || !submissionText.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى كتابة التقرير\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    submitTaskMutation.mutate({\n      taskId: selectedTask.id,\n      submission: submissionText,\n    });\n  };\n\n  const openSubmitDialog = (task: Task) => {\n    setSelectedTask(task);\n    setSubmissionText(task.submission || \"\");\n    setShowSubmitDialog(true);\n  };\n\n  // Withdrawal mutation\n  const createWithdrawalMutation = useMutation({\n    mutationFn: async (data: { amount: number; paymentMethod: string; accountNumber: string }) => {\n      return apiRequest(\"/api/withdrawals\",\"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/withdrawals/my\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/wallet\"] });\n      setShowWithdrawalDialog(false);\n      setWithdrawalAmount(\"\");\n      setWithdrawalMethod(\"\");\n      setWithdrawalAccount(\"\");\n      toast({\n        title: \"تم إرسال طلب السحب\",\n        description: \"سيتم مراجعة طلبك ومعالجته في أقرب وقت\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء إنشاء طلب السحب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleWithdrawalSubmit = () => {\n    const amount = parseFloat(withdrawalAmount);\n    \n    if (!withdrawalAmount || amount <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال مبلغ صحيح\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalMethod) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار طريقة الدفع\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalAccount.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال رقم الحساب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const walletBalance = parseFloat(wallet?.balance || \"0\");\n    if (amount > walletBalance) {\n      toast({\n        title: \"خطأ\",\n        description: `الرصيد المتاح غير كافٍ. الرصيد الحالي: ${walletBalance} ر.س`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createWithdrawalMutation.mutate({\n      amount: Number(withdrawalAmount),\n      paymentMethod: withdrawalMethod,\n      accountNumber: withdrawalAccount,\n    });\n  };\n\n  // Filter available tasks\n  const filteredAvailableTasks = availableTasks.filter((task) =>\n    task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.serviceType.includes(searchQuery)\n  );\n\n  // Calculate stats\n  const completedTasks = myTasks.filter((t) => t.status === \"approved\").length;\n  const activeTasks = myTasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\").length;\n  const pendingTasks = myTasks.filter((t) => t.status === \"submitted\").length;\n  const totalOrders = orders.length;\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\").length;\n\n  const getStatusBadge = (status: string, taskId: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      available: { label: \"متاحة\", variant: \"outline\" },\n      assigned: { label: \"مقبولة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"تم التسليم\", variant: \"secondary\" },\n      approved: { label: \"موافق عليها\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n    \n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant} data-testid={`badge-status-${taskId}`}>{statusInfo.label}</Badge>;\n  };\n\n  const getOrderStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-order-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n          {/* Welcome Section with Gradient */}\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"mb-12 relative overflow-hidden rounded-3xl bg-gradient-to-br from-blue-600 via-purple-600 to-cyan-600 p-12 text-white shadow-2xl\"\n          >\n            <div className=\"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl\"></div>\n            <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-white/10 rounded-full blur-3xl\"></div>\n            \n            <div className=\"relative z-10\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <div className=\"p-3 bg-white/20 rounded-2xl backdrop-blur-sm\">\n                  <Sparkles className=\"h-6 w-6\" />\n                </div>\n                <Badge className=\"bg-white/20 text-white border-white/30 rounded-full px-4 py-1\">\n                  مستقل محترف\n                </Badge>\n              </div>\n              <h1 className=\"text-4xl font-bold mb-3\" data-testid=\"text-welcome\">\n                مرحباً بك في لوحة التحكم\n              </h1>\n              <p className=\"text-xl text-blue-100 max-w-2xl\">\n                ابدأ بتصفح المهام المتاحة واختر ما يناسب مهاراتك لتحقيق أرباح مجزية\n              </p>\n              \n              <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-6 mt-8\">\n                <div className=\"bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20\">\n                  <div className=\"flex items-center gap-3\">\n                    <Target className=\"h-8 w-8\" />\n                    <div>\n                      <div className=\"text-2xl font-bold\">{activeTasks}</div>\n                      <div className=\"text-sm text-blue-100\">مهمة نشطة</div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20\">\n                  <div className=\"flex items-center gap-3\">\n                    <Award className=\"h-8 w-8\" />\n                    <div>\n                      <div className=\"text-2xl font-bold\">{completedTasks}</div>\n                      <div className=\"text-sm text-blue-100\">مهمة مكتملة</div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20\">\n                  <div className=\"flex items-center gap-3\">\n                    <TrendingUp className=\"h-8 w-8\" />\n                    <div>\n                      <div className=\"text-2xl font-bold\">{wallet?.balance || \"0\"} ر.س</div>\n                      <div className=\"text-sm text-blue-100\">إجمالي الأرباح</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n\n          {/* Enhanced Stats Cards */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.1 }}\n            >\n              <Card className=\"rounded-3xl shadow-lg border-0 bg-gradient-to-br from-blue-50 to-white hover:shadow-xl transition-all duration-300 group\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">المهام النشطة</p>\n                      <p className=\"text-3xl font-bold text-blue-600\" data-testid=\"stat-active-tasks\">{activeTasks}</p>\n                      <div className=\"flex items-center gap-1 mt-2 text-xs text-green-600\">\n                        <ArrowUp className=\"h-3 w-3\" />\n                        <span>+12% هذا الشهر</span>\n                      </div>\n                    </div>\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                      <Clock className=\"h-8 w-8 text-white\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.2 }}\n            >\n              <Card className=\"rounded-3xl shadow-lg border-0 bg-gradient-to-br from-purple-50 to-white hover:shadow-xl transition-all duration-300 group\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">قيد المراجعة</p>\n                      <p className=\"text-3xl font-bold text-purple-600\" data-testid=\"stat-pending-tasks\">{pendingTasks}</p>\n                      <div className=\"flex items-center gap-1 mt-2 text-xs text-orange-600\">\n                        <Clock className=\"h-3 w-3\" />\n                        <span>انتظار الموافقة</span>\n                      </div>\n                    </div>\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                      <AlertCircle className=\"h-8 w-8 text-white\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.3 }}\n            >\n              <Card className=\"rounded-3xl shadow-lg border-0 bg-gradient-to-br from-green-50 to-white hover:shadow-xl transition-all duration-300 group\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">المكتملة</p>\n                      <p className=\"text-3xl font-bold text-green-600\" data-testid=\"stat-completed-tasks\">{completedTasks}</p>\n                      <div className=\"flex items-center gap-1 mt-2 text-xs text-green-600\">\n                        <Zap className=\"h-3 w-3\" />\n                        <span>معدل إنجاز 98%</span>\n                      </div>\n                    </div>\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                      <CheckCircle2 className=\"h-8 w-8 text-white\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.4 }}\n            >\n              <Card className=\"rounded-3xl shadow-lg border-0 bg-gradient-to-br from-cyan-50 to-white hover:shadow-xl transition-all duration-300 group\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">الأرباح</p>\n                      <p className=\"text-3xl font-bold text-cyan-600\" data-testid=\"stat-earnings\">\n                        {wallet?.balance || \"0\"} ر.س\n                      </p>\n                      <div className=\"flex items-center gap-1 mt-2 text-xs text-green-600\">\n                        <TrendingUp className=\"h-3 w-3\" />\n                        <span>+{wallet?.totalEarned || \"0\"} ر.س</span>\n                      </div>\n                    </div>\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform\">\n                      <WalletIcon className=\"h-8 w-8 text-white\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </motion.div>\n          </div>\n\n          {/* Tabs for Available Tasks, My Tasks, Orders, and Withdrawals */}\n          <Tabs defaultValue=\"orders\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-2 md:grid-cols-4 gap-2\" data-testid=\"tabs-tasks\">\n              <TabsTrigger value=\"orders\" data-testid=\"tab-orders\">\n                <ShoppingCart className=\"h-4 w-4 ml-2\" />\n                الطلبات ({totalOrders})\n              </TabsTrigger>\n              <TabsTrigger value=\"withdrawals\" data-testid=\"tab-withdrawals\">\n                <Download className=\"h-4 w-4 ml-2\" />\n                السحوبات ({withdrawals.length})\n              </TabsTrigger>\n              <TabsTrigger value=\"available\" data-testid=\"tab-available-tasks\">\n                المهام المتاحة ({filteredAvailableTasks.length})\n              </TabsTrigger>\n              <TabsTrigger value=\"my-tasks\" data-testid=\"tab-my-tasks\">\n                مهامي ({myTasks.length})\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Orders Tab */}\n            <TabsContent value=\"orders\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">الطلبات الواردة من أصحاب المنتجات</h2>\n\n              {orders.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Package className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض الطلبات الواردة من أصحاب المنتجات هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {orders.map((order) => (\n                    <Card key={order.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-order-${order.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{order.serviceType}</h3>\n                              {getOrderStatusBadge(order.status)}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">\n                              الكمية: {order.quantity} • السعر لكل وحدة: ${order.pricePerUnit}\n                            </p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <WalletIcon className=\"h-4 w-4\" />\n                                ${order.totalAmount}\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(order.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"bg-muted/50 rounded-xl p-4\">\n                          <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">طريقة الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                order.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                order.paymentMethod === 'orange_cash' ? 'أورانج كاش' : 'البطاقة البنكية'}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">بيانات الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentDetails}</p>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Withdrawals Tab */}\n            <TabsContent value=\"withdrawals\" className=\"space-y-4\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div>\n                  <h2 className=\"text-xl font-bold\">السحوبات والأرباح</h2>\n                  <p className=\"text-muted-foreground\">إدارة طلبات السحب وتتبع حالتها</p>\n                </div>\n                <Button \n                  onClick={() => setShowWithdrawalDialog(true)}\n                  className=\"rounded-xl\"\n                  data-testid=\"button-new-withdrawal\"\n                >\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  طلب سحب جديد\n                </Button>\n              </div>\n\n              {/* Wallet Balance Card */}\n              <Card className=\"rounded-2xl shadow-md bg-gradient-to-br from-primary/10 to-primary/5\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <p className=\"text-sm text-muted-foreground mb-1\">الرصيد المتاح</p>\n                      <p className=\"text-3xl font-bold text-primary\" data-testid=\"text-wallet-balance\">\n                        {wallet?.balance || \"0\"} ر.س\n                      </p>\n                      <p className=\"text-sm text-muted-foreground mt-2\">\n                        إجمالي الأرباح: {wallet?.totalEarned || \"0\"} ر.س\n                      </p>\n                    </div>\n                    <div className=\"w-16 h-16 bg-primary/20 rounded-2xl flex items-center justify-center\">\n                      <WalletIcon className=\"h-8 w-8 text-primary\" />\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Withdrawals List */}\n              {loadingWithdrawals ? (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {[1, 2].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-6 bg-muted rounded mb-2 w-1/3\"></div>\n                        <div className=\"h-4 bg-muted rounded w-1/2\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : withdrawals.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Download className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات سحب</h3>\n                    <p className=\"text-muted-foreground\">يمكنك إنشاء طلب سحب جديد للحصول على أرباحك</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {withdrawals.map((withdrawal) => (\n                    <Card key={withdrawal.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-withdrawal-${withdrawal.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{withdrawal.amount} ر.س</h3>\n                              <Badge \n                                variant={\n                                  withdrawal.status === \"completed\" ? \"default\" : \n                                  withdrawal.status === \"pending\" ? \"outline\" : \n                                  withdrawal.status === \"processing\" ? \"secondary\" : \"destructive\"\n                                }\n                                data-testid={`badge-withdrawal-status-${withdrawal.id}`}\n                              >\n                                {withdrawal.status === \"completed\" ? \"مكتمل\" : \n                                 withdrawal.status === \"pending\" ? \"قيد الانتظار\" : \n                                 withdrawal.status === \"processing\" ? \"قيد المعالجة\" : \"مرفوض\"}\n                              </Badge>\n                            </div>\n                            <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CreditCard className=\"h-4 w-4\" />\n                                {withdrawal.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                 withdrawal.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                 withdrawal.paymentMethod === 'orange_cash' ? 'أورانج كاش' : \n                                 withdrawal.paymentMethod === 'bank_card' ? 'البطاقة البنكية' : withdrawal.paymentMethod}\n                              </span>\n                              <span>{withdrawal.accountNumber}</span>\n                              <span className=\"flex items-center gap-1\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(withdrawal.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                            {withdrawal.notes && (\n                              <p className=\"text-sm text-muted-foreground mt-2 bg-muted/50 rounded-lg p-3\">\n                                <span className=\"font-semibold\">ملاحظات:</span> {withdrawal.notes}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Available Tasks Tab */}\n            <TabsContent value=\"available\" className=\"space-y-4\">\n              {/* Search */}\n              <div className=\"relative\">\n                <Search className=\"absolute right-3 top-3 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"ابحث عن مهام...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pr-9 rounded-xl\"\n                  data-testid=\"input-search-tasks\"\n                />\n              </div>\n\n              {loadingAvailable ? (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {[1, 2, 3].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                        <div className=\"h-3 bg-muted rounded mb-4\"></div>\n                        <div className=\"h-8 bg-muted rounded\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : filteredAvailableTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12\">\n                    <div className=\"text-center space-y-4\">\n                      <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto\">\n                        <FileCheck className=\"h-10 w-10 text-muted-foreground\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"text-no-tasks\">\n                          لا توجد مهام متاحة حالياً\n                        </h3>\n                        <p className=\"text-muted-foreground\">\n                          سنقوم بإشعارك عند توفر مهام جديدة مناسبة لمهاراتك\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {filteredAvailableTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-task-${task.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between gap-2 mb-2\">\n                          <CardTitle className=\"text-lg\" data-testid={`text-task-title-${task.id}`}>\n                            {task.title}\n                          </CardTitle>\n                          {getStatusBadge(task.status, task.id)}\n                        </div>\n                        <Badge variant=\"outline\" className=\"w-fit\" data-testid={`badge-service-${task.id}`}>\n                          {task.serviceType}\n                        </Badge>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        <p className=\"text-sm text-muted-foreground line-clamp-2\" data-testid={`text-task-description-${task.id}`}>\n                          {task.description}\n                        </p>\n                        <div className=\"flex items-center justify-between pt-2\">\n                          <div className=\"flex items-center gap-1\">\n                            <Star className=\"h-4 w-4 text-primary fill-primary\" />\n                            <span className=\"font-bold text-primary\" data-testid={`text-task-reward-${task.id}`}>\n                              {task.reward} ر.س\n                            </span>\n                          </div>\n                          <Button\n                            onClick={() => handleAcceptTask(task)}\n                            disabled={acceptTaskMutation.isPending}\n                            className=\"rounded-xl\"\n                            size=\"sm\"\n                            data-testid={`button-accept-task-${task.id}`}\n                          >\n                            قبول المهمة\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* My Tasks Tab */}\n            <TabsContent value=\"my-tasks\" className=\"space-y-4\">\n              {loadingMyTasks ? (\n                <div className=\"space-y-4\">\n                  {[1, 2].map((i) => (\n                    <Card key={i} className=\"rounded-2xl shadow-md animate-pulse\">\n                      <CardContent className=\"p-6\">\n                        <div className=\"h-4 bg-muted rounded mb-2\"></div>\n                        <div className=\"h-3 bg-muted rounded mb-4\"></div>\n                        <div className=\"h-8 bg-muted rounded\"></div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : myTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12\">\n                    <div className=\"text-center space-y-4\">\n                      <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto\">\n                        <FileCheck className=\"h-10 w-10 text-muted-foreground\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-lg mb-2\" data-testid=\"text-no-my-tasks\">\n                          ليس لديك مهام حالياً\n                        </h3>\n                        <p className=\"text-muted-foreground\">\n                          ابدأ بتصفح المهام المتاحة واختر ما يناسبك\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"space-y-4\">\n                  {myTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md\" data-testid={`card-my-task-${task.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between gap-2\">\n                          <div className=\"flex-1\">\n                            <CardTitle className=\"text-lg mb-2\" data-testid={`text-my-task-title-${task.id}`}>\n                              {task.title}\n                            </CardTitle>\n                            <CardDescription data-testid={`text-my-task-description-${task.id}`}>\n                              {task.description}\n                            </CardDescription>\n                          </div>\n                          {getStatusBadge(task.status, task.id)}\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-2\">\n                          <Badge variant=\"outline\" data-testid={`badge-my-task-service-${task.id}`}>\n                            {task.serviceType}\n                          </Badge>\n                          <span className=\"text-sm font-semibold text-primary\" data-testid={`text-my-task-reward-${task.id}`}>\n                            {task.reward} ر.س\n                          </span>\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        {task.submission && (\n                          <div className=\"p-4 bg-muted/50 rounded-xl\">\n                            <p className=\"text-sm font-semibold mb-1\">التقرير المقدم:</p>\n                            <p className=\"text-sm text-muted-foreground\" data-testid={`text-my-task-submission-${task.id}`}>\n                              {task.submission}\n                            </p>\n                          </div>\n                        )}\n                        {task.feedback && (\n                          <div className=\"p-4 bg-primary/5 rounded-xl border border-primary/20\">\n                            <p className=\"text-sm font-semibold mb-1 text-primary\">تعليق صاحب المنتج:</p>\n                            <p className=\"text-sm\" data-testid={`text-my-task-feedback-${task.id}`}>\n                              {task.feedback}\n                            </p>\n                          </div>\n                        )}\n                        <div className=\"flex items-center gap-2\">\n                          {task.status === \"assigned\" && (\n                            <Button\n                              onClick={() => handleStartTask(task)}\n                              disabled={startTaskMutation.isPending}\n                              variant=\"outline\"\n                              className=\"rounded-xl\"\n                              size=\"sm\"\n                              data-testid={`button-start-task-${task.id}`}\n                            >\n                              <Play className=\"h-4 w-4 ml-1\" />\n                              بدء العمل\n                            </Button>\n                          )}\n                          {(task.status === \"assigned\" || task.status === \"in_progress\") && (\n                            <Button\n                              onClick={() => openSubmitDialog(task)}\n                              className=\"rounded-xl\"\n                              size=\"sm\"\n                              data-testid={`button-submit-task-${task.id}`}\n                            >\n                              <Send className=\"h-4 w-4 ml-1\" />\n                              تسليم المهمة\n                            </Button>\n                          )}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n\n      {/* Submit Task Dialog */}\n      <Dialog open={showSubmitDialog} onOpenChange={setShowSubmitDialog}>\n        <DialogContent className=\"rounded-2xl\" data-testid=\"dialog-submit-task\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-submit-dialog-title\">تسليم المهمة</DialogTitle>\n            <DialogDescription data-testid=\"text-submit-dialog-description\">\n              قم بكتابة تقرير مفصل عن عملك في هذه المهمة\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-semibold mb-2 block\">التقرير</label>\n              <Textarea\n                value={submissionText}\n                onChange={(e) => setSubmissionText(e.target.value)}\n                placeholder=\"اكتب تقريرك هنا...\"\n                rows={8}\n                className=\"rounded-xl resize-none\"\n                data-testid=\"textarea-submission\"\n              />\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowSubmitDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-submit\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleSubmitTask}\n              disabled={submitTaskMutation.isPending || !submissionText.trim()}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-submit\"\n            >\n              <Send className=\"h-4 w-4 ml-1\" />\n              تسليم\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* New Withdrawal Dialog */}\n      <Dialog open={showWithdrawalDialog} onOpenChange={setShowWithdrawalDialog}>\n        <DialogContent className=\"rounded-2xl\" data-testid=\"dialog-new-withdrawal\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-withdrawal-dialog-title\">طلب سحب جديد</DialogTitle>\n            <DialogDescription data-testid=\"text-withdrawal-dialog-description\">\n              املأ البيانات المطلوبة لطلب سحب أرباحك\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"amount\">المبلغ (ر.س)</Label>\n              <Input\n                id=\"amount\"\n                type=\"number\"\n                value={withdrawalAmount}\n                onChange={(e) => setWithdrawalAmount(e.target.value)}\n                placeholder=\"أدخل المبلغ\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-amount\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                الرصيد المتاح: {wallet?.balance || \"0\"} ر.س\n              </p>\n            </div>\n\n            <div>\n              <Label htmlFor=\"payment-method\">طريقة الدفع</Label>\n              <Select value={withdrawalMethod} onValueChange={setWithdrawalMethod}>\n                <SelectTrigger className=\"rounded-xl mt-1\" data-testid=\"select-withdrawal-method\">\n                  <SelectValue placeholder=\"اختر طريقة الدفع\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"vodafone_cash\">فودافون كاش</SelectItem>\n                  <SelectItem value=\"etisalat_cash\">اتصالات كاش</SelectItem>\n                  <SelectItem value=\"orange_cash\">أورانج كاش</SelectItem>\n                  <SelectItem value=\"bank_card\">البطاقة البنكية</SelectItem>\n                  <SelectItem value=\"bank_transfer\">تحويل بنكي</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"account-number\">رقم الحساب / المحفظة</Label>\n              <Input\n                id=\"account-number\"\n                value={withdrawalAccount}\n                onChange={(e) => setWithdrawalAccount(e.target.value)}\n                placeholder=\"أدخل رقم الحساب\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-account\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                تأكد من صحة رقم الحساب لتجنب التأخير في التحويل\n              </p>\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowWithdrawalDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-withdrawal\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleWithdrawalSubmit}\n              disabled={createWithdrawalMutation.isPending}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-withdrawal\"\n            >\n              <Download className=\"h-4 w-4 ml-1\" />\n              إرسال الطلب\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":44780},"client/src/pages/ProductOwnerDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { \n  BarChart3, \n  Users, \n  Rocket, \n  Wallet, \n  Plus, \n  Eye,\n  CheckCircle,\n  XCircle,\n  Clock,\n  FileText,\n  TrendingUp,\n  Calendar,\n  ShoppingCart,\n  Package\n} from \"lucide-react\";\nimport type { Campaign, Task, Order } from \"@shared/schema\";\n\ninterface TaskWithCampaign extends Task {\n  campaign?: Campaign;\n}\n\nexport default function ProductOwnerDashboard() {\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<TaskWithCampaign | null>(null);\n  const [feedback, setFeedback] = useState(\"\");\n\n  // Fetch campaigns\n  const { data: campaigns = [], isLoading: campaignsLoading } = useQuery<Campaign[]>({\n    queryKey: [\"/api/campaigns\"],\n  });\n\n  // Fetch tasks for all campaigns\n  const { data: allTasks = [], isLoading: tasksLoading } = useQuery<TaskWithCampaign[]>({\n    queryKey: [\"/api/tasks/owner\"],\n    enabled: campaigns.length > 0,\n  });\n\n  // Fetch orders from direct purchase system\n  const { data: orders = [], isLoading: ordersLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Calculate statistics\n  const stats = {\n    activeCampaigns: campaigns.filter(c => c.status === \"active\").length,\n    totalTasks: allTasks.length,\n    submittedTasks: allTasks.filter(t => t.status === \"submitted\").length,\n    completedTasks: allTasks.filter(t => t.status === \"approved\").length,\n    totalSpent: campaigns.reduce((sum, c) => sum + Number(c.budget), 0),\n    totalOrders: orders.length,\n    pendingOrders: orders.filter(o => o.status === \"pending\").length,\n    completedOrders: orders.filter(o => o.status === \"completed\").length,\n    totalOrdersAmount: orders.reduce((sum, o) => sum + Number(o.totalAmount), 0),\n  };\n\n  // Approve task mutation\n  const approveTaskMutation = useMutation({\n    mutationFn: async ({ taskId, feedback }: { taskId: string; feedback: string }) => {\n      return await apiRequest( `/api/tasks/${taskId}/approve`,\"PATCH\", { feedback });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تمت الموافقة على المهمة\",\n        description: \"تم الموافقة على المهمة وإضافة المكافأة لمحفظة المستقل\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/owner\"] });\n      setSelectedTask(null);\n      setFeedback(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: error.message || \"فشلت الموافقة على المهمة\",\n      });\n    },\n  });\n\n  // Reject task mutation\n  const rejectTaskMutation = useMutation({\n    mutationFn: async ({ taskId, feedback }: { taskId: string; feedback: string }) => {\n      return await apiRequest( `/api/tasks/${taskId}/reject`,\"PATCH\", { feedback });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم رفض المهمة\",\n        description: \"تم رفض المهمة وإعادتها للمستقل\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/owner\"] });\n      setSelectedTask(null);\n      setFeedback(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: error.message || \"فشل رفض المهمة\",\n      });\n    },\n  });\n\n  const handleApprove = () => {\n    if (!selectedTask) return;\n    approveTaskMutation.mutate({ taskId: selectedTask.id, feedback });\n  };\n\n  const handleReject = () => {\n    if (!selectedTask || !feedback.trim()) {\n      toast({\n        variant: \"destructive\",\n        title: \"خطأ\",\n        description: \"يجب كتابة سبب الرفض\",\n      });\n      return;\n    }\n    rejectTaskMutation.mutate({ taskId: selectedTask.id, feedback });\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      available: { label: \"متاحة\", variant: \"outline\" },\n      assigned: { label: \"معينة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"مُسلّمة\", variant: \"default\" },\n      approved: { label: \"مقبولة\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  const getOrderStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n    };\n\n    const config = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return (\n      <Badge variant={config.variant} className=\"rounded-lg\" data-testid={`badge-order-status-${status}`}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  if (campaignsLoading || tasksLoading || ordersLoading) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n            <p className=\"mt-4 text-muted-foreground\">جاري التحميل...</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          {/* Welcome Section */}\n          <div className=\"mb-8\">\n            <div className=\"flex items-center gap-3 mb-2\">\n              <h1 className=\"text-3xl font-bold\" data-testid=\"text-owner-welcome\">\n                لوحة تحكم صاحب المنتج\n              </h1>\n              <Rocket className=\"h-8 w-8 text-primary\" />\n            </div>\n            <p className=\"text-lg text-muted-foreground\">\n              إدارة حملاتك ومراجعة المهام المُسلّمة\n            </p>\n          </div>\n\n          {/* Statistics Cards */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8\">\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-total-orders\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">إجمالي الطلبات</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.totalOrders}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <ShoppingCart className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-active-campaigns\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">الحملات النشطة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.activeCampaigns}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Rocket className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-submitted-tasks\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">مهام قيد المراجعة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-primary\">{stats.submittedTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Clock className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-completed-tasks\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">مهام مكتملة</p>\n                    <p className=\"text-3xl font-bold mt-1 text-green-600\">{stats.completedTasks}</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-green-500/10 rounded-xl flex items-center justify-center\">\n                    <CheckCircle className=\"h-6 w-6 text-green-600\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className=\"rounded-2xl shadow-md hover-elevate\" data-testid=\"stat-total-spent\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">إجمالي الميزانية</p>\n                    <p className=\"text-2xl font-bold mt-1\">{stats.totalSpent.toFixed(2)} ر.س</p>\n                  </div>\n                  <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n                    <Wallet className=\"h-6 w-6 text-primary\" />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <Tabs defaultValue=\"orders\" className=\"space-y-6\" data-testid=\"tabs-main\">\n            <TabsList className=\"bg-muted/50 p-1 rounded-2xl w-full sm:w-auto\">\n              <TabsTrigger value=\"orders\" className=\"rounded-xl\" data-testid=\"tab-orders\">\n                <ShoppingCart className=\"h-4 w-4 ml-2\" />\n                طلباتي ({stats.totalOrders})\n              </TabsTrigger>\n              <TabsTrigger value=\"submitted\" className=\"rounded-xl\" data-testid=\"tab-submitted\">\n                <Clock className=\"h-4 w-4 ml-2\" />\n                قيد المراجعة ({stats.submittedTasks})\n              </TabsTrigger>\n              <TabsTrigger value=\"campaigns\" className=\"rounded-xl\" data-testid=\"tab-campaigns\">\n                <BarChart3 className=\"h-4 w-4 ml-2\" />\n                جميع الحملات\n              </TabsTrigger>\n              <TabsTrigger value=\"all-tasks\" className=\"rounded-xl\" data-testid=\"tab-all-tasks\">\n                <FileText className=\"h-4 w-4 ml-2\" />\n                جميع المهام\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Orders Tab */}\n            <TabsContent value=\"orders\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">طلباتي من الجروبات</h2>\n\n              {orders.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Package className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد طلبات</h3>\n                    <p className=\"text-muted-foreground mb-4\">ابحث عن جروبات المطورين واطلب خدماتهم</p>\n                    <Button className=\"rounded-xl\" data-testid=\"button-browse-groups\">\n                      <Users className=\"h-4 w-4 ml-2\" />\n                      تصفح الجروبات\n                    </Button>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {orders.map((order) => (\n                    <Card key={order.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-order-${order.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{order.serviceType}</h3>\n                              {getOrderStatusBadge(order.status)}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">\n                              الكمية: {order.quantity} • السعر لكل وحدة: ${order.pricePerUnit}\n                            </p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                ${order.totalAmount}\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                {new Date(order.createdAt).toLocaleDateString('ar-SA')}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"bg-muted/50 rounded-xl p-4\">\n                          <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">طريقة الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentMethod === 'vodafone_cash' ? 'فودافون كاش' : \n                                order.paymentMethod === 'etisalat_cash' ? 'اتصالات كاش' :\n                                order.paymentMethod === 'orange_cash' ? 'أورانج كاش' : 'البطاقة البنكية'}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-muted-foreground mb-1\">بيانات الدفع:</p>\n                              <p className=\"font-semibold\">{order.paymentDetails}</p>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Submitted Tasks Tab */}\n            <TabsContent value=\"submitted\" className=\"space-y-4\">\n              {allTasks.filter(t => t.status === \"submitted\").length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Clock className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد مهام قيد المراجعة</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض المهام المُسلّمة من المستقلين هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {allTasks.filter(t => t.status === \"submitted\").map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-task-${task.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between mb-4\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{task.title}</h3>\n                              {getStatusBadge(task.status)}\n                              <Badge variant=\"outline\" className=\"rounded-lg\">{task.serviceType}</Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{task.description}</p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                {task.reward} ر.س\n                              </span>\n                              <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                <Calendar className=\"h-4 w-4\" />\n                                سُلّمت: {task.submittedAt ? new Date(task.submittedAt).toLocaleDateString('ar-SA') : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n\n                        {task.submission && (\n                          <div className=\"bg-muted/50 rounded-xl p-4 mb-4\">\n                            <p className=\"text-sm font-semibold mb-2\">تقرير المستقل:</p>\n                            <p className=\"text-sm whitespace-pre-wrap\">{task.submission}</p>\n                          </div>\n                        )}\n\n                        <div className=\"flex gap-2\">\n                          <Dialog>\n                            <DialogTrigger asChild>\n                              <Button \n                                size=\"sm\" \n                                className=\"rounded-xl flex-1\" \n                                onClick={() => setSelectedTask(task)}\n                                data-testid={`button-review-${task.id}`}\n                              >\n                                <Eye className=\"h-4 w-4 ml-2\" />\n                                مراجعة وتقييم\n                              </Button>\n                            </DialogTrigger>\n                            <DialogContent className=\"sm:max-w-[500px]\" data-testid=\"dialog-review-task\">\n                              <DialogHeader>\n                                <DialogTitle>مراجعة المهمة</DialogTitle>\n                                <DialogDescription>\n                                  قم بمراجعة التقرير وقرر الموافقة أو الرفض\n                                </DialogDescription>\n                              </DialogHeader>\n\n                              <div className=\"space-y-4\">\n                                <div>\n                                  <p className=\"text-sm font-semibold mb-1\">عنوان المهمة:</p>\n                                  <p className=\"text-sm\">{selectedTask?.title}</p>\n                                </div>\n\n                                <div>\n                                  <p className=\"text-sm font-semibold mb-1\">التقرير:</p>\n                                  <div className=\"bg-muted/50 rounded-lg p-3 max-h-48 overflow-y-auto\">\n                                    <p className=\"text-sm whitespace-pre-wrap\">{selectedTask?.submission}</p>\n                                  </div>\n                                </div>\n\n                                <div>\n                                  <label className=\"text-sm font-semibold mb-1 block\">\n                                    تعليقك (اختياري للموافقة، مطلوب للرفض)\n                                  </label>\n                                  <Textarea\n                                    placeholder=\"اكتب تعليقك هنا...\"\n                                    value={feedback}\n                                    onChange={(e) => setFeedback(e.target.value)}\n                                    className=\"rounded-xl min-h-[100px]\"\n                                    data-testid=\"textarea-feedback\"\n                                  />\n                                </div>\n\n                                <div className=\"flex gap-2\">\n                                  <Button\n                                    onClick={handleApprove}\n                                    disabled={approveTaskMutation.isPending}\n                                    className=\"flex-1 rounded-xl bg-green-600 hover:bg-green-700\"\n                                    data-testid=\"button-approve-task\"\n                                  >\n                                    <CheckCircle className=\"h-4 w-4 ml-2\" />\n                                    موافقة\n                                  </Button>\n                                  <Button\n                                    onClick={handleReject}\n                                    disabled={rejectTaskMutation.isPending}\n                                    variant=\"destructive\"\n                                    className=\"flex-1 rounded-xl\"\n                                    data-testid=\"button-reject-task\"\n                                  >\n                                    <XCircle className=\"h-4 w-4 ml-2\" />\n                                    رفض\n                                  </Button>\n                                </div>\n                              </div>\n                            </DialogContent>\n                          </Dialog>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Campaigns Tab */}\n            <TabsContent value=\"campaigns\" className=\"space-y-4\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">حملاتي</h2>\n                <Button className=\"rounded-xl\" data-testid=\"button-new-campaign\">\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  حملة جديدة\n                </Button>\n              </div>\n\n              {campaigns.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <Rocket className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد حملات بعد</h3>\n                    <p className=\"text-muted-foreground mb-4\">أنشئ أول حملة لاختبار منتجك</p>\n                    <Button className=\"rounded-xl\" data-testid=\"button-create-first-campaign\">\n                      <Plus className=\"h-4 w-4 ml-2\" />\n                      إنشاء حملة جديدة\n                    </Button>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {campaigns.map((campaign) => (\n                    <Card key={campaign.id} className=\"rounded-2xl shadow-md hover-elevate\" data-testid={`card-campaign-${campaign.id}`}>\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <CardTitle className=\"text-xl mb-2\">{campaign.title}</CardTitle>\n                            <p className=\"text-sm text-muted-foreground\">{campaign.description}</p>\n                          </div>\n                          {getStatusBadge(campaign.status)}\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm\">\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">الميزانية</p>\n                            <p className=\"font-bold text-primary\">{campaign.budget} ر.س</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">المختبرين المطلوبين</p>\n                            <p className=\"font-bold\">{campaign.testersNeeded}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">المُعيّنين</p>\n                            <p className=\"font-bold\">{campaign.testersAssigned}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-muted-foreground mb-1\">الباقة</p>\n                            <p className=\"font-bold\">{campaign.package}</p>\n                          </div>\n                        </div>\n                        <div className=\"flex gap-2 mt-4\">\n                          <Button size=\"sm\" variant=\"outline\" className=\"rounded-xl\" data-testid={`button-view-campaign-${campaign.id}`}>\n                            <Eye className=\"h-4 w-4 ml-2\" />\n                            عرض التفاصيل\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* All Tasks Tab */}\n            <TabsContent value=\"all-tasks\" className=\"space-y-4\">\n              <h2 className=\"text-xl font-bold mb-4\">جميع المهام</h2>\n\n              {allTasks.length === 0 ? (\n                <Card className=\"rounded-2xl shadow-md\">\n                  <CardContent className=\"p-12 text-center\">\n                    <FileText className=\"h-16 w-16 mx-auto mb-4 text-muted-foreground/50\" />\n                    <h3 className=\"text-xl font-bold mb-2\">لا توجد مهام</h3>\n                    <p className=\"text-muted-foreground\">سيتم عرض جميع المهام الخاصة بحملاتك هنا</p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {allTasks.map((task) => (\n                    <Card key={task.id} className=\"rounded-2xl shadow-md\" data-testid={`card-all-task-${task.id}`}>\n                      <CardContent className=\"p-6\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-3 mb-2\">\n                              <h3 className=\"text-lg font-bold\">{task.title}</h3>\n                              {getStatusBadge(task.status)}\n                              <Badge variant=\"outline\" className=\"rounded-lg\">{task.serviceType}</Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{task.description}</p>\n                            <div className=\"flex items-center gap-4 text-sm\">\n                              <span className=\"flex items-center gap-1 text-primary font-bold\">\n                                <Wallet className=\"h-4 w-4\" />\n                                {task.reward} ر.س\n                              </span>\n                              {task.submittedAt && (\n                                <span className=\"flex items-center gap-1 text-muted-foreground\">\n                                  <Calendar className=\"h-4 w-4\" />\n                                  {new Date(task.submittedAt).toLocaleDateString('ar-SA')}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":29065},"client/src/pages/PurchaseService.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useRoute, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { ArrowLeft, ShoppingCart, Check } from \"lucide-react\";\nimport type { Group } from \"@shared/schema\";\n\nconst SERVICE_TYPES = [\n  { value: \"google_play_reviews\", label: \"تقييم تطبيقات Google Play\", price: 1, isPerUnit: true },\n  { value: \"ios_reviews\", label: \"تقييم تطبيقات iOS\", price: 1, isPerUnit: true },\n  { value: \"website_reviews\", label: \"تقييم مواقع إلكترونية\", price: 1, isPerUnit: true },\n  { value: \"ux_testing\", label: \"اختبار تجربة المستخدم UX\", price: 1, isPerUnit: true },\n  { value: \"software_testing\", label: \"اختبار أنظمة Software\", price: 1, isPerUnit: true },\n  { value: \"social_media_single\", label: \"التفاعل مع السوشيال ميديا (حساب واحد شهرياً)\", price: 700, isPerUnit: false },\n  { value: \"social_media_dual\", label: \"التفاعل مع السوشيال ميديا (حسابين شهرياً)\", price: 1200, isPerUnit: false },\n  { value: \"google_maps\", label: \"تقييم خرائط Google Maps\", price: 2, isPerUnit: true },\n];\n\nconst PAYMENT_METHODS = [\n  { value: \"vodafone_cash\", label: \"فودافون كاش\", icon: \"📱\" },\n  { value: \"etisalat_cash\", label: \"اتصالات كاش\", icon: \"📱\" },\n  { value: \"orange_cash\", label: \"أورانج كاش\", icon: \"📱\" },\n  { value: \"bank_card\", label: \"بطاقة بنكية\", icon: \"💳\" },\n];\n\nexport default function PurchaseService() {\n  const [, params] = useRoute(\"/purchase/:groupId\");\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  \n  const [step, setStep] = useState(1);\n  const [serviceType, setServiceType] = useState(\"\");\n  const [quantity, setQuantity] = useState(1);\n  const [paymentMethod, setPaymentMethod] = useState(\"\");\n  const [paymentDetails, setPaymentDetails] = useState(\"\");\n\n  const groupId = params?.groupId;\n\n  // Check authentication and role\n  useEffect(() => {\n    const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n    const token = localStorage.getItem(\"token\");\n    const userType = localStorage.getItem(\"userType\");\n    \n    if (!currentUser || !token || userType !== \"product_owner\") {\n      toast({\n        title: \"غير مصرح\",\n        description: \"يجب تسجيل الدخول كصاحب منتج للوصول لهذه الصفحة\",\n        variant: \"destructive\",\n      });\n      navigate(\"/login\");\n    }\n  }, [navigate, toast]);\n\n  // Reset quantity to 1 when selecting a monthly subscription service\n  useEffect(() => {\n    const selectedService = SERVICE_TYPES.find(s => s.value === serviceType);\n    if (selectedService && !selectedService.isPerUnit) {\n      setQuantity(1);\n    }\n  }, [serviceType]);\n\n  // Fetch group details\n  const { data: group, isLoading } = useQuery<Group>({\n    queryKey: [\"/api/groups\", groupId],\n    enabled: !!groupId,\n  });\n\n  // Calculate total price\n  const selectedService = SERVICE_TYPES.find(s => s.value === serviceType);\n  const pricePerUnit = selectedService?.price || 0;\n  const isPerUnit = selectedService?.isPerUnit ?? true;\n  const totalAmount = isPerUnit ? pricePerUnit * quantity : pricePerUnit;\n\n  // Create order mutation\n  const createOrderMutation = useMutation({\n    mutationFn: async () => {\n      const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n      \n      return await apiRequest(\"/api/orders\",\"POST\", {\n        productOwnerId: currentUser?.id,\n        groupId: groupId,\n        serviceType,\n        quantity: isPerUnit ? quantity : 1, // For monthly services, quantity is always 1\n        pricePerUnit: pricePerUnit.toString(),\n        totalAmount: totalAmount.toString(),\n        paymentMethod,\n        paymentDetails,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/orders\"] });\n      toast({\n        title: \"تم إنشاء الطلب بنجاح\",\n        description: \"سيتم مراجعة طلبك والرد عليك قريباً\",\n      });\n      navigate(\"/product-owner-dashboard\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الطلب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = () => {\n    if (!serviceType || !quantity || !paymentMethod || !paymentDetails) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إكمال جميع الحقول\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createOrderMutation.mutate();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"text-center\">جاري التحميل...</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(\"/groups\")}\n            className=\"mb-4\"\n            data-testid=\"button-back-to-groups\"\n          >\n            <ArrowLeft className=\"ml-2 h-4 w-4\" />\n            العودة للجروبات\n          </Button>\n\n          <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n            شراء خدمة من {group?.name}\n          </h1>\n          <p className=\"text-muted-foreground\">\n            اختر الخدمة المطلوبة وقم بإكمال عملية الدفع\n          </p>\n        </div>\n\n        {/* Progress Steps */}\n        <div className=\"flex items-center justify-center mb-8\">\n          {[1, 2, 3].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div\n                className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                  step >= s ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\"\n                }`}\n              >\n                {step > s ? <Check className=\"h-5 w-5\" /> : s}\n              </div>\n              {s < 3 && <div className={`w-20 h-1 ${step > s ? \"bg-primary\" : \"bg-muted\"}`} />}\n            </div>\n          ))}\n        </div>\n\n        {/* Step 1: Select Service */}\n        {step === 1 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>اختر نوع الخدمة</CardTitle>\n              <CardDescription>حدد الخدمة التي تحتاجها من الجروب</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"service-type\">نوع الخدمة</Label>\n                <Select value={serviceType} onValueChange={setServiceType}>\n                  <SelectTrigger id=\"service-type\" data-testid=\"select-service-type\">\n                    <SelectValue placeholder=\"اختر نوع الخدمة\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {SERVICE_TYPES.map((service) => (\n                      <SelectItem key={service.value} value={service.value}>\n                        {service.label} - ${service.price} {service.isPerUnit ? \"لكل وحدة\" : \"شهرياً\"}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {isPerUnit && (\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"quantity\">عدد المراجعات / المهام</Label>\n                  <Input\n                    id=\"quantity\"\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"1000\"\n                    value={quantity}\n                    onChange={(e) => setQuantity(Math.max(1, Math.min(1000, parseInt(e.target.value) || 1)))}\n                    data-testid=\"input-quantity\"\n                  />\n                  <p className=\"text-sm text-muted-foreground\">\n                    (من 1 إلى 1000)\n                  </p>\n                </div>\n              )}\n\n              {serviceType && (\n                <div className=\"bg-muted p-4 rounded-lg\">\n                  {isPerUnit ? (\n                    <>\n                      <div className=\"flex justify-between mb-2\">\n                        <span>السعر لكل وحدة:</span>\n                        <span className=\"font-bold\">${pricePerUnit}</span>\n                      </div>\n                      <div className=\"flex justify-between mb-2\">\n                        <span>الكمية:</span>\n                        <span className=\"font-bold\">{quantity}</span>\n                      </div>\n                      <div className=\"border-t pt-2 mt-2\">\n                        <div className=\"flex justify-between text-lg\">\n                          <span className=\"font-bold\">الإجمالي:</span>\n                          <span className=\"font-bold text-primary\">${totalAmount}</span>\n                        </div>\n                      </div>\n                    </>\n                  ) : (\n                    <>\n                      <div className=\"flex justify-between mb-2\">\n                        <span>نوع الاشتراك:</span>\n                        <span className=\"font-bold\">شهري</span>\n                      </div>\n                      <div className=\"border-t pt-2 mt-2\">\n                        <div className=\"flex justify-between text-lg\">\n                          <span className=\"font-bold\">المبلغ الشهري:</span>\n                          <span className=\"font-bold text-primary\">${totalAmount}</span>\n                        </div>\n                      </div>\n                    </>\n                  )}\n                </div>\n              )}\n\n              <Button\n                className=\"w-full\"\n                onClick={() => setStep(2)}\n                disabled={!serviceType}\n                data-testid=\"button-next-step-1\"\n              >\n                التالي\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Step 2: Select Payment Method */}\n        {step === 2 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>اختر طريقة الدفع</CardTitle>\n              <CardDescription>حدد الطريقة التي تفضلها للدفع</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <RadioGroup value={paymentMethod} onValueChange={setPaymentMethod}>\n                {PAYMENT_METHODS.map((method) => (\n                  <div key={method.value} className=\"flex items-center space-x-2 space-x-reverse\">\n                    <RadioGroupItem\n                      value={method.value}\n                      id={method.value}\n                      data-testid={`radio-payment-${method.value}`}\n                    />\n                    <Label htmlFor={method.value} className=\"flex items-center gap-2 cursor-pointer flex-1\">\n                      <span className=\"text-2xl\">{method.icon}</span>\n                      <span>{method.label}</span>\n                    </Label>\n                  </div>\n                ))}\n              </RadioGroup>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setStep(1)}\n                  className=\"flex-1\"\n                  data-testid=\"button-back-step-2\"\n                >\n                  السابق\n                </Button>\n                <Button\n                  onClick={() => setStep(3)}\n                  disabled={!paymentMethod}\n                  className=\"flex-1\"\n                  data-testid=\"button-next-step-2\"\n                >\n                  التالي\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Step 3: Payment Details */}\n        {step === 3 && (\n          <Card>\n            <CardHeader>\n              <CardTitle>بيانات الدفع</CardTitle>\n              <CardDescription>أدخل بيانات الدفع لإتمام العملية</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"payment-details\">\n                  {paymentMethod === \"bank_card\" ? \"رقم البطاقة\" : \"رقم الهاتف\"}\n                </Label>\n                <Input\n                  id=\"payment-details\"\n                  type={paymentMethod === \"bank_card\" ? \"text\" : \"tel\"}\n                  placeholder={paymentMethod === \"bank_card\" ? \"XXXX-XXXX-XXXX-XXXX\" : \"01XXXXXXXXX\"}\n                  value={paymentDetails}\n                  onChange={(e) => setPaymentDetails(e.target.value)}\n                  data-testid=\"input-payment-details\"\n                />\n              </div>\n\n              <div className=\"bg-muted p-4 rounded-lg\">\n                <h4 className=\"font-bold mb-3\">ملخص الطلب</h4>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span>الخدمة:</span>\n                    <span>{SERVICE_TYPES.find(s => s.value === serviceType)?.label}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>الكمية:</span>\n                    <span>{quantity}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>طريقة الدفع:</span>\n                    <span>{PAYMENT_METHODS.find(p => p.value === paymentMethod)?.label}</span>\n                  </div>\n                  <div className=\"border-t pt-2 mt-2\">\n                    <div className=\"flex justify-between text-lg\">\n                      <span className=\"font-bold\">المبلغ الإجمالي:</span>\n                      <span className=\"font-bold text-primary\">${totalAmount}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setStep(2)}\n                  className=\"flex-1\"\n                  data-testid=\"button-back-step-3\"\n                >\n                  السابق\n                </Button>\n                <Button\n                  onClick={handleSubmit}\n                  disabled={!paymentDetails || createOrderMutation.isPending}\n                  className=\"flex-1\"\n                  data-testid=\"button-submit-order\"\n                >\n                  <ShoppingCart className=\"ml-2 h-4 w-4\" />\n                  {createOrderMutation.isPending ? \"جاري الإرسال...\" : \"تأكيد الطلب\"}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":15795},"client/src/pages/Profile.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  User, \n  Mail, \n  Phone, \n  Briefcase, \n  MapPin, \n  Calendar,\n  Star,\n  Award,\n  Settings,\n  Edit\n} from \"lucide-react\";\nimport type { Freelancer, ProductOwner } from \"@shared/schema\";\n\nexport default function Profile() {\n  const [, navigate] = useLocation();\n  const [userType, setUserType] = useState<string | null>(null);\n  const [user, setUser] = useState<any>(null);\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const type = localStorage.getItem(\"userType\");\n    const userData = localStorage.getItem(\"user\");\n\n    if (!token) {\n      navigate(\"/login\");\n      return;\n    }\n\n    setUserType(type);\n    if (userData) {\n      try {\n        setUser(JSON.parse(userData));\n      } catch (e) {\n        console.error(\"Error parsing user data:\", e);\n      }\n    }\n  }, [navigate]);\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <div className=\"flex-1 flex items-center justify-center\">\n          <div className=\"text-center max-w-md mx-auto p-6\">\n            <div className=\"w-20 h-20 bg-muted rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <User className=\"h-10 w-10 text-muted-foreground\" />\n            </div>\n            <h2 className=\"text-2xl font-bold mb-2\">لا توجد بيانات مستخدم</h2>\n            <p className=\"text-muted-foreground mb-6\">\n              لم نتمكن من تحميل بيانات ملفك الشخصي. يرجى تسجيل الدخول مرة أخرى.\n            </p>\n            <Button onClick={() => navigate(\"/login\")} className=\"rounded-2xl\">\n              تسجيل الدخول\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const getUserInitials = () => {\n    if (!user?.fullName) return \"م\";\n    const names = user.fullName.split(\" \");\n    if (names.length >= 2) {\n      return names[0][0] + names[1][0];\n    }\n    return names[0][0];\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-muted/20\">\n      <Navbar />\n\n      <div className=\"flex-1\">\n        <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n          {/* Header */}\n          <div className=\"mb-8\">\n            <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"text-profile-title\">\n              الملف الشخصي\n            </h1>\n            <p className=\"text-lg text-muted-foreground\">\n              عرض وتحديث معلوماتك الشخصية\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n            {/* Profile Card */}\n            <div className=\"lg:col-span-1\">\n              <Card className=\"rounded-2xl shadow-md\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex flex-col items-center text-center space-y-4\">\n                    <Avatar className=\"h-24 w-24\" data-testid=\"avatar-profile\">\n                      <AvatarImage src={user.profileImage} alt={user.fullName} />\n                      <AvatarFallback className=\"bg-primary/10 text-primary text-2xl font-bold\">\n                        {getUserInitials()}\n                      </AvatarFallback>\n                    </Avatar>\n\n                    <div className=\"space-y-1\">\n                      <h2 className=\"text-2xl font-bold\" data-testid=\"text-user-name\">\n                        {user.fullName}\n                      </h2>\n                      {user.username && (\n                        <p className=\"text-sm text-muted-foreground\" data-testid=\"text-username\">\n                          @{user.username}\n                        </p>\n                      )}\n                      <Badge variant=\"default\" className=\"mt-2\" data-testid=\"badge-user-type\">\n                        {userType === \"freelancer\" ? \"مستقل\" : \"صاحب منتج\"}\n                      </Badge>\n                    </div>\n\n                    {user.jobTitle && (\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\" data-testid=\"text-job-title\">\n                        <Briefcase className=\"h-4 w-4\" />\n                        {user.jobTitle}\n                      </div>\n                    )}\n\n                    <Button variant=\"outline\" className=\"w-full rounded-2xl mt-4\" data-testid=\"button-edit-profile\">\n                      <Edit className=\"ml-2 h-4 w-4\" />\n                      تعديل الملف الشخصي\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Quick Stats for Freelancer */}\n              {userType === \"freelancer\" && (\n                <Card className=\"rounded-2xl shadow-md mt-6\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg\">إحصائيات سريعة</CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Award className=\"h-5 w-5 text-primary\" />\n                        <span className=\"text-sm\">التقييم</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Star className=\"h-4 w-4 text-yellow-500 fill-yellow-500\" />\n                        <span className=\"font-semibold\">--</span>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm\">المهام المكتملة</span>\n                      <span className=\"font-semibold\" data-testid=\"stat-completed-tasks\">0</span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm\">إجمالي الأرباح</span>\n                      <span className=\"font-semibold text-green-600\">0 ر.س</span>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n\n            {/* Details Tabs */}\n            <div className=\"lg:col-span-2\">\n              <Card className=\"rounded-2xl shadow-md\">\n                <CardHeader>\n                  <CardTitle>تفاصيل الحساب</CardTitle>\n                  <CardDescription>المعلومات الشخصية وإعدادات الحساب</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Tabs defaultValue=\"personal\" className=\"w-full\">\n                    <TabsList className=\"grid w-full grid-cols-2 rounded-xl\">\n                      <TabsTrigger value=\"personal\" className=\"rounded-lg\" data-testid=\"tab-personal\">\n                        المعلومات الشخصية\n                      </TabsTrigger>\n                      <TabsTrigger value=\"account\" className=\"rounded-lg\" data-testid=\"tab-account\">\n                        إعدادات الحساب\n                      </TabsTrigger>\n                    </TabsList>\n\n                    <TabsContent value=\"personal\" className=\"space-y-4 mt-6\">\n                      {/* Email */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Mail className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">البريد الإلكتروني</p>\n                          <p className=\"text-base\" data-testid=\"text-email\">{user.email}</p>\n                        </div>\n                      </div>\n\n                      {/* Phone */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Phone className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">رقم الهاتف</p>\n                          <p className=\"text-base\" data-testid=\"text-phone\">\n                            {user.countryCode} {user.phone}\n                          </p>\n                        </div>\n                      </div>\n\n                      {/* Bio - Freelancer */}\n                      {userType === \"freelancer\" && user.bio && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <User className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">نبذة مختصرة</p>\n                            <p className=\"text-base\" data-testid=\"text-bio\">{user.bio}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* About Me - Freelancer */}\n                      {userType === \"freelancer\" && user.aboutMe && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <User className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">عني</p>\n                            <p className=\"text-base whitespace-pre-wrap\" data-testid=\"text-about-me\">\n                              {user.aboutMe}\n                            </p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Company Name - Product Owner */}\n                      {userType === \"product_owner\" && user.companyName && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">اسم الشركة</p>\n                            <p className=\"text-base\" data-testid=\"text-company-name\">{user.companyName}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Product Name - Product Owner */}\n                      {userType === \"product_owner\" && user.productName && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">اسم المنتج</p>\n                            <p className=\"text-base\" data-testid=\"text-product-name\">{user.productName}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Services */}\n                      {user.services && user.services.length > 0 && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Award className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground mb-2\">الخدمات</p>\n                            <div className=\"flex flex-wrap gap-2\" data-testid=\"container-services\">\n                              {user.services.map((service: string, index: number) => (\n                                <Badge key={index} variant=\"secondary\" className=\"rounded-lg\">\n                                  {service}\n                                </Badge>\n                              ))}\n                            </div>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Join Date */}\n                      <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                        <Calendar className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                        <div className=\"flex-1\">\n                          <p className=\"text-sm font-medium text-muted-foreground\">تاريخ الانضمام</p>\n                          <p className=\"text-base\" data-testid=\"text-join-date\">\n                            {user.createdAt ? new Date(user.createdAt).toLocaleDateString(\"ar-EG\", {\n                              year: \"numeric\",\n                              month: \"long\",\n                              day: \"numeric\"\n                            }) : \"غير متوفر\"}\n                          </p>\n                        </div>\n                      </div>\n                    </TabsContent>\n\n                    <TabsContent value=\"account\" className=\"space-y-4 mt-6\">\n                      {/* Payment Method - Freelancer */}\n                      {userType === \"freelancer\" && user.paymentMethod && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Briefcase className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">وسيلة الدفع</p>\n                            <p className=\"text-base\" data-testid=\"text-payment-method\">{user.paymentMethod}</p>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Verification Status - Freelancer */}\n                      {userType === \"freelancer\" && (\n                        <div className=\"flex items-start gap-4 p-4 rounded-xl border\">\n                          <Award className=\"h-5 w-5 text-muted-foreground mt-0.5\" />\n                          <div className=\"flex-1\">\n                            <p className=\"text-sm font-medium text-muted-foreground\">حالة التوثيق</p>\n                            <Badge \n                              variant={user.isVerified ? \"default\" : \"secondary\"} \n                              className=\"mt-1\"\n                              data-testid=\"badge-verified-status\"\n                            >\n                              {user.isVerified ? \"موثق\" : \"غير موثق\"}\n                            </Badge>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Settings Buttons */}\n                      <div className=\"space-y-3 pt-4\">\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" data-testid=\"button-change-password\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          تغيير كلمة المرور\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start\" data-testid=\"button-notifications\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          إعدادات الإشعارات\n                        </Button>\n                        <Button variant=\"outline\" className=\"w-full rounded-2xl justify-start text-destructive\" data-testid=\"button-delete-account\">\n                          <Settings className=\"ml-2 h-4 w-4\" />\n                          حذف الحساب\n                        </Button>\n                      </div>\n                    </TabsContent>\n                  </Tabs>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":16222},"client/src/pages/MyTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { CheckCircle2, Clock, FileText, Upload, Calendar, DollarSign } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function MyTasks() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submission, setSubmission] = useState(\"\");\n  const [proofImage, setProofImage] = useState(\"\");\n\n  // Fetch assigned tasks\n  const { data: tasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my/assigned\"],\n  });\n\n  // Start work mutation\n  const startWorkMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return await apiRequest(`/api/tasks/${taskId}/start-work`, \"PATCH\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my/assigned\"] });\n      toast({\n        title: \"تم بدء العمل\",\n        description: \"تم بدء العمل على المهمة بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء بدء العمل\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Submit task mutation\n  const submitTaskMutation = useMutation({\n    mutationFn: async ({ taskId, data }: { taskId: string; data: { submission: string; proofImage?: string } }) => {\n      return await apiRequest(`/api/tasks/${taskId}/submit-proof`, \"PATCH\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my/assigned\"] });\n      toast({\n        title: \"تم تسليم المهمة\",\n        description: \"تم تسليم المهمة بنجاح وهي الآن قيد المراجعة\",\n      });\n      setSelectedTask(null);\n      setSubmission(\"\");\n      setProofImage(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء تسليم المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmitTask = () => {\n    if (selectedTask && submission.trim()) {\n      submitTaskMutation.mutate({\n        taskId: selectedTask.id,\n        data: {\n          submission: submission.trim(),\n          proofImage: proofImage.trim() || undefined,\n        },\n      });\n    }\n  };\n\n  // Filter tasks by status\n  const assignedTasks = tasks.filter(t => t.status === \"assigned\");\n  const inProgressTasks = tasks.filter(t => t.status === \"in_progress\");\n  const submittedTasks = tasks.filter(t => t.status === \"submitted\");\n  const approvedTasks = tasks.filter(t => t.status === \"approved\");\n  const rejectedTasks = tasks.filter(t => t.status === \"rejected\");\n\n  const renderTaskCard = (task: Task) => (\n    <Card key={task.id} data-testid={`card-task-${task.id}`}>\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex-1\">\n            <CardTitle className=\"text-lg mb-2\">{task.title}</CardTitle>\n            <CardDescription className=\"line-clamp-2\">\n              {task.description}\n            </CardDescription>\n          </div>\n          <Badge variant={\n            task.status === \"assigned\" ? \"secondary\" :\n            task.status === \"in_progress\" ? \"default\" :\n            task.status === \"submitted\" ? \"outline\" :\n            task.status === \"approved\" ? \"default\" : \"destructive\"\n          }>\n            {task.status === \"assigned\" ? \"معينة\" :\n             task.status === \"in_progress\" ? \"جارية\" :\n             task.status === \"submitted\" ? \"مُسلّمة\" :\n             task.status === \"approved\" ? \"مُوافق عليها\" : \"مرفوضة\"}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <div className=\"flex items-center text-muted-foreground\">\n              <DollarSign className=\"ml-2 h-4 w-4\" />\n              المكافأة\n            </div>\n            <span className=\"font-semibold text-green-600\">{task.reward} ر.س</span>\n          </div>\n\n          {task.taskUrl && (\n            <div className=\"flex items-center justify-between text-sm\">\n              <div className=\"flex items-center text-muted-foreground\">\n                <FileText className=\"ml-2 h-4 w-4\" />\n                رابط المهمة\n              </div>\n              <a\n                href={task.taskUrl}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-primary hover:underline\"\n                onClick={(e) => e.stopPropagation()}\n              >\n                فتح الرابط\n              </a>\n            </div>\n          )}\n\n          {task.assignedAt && (\n            <div className=\"flex items-center justify-between text-sm\">\n              <div className=\"flex items-center text-muted-foreground\">\n                <Calendar className=\"ml-2 h-4 w-4\" />\n                تم التعيين\n              </div>\n              <span>{new Date(task.assignedAt).toLocaleDateString(\"ar\")}</span>\n            </div>\n          )}\n\n          {task.feedback && (\n            <div className=\"p-3 rounded-lg bg-muted/50 text-sm\">\n              <p className=\"font-semibold mb-1\">ملاحظات القائد:</p>\n              <p className=\"text-muted-foreground\">{task.feedback}</p>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          {task.status === \"assigned\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => startWorkMutation.mutate(task.id)}\n              disabled={startWorkMutation.isPending}\n              data-testid={`button-start-work-${task.id}`}\n            >\n              <Clock className=\"ml-2 h-4 w-4\" />\n              {startWorkMutation.isPending ? \"جاري البدء...\" : \"بدء العمل\"}\n            </Button>\n          )}\n\n          {task.status === \"in_progress\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => setSelectedTask(task)}\n              data-testid={`button-submit-task-${task.id}`}\n            >\n              <Upload className=\"ml-2 h-4 w-4\" />\n              تسليم المهمة\n            </Button>\n          )}\n\n          {task.status === \"rejected\" && (\n            <Button\n              className=\"w-full\"\n              onClick={() => setSelectedTask(task)}\n              data-testid={`button-resubmit-task-${task.id}`}\n            >\n              <Upload className=\"ml-2 h-4 w-4\" />\n              إعادة التسليم\n            </Button>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n            مهامي\n          </h1>\n          <p className=\"text-muted-foreground\">\n            تابع وأنجز مهامك المعينة\n          </p>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8\">\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">معينة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{assignedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">جارية</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{inProgressTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مُسلّمة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{submittedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مُوافق عليها</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\">{approvedTasks.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium\">مرفوضة</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-destructive\">{rejectedTasks.length}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tabs */}\n        <Tabs defaultValue=\"all\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            <TabsTrigger value=\"all\" data-testid=\"tab-all-tasks\">\n              الكل ({tasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"assigned\" data-testid=\"tab-assigned\">\n              معينة ({assignedTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"in_progress\" data-testid=\"tab-in-progress\">\n              جارية ({inProgressTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"submitted\" data-testid=\"tab-submitted\">\n              مُسلّمة ({submittedTasks.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"completed\" data-testid=\"tab-completed\">\n              مُكتملة ({approvedTasks.length})\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"all\" className=\"mt-6\">\n            {isLoading ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {[1, 2, 3].map((i) => (\n                  <Card key={i} className=\"animate-pulse\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"h-32 bg-muted rounded\" />\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : tasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">لا توجد مهام</h3>\n                  <p className=\"text-muted-foreground\">لم يتم تعيين أي مهام لك بعد</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {tasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"assigned\" className=\"mt-6\">\n            {assignedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام معينة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {assignedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"in_progress\" className=\"mt-6\">\n            {inProgressTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <Clock className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام جارية</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {inProgressTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"submitted\" className=\"mt-6\">\n            {submittedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <FileText className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام مُسلّمة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {submittedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"completed\" className=\"mt-6\">\n            {approvedTasks.length === 0 ? (\n              <Card>\n                <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                  <CheckCircle2 className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">لا توجد مهام مُكتملة</p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {approvedTasks.map(renderTaskCard)}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      {/* Submit Task Dialog */}\n      <Dialog open={!!selectedTask} onOpenChange={() => {\n        setSelectedTask(null);\n        setSubmission(\"\");\n        setProofImage(\"\");\n      }}>\n        <DialogContent className=\"max-w-2xl\" data-testid=\"dialog-submit-task\">\n          <DialogHeader>\n            <DialogTitle>تسليم المهمة</DialogTitle>\n            <DialogDescription>\n              قم بكتابة تقرير عن إنجاز المهمة وإرفاق صورة الإثبات\n            </DialogDescription>\n          </DialogHeader>\n\n          {selectedTask && (\n            <div className=\"space-y-4\">\n              <div className=\"p-4 rounded-lg bg-muted/50\">\n                <h3 className=\"font-semibold mb-1\">{selectedTask.title}</h3>\n                <p className=\"text-sm text-muted-foreground\">{selectedTask.description}</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">التقرير *</label>\n                <Textarea\n                  placeholder=\"اكتب تقرير مفصل عن كيفية إنجاز المهمة...\"\n                  className=\"resize-none min-h-[150px]\"\n                  value={submission}\n                  onChange={(e) => setSubmission(e.target.value)}\n                  data-testid=\"input-submission\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">رابط صورة الإثبات (اختياري)</label>\n                <Input\n                  type=\"url\"\n                  placeholder=\"https://example.com/proof-image.jpg\"\n                  value={proofImage}\n                  onChange={(e) => setProofImage(e.target.value)}\n                  data-testid=\"input-proof-image\"\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                  يمكنك رفع الصورة على خدمة مثل Imgur ووضع الرابط هنا\n                </p>\n              </div>\n            </div>\n          )}\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSelectedTask(null);\n                setSubmission(\"\");\n                setProofImage(\"\");\n              }}\n              data-testid=\"button-cancel-submit\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleSubmitTask}\n              disabled={!submission.trim() || submitTaskMutation.isPending}\n              data-testid=\"button-confirm-submit\"\n            >\n              {submitTaskMutation.isPending ? \"جاري التسليم...\" : \"تسليم المهمة\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17262},"client/src/pages/GroupDetails.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { \n  Users, \n  ArrowRight, \n  Crown, \n  UserMinus, \n  MessageCircle, \n  Briefcase, \n  CheckCircle2, \n  Clock, \n  MessageSquareText,\n  Star,\n  TrendingUp,\n  DollarSign,\n  Target,\n  Calendar,\n  MapPin,\n  BarChart3,\n  Award,\n  UserCheck,\n  UserPlus,\n  Mail,\n  Phone,\n  Shield,\n  Sparkles,\n  Zap,\n  Rocket,\n  ArrowUpRight,\n  Eye,\n  FileText,\n  Settings,\n  Palette\n} from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group, GroupMember, Project, Task, Freelancer } from \"@shared/schema\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { gsap } from \"gsap\";\nimport { ScrollTrigger } from \"gsap/ScrollTrigger\";\n\n// Register GSAP plugins\ngsap.registerPlugin(ScrollTrigger);\n\n// Animated section wrapper with GSAP\nfunction FadeInSection({ children, delay = 0 }: { children: React.ReactNode; delay?: number }) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      gsap.fromTo(element, \n        { \n          opacity: 0, \n          y: 60,\n          scale: 0.95\n        },\n        { \n          opacity: 1, \n          y: 0,\n          scale: 1,\n          duration: 0.8,\n          delay,\n          ease: \"power2.out\",\n          scrollTrigger: {\n            trigger: element,\n            start: \"top 80%\",\n            end: \"bottom 20%\",\n            toggleActions: \"play none none reverse\"\n          }\n        }\n      );\n    }\n  }, [delay]);\n\n  return (\n    <div ref={ref} className=\"opacity-0\">\n      {children}\n    </div>\n  );\n}\n\n// Professional gradient background component\nfunction GradientBackground() {\n  return (\n    <div className=\"absolute inset-0 overflow-hidden\">\n      <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute top-60 -left-40 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute -bottom-40 right-1/4 w-72 h-72 bg-emerald-500/10 rounded-full blur-3xl\"></div>\n    </div>\n  );\n}\n\nexport default function GroupDetails() {\n  const params = useParams();\n  const groupId = params.id as string;\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [memberToRemove, setMemberToRemove] = useState<string | null>(null);\n  const [user, setUser] = useState<any>(() => {\n    const userData = localStorage.getItem(\"user\");\n    return userData ? JSON.parse(userData) : null;\n  });\n\n  // Fetch group details with enhanced data\n  const { data: group, isLoading: groupLoading } = useQuery({\n    queryKey: [\"/api/groups\", groupId],\n    queryFn: async () => {\n      const response = await apiRequest(`/api/groups/${groupId}`, \"GET\");\n      return response.json();\n    },\n  });\n\n  // Fetch group members with enhanced data\n  const { data: members = [], isLoading: membersLoading } = useQuery<(GroupMember & { freelancer: Freelancer })[]>({\n    queryKey: [\"/api/groups\", groupId, \"members\"],\n    queryFn: async () => {\n      const response = await apiRequest(`/api/groups/${groupId}/members`, \"GET\");\n      return response.json();\n    },\n  });\n\n  // Fetch group projects\n  const { data: projects = [] } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/group\", groupId],\n  });\n\n  // Fetch group tasks\n  const { data: tasks = [] } = useQuery<Task[]>({\n    queryKey: [\"/api/groups\", groupId, \"tasks\"],\n  });\n\n  // Check if current user is the leader\n  const isLeader = user && group && user.userId === group.leaderId;\n\n  // Check if current user is product owner\n  const userType = localStorage.getItem(\"userType\");\n  const isProductOwner = userType === \"product_owner\";\n\n  // Check if current user is freelancer\n  const isFreelancer = userType === \"freelancer\";\n\n  // Check if user is member of this group\n  const isMember = group?.isMember || false;\n\n  // Calculate additional stats\n  const completedTasks = tasks.filter(t => t.status === \"approved\").length;\n  const inProgressTasks = tasks.filter(t => t.status === \"in_progress\").length;\n  const successRate = group?.totalProjects ? Math.round((group.completedProjects / group.totalProjects) * 100) : 0;\n\n  // Join group mutation\n  const joinGroupMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/groups/${groupId}/join`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId, \"members\"] });\n      toast({\n        title: \"تم الانضمام بنجاح\",\n        description: \"تم انضمامك للجروب بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء الانضمام للجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Leave group mutation\n  const leaveGroupMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/groups/${groupId}/leave`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId, \"members\"] });\n      toast({\n        title: \"تم المغادرة بنجاح\",\n        description: \"تم مغادرة الجروب بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء مغادرة الجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Remove member mutation\n  const removeMemberMutation = useMutation({\n    mutationFn: async (freelancerId: string) => {\n      return await apiRequest(`/api/groups/${groupId}/members/${freelancerId}`, \"DELETE\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId, \"members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\", groupId] });\n      toast({\n        title: \"تم الإزالة بنجاح\",\n        description: \"تم إزالة العضو من الجروب\",\n      });\n      setMemberToRemove(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إزالة العضو\",\n        variant: \"destructive\",\n      });\n      setMemberToRemove(null);\n    },\n  });\n\n  // Navigate to chat page\n  const handleStartConversation = () => {\n    navigate(`/groups/${groupId}/chat`);\n  };\n\n  // Render stars for rating\n  const renderStars = (rating: number) => {\n    const stars = [];\n    const fullStars = Math.floor(rating);\n    const hasHalfStar = rating % 1 >= 0.5;\n\n    for (let i = 0; i < fullStars; i++) {\n      stars.push(<Star key={i} className=\"h-4 w-4 fill-yellow-400 text-yellow-500\" />);\n    }\n\n    if (hasHalfStar) {\n      stars.push(<Star key=\"half\" className=\"h-4 w-4 fill-yellow-400 text-yellow-500\" />);\n    }\n\n    const emptyStars = 5 - stars.length;\n    for (let i = 0; i < emptyStars; i++) {\n      stars.push(<Star key={`empty-${i}`} className=\"h-4 w-4 text-gray-300\" />);\n    }\n\n    return stars;\n  };\n\n  // Format last seen time\n  const formatLastSeen = (lastSeen: string) => {\n    const now = new Date();\n    const lastSeenDate = new Date(lastSeen);\n    const diffInHours = Math.floor((now.getTime() - lastSeenDate.getTime()) / (1000 * 60 * 60));\n    \n    if (diffInHours < 1) return \"أونلاين الآن\";\n    if (diffInHours < 24) return `منذ ${diffInHours} ساعة`;\n    if (diffInHours < 168) return `منذ ${Math.floor(diffInHours / 24)} يوم`;\n    return `منذ ${Math.floor(diffInHours / 168)} أسبوع`;\n  };\n\n  if (groupLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n          <Card className=\"animate-pulse border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg\">\n            <CardHeader>\n              <div className=\"h-8 bg-gray-200 rounded w-1/3 mb-4\" />\n              <div className=\"h-4 bg-gray-200 rounded w-2/3\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-64 bg-gray-200 rounded-2xl\" />\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  if (!group) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n          <Card className=\"border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg overflow-hidden\">\n            <CardContent className=\"flex flex-col items-center justify-center py-20\">\n              <div className=\"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6 shadow-lg\">\n                <Users className=\"h-12 w-12 text-blue-600\" />\n              </div>\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-3\">الجروب غير موجود</h3>\n              <p className=\"text-gray-600 text-lg text-center mb-8 max-w-md\">\n                لم يتم العثور على هذا الجروب أو قد تم إزالته\n              </p>\n              <motion.div\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n              >\n                <Button \n                  onClick={() => navigate(\"/groups\")}\n                  className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-6 rounded-2xl font-semibold shadow-xl hover:shadow-2xl transition-all duration-300\"\n                >\n                  <ArrowRight className=\"ml-3 h-5 w-5\" />\n                  العودة للجروبات\n                  <Rocket className=\"mr-2 h-5 w-5\" />\n                </Button>\n              </motion.div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        {/* Enhanced Back Button */}\n        <motion.div\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          className=\"mb-8\"\n        >\n          <Button\n            variant=\"ghost\"\n            onClick={() => navigate(\"/groups\")}\n            className=\"hover:bg-white/80 backdrop-blur-sm rounded-2xl px-6 py-3 text-gray-600 hover:text-gray-900 transition-all duration-300 group\"\n          >\n            <ArrowRight className=\"ml-2 h-5 w-5 group-hover:-translate-x-1 transition-transform\" />\n            العودة للجروبات\n          </Button>\n        </motion.div>\n\n        {/* Enhanced Group Header */}\n        <FadeInSection delay={0.1}>\n          <Card className=\"mb-8 border-0 rounded-2xl shadow-lg overflow-hidden bg-white/80 backdrop-blur-sm hover:shadow-xl transition-all duration-300\">\n            {/* Enhanced Group Image with Gradient Overlay */}\n            {group.groupImage && (\n              <div className=\"relative w-full h-80 overflow-hidden bg-gradient-to-br from-blue-500 via-blue-600 to-purple-600\">\n                <img\n                  src={group.groupImage}\n                  alt={group.name}\n                  className=\"w-full h-full object-cover opacity-90\"\n                  onError={(e) => {\n                    e.currentTarget.parentElement!.style.display = 'none';\n                  }}\n                />\n                <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent\" />\n                \n                {/* Enhanced Header Content Overlay */}\n                <div className=\"absolute bottom-8 left-8 right-8 text-white\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-4 mb-4\">\n                        <h1 className=\"text-4xl font-bold\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                          {group.name}\n                        </h1>\n                        <div className=\"flex items-center gap-2\">\n                          <Badge className=\"bg-white/20 text-white border-0 backdrop-blur-sm px-3 py-1.5 rounded-full\">\n                            {group.status === \"active\" ? \"نشط\" : \"غير نشط\"}\n                          </Badge>\n                          {isLeader && (\n                            <Badge className=\"bg-gradient-to-r from-yellow-500 to-orange-500 text-white border-0 gap-2 px-3 py-1.5 rounded-full shadow-lg\">\n                              <Crown className=\"h-4 w-4\" />\n                              أنت القائد\n                            </Badge>\n                          )}\n                        </div>\n                      </div>\n                      <p className=\"text-white/90 text-xl max-w-3xl leading-relaxed\">\n                        {group.description || \"لا يوجد وصف للجروب حالياً\"}\n                      </p>\n                    </div>\n\n                    <div className=\"flex flex-col gap-3 min-w-max\">\n                      {/* Show community button only if user is a member */}\n                      {!isProductOwner && isMember && (\n                        <motion.div\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                        >\n                          <Button\n                            onClick={() => navigate(`/groups/${groupId}/community`)}\n                            className=\"bg-white/20 hover:bg-white/30 text-white border-white/30 backdrop-blur-sm rounded-2xl px-6 py-4 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                            data-testid=\"button-community\"\n                          >\n                            <MessageSquareText className=\"ml-3 h-5 w-5\" />\n                            مجتمع المجموعة\n                            <ArrowUpRight className=\"mr-2 h-5 w-5\" />\n                          </Button>\n                        </motion.div>\n                      )}\n                      \n                      {/* Show join button if user is freelancer and not a member */}\n                      {isFreelancer && !isMember && group.status === \"active\" && group.currentMembers < group.maxMembers && (\n                        <motion.div\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                        >\n                          <Button\n                            onClick={() => joinGroupMutation.mutate()}\n                            disabled={joinGroupMutation.isPending}\n                            className=\"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-2xl px-6 py-4 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                            data-testid=\"button-join-group\"\n                          >\n                            <UserPlus className=\"ml-3 h-5 w-5\" />\n                            {joinGroupMutation.isPending ? \"جاري الانضمام...\" : \"انضم للجروب\"}\n                            <Rocket className=\"mr-2 h-5 w-5\" />\n                          </Button>\n                        </motion.div>\n                      )}\n                      \n                      {isProductOwner && (\n                        <motion.div\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                        >\n                          <Button\n                            onClick={handleStartConversation}\n                            className=\"bg-white text-blue-600 hover:bg-gray-100 rounded-2xl px-6 py-4 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                            data-testid=\"button-start-conversation\"\n                          >\n                            <MessageCircle className=\"ml-3 h-5 w-5\" />\n                            ابدأ محادثة\n                            <ArrowUpRight className=\"mr-2 h-5 w-5\" />\n                          </Button>\n                        </motion.div>\n                      )}\n                      \n                      {/* Show leave button only if user is a member and not the leader */}\n                      {isFreelancer && isMember && !isLeader && (\n                        <motion.div\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                        >\n                          <Button\n                            variant=\"outline\"\n                            onClick={() => leaveGroupMutation.mutate()}\n                            disabled={leaveGroupMutation.isPending}\n                            className=\"border-2 border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300 rounded-2xl px-6 py-4 font-semibold shadow-sm hover:shadow-md transition-all duration-300\"\n                            data-testid=\"button-leave-group\"\n                          >\n                            {leaveGroupMutation.isPending ? \"جاري المغادرة...\" : \"مغادرة الجروب\"}\n                          </Button>\n                        </motion.div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Enhanced Stats Grid */}\n            <CardContent className=\"p-8\">\n              <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6\">\n                {/* Members */}\n                <FadeInSection delay={0.2}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl border border-blue-200 hover:shadow-lg transition-all duration-300 group\">\n                    <Users className=\"h-10 w-10 text-blue-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">{group.currentMembers}</p>\n                    <p className=\"text-sm font-semibold text-gray-700\">الأعضاء</p>\n                    <p className=\"text-xs text-gray-500 mt-1\">{group.maxMembers} كحد أقصى</p>\n                  </div>\n                </FadeInSection>\n\n                {/* Total Projects */}\n                <FadeInSection delay={0.25}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-2xl border border-green-200 hover:shadow-lg transition-all duration-300 group\">\n                    <Briefcase className=\"h-10 w-10 text-green-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">{group.totalProjects || 0}</p>\n                    <p className=\"text-sm font-semibold text-gray-700\">المشاريع</p>\n                  </div>\n                </FadeInSection>\n\n                {/* Completed Projects */}\n                <FadeInSection delay={0.3}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-2xl border border-emerald-200 hover:shadow-lg transition-all duration-300 group\">\n                    <CheckCircle2 className=\"h-10 w-10 text-emerald-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">{group.completedProjects || 0}</p>\n                    <p className=\"text-sm font-semibold text-gray-700\">مكتملة</p>\n                  </div>\n                </FadeInSection>\n\n                {/* In Progress Projects */}\n                <FadeInSection delay={0.35}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-amber-50 to-amber-100 rounded-2xl border border-amber-200 hover:shadow-lg transition-all duration-300 group\">\n                    <Clock className=\"h-10 w-10 text-amber-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">{group.inProgressProjects || 0}</p>\n                    <p className=\"text-sm font-semibold text-gray-700\">جارية</p>\n                  </div>\n                </FadeInSection>\n\n                {/* Success Rate */}\n                <FadeInSection delay={0.4}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl border border-purple-200 hover:shadow-lg transition-all duration-300 group\">\n                    <TrendingUp className=\"h-10 w-10 text-purple-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">{successRate}%</p>\n                    <p className=\"text-sm font-semibold text-gray-700\">معدل النجاح</p>\n                  </div>\n                </FadeInSection>\n\n                {/* Rating */}\n                <FadeInSection delay={0.45}>\n                  <div className=\"text-center p-6 bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl border border-orange-200 hover:shadow-lg transition-all duration-300 group\">\n                    <Star className=\"h-10 w-10 text-orange-600 mx-auto mb-3 group-hover:scale-110 transition-transform\" />\n                    <p className=\"text-3xl font-bold text-gray-900\">\n                      {parseFloat(group.averageRating) > 0 ? parseFloat(group.averageRating).toFixed(1) : \"0.0\"}\n                    </p>\n                    <p className=\"text-sm font-semibold text-gray-700\">التقييم</p>\n                    <div className=\"flex justify-center gap-0.5 mt-2\">\n                      {renderStars(parseFloat(group.averageRating) || 0)}\n                    </div>\n                  </div>\n                </FadeInSection>\n              </div>\n\n              {/* Enhanced Additional Info Row */}\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8 pt-8 border-t border-gray-200\">\n                <div className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl border border-blue-100\">\n                  <div className=\"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center\">\n                    <Crown className=\"h-6 w-6 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">القائد</p>\n                    <p className=\"font-semibold text-gray-900\">{group.leaderName}</p>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl border border-green-100\">\n                  <div className=\"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center\">\n                    <Calendar className=\"h-6 w-6 text-white\" />\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">تاريخ الإنشاء</p>\n                    <p className=\"font-semibold text-gray-900\">{new Date(group.createdAt).toLocaleDateString('ar-EG')}</p>\n                  </div>\n                </div>\n\n                {group.totalRevenue > 0 && (\n                  <div className=\"flex items-center gap-4 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl border border-yellow-100\">\n                    <div className=\"w-12 h-12 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center\">\n                      <DollarSign className=\"h-6 w-6 text-white\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-gray-600\">إجمالي الإيرادات</p>\n                      <p className=\"font-semibold text-gray-900\">{group.totalRevenue} ر.س</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </FadeInSection>\n\n        {/* Enhanced Tabs */}\n        <FadeInSection delay={0.5}>\n          <Tabs defaultValue=\"members\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-3 bg-white/80 backdrop-blur-sm border border-gray-200 p-2 rounded-2xl shadow-lg\">\n              <TabsTrigger \n                value=\"members\" \n                className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white rounded-xl py-4 font-semibold transition-all duration-300\"\n                data-testid=\"tab-members\"\n              >\n                <Users className=\"ml-3 h-5 w-5\" />\n                الأعضاء ({members.length})\n              </TabsTrigger>\n              <TabsTrigger \n                value=\"projects\" \n                className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white rounded-xl py-4 font-semibold transition-all duration-300\"\n                data-testid=\"tab-projects\"\n              >\n                <Briefcase className=\"ml-3 h-5 w-5\" />\n                المشاريع ({projects.length})\n              </TabsTrigger>\n              <TabsTrigger \n                value=\"tasks\" \n                className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white rounded-xl py-4 font-semibold transition-all duration-300\"\n                data-testid=\"tab-tasks\"\n              >\n                <Target className=\"ml-3 h-5 w-5\" />\n                المهام ({tasks.length})\n              </TabsTrigger>\n            </TabsList>\n\n            {/* Enhanced Members Tab */}\n            <TabsContent value=\"members\" className=\"mt-8\">\n              {membersLoading ? (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {[1, 2, 3, 4, 5, 6].map((i) => (\n                    <Card key={i} className=\"animate-pulse border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg\">\n                      <CardContent className=\"pt-6 p-6\">\n                        <div className=\"h-32 bg-gray-200 rounded-2xl\" />\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : members.length === 0 ? (\n                <Card className=\"border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg overflow-hidden\">\n                  <CardContent className=\"flex flex-col items-center justify-center py-16\">\n                    <div className=\"w-20 h-20 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6 shadow-lg\">\n                      <Users className=\"h-10 w-10 text-blue-600\" />\n                    </div>\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-3\">لا يوجد أعضاء</h3>\n                    <p className=\"text-gray-600 text-lg text-center max-w-md\">\n                      لا يوجد أعضاء في الجروب حالياً. كن أول من ينضم لهذا الجروب المحترف!\n                    </p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {members.map((member, index) => (\n                    <FadeInSection key={member.id} delay={index * 0.1}>\n                      <motion.div\n                        whileHover={{ y: -5, scale: 1.02 }}\n                        className=\"group\"\n                      >\n                        <Card \n                          className=\"border-0 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 bg-white/80 backdrop-blur-sm overflow-hidden\"\n                          data-testid={`card-member-${member.freelancerId}`}\n                        >\n                          <CardContent className=\"pt-6 p-6\">\n                            <div className=\"flex items-start justify-between mb-5\">\n                              <div className=\"flex items-center gap-4\">\n                                <Avatar className=\"h-14 w-14 border-2 border-white shadow-lg ring-2 ring-blue-100\">\n                                  <AvatarImage src={member.freelancer?.profileImage || \"\"} />\n                                  <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-bold text-lg\">\n                                    {member.freelancer?.fullName?.charAt(0) || \"U\"}\n                                  </AvatarFallback>\n                                </Avatar>\n                                <div>\n                                  <div className=\"flex items-center gap-2\">\n                                    <h4 className=\"font-bold text-gray-900 text-lg\">{member.freelancer?.fullName || \"مستخدم\"}</h4>\n                                    {member.freelancer?.isVerified && (\n                                      <Shield className=\"h-4 w-4 text-green-600\" title=\"مستخدم موثوق\" />\n                                    )}\n                                  </div>\n                                  <p className=\"text-sm text-gray-600\">\n                                    {member.freelancer?.username || \"@user\"}\n                                  </p>\n                                  {member.freelancer?.jobTitle && (\n                                    <p className=\"text-xs text-blue-600 font-semibold bg-blue-50 px-2 py-1 rounded-full mt-1\">\n                                      {member.freelancer.jobTitle}\n                                    </p>\n                                  )}\n                                </div>\n                              </div>\n\n                              {member.role === \"leader\" ? (\n                                <div className=\"flex items-center gap-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-3 py-1.5 rounded-full text-sm font-semibold shadow-lg\">\n                                  <Crown className=\"h-4 w-4\" />\n                                  قائد\n                                </div>\n                              ) : (\n                                <Badge className=\"bg-gradient-to-r from-gray-500 to-gray-600 text-white border-0 px-3 py-1.5 rounded-full text-sm font-semibold shadow-sm\">\n                                  عضو\n                                </Badge>\n                              )}\n                            </div>\n\n                            {/* Enhanced Member Details */}\n                            <div className=\"space-y-3 text-sm text-gray-600 mb-5\">\n                              {member.freelancer?.bio && (\n                                <p className=\"text-sm text-gray-700 line-clamp-2 leading-relaxed bg-gray-50 p-3 rounded-xl\">\n                                  {member.freelancer.bio}\n                                </p>\n                              )}\n                              \n                              {member.freelancer?.services && member.freelancer.services.length > 0 && (\n                                <div className=\"flex flex-wrap gap-2\">\n                                  {member.freelancer.services.slice(0, 3).map((service, index) => (\n                                    <span key={index} className=\"text-xs bg-gradient-to-r from-blue-50 to-purple-50 text-blue-700 px-3 py-1.5 rounded-full border border-blue-200 font-medium\">\n                                      {service}\n                                    </span>\n                                  ))}\n                                  {member.freelancer.services.length > 3 && (\n                                    <span className=\"text-xs text-blue-600 bg-blue-50 px-2 py-1.5 rounded-full border border-blue-200 font-medium\">\n                                      +{member.freelancer.services.length - 3}\n                                    </span>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n\n                            <div className=\"space-y-3 text-sm text-gray-600 border-t border-gray-100 pt-4\">\n                              <div className=\"flex justify-between items-center\">\n                                <span className=\"text-gray-600\">انضم في:</span>\n                                <span className=\"font-semibold text-gray-900\">{new Date(member.joinedAt).toLocaleDateString(\"ar-EG\")}</span>\n                              </div>\n                              {member.freelancer?.lastSeen && (\n                                <div className=\"flex justify-between items-center\">\n                                  <span className=\"text-gray-600\">الحالة:</span>\n                                  <span className={`font-semibold ${\n                                    new Date().getTime() - new Date(member.freelancer.lastSeen).getTime() < 300000 \n                                      ? \"text-green-600\" \n                                      : \"text-gray-500\"\n                                  }`}>\n                                    {formatLastSeen(member.freelancer.lastSeen)}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n\n                            {isLeader && member.role !== \"leader\" && (\n                              <motion.div\n                                whileHover={{ scale: 1.05 }}\n                                whileTap={{ scale: 0.95 }}\n                                className=\"mt-5\"\n                              >\n                                <Button\n                                  variant=\"outline\"\n                                  size=\"sm\"\n                                  className=\"w-full border-2 border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300 rounded-xl py-3 font-semibold transition-all duration-300\"\n                                  onClick={() => setMemberToRemove(member.freelancerId)}\n                                  data-testid={`button-remove-member-${member.freelancerId}`}\n                                >\n                                  <UserMinus className=\"ml-2 h-4 w-4\" />\n                                  إزالة من الجروب\n                                </Button>\n                              </motion.div>\n                            )}\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    </FadeInSection>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Enhanced Projects Tab */}\n            <TabsContent value=\"projects\" className=\"mt-8\">\n              {projects.length === 0 ? (\n                <Card className=\"border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg overflow-hidden\">\n                  <CardContent className=\"flex flex-col items-center justify-center py-16\">\n                    <div className=\"w-20 h-20 bg-gradient-to-br from-green-100 to-blue-100 rounded-full flex items-center justify-center mb-6 shadow-lg\">\n                      <Briefcase className=\"h-10 w-10 text-green-600\" />\n                    </div>\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-3\">لا توجد مشاريع</h3>\n                    <p className=\"text-gray-600 text-lg text-center max-w-md\">\n                      لا يوجد مشاريع مرتبطة بهذا الجروب حالياً\n                    </p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {projects.map((project, index) => (\n                    <FadeInSection key={project.id} delay={index * 0.1}>\n                      <motion.div\n                        whileHover={{ y: -5, scale: 1.02 }}\n                        className=\"group\"\n                      >\n                        <Card className=\"border-0 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 bg-white/80 backdrop-blur-sm overflow-hidden\">\n                          <div className=\"h-2 bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600\" />\n                          <CardHeader className=\"pb-4\">\n                            <div className=\"flex items-start justify-between mb-3\">\n                              <div className=\"flex-1\">\n                                <CardTitle className=\"text-xl font-bold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors\">\n                                  {project.title}\n                                </CardTitle>\n                                <CardDescription className=\"text-gray-600 leading-relaxed line-clamp-2\">\n                                  {project.description}\n                                </CardDescription>\n                              </div>\n                              <Badge className={\n                                project.status === \"completed\" \n                                  ? \"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0 px-3 py-1.5 rounded-full shadow-sm\"\n                                  : project.status === \"in_progress\"\n                                  ? \"bg-gradient-to-r from-blue-500 to-cyan-600 text-white border-0 px-3 py-1.5 rounded-full shadow-sm\"\n                                  : \"bg-gradient-to-r from-gray-400 to-gray-500 text-white border-0 px-3 py-1.5 rounded-full shadow-sm\"\n                              }>\n                                {project.status === \"completed\" ? \"مكتمل\" : project.status === \"in_progress\" ? \"جاري\" : \"معلق\"}\n                              </Badge>\n                            </div>\n                          </CardHeader>\n                          <CardContent className=\"space-y-4\">\n                            <div className=\"grid grid-cols-2 gap-4\">\n                              <div className=\"flex items-center gap-3 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-100\">\n                                <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center\">\n                                  <DollarSign className=\"h-5 w-5 text-white\" />\n                                </div>\n                                <div>\n                                  <p className=\"text-xs text-gray-600\">الميزانية</p>\n                                  <p className=\"font-bold text-gray-900\">{project.budget} ر.س</p>\n                                </div>\n                              </div>\n                              <div className=\"flex items-center gap-3 p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100\">\n                                <div className=\"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg flex items-center justify-center\">\n                                  <Target className=\"h-5 w-5 text-white\" />\n                                </div>\n                                <div>\n                                  <p className=\"text-xs text-gray-600\">المهام</p>\n                                  <p className=\"font-bold text-gray-900\">{project.tasksCount}</p>\n                                </div>\n                              </div>\n                            </div>\n\n                            {project.deadline && (\n                              <div className=\"flex items-center justify-between p-3 bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl border border-orange-100\">\n                                <div className=\"flex items-center gap-3\">\n                                  <div className=\"w-10 h-10 bg-gradient-to-r from-orange-500 to-yellow-600 rounded-lg flex items-center justify-center\">\n                                    <Calendar className=\"h-5 w-5 text-white\" />\n                                  </div>\n                                  <div>\n                                    <p className=\"text-xs text-gray-600\">الموعد النهائي</p>\n                                    <p className=\"font-semibold text-gray-900\">{new Date(project.deadline).toLocaleDateString('ar-EG')}</p>\n                                  </div>\n                                </div>\n                              </div>\n                            )}\n\n                            <div className=\"flex items-center justify-between pt-3 border-t border-gray-100\">\n                              <span className=\"text-sm text-gray-600\">تاريخ الإنشاء</span>\n                              <span className=\"text-sm font-semibold text-gray-900\">{new Date(project.createdAt).toLocaleDateString('ar-EG')}</span>\n                            </div>\n\n                            <motion.div\n                              whileHover={{ scale: 1.05 }}\n                              whileTap={{ scale: 0.95 }}\n                            >\n                              <Button\n                                onClick={() => navigate(`/projects/${project.id}`)}\n                                className=\"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl py-3 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                              >\n                                <Eye className=\"ml-2 h-5 w-5\" />\n                                عرض التفاصيل\n                                <ArrowUpRight className=\"mr-2 h-5 w-5\" />\n                              </Button>\n                            </motion.div>\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    </FadeInSection>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n\n            {/* Enhanced Tasks Tab */}\n            <TabsContent value=\"tasks\" className=\"mt-8\">\n              {tasks.length === 0 ? (\n                <Card className=\"border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg overflow-hidden\">\n                  <CardContent className=\"flex flex-col items-center justify-center py-16\">\n                    <div className=\"w-20 h-20 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full flex items-center justify-center mb-6 shadow-lg\">\n                      <Target className=\"h-10 w-10 text-purple-600\" />\n                    </div>\n                    <h3 className=\"text-xl font-bold text-gray-900 mb-3\">لا توجد مهام</h3>\n                    <p className=\"text-gray-600 text-lg text-center max-w-md\">\n                      لا يوجد مهام مرتبطة بهذا الجروب حالياً\n                    </p>\n                  </CardContent>\n                </Card>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {tasks.map((task, index) => (\n                    <FadeInSection key={task.id} delay={index * 0.1}>\n                      <motion.div\n                        whileHover={{ y: -5, scale: 1.02 }}\n                        className=\"group\"\n                      >\n                        <Card className=\"border-0 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 bg-white/80 backdrop-blur-sm overflow-hidden\">\n                          <div className={\n                            task.status === \"approved\" \n                              ? \"h-2 bg-gradient-to-r from-green-500 to-emerald-600\"\n                              : task.status === \"in_progress\"\n                              ? \"h-2 bg-gradient-to-r from-blue-500 to-cyan-600\"\n                              : task.status === \"submitted\"\n                              ? \"h-2 bg-gradient-to-r from-orange-500 to-yellow-600\"\n                              : \"h-2 bg-gradient-to-r from-gray-400 to-gray-500\"\n                          } />\n                          <CardHeader className=\"pb-3\">\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex-1\">\n                                <CardTitle className=\"text-lg font-bold text-gray-900 mb-1 group-hover:text-blue-600 transition-colors\">\n                                  {task.title}\n                                </CardTitle>\n                                <CardDescription className=\"text-sm text-gray-600 leading-relaxed line-clamp-2\">\n                                  {task.description}\n                                </CardDescription>\n                              </div>\n                            </div>\n                            <Badge className={\n                              task.status === \"approved\" \n                                ? \"bg-gradient-to-r from-green-500 to-emerald-600 text-white border-0 px-3 py-1 rounded-full shadow-sm w-fit\"\n                                : task.status === \"in_progress\"\n                                ? \"bg-gradient-to-r from-blue-500 to-cyan-600 text-white border-0 px-3 py-1 rounded-full shadow-sm w-fit\"\n                                : task.status === \"submitted\"\n                                ? \"bg-gradient-to-r from-orange-500 to-yellow-600 text-white border-0 px-3 py-1 rounded-full shadow-sm w-fit\"\n                                : \"bg-gradient-to-r from-gray-400 to-gray-500 text-white border-0 px-3 py-1 rounded-full shadow-sm w-fit\"\n                            }>\n                              {task.status === \"approved\" ? \"معتمدة\" : task.status === \"in_progress\" ? \"قيد التنفيذ\" : task.status === \"submitted\" ? \"مقدمة\" : \"متاحة\"}\n                            </Badge>\n                          </CardHeader>\n                          <CardContent className=\"space-y-3\">\n                            <div className=\"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-100\">\n                              <div className=\"flex items-center gap-3\">\n                                <div className=\"w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-lg flex items-center justify-center\">\n                                  <Award className=\"h-5 w-5 text-white\" />\n                                </div>\n                                <div>\n                                  <p className=\"text-xs text-gray-600\">المكافأة</p>\n                                  <p className=\"font-bold text-gray-900\">{task.reward} ر.س</p>\n                                </div>\n                              </div>\n                              {task.rating && task.rating > 0 && (\n                                <div className=\"flex items-center gap-1\">\n                                  <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-500\" />\n                                  <span className=\"font-semibold text-gray-900\">{task.rating}</span>\n                                </div>\n                              )}\n                            </div>\n\n                            {task.deadline && (\n                              <div className=\"flex items-center gap-3 p-3 bg-gradient-to-r from-orange-50 to-yellow-50 rounded-xl border border-orange-100\">\n                                <div className=\"w-10 h-10 bg-gradient-to-r from-orange-500 to-yellow-600 rounded-lg flex items-center justify-center\">\n                                  <Clock className=\"h-5 w-5 text-white\" />\n                                </div>\n                                <div>\n                                  <p className=\"text-xs text-gray-600\">الموعد النهائي</p>\n                                  <p className=\"font-semibold text-gray-900 text-sm\">{new Date(task.deadline).toLocaleDateString('ar-EG')}</p>\n                                </div>\n                              </div>\n                            )}\n\n                            {task.serviceType && (\n                              <div className=\"flex items-center gap-2 p-2 bg-blue-50 rounded-lg border border-blue-100\">\n                                <Palette className=\"h-4 w-4 text-blue-600\" />\n                                <span className=\"text-sm text-blue-700 font-medium\">{task.serviceType}</span>\n                              </div>\n                            )}\n\n                            <div className=\"flex items-center justify-between pt-2 border-t border-gray-100\">\n                              <span className=\"text-xs text-gray-600\">تاريخ الإنشاء</span>\n                              <span className=\"text-xs font-semibold text-gray-900\">{new Date(task.createdAt).toLocaleDateString('ar-EG')}</span>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    </FadeInSection>\n                  ))}\n                </div>\n              )}\n            </TabsContent>\n          </Tabs>\n        </FadeInSection>\n      </div>\n\n      {/* Enhanced Remove Member Dialog */}\n      <AlertDialog open={!!memberToRemove} onOpenChange={() => setMemberToRemove(null)}>\n        <AlertDialogContent className=\"border-0 rounded-2xl shadow-2xl bg-white/95 backdrop-blur-sm\">\n          <AlertDialogHeader className=\"text-center pb-4\">\n            <div className=\"w-16 h-16 bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <UserMinus className=\"h-8 w-8 text-white\" />\n            </div>\n            <AlertDialogTitle className=\"text-xl font-bold text-gray-900\">تأكيد إزالة العضو</AlertDialogTitle>\n            <AlertDialogDescription className=\"text-gray-600 text-lg leading-relaxed\">\n              هل أنت متأكد من إزالة هذا العضو من الجروب؟ هذا الإجراء لا يمكن التراجع عنه وقد يؤثر على سير العمل في المشاريع الجارية.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter className=\"flex gap-3\">\n            <AlertDialogCancel \n              className=\"flex-1 border-2 border-gray-300 text-gray-700 hover:bg-gray-50 rounded-xl py-3 font-semibold transition-all duration-300\"\n              data-testid=\"button-cancel-remove\"\n            >\n              إلغاء\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => memberToRemove && removeMemberMutation.mutate(memberToRemove)}\n              className=\"flex-1 bg-gradient-to-r from-red-500 to-pink-600 text-white hover:from-red-600 hover:to-pink-700 rounded-xl py-3 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n              data-testid=\"button-confirm-remove\"\n            >\n              {removeMemberMutation.isPending ? \"جاري الإزالة...\" : \"تأكيد الإزالة\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}","size_bytes":52272},"client/src/pages/Groups.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { \n  Users, \n  Search, \n  UserPlus, \n  Crown, \n  TrendingUp, \n  MessageCircle, \n  ShoppingCart, \n  Image as ImageIcon,\n  Star,\n  StarHalf,\n  MapPin,\n  Calendar,\n  CheckCircle,\n  Eye,\n  Building,\n  Filter,\n  Sparkles,\n  Zap,\n  Target,\n  Rocket,\n  ArrowRight,\n  ArrowUpRight,\n  Shield,\n  Award,\n  Lock,\n  Clock\n} from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group } from \"@shared/schema\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { gsap } from \"gsap\";\nimport { ScrollTrigger } from \"gsap/ScrollTrigger\";\n\n// Register GSAP plugins\ngsap.registerPlugin(ScrollTrigger);\n\n// Animated section wrapper with GSAP\nfunction FadeInSection({ children, delay = 0 }: { children: React.ReactNode; delay?: number }) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      gsap.fromTo(element, \n        { \n          opacity: 0, \n          y: 60,\n          scale: 0.95\n        },\n        { \n          opacity: 1, \n          y: 0,\n          scale: 1,\n          duration: 0.8,\n          delay,\n          ease: \"power2.out\",\n          scrollTrigger: {\n            trigger: element,\n            start: \"top 80%\",\n            end: \"bottom 20%\",\n            toggleActions: \"play none none reverse\"\n          }\n        }\n      );\n    }\n  }, [delay]);\n\n  return (\n    <div ref={ref} className=\"opacity-0\">\n      {children}\n    </div>\n  );\n}\n\n// Professional gradient background component\nfunction GradientBackground() {\n  return (\n    <div className=\"absolute inset-0 overflow-hidden\">\n      <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute top-60 -left-40 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute -bottom-40 right-1/4 w-72 h-72 bg-emerald-500/10 rounded-full blur-3xl\"></div>\n    </div>\n  );\n}\n\nexport default function Groups() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [activeFilter, setActiveFilter] = useState(\"all\");\n  const [pendingRequests, setPendingRequests] = useState<Set<string>>(new Set());\n\n  // Get current user from localStorage\n  const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"null\");\n  const userType = localStorage.getItem(\"userType\");\n  const isProductOwner = userType === \"product_owner\";\n  const isFreelancer = userType === \"freelancer\";\n  const currentUserId = currentUser?.id;\n\n  // Fetch all groups with enhanced data\n  const { data: groups = [], isLoading } = useQuery({\n    queryKey: [\"/api/groups\"],\n    queryFn: async () => {\n      const response = await apiRequest(\"/api/groups\", \"GET\");\n      return response.json();\n    },\n  });\n\n  // Join group mutation\n  const joinGroupMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      const response = await apiRequest(`/api/groups/${groupId}/join`, \"POST\");\n      return response.json();\n    },\n    onSuccess: (data, groupId) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\"] });\n      \n      // Check if it's a pending request or direct join\n      if (data.request && data.request.status === \"pending\") {\n        setPendingRequests(prev => new Set(prev).add(groupId));\n        toast({\n          title: \"تم إرسال طلب الانضمام\",\n          description: \"طلبك قيد المراجعة من قائد الجروب. سيتم إشعارك عند الموافقة.\",\n        });\n      } else {\n        toast({\n          title: \"تم الانضمام بنجاح\",\n          description: \"تم انضمامك للجروب بنجاح، يمكنك الآن المشاركة في المشاريع\",\n        });\n      }\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء الانضمام للجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Leave group mutation\n  const leaveGroupMutation = useMutation({\n    mutationFn: async (groupId: string) => {\n      return await apiRequest(`/api/groups/${groupId}/leave`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\"] });\n      toast({\n        title: \"تم المغادرة\",\n        description: \"تم مغادرة الجروب بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء مغادرة الجروب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Render stars based on rating\n  const renderStars = (rating: number) => {\n    const stars = [];\n    const fullStars = Math.floor(rating);\n    const hasHalfStar = rating % 1 >= 0.5;\n\n    for (let i = 0; i < fullStars; i++) {\n      stars.push(<Star key={i} className=\"h-3 w-3 fill-blue-500 text-blue-500\" />);\n    }\n\n    if (hasHalfStar) {\n      stars.push(<StarHalf key=\"half\" className=\"h-3 w-3 fill-blue-500 text-blue-500\" />);\n    }\n\n    const emptyStars = 5 - stars.length;\n    for (let i = 0; i < emptyStars; i++) {\n      stars.push(<Star key={`empty-${i}`} className=\"h-3 w-3 text-gray-300\" />);\n    }\n\n    return stars;\n  };\n\n  // Filter groups based on search and active filter\n  const filteredGroups = groups?.filter((group) => {\n    const matchesSearch = group.name?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      (group.description?.toLowerCase()?.includes(searchTerm.toLowerCase()) ?? false);\n    \n    const matchesFilter = activeFilter === \"all\" || \n      (activeFilter === \"joined\" && group.isJoined) ||\n      (activeFilter === \"active\" && group.status === \"active\") ||\n      (activeFilter === \"high-rated\" && (parseFloat(group.averageRating) || 0) > 4);\n\n    return matchesSearch && matchesFilter;\n  });\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        {/* Enhanced Professional Header Section */}\n        <div className=\"mb-12\">\n          <div className=\"flex items-center justify-between mb-8\">\n            <div className=\"text-right\">\n              <Badge className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white border-0 px-6 py-2 rounded-full inline-flex items-center gap-3 shadow-lg mb-4\">\n                <Sparkles className=\"h-4 w-4\" />\n                مجتمع المحترفين\n                <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n              </Badge>\n\n              <h1 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-4\">\n                اكتشف <span className=\"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">جروبات المحترفين</span>\n              </h1>\n              <p className=\"text-xl text-gray-600 max-w-2xl leading-relaxed\">\n                {isFreelancer \n                  ? \"انضم لفِرَاح محترفة وارتقِ بمستوى أعمالك من خلال التعاون مع أفضل المواهب\" \n                  : \"اختر من بين أفضل الفِرَاح المحترفة لتنفيذ مشاريعك بأعلى معايير الجودة\"\n                }\n              </p>\n            </div>\n\n            {isFreelancer && (\n              <motion.div\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n              >\n                <Button\n                  onClick={() => navigate(\"/groups/create\")}\n                  className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-6 rounded-2xl font-semibold shadow-xl hover:shadow-2xl transition-all duration-300\"\n                  data-testid=\"button-create-group\"\n                >\n                  <UserPlus className=\"ml-3 h-5 w-5\" />\n                  إنشاء جروب جديد\n                  <Rocket className=\"mr-2 h-5 w-5\" />\n                </Button>\n              </motion.div>\n            )}\n          </div>\n\n          {/* Enhanced Search and Filter Section */}\n          <FadeInSection delay={0.1}>\n            <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n              <CardContent className=\"p-8\">\n                <div className=\"flex flex-col lg:flex-row gap-6 items-center justify-between\">\n                  <div className=\"flex-1 w-full lg:max-w-md\">\n                    <div className=\"relative\">\n                      <Search className=\"absolute right-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                      <Input\n                        placeholder=\"ابحث عن الجروبات، الخدمات، أو المحترفين...\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"pr-12 pl-4 py-6 rounded-2xl border-gray-200 focus:border-blue-500 bg-white shadow-sm text-lg\"\n                        data-testid=\"input-search-groups\"\n                      />\n                      {searchTerm && (\n                        <button\n                          onClick={() => setSearchTerm(\"\")}\n                          className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                        >\n                          <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                          </svg>\n                        </button>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Enhanced Filter Buttons */}\n                  <div className=\"flex flex-wrap gap-3\">\n                    {[\n                      { key: \"all\", label: \"كل الجروبات\", icon: Building, gradient: \"from-blue-500 to-cyan-500\" },\n                      { key: \"joined\", label: \"الجروبات المنضم\", icon: CheckCircle, gradient: \"from-green-500 to-emerald-500\" },\n                      { key: \"active\", label: \"الأكثر نشاطاً\", icon: TrendingUp, gradient: \"from-purple-500 to-pink-500\" },\n                      { key: \"high-rated\", label: \"الأعلى تقييماً\", icon: Star, gradient: \"from-yellow-500 to-orange-500\" },\n                    ].map((filter) => {\n                      const IconComponent = filter.icon;\n                      const isActive = activeFilter === filter.key;\n                      \n                      return (\n                        <motion.button\n                          key={filter.key}\n                          whileHover={{ scale: 1.05 }}\n                          whileTap={{ scale: 0.95 }}\n                          onClick={() => setActiveFilter(filter.key)}\n                          className={`relative px-6 py-3 rounded-2xl font-medium text-sm transition-all duration-300 ${\n                            isActive \n                              ? `bg-gradient-to-r ${filter.gradient} text-white shadow-lg` \n                              : \"bg-white text-gray-700 border border-gray-200 hover:border-gray-300 hover:shadow-md\"\n                          }`}\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            <IconComponent className=\"h-4 w-4\" />\n                            {filter.label}\n                          </div>\n                          {isActive && (\n                            <motion.div\n                              layoutId=\"activeFilter\"\n                              className=\"absolute inset-0 rounded-2xl border-2 border-white/20\"\n                              transition={{ type: \"spring\", bounce: 0.2, duration: 0.6 }}\n                            />\n                          )}\n                        </motion.button>\n                      );\n                    })}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </FadeInSection>\n        </div>\n\n        {/* Enhanced Professional Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12\">\n          {[\n            { \n              title: \"إجمالي الجروبات\", \n              value: groups.length, \n              icon: Building,\n              description: \"جروب متاح\",\n              gradient: \"from-blue-500 to-cyan-500\",\n              delay: 0.1\n            },\n            { \n              title: \"جروبات نشطة\", \n              value: groups.filter(g => g.status === \"active\").length, \n              icon: TrendingUp,\n              description: \"جروب نشط\",\n              gradient: \"from-purple-500 to-pink-500\",\n              delay: 0.2\n            },\n            { \n              title: \"إجمالي الأعضاء\", \n              value: groups.reduce((sum, g) => sum + (g.memberCount || 0), 0), \n              icon: Users,\n              description: \"عضو نشط\",\n              gradient: \"from-green-500 to-emerald-500\",\n              delay: 0.3\n            },\n            { \n              title: \"معدل التقييم\", \n              value: groups.filter(g => parseFloat(g.averageRating) > 0).length > 0 \n                ? (groups.reduce((sum, g) => sum + (parseFloat(g.averageRating) || 0), 0) / groups.filter(g => parseFloat(g.averageRating) > 0).length).toFixed(1)\n                : \"0.0\", \n              icon: Star,\n              description: \"متوسط التقييم\",\n              gradient: \"from-yellow-500 to-orange-500\",\n              delay: 0.4\n            },\n          ].map((stat, index) => {\n            const IconComponent = stat.icon;\n            return (\n              <FadeInSection key={index} delay={stat.delay}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 group overflow-hidden\">\n                  <CardContent className=\"p-6 relative\">\n                    <div className=\"absolute inset-0 bg-gradient-to-r opacity-0 group-hover:opacity-5 transition-opacity duration-300 rounded-2xl\" />\n                    \n                    <div className=\"flex items-center justify-between mb-4\">\n                      <CardTitle className=\"text-sm font-semibold text-gray-600\">\n                        {stat.title}\n                      </CardTitle>\n                      <div className={`p-3 rounded-xl bg-gradient-to-r ${stat.gradient} text-white shadow-lg group-hover:scale-110 transition-transform duration-300`}>\n                        <IconComponent className=\"h-5 w-5\" />\n                      </div>\n                    </div>\n                    \n                    <div className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent mb-2\">\n                      {stat.value}\n                    </div>\n                    <p className=\"text-sm text-gray-500\">{stat.description}</p>\n                    \n                    <div className=\"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-current to-transparent opacity-0 group-hover:opacity-20 transition-opacity duration-300\" />\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            );\n          })}\n        </div>\n\n        {/* Enhanced Professional Groups Grid */}\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <Card key={i} className=\"animate-pulse border-0 rounded-2xl bg-white/80 backdrop-blur-sm overflow-hidden\">\n                <div className=\"h-48 bg-gradient-to-br from-gray-200 to-gray-300 rounded-t-2xl\" />\n                <CardHeader className=\"space-y-4 p-6\">\n                  <div className=\"h-6 bg-gray-200 rounded w-3/4\" />\n                  <div className=\"h-4 bg-gray-200 rounded w-full\" />\n                  <div className=\"h-4 bg-gray-200 rounded w-2/3\" />\n                </CardHeader>\n                <CardContent className=\"p-6 pt-0\">\n                  <div className=\"h-12 bg-gray-200 rounded-xl\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredGroups.length === 0 ? (\n          <FadeInSection delay={0.2}>\n            <Card className=\"text-center border-0 rounded-2xl bg-white/80 backdrop-blur-sm shadow-lg overflow-hidden\">\n              <CardContent className=\"flex flex-col items-center justify-center py-20 px-6\">\n                <div className=\"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mb-6 shadow-lg\">\n                  <Building className=\"h-12 w-12 text-blue-600\" />\n                </div>\n                <h3 className=\"text-2xl font-bold text-gray-900 mb-3\">لا توجد جروبات</h3>\n                <p className=\"text-gray-600 text-lg mb-8 max-w-md leading-relaxed\">\n                  {searchTerm ? \"لم نتمكن من العثور على جروبات تطابق بحثك\" : \"ابدأ رحلتك وأنشئ أول جروب محترف\"}\n                </p>\n                {!searchTerm && isFreelancer && (\n                  <motion.div\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                  >\n                    <Button \n                      onClick={() => navigate(\"/groups/create\")} \n                      className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-6 rounded-2xl font-semibold shadow-xl hover:shadow-2xl transition-all duration-300\"\n                      data-testid=\"button-create-first-group\"\n                    >\n                      <UserPlus className=\"ml-3 h-5 w-5\" />\n                      أنشئ أول جروب\n                      <Rocket className=\"mr-2 h-5 w-5\" />\n                    </Button>\n                  </motion.div>\n                )}\n                {searchTerm && (\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => setSearchTerm(\"\")}\n                    className=\"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-3 rounded-2xl font-medium\"\n                  >\n                    مسح البحث\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          </FadeInSection>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {filteredGroups.map((group, index) => {\n              const rating = parseFloat(group.averageRating) || 0;\n              const totalRatings = group.totalRatings || 0;\n              \n              return (\n                <FadeInSection key={group.id} delay={index * 0.1}>\n                  <motion.div\n                    whileHover={{ y: -8, scale: 1.02 }}\n                    className=\"group cursor-pointer\"\n                  >\n                    <Card\n                      className=\"border-0 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 bg-white/80 backdrop-blur-sm overflow-hidden\"\n                      onClick={() => navigate(`/groups/${group.id}`)}\n                      data-testid={`card-group-${group.id}`}\n                    >\n                      {/* Enhanced Image Section */}\n                      <div className=\"relative h-52 w-full overflow-hidden bg-gradient-to-br from-gray-100 to-gray-200\">\n                        {group.portfolioImages && group.portfolioImages.length > 0 ? (\n                          <img\n                            src={group.portfolioImages[0]}\n                            alt={`صورة الجروب ${group.name}`}\n                            className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\"\n                            onError={(e) => {\n                              e.currentTarget.src = `https://placehold.co/600x400/f8fafc/94a3b8?text=${encodeURIComponent(group.name)}`;\n                            }}\n                          />\n                        ) : group.groupImage ? (\n                          <img\n                            src={group.groupImage}\n                            alt={`صورة الجروب ${group.name}`}\n                            className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\"\n                            onError={(e) => {\n                              e.currentTarget.src = `https://placehold.co/600x400/f8fafc/94a3b8?text=${encodeURIComponent(group.name)}`;\n                            }}\n                          />\n                        ) : (\n                          <div className=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50\">\n                            <div className=\"text-center\">\n                              <Building className=\"h-12 w-12 text-blue-400 mx-auto mb-2\" />\n                              <p className=\"text-blue-600 font-medium text-sm\">{group.name}</p>\n                            </div>\n                          </div>\n                        )}\n                        \n                        {/* Enhanced Status Badges */}\n                        <div className=\"absolute top-4 left-4 flex gap-2\">\n                          <Badge \n                            className={`text-xs font-semibold px-3 py-1.5 rounded-full border-0 shadow-lg ${\n                              group.status === \"active\" \n                                ? \"bg-gradient-to-r from-green-500 to-emerald-500 text-white\" \n                                : \"bg-gradient-to-r from-gray-500 to-gray-600 text-white\"\n                            }`}\n                          >\n                            {group.status === \"active\" ? \"نشط\" : \"غير نشط\"}\n                          </Badge>\n                          {group.privacy === \"private\" && (\n                            <Badge className=\"text-xs font-semibold px-3 py-1.5 rounded-full border-0 shadow-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white flex items-center gap-1\">\n                              <Lock className=\"h-3 w-3\" />\n                              خاص\n                            </Badge>\n                          )}\n                        </div>\n\n                        {/* Enhanced Rating Badge */}\n                        {rating > 0 && (\n                          <div className=\"absolute top-4 right-4 bg-white/95 backdrop-blur-sm rounded-xl px-3 py-2 flex items-center gap-2 shadow-lg\">\n                            <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-500\" />\n                            <span className=\"text-sm font-bold text-gray-900\">{rating}</span>\n                            <span className=\"text-xs text-gray-500\">({totalRatings})</span>\n                          </div>\n                        )}\n\n                        {/* Enhanced Members Count */}\n                        <div className=\"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm rounded-xl px-3 py-2 flex items-center gap-2 shadow-lg\">\n                          <Users className=\"h-4 w-4 text-blue-600\" />\n                          <span className=\"text-sm font-bold text-gray-900\">\n                            {group.memberCount || 0}<span className=\"text-gray-500 font-normal\">/{group.maxMembers}</span>\n                          </span>\n                        </div>\n\n                        {/* Enhanced Join Status */}\n                        {group.isJoined && (\n                          <div className=\"absolute bottom-4 right-4 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl px-3 py-2 flex items-center gap-2 shadow-lg\">\n                            <CheckCircle className=\"h-4 w-4\" />\n                            <span className=\"text-sm font-semibold\">منضم</span>\n                          </div>\n                        )}\n\n                        {/* Gradient Overlay */}\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\n                      </div>\n\n                      <CardHeader className=\"pb-4 px-6 pt-6\">\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <CardTitle \n                            className=\"text-xl font-bold text-gray-900 line-clamp-1 leading-tight\" \n                          >\n                            {group.name}\n                          </CardTitle>\n                        </div>\n                        \n                        {/* Enhanced Leader Info */}\n                        <div className=\"flex items-center gap-3 mb-3 p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-100\">\n                          <div className=\"w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center\">\n                            <Crown className=\"h-4 w-4 text-white\" />\n                          </div>\n                          <div>\n                            <p className=\"text-sm font-semibold text-gray-900\">{group.leaderName || \"قائد الجروب\"}</p>\n                            <p className=\"text-xs text-gray-600\">قائد المجموعة</p>\n                          </div>\n                        </div>\n\n                        <CardDescription className=\"text-sm text-gray-600 line-clamp-2 leading-relaxed min-h-[3rem]\">\n                          {group.description || \"لا يوجد وصف للجروب حالياً...\"}\n                        </CardDescription>\n                      </CardHeader>\n\n                      <CardContent className=\"pt-0 px-6 pb-6\">\n                        {/* Enhanced Member Avatars Section */}\n                        {group.membersToShow && group.membersToShow.length > 0 && (\n                          <div className=\"flex items-center justify-between mb-5 p-4 bg-gradient-to-r from-blue-50/50 to-purple-50/50 rounded-2xl border border-blue-100/50\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"flex -space-x-3\">\n                                {group.membersToShow\n                                  .slice(0, 5)\n                                  .sort((a, b) => {\n                                    if (a.role === 'leader') return 1;\n                                    if (b.role === 'leader') return -1;\n                                    return 0;\n                                  })\n                                  .map((member, index, sortedArray) => (\n                                    <div\n                                      key={member.id}\n                                      className=\"relative group\"\n                                      style={{ zIndex: index + 1 }}\n                                    >\n                                      <div className={`w-10 h-10 rounded-full border-2 border-white flex items-center justify-center text-xs font-semibold shadow-lg transition-all duration-300 group-hover:scale-110 ${\n                                        member.role === 'leader' \n                                          ? 'bg-gradient-to-br from-yellow-400 to-orange-500 text-white ring-2 ring-yellow-300' \n                                          : 'bg-gradient-to-br from-blue-500 to-purple-600 text-white'\n                                      }`}>\n                                        {member.avatar ? (\n                                          <img\n                                            src={member.avatar}\n                                            alt={member.name}\n                                            className=\"w-full h-full rounded-full object-cover\"\n                                            onError={(e) => {\n                                              const parent = e.currentTarget.parentElement;\n                                              if (parent) {\n                                                parent.textContent = member.name?.charAt(0) || 'ع';\n                                              }\n                                            }}\n                                          />\n                                        ) : (\n                                          member.name?.charAt(0) || 'ع'\n                                        )}\n                                      </div>\n                                      \n                                      {member.role === 'leader' && (\n                                        <div className=\"absolute -top-1 -right-1\">\n                                          <Crown className=\"h-4 w-4 fill-yellow-300 text-yellow-600\" />\n                                        </div>\n                                      )}\n                                      \n                                      <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1.5 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none shadow-lg\">\n                                        {member.name}\n                                        {member.role === 'leader' && ' (قائد)'}\n                                        <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900\" />\n                                      </div>\n                                    </div>\n                                  ))}\n                              </div>\n                              \n                              {group.memberCount > 5 && (\n                                <div className=\"text-sm font-semibold text-blue-600 bg-white rounded-full px-3 py-1.5 border border-blue-200 shadow-sm\">\n                                  +{group.memberCount - 5}\n                                </div>\n                              )}\n                            </div>\n                            <div className=\"text-sm font-bold text-blue-600\">\n                              فريق العمل\n                            </div>\n                          </div>\n                        )}\n\n                        {/* Enhanced Action buttons */}\n                        {isProductOwner ? (\n                          <div className=\"space-y-3\">\n                            <div className=\"flex gap-3\">\n                              <Button\n                                className=\"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-2xl py-6 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  navigate(`/purchase/${group.id}`);\n                                }}\n                                data-testid={`button-purchase-service-${group.id}`}\n                              >\n                                <ShoppingCart className=\"ml-3 h-5 w-5\" />\n                                طلب خدمة\n                                <ArrowUpRight className=\"mr-2 h-5 w-5\" />\n                              </Button>\n                              <Button\n                                variant=\"outline\"\n                                className=\"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400 rounded-2xl px-4 shadow-sm\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  // startConversationMutation.mutate(group.id);\n                                }}\n                                data-testid={`button-contact-leader-${group.id}`}\n                              >\n                                <MessageCircle className=\"h-5 w-5\" />\n                              </Button>\n                            </div>\n                          </div>\n                        ) : (\n                          <div className=\"flex gap-3\">\n                            <Button\n                              className=\"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-2xl py-6 font-semibold shadow-lg hover:shadow-xl transition-all duration-300\"\n                              onClick={(e) => {\n                                e.stopPropagation();\n                                navigate(`/groups/${group.id}`);\n                              }}\n                              data-testid={`button-view-group-${group.id}`}\n                            >\n                              <Eye className=\"ml-3 h-5 w-5\" />\n                              عرض التفاصيل\n                              <ArrowRight className=\"mr-2 h-5 w-5\" />\n                            </Button>\n\n                            {group.isJoined ? (\n                              <Button\n                                variant=\"outline\"\n                                className=\"border-2 border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300 rounded-2xl px-4 shadow-sm\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  navigate(`/groups/${group.id}`);\n                                }}\n                                data-testid={`button-member-status-${group.id}`}\n                              >\n                                <CheckCircle className=\"h-5 w-5\" />\n                              </Button>\n                            ) : group.joinRequestStatus === \"pending\" || pendingRequests.has(group.id) ? (\n                              <Button\n                                variant=\"outline\"\n                                className=\"border-2 border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-100 hover:border-orange-300 rounded-2xl px-4 shadow-sm cursor-not-allowed\"\n                                disabled\n                                onClick={(e) => e.stopPropagation()}\n                                data-testid={`button-pending-status-${group.id}`}\n                              >\n                                <Clock className=\"h-5 w-5\" />\n                              </Button>\n                            ) : group.joinRequestStatus === \"approved\" ? (\n                              <motion.div\n                                whileHover={{ scale: 1.05 }}\n                                whileTap={{ scale: 0.95 }}\n                              >\n                                <Button\n                                  variant=\"outline\"\n                                  className=\"border-2 border-green-200 bg-green-50 text-green-700 hover:bg-green-100 hover:border-green-300 rounded-2xl px-4 shadow-sm\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    joinGroupMutation.mutate(group.id);\n                                  }}\n                                  disabled={joinGroupMutation.isPending}\n                                  data-testid={`button-approved-join-${group.id}`}\n                                >\n                                  <CheckCircle className=\"h-5 w-5\" />\n                                </Button>\n                              </motion.div>\n                            ) : isFreelancer && group.status === \"active\" && (group.memberCount || 0) < group.maxMembers ? (\n                              <motion.div\n                                whileHover={{ scale: 1.05 }}\n                                whileTap={{ scale: 0.95 }}\n                              >\n                                <Button\n                                  variant=\"outline\"\n                                  className=\"border-2 border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 hover:border-blue-300 rounded-2xl px-4 shadow-sm\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    joinGroupMutation.mutate(group.id);\n                                  }}\n                                  disabled={joinGroupMutation.isPending}\n                                  data-testid={`button-join-group-${group.id}`}\n                                >\n                                  <UserPlus className=\"h-5 w-5\" />\n                                </Button>\n                              </motion.div>\n                            ) : null}\n                          </div>\n                        )}\n\n                        {/* Pending Request Status Message */}\n                        {(group.joinRequestStatus === \"pending\" || pendingRequests.has(group.id)) && !group.isJoined && (\n                          <div className=\"mt-3 p-4 bg-gradient-to-r from-orange-50 to-yellow-50 border border-orange-200 rounded-2xl text-center\">\n                            <div className=\"flex items-center justify-center gap-2 mb-1\">\n                              <Clock className=\"h-4 w-4 text-orange-600 animate-pulse\" />\n                              <p className=\"text-orange-700 text-sm font-bold\">\n                                قيد المراجعة\n                              </p>\n                            </div>\n                            <p className=\"text-orange-600 text-xs\">\n                              طلبك قيد مراجعة قائد الجروب\n                            </p>\n                          </div>\n                        )}\n\n                        {/* Approved Request - Can Join Now */}\n                        {group.joinRequestStatus === \"approved\" && !group.isJoined && (\n                          <div className=\"mt-3 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-2xl text-center\">\n                            <div className=\"flex items-center justify-center gap-2 mb-1\">\n                              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                              <p className=\"text-green-700 text-sm font-bold\">\n                                تمت الموافقة!\n                              </p>\n                            </div>\n                            <p className=\"text-green-600 text-xs\">\n                              اضغط على الزر للانضمام الآن\n                            </p>\n                          </div>\n                        )}\n\n                        {/* Enhanced Leave Group Button */}\n                        {group.isJoined && (\n                          <Button\n                            variant=\"outline\"\n                            className=\"w-full mt-3 border-2 border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gray-400 rounded-2xl py-3 font-medium\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              if (window.confirm(\"هل أنت متأكد من رغبتك في مغادرة هذا الجروب؟\")) {\n                                leaveGroupMutation.mutate(group.id);\n                              }\n                            }}\n                            disabled={leaveGroupMutation.isPending}\n                            data-testid={`button-leave-group-${group.id}`}\n                          >\n                            مغادرة الجروب\n                          </Button>\n                        )}\n\n                        {/* Enhanced Group Full Message */}\n                        {(group.memberCount || 0) >= group.maxMembers && !group.isJoined && (\n                          <div className=\"mt-3 p-4 bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl text-center\">\n                            <div className=\"flex items-center justify-center gap-2\">\n                              <Shield className=\"h-4 w-4 text-amber-600\" />\n                              <p className=\"text-amber-700 text-sm font-semibold\">\n                                الجروب ممتلئ - لا يمكن الانضمام حالياً\n                              </p>\n                            </div>\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  </motion.div>\n                </FadeInSection>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":41365},"client/src/pages/CreateProject.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { ArrowRight, Briefcase } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { insertProjectSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst createProjectSchema = insertProjectSchema.omit({ productOwnerId: true }).extend({\n  budget: z.string().min(1, \"الميزانية مطلوبة\"),\n  tasksCount: z.number().min(1, \"يجب أن يكون عدد المهام 1 على الأقل\"),\n});\n\ntype CreateProjectForm = z.infer<typeof createProjectSchema>;\n\nexport default function CreateProject() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n\n  const form = useForm<CreateProjectForm>({\n    resolver: zodResolver(createProjectSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      targetCountry: \"السعودية\",\n      tasksCount: 10,\n      budget: \"\",\n      deadline: undefined,\n    },\n  });\n\n  const createProjectMutation = useMutation({\n    mutationFn: async (data: CreateProjectForm) => {\n      return await apiRequest(\"/api/projects\", \"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/pending\"] });\n      toast({\n        title: \"تم إنشاء المشروع\",\n        description: \"تم إنشاء المشروع بنجاح وهو متاح الآن لقادة الجروبات\",\n      });\n      navigate(\"/projects\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المشروع\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CreateProjectForm) => {\n    createProjectMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(\"/projects\")}\n          className=\"mb-6\"\n          data-testid=\"button-back-to-projects\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة للمشاريع\n        </Button>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center gap-3 mb-2\">\n              <div className=\"p-3 rounded-lg bg-primary/10\">\n                <Briefcase className=\"h-6 w-6 text-primary\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-2xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  إنشاء مشروع جديد\n                </CardTitle>\n                <CardDescription>\n                  أنشئ مشروعاً جديداً ليقبله قادة الجروبات\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                {/* Title */}\n                <FormField\n                  control={form.control}\n                  name=\"title\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>عنوان المشروع *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"مثال: اختبار تطبيق التجارة الإلكترونية\"\n                          {...field}\n                          data-testid=\"input-project-title\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        عنوان واضح ومختصر للمشروع\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Description */}\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>وصف المشروع *</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"وصف تفصيلي عن المشروع والمهام المطلوبة...\"\n                          className=\"resize-none min-h-[150px]\"\n                          {...field}\n                          data-testid=\"input-project-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اشرح تفاصيل المشروع وما هو المطلوب من الفريلانسرز\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {/* Target Country */}\n                  <FormField\n                    control={form.control}\n                    name=\"targetCountry\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الدولة المستهدفة *</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"السعودية\"\n                            {...field}\n                            data-testid=\"input-target-country\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          الدولة التي يجب أن يكون الفريلانسرز منها\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Tasks Count */}\n                  <FormField\n                    control={form.control}\n                    name=\"tasksCount\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>عدد المهام *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"number\"\n                            min=\"1\"\n                            {...field}\n                            onChange={(e) => field.onChange(parseInt(e.target.value) || 0)}\n                            data-testid=\"input-tasks-count\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          عدد المهام المطلوب إنجازها\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  {/* Budget */}\n                  <FormField\n                    control={form.control}\n                    name=\"budget\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الميزانية (ر.س) *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"number\"\n                            min=\"0\"\n                            step=\"0.01\"\n                            placeholder=\"1000\"\n                            {...field}\n                            data-testid=\"input-budget\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          إجمالي ميزانية المشروع\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Deadline */}\n                  <FormField\n                    control={form.control}\n                    name=\"deadline\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>الموعد النهائي (اختياري)</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"date\"\n                            {...field}\n                            value={field.value ? new Date(field.value).toISOString().split('T')[0] : \"\"}\n                            onChange={(e) => field.onChange(e.target.value ? new Date(e.target.value) : undefined)}\n                            data-testid=\"input-deadline\"\n                          />\n                        </FormControl>\n                        <FormDescription>\n                          الموعد النهائي لإنجاز المشروع\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                {/* Info Card */}\n                <Card className=\"bg-muted/50\">\n                  <CardContent className=\"pt-6\">\n                    <h4 className=\"font-semibold mb-3\">ملاحظات هامة:</h4>\n                    <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>سيكون المشروع متاحاً لجميع قادة الجروبات للقبول</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>عند قبول المشروع، سيقوم قائد الجروب بتوزيع المهام على الأعضاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستدفع 5% عمولة إضافية لقائد الجروب عند إنجاز كل مهمة</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك متابعة تقدم المشروع ومراجعة المهام المنجزة</span>\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                {/* Submit Buttons */}\n                <div className=\"flex gap-3\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => navigate(\"/projects\")}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createProjectMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-submit\"\n                  >\n                    {createProjectMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء المشروع\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":12161},"client/src/pages/CreateGroup.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { ArrowRight, Users, Image, Upload } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { insertGroupSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst createGroupSchema = insertGroupSchema.extend({\n  maxMembers: z.number().min(2, \"يجب أن يكون الحد الأقصى للأعضاء 2 على الأقل\").max(700, \"الحد الأقصى 700 عضو\"),\n}).omit({ leaderId: true });\n\ntype CreateGroupForm = z.infer<typeof createGroupSchema>;\n\nexport default function CreateGroup() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [imagePreview, setImagePreview] = useState<string>(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n\n  const form = useForm<CreateGroupForm>({\n    resolver: zodResolver(createGroupSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      groupImage: \"\",\n      maxMembers: 50,\n    },\n  });\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validate file type\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"خطأ\",\n        description: \"يجب اختيار صورة فقط\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate file size (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"خطأ\",\n        description: \"حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setIsUploading(true);\n      \n      // Create FormData\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', 'group');\n\n\n      // Upload to server\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'فشل رفع الصورة');\n      }\n\n      const { url } = await response.json();\n      \n      // Set preview\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setImagePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n\n      // Update form\n      form.setValue('groupImage', url);\n      \n      toast({\n        title: \"تم رفع الصورة\",\n        description: \"تم رفع صورة الجروب بنجاح\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء رفع الصورة\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const createGroupMutation = useMutation({\n    mutationFn: async (data: CreateGroupForm) => {\n      // Get user data from localStorage at the time of submission\n      const userDataStr = localStorage.getItem(\"user\");\n      if (!userDataStr) {\n        throw new Error(\"يجب تسجيل الدخول أولاً\");\n      }\n      \n      const userData = JSON.parse(userDataStr);\n      if (!userData || !userData.id) {\n        throw new Error(\"بيانات المستخدم غير صحيحة. يرجى تسجيل الدخول مرة أخرى\");\n      }\n      \n      const groupData = {\n        ...data,\n        leaderId: userData.id,\n      };\n      \n       // Call apiRequest and parse the JSON response\n    const response = await apiRequest(\"/api/groups\", \"POST\", groupData);\n    return await response.json(); // Add this line\n\n    },\n    onSuccess: (data: any) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/groups\"] });\n      toast({\n        title: \"تم إنشاء الجروب بنجاح\",\n        description: \"تم إنشاء الجروب وأنت الآن قائد الجروب\",\n      });\n      console.log(\"Create Group Success:\", data);\n      navigate(`/groups/${data?.id}`);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الجروب\",\n        variant: \"destructive\",\n      });\n\n      console.log(\"Create Group Error:\", error);\n    },\n  });\n\n  const onSubmit = (data: CreateGroupForm) => {\n    createGroupMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8 max-w-2xl\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(\"/groups\")}\n          className=\"mb-6\"\n          data-testid=\"button-back-to-groups\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة للجروبات\n        </Button>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center gap-4 mb-2\">\n              {/* Preview Image or Icon */}\n              {imagePreview ? (\n                <div className=\"relative w-20 h-20 rounded-lg overflow-hidden bg-muted flex-shrink-0\">\n                  <img\n                    src={imagePreview}\n                    alt=\"معاينة صورة الجروب\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                </div>\n              ) : (\n                <div className=\"p-3 rounded-lg bg-primary/10 flex-shrink-0\">\n                  <Users className=\"h-6 w-6 text-primary\" />\n                </div>\n              )}\n              \n              <div className=\"flex-1\">\n                <CardTitle className=\"text-2xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  إنشاء جروب جديد\n                </CardTitle>\n                <CardDescription>\n                  أنشئ جروب وابدأ باستقبال أعضاء والعمل على المشاريع\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                {/* Group Name */}\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>اسم الجروب *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"مثال: فريق التطبيقات المحترف\"\n                          {...field}\n                          data-testid=\"input-group-name\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اختر اسماً واضحاً وجذاباً للجروب\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Description */}\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>الوصف</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"وصف مختصر عن الجروب وأهدافه...\"\n                          className=\"resize-none min-h-[120px]\"\n                          {...field}\n                          value={field.value || \"\"}\n                          data-testid=\"input-group-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        اشرح للأعضاء ما يميز جروبك\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Group Image */}\n                <FormField\n                  control={form.control}\n                  name=\"groupImage\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>صورة الجروب</FormLabel>\n                      <FormControl>\n                        <div className=\"space-y-4\">\n                          {/* Upload Button */}\n                          <div className=\"flex items-center gap-3\">\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              onClick={() => document.getElementById('group-image-input')?.click()}\n                              disabled={isUploading}\n                              className=\"flex items-center gap-2\"\n                              data-testid=\"button-upload-group-image\"\n                            >\n                              <Upload className=\"h-4 w-4\" />\n                              {isUploading ? \"جاري الرفع...\" : \"اختر صورة من المعرض\"}\n                            </Button>\n                            <input\n                              id=\"group-image-input\"\n                              type=\"file\"\n                              accept=\"image/*\"\n                              className=\"hidden\"\n                              onChange={handleImageUpload}\n                              data-testid=\"input-group-image-file\"\n                            />\n                          </div>\n\n                          {/* Preview */}\n                          {imagePreview && (\n                            <div className=\"relative w-full max-w-md\">\n                              <div className=\"relative w-full h-48 rounded-lg overflow-hidden bg-muted\">\n                                <img\n                                  src={imagePreview}\n                                  alt=\"معاينة صورة الجروب\"\n                                  className=\"w-full h-full object-cover\"\n                                />\n                              </div>\n                              <Button\n                                type=\"button\"\n                                variant=\"destructive\"\n                                size=\"sm\"\n                                className=\"absolute top-2 left-2\"\n                                onClick={() => {\n                                  setImagePreview(\"\");\n                                  form.setValue('groupImage', \"\");\n                                }}\n                                data-testid=\"button-remove-group-image\"\n                              >\n                                حذف الصورة\n                              </Button>\n                            </div>\n                          )}\n                        </div>\n                      </FormControl>\n                      <FormDescription>\n                        اختر صورة من معرض الصور (اختياري). الحد الأقصى 5 ميجابايت\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Max Members */}\n                <FormField\n                  control={form.control}\n                  name=\"maxMembers\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>الحد الأقصى للأعضاء *</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min={2}\n                          max={700}\n                          value={field.value}\n                          onChange={(e) => {\n                            const value = e.target.value;\n                            field.onChange(value === \"\" ? 0 : parseInt(value));\n                          }}\n                          data-testid=\"input-group-max-members\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        يمكنك استقبال حتى 700 عضو (الحد الأقصى للمنصة)\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Info Card */}\n                <Card className=\"bg-muted/50\">\n                  <CardContent className=\"pt-6\">\n                    <h4 className=\"font-semibold mb-3\">ملاحظات هامة:</h4>\n                    <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستصبح قائد الجروب تلقائياً بعد الإنشاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>ستحصل على عمولة 5% من كل مهمة يكملها أعضاء جروبك</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك قبول المشاريع وتوزيع المهام على الأعضاء</span>\n                      </li>\n                      <li className=\"flex items-start gap-2\">\n                        <span className=\"text-primary mt-1\">•</span>\n                        <span>يمكنك إزالة الأعضاء غير النشطين من الجروب</span>\n                      </li>\n                    </ul>\n                  </CardContent>\n                </Card>\n\n                {/* Submit Buttons */}\n                <div className=\"flex gap-3\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => navigate(\"/groups\")}\n                    className=\"flex-1\"\n                    data-testid=\"button-cancel\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    disabled={createGroupMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"button-submit\"\n                  >\n                    {createGroupMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء الجروب\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15370},"client/src/pages/Projects.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { Briefcase, Search, Calendar, DollarSign, CheckCircle2, Users, MapPin } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Project, Group } from \"@shared/schema\";\n\nexport default function Projects() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedProject, setSelectedProject] = useState<Project | null>(null);\n  const [selectedGroupId, setSelectedGroupId] = useState<string>(\"\");\n  const [user, setUser] = useState<any>(() => {\n    const userData = localStorage.getItem(\"user\");\n    return userData ? JSON.parse(userData) : null;\n  });\n\n  // Fetch pending projects\n  const { data: projects = [], isLoading: projectsLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/pending\"],\n  });\n\n  // Fetch user's groups where they are leader\n  const { data: leaderGroups = [] } = useQuery<Group[]>({\n    queryKey: [\"/api/groups/my/leader\"],\n    enabled: !!user && user.userType === \"freelancer\",\n  });\n\n  // Accept project mutation\n  const acceptProjectMutation = useMutation({\n    mutationFn: async ({ projectId, groupId }: { projectId: string; groupId: string }) => {\n      return await apiRequest(`/api/projects/${projectId}/accept`, \"POST\", { groupId });\n    },\n    onSuccess: (_data, variables) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/pending\"] });\n      // Invalidate the specific group's projects\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects/group\", variables.groupId] });\n      // Also invalidate all group project queries\n      queryClient.invalidateQueries({ \n        predicate: (query) => {\n          const key = query.queryKey;\n          return Array.isArray(key) && key[0] === \"/api/projects/group\";\n        }\n      });\n      toast({\n        title: \"تم قبول المشروع\",\n        description: \"تم قبول المشروع بنجاح ويمكنك الآن البدء بتوزيع المهام\",\n      });\n      setSelectedProject(null);\n      setSelectedGroupId(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء قبول المشروع\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Filter projects\n  const filteredProjects = projects.filter((project) =>\n    project.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    project.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    project.targetCountry.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const handleAcceptProject = () => {\n    if (selectedProject && selectedGroupId) {\n      acceptProjectMutation.mutate({\n        projectId: selectedProject.id,\n        groupId: selectedGroupId,\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                المشاريع المتاحة\n              </h1>\n              <p className=\"text-muted-foreground\">\n                تصفح واقبل المشاريع المتاحة لجروبك\n              </p>\n            </div>\n\n            {user?.userType === \"productOwner\" && (\n              <Button\n                onClick={() => navigate(\"/projects/create\")}\n                size=\"lg\"\n                data-testid=\"button-create-project\"\n              >\n                <Briefcase className=\"ml-2 h-5 w-5\" />\n                إنشاء مشروع جديد\n              </Button>\n            )}\n          </div>\n\n          {/* Search */}\n          <div className=\"relative max-w-md\">\n            <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"ابحث عن مشروع...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pr-10\"\n              data-testid=\"input-search-projects\"\n            />\n          </div>\n        </div>\n\n        {/* Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">المشاريع المتاحة</CardTitle>\n              <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{projects.length}</div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">إجمالي الميزانيات</CardTitle>\n              <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {projects.reduce((sum, p) => sum + parseFloat(p.budget as string), 0).toLocaleString()} ر.س\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">جروباتي (كقائد)</CardTitle>\n              <Users className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{leaderGroups.length}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Projects Grid */}\n        {projectsLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3, 4, 5, 6].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardHeader>\n                  <div className=\"h-6 bg-muted rounded w-3/4 mb-2\" />\n                  <div className=\"h-4 bg-muted rounded w-full\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-32 bg-muted rounded mb-4\" />\n                  <div className=\"h-10 bg-muted rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredProjects.length === 0 ? (\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <Briefcase className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع</h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                {searchTerm ? \"لم يتم العثور على مشاريع تطابق البحث\" : \"لا توجد مشاريع متاحة حالياً\"}\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredProjects.map((project) => (\n              <Card\n                key={project.id}\n                className=\"hover-elevate transition-all\"\n                data-testid={`card-project-${project.id}`}\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <CardTitle className=\"text-xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge>{project.status === \"pending\" ? \"متاح\" : project.status}</Badge>\n                  </div>\n                  <CardDescription className=\"line-clamp-3 min-h-[3.5rem]\">\n                    {project.description}\n                  </CardDescription>\n                </CardHeader>\n\n                <CardContent>\n                  <div className=\"space-y-3 mb-4\">\n                    {/* Budget */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <DollarSign className=\"ml-2 h-4 w-4\" />\n                        الميزانية\n                      </div>\n                      <span className=\"font-semibold text-green-600\">\n                        {parseFloat(project.budget as string).toLocaleString()} ر.س\n                      </span>\n                    </div>\n\n                    {/* Tasks Count */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n                        عدد المهام\n                      </div>\n                      <span className=\"font-semibold\">{project.tasksCount}</span>\n                    </div>\n\n                    {/* Target Country */}\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <div className=\"flex items-center text-muted-foreground\">\n                        <MapPin className=\"ml-2 h-4 w-4\" />\n                        الدولة المستهدفة\n                      </div>\n                      <span className=\"font-semibold\">{project.targetCountry}</span>\n                    </div>\n\n                    {/* Deadline */}\n                    {project.deadline && (\n                      <div className=\"flex items-center justify-between text-sm\">\n                        <div className=\"flex items-center text-muted-foreground\">\n                          <Calendar className=\"ml-2 h-4 w-4\" />\n                          الموعد النهائي\n                        </div>\n                        <span className=\"font-semibold\">\n                          {new Date(project.deadline).toLocaleDateString(\"ar\")}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n\n                  <Button\n                    className=\"w-full\"\n                    onClick={() => setSelectedProject(project)}\n                    disabled={leaderGroups.length === 0}\n                    data-testid={`button-accept-project-${project.id}`}\n                  >\n                    {leaderGroups.length === 0 ? \"يجب أن تكون قائد جروب\" : \"قبول المشروع\"}\n                  </Button>\n\n                  {leaderGroups.length === 0 && (\n                    <p className=\"text-xs text-muted-foreground text-center mt-2\">\n                      أنشئ جروب لتتمكن من قبول المشاريع\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Accept Project Dialog */}\n      <Dialog open={!!selectedProject} onOpenChange={() => {\n        setSelectedProject(null);\n        setSelectedGroupId(\"\");\n      }}>\n        <DialogContent data-testid=\"dialog-accept-project\">\n          <DialogHeader>\n            <DialogTitle>قبول المشروع</DialogTitle>\n            <DialogDescription>\n              اختر الجروب الذي سيعمل على هذا المشروع\n            </DialogDescription>\n          </DialogHeader>\n\n          {selectedProject && (\n            <div className=\"space-y-4\">\n              <div className=\"p-4 rounded-lg bg-muted/50\">\n                <h3 className=\"font-semibold mb-2\">{selectedProject.title}</h3>\n                <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                  <div>\n                    <span className=\"text-muted-foreground\">الميزانية:</span>\n                    <span className=\"font-semibold mr-2 text-green-600\">\n                      {parseFloat(selectedProject.budget as string).toLocaleString()} ر.س\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">المهام:</span>\n                    <span className=\"font-semibold mr-2\">{selectedProject.tasksCount}</span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium\">اختر الجروب</label>\n                <Select value={selectedGroupId} onValueChange={setSelectedGroupId}>\n                  <SelectTrigger data-testid=\"select-group\">\n                    <SelectValue placeholder=\"اختر جروب...\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {leaderGroups.map((group) => (\n                      <SelectItem key={group.id} value={group.id}>\n                        {group.name} ({group.currentMembers}/{group.maxMembers} عضو)\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <Card className=\"bg-blue-500/10 border-blue-500/20\">\n                <CardContent className=\"pt-6\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    ملاحظة: بعد قبول المشروع، ستتمكن من إنشاء المهام وتوزيعها على أعضاء الجروب.\n                    ستحصل على عمولة 5% من كل مهمة يكملها الأعضاء.\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSelectedProject(null);\n                setSelectedGroupId(\"\");\n              }}\n              data-testid=\"button-cancel-accept\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleAcceptProject}\n              disabled={!selectedGroupId || acceptProjectMutation.isPending}\n              data-testid=\"button-confirm-accept\"\n            >\n              {acceptProjectMutation.isPending ? \"جاري القبول...\" : \"قبول المشروع\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":15152},"client/src/components/NotificationsDropdown.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport function NotificationsDropdown() {\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Fetch notifications\n  const { data: notifications = [] } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest( `/api/notifications/${id}/read`,\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest( \"/api/notifications/mark-all-read\",\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"relative rounded-xl\"\n          data-testid=\"button-notifications\"\n        >\n          <Bell className=\"h-5 w-5\" />\n          {unreadCount > 0 && (\n            <Badge\n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 rounded-full text-xs\"\n              data-testid=\"badge-unread-count\"\n            >\n              {unreadCount > 9 ? \"9+\" : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-80\" data-testid=\"dropdown-notifications\">\n        <DropdownMenuLabel className=\"flex items-center justify-between\">\n          <span>الإشعارات</span>\n          {unreadCount > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              className=\"h-auto p-1 text-xs\"\n              data-testid=\"button-mark-all-read\"\n            >\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <ScrollArea className=\"h-[400px]\">\n          {notifications.length === 0 ? (\n            <div className=\"py-8 text-center text-sm text-muted-foreground\" data-testid=\"text-no-notifications\">\n              <Bell className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n              <p>لا توجد إشعارات</p>\n            </div>\n          ) : (\n            notifications.map((notification) => (\n              <DropdownMenuItem\n                key={notification.id}\n                className=\"flex flex-col items-start gap-1 p-3 cursor-pointer\"\n                onClick={() => handleNotificationClick(notification)}\n                data-testid={`notification-${notification.id}`}\n              >\n                <div className=\"flex items-start gap-2 w-full\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <p className={`text-sm font-semibold ${!notification.isRead ? 'text-primary' : ''}`}>\n                        {notification.title}\n                      </p>\n                      {!notification.isRead && (\n                        <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread\" />\n                      )}\n                    </div>\n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">\n                      {notification.message}\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {getTimeAgo(notification.createdAt)}\n                    </p>\n                  </div>\n                  {!notification.isRead && (\n                    <CheckCircle2 className=\"h-4 w-4 text-muted-foreground flex-shrink-0 mt-1\" />\n                  )}\n                </div>\n              </DropdownMenuItem>\n            ))\n          )}\n        </ScrollArea>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n","size_bytes":5601},"client/src/components/FreelancerSidebar.tsx":{"content":"import {\n  Home,\n  ListTodo,\n  CheckSquare,\n  Users,\n  Wallet,\n  Download,\n  ShoppingBag,\n  Settings,\n  ChevronDown,\n  MessageCircle,\n  Bell\n} from \"lucide-react\";\nimport { useLocation, Link } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n} from \"@/components/ui/sidebar\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\n\nconst menuItems = [\n  {\n    title: \"الرئيسية\",\n    url: \"/freelancer-dashboard\",\n    icon: Home,\n  },\n  {\n    title: \"المهام\",\n    icon: ListTodo,\n    items: [\n      { title: \"المهام المتاحة\", url: \"/freelancer-dashboard/tasks/available\" },\n      { title: \"مهامي\", url: \"/freelancer-dashboard/tasks/my-tasks\" },\n    ],\n  },\n  {\n    title: \"الجروبات\",\n    icon: Users,\n    items: [\n      { title: \"تصفح المجموعات\", url: \"/groups\" },\n      { title: \"مجموعاتي\", url: \"/freelancer-dashboard/groups\" },\n    ],\n  },\n  {\n    title: \"المالية\",\n    icon: Wallet,\n    items: [\n      { title: \"المحفظة\", url: \"/freelancer-dashboard/wallet\" },\n      { title: \"السحوبات\", url: \"/freelancer-dashboard/withdrawals\" },\n    ],\n  },\n  {\n    title: \"الطلبات الواردة\",\n    url: \"/freelancer-dashboard/orders\",\n    icon: ShoppingBag,\n  },\n  {\n    title: \"المحادثات\",\n    url: \"/freelancer-dashboard/conversations\",\n    icon: MessageCircle,\n  },\n  {\n    title: \"الإشعارات\",\n    url: \"/freelancer-dashboard/notifications\",\n    icon: Bell,\n  },\n  {\n    title: \"الإعدادات\",\n    url: \"/freelancer-dashboard/settings\",\n    icon: Settings,\n  },\n];\n\nexport function FreelancerSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar side=\"right\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-lg font-bold text-primary\">\n            لوحة التحكم - مستقل\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => {\n                const isActive = location === item.url || location.startsWith(item.url + \"/\");\n\n                if (item.items) {\n                  return (\n                    <Collapsible\n                      key={item.title}\n                      defaultOpen={item.items.some((subItem) => location === subItem.url)}\n                      className=\"group/collapsible\"\n                    >\n                      <SidebarMenuItem>\n                        <CollapsibleTrigger asChild>\n                          <SidebarMenuButton data-testid={`sidebar-${item.title}`}>\n                            <item.icon className=\"ml-2\" />\n                            <span>{item.title}</span>\n                            <ChevronDown className=\"mr-auto transition-transform group-data-[state=open]/collapsible:rotate-180\" />\n                          </SidebarMenuButton>\n                        </CollapsibleTrigger>\n                        <CollapsibleContent>\n                          <SidebarMenuSub>\n                            {item.items.map((subItem) => (\n                              <SidebarMenuSubItem key={subItem.title}>\n                                <SidebarMenuSubButton\n                                  asChild\n                                  isActive={location === subItem.url}\n                                  data-testid={`sidebar-sub-${subItem.title}`}\n                                >\n                                  <Link href={subItem.url}>{subItem.title}</Link>\n                                </SidebarMenuSubButton>\n                              </SidebarMenuSubItem>\n                            ))}\n                          </SidebarMenuSub>\n                        </CollapsibleContent>\n                      </SidebarMenuItem>\n                    </Collapsible>\n                  );\n                }\n\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive}\n                      data-testid={`sidebar-${item.title}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"ml-2\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":4743},"client/src/pages/freelancer-dashboard/Withdrawals.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Download, Wallet as WalletIcon } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Wallet, Withdrawal } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function WithdrawalsPage() {\n  const { toast } = useToast();\n  const [showWithdrawalDialog, setShowWithdrawalDialog] = useState(false);\n  const [withdrawalAmount, setWithdrawalAmount] = useState(\"\");\n  const [withdrawalMethod, setWithdrawalMethod] = useState(\"\");\n  const [withdrawalAccount, setWithdrawalAccount] = useState(\"\");\n\n  const { data: wallet } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  const { data: withdrawals = [], isLoading } = useQuery<Withdrawal[]>({\n    queryKey: [\"/api/withdrawals/my\"],\n  });\n\n  const createWithdrawalMutation = useMutation({\n    mutationFn: async (data: { amount: number; paymentMethod: string; accountNumber: string }) => {\n      return apiRequest( \"/api/withdrawals\",\"POST\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/withdrawals/my\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/wallet\"] });\n      setShowWithdrawalDialog(false);\n      setWithdrawalAmount(\"\");\n      setWithdrawalMethod(\"\");\n      setWithdrawalAccount(\"\");\n      toast({\n        title: \"تم إرسال طلب السحب بنجاح\",\n        description: \"سيتم مراجعة طلبك وتحويل المبلغ قريباً\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء إنشاء طلب السحب\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleWithdrawalSubmit = () => {\n    const amount = parseFloat(withdrawalAmount);\n    \n    if (!withdrawalAmount || amount <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال مبلغ صحيح\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalMethod) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار طريقة الدفع\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!withdrawalAccount.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى إدخال رقم الحساب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const walletBalance = parseFloat(wallet?.balance || \"0\");\n    if (amount > walletBalance) {\n      toast({\n        title: \"خطأ\",\n        description: `الرصيد المتاح غير كافٍ. الرصيد الحالي: ${walletBalance} ر.س`,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createWithdrawalMutation.mutate({\n      amount: Number(withdrawalAmount),\n      paymentMethod: withdrawalMethod,\n      accountNumber: withdrawalAccount,\n    });\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد المراجعة\", variant: \"outline\" },\n      processing: { label: \"جارٍ المعالجة\", variant: \"secondary\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n      rejected: { label: \"مرفوض\", variant: \"destructive\" },\n    };\n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  const getPaymentMethodLabel = (method: string) => {\n    const methods: Record<string, string> = {\n      vodafone_cash: \"فودافون كاش\",\n      etisalat_cash: \"اتصالات كاش\",\n      orange_cash: \"أورانج كاش\",\n      bank_card: \"البطاقة البنكية\",\n      bank_transfer: \"تحويل بنكي\",\n    };\n    return methods[method] || method;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-3xl font-bold\">السحوبات</h2>\n          <p className=\"text-muted-foreground mt-1\">\n            اطلب سحب أرباحك وتابع حالة الطلبات\n          </p>\n        </div>\n        <Button\n          onClick={() => setShowWithdrawalDialog(true)}\n          className=\"rounded-xl\"\n          data-testid=\"button-new-withdrawal\"\n        >\n          <Download className=\"ml-2 h-4 w-4\" />\n          طلب سحب جديد\n        </Button>\n      </div>\n\n      <Card className=\"rounded-2xl bg-gradient-to-br from-primary/10 to-primary/5\">\n        <CardHeader>\n          <div className=\"flex items-center gap-2\">\n            <WalletIcon className=\"h-5 w-5 text-primary\" />\n            <CardTitle>رصيد المحفظة</CardTitle>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-4xl font-bold text-primary\">\n            {wallet?.balance || \"0\"} ر.س\n          </div>\n          <p className=\"text-sm text-muted-foreground mt-1\">\n            متاح للسحب\n          </p>\n        </CardContent>\n      </Card>\n\n      <div>\n        <h3 className=\"text-lg font-semibold mb-4\">سجل السحوبات</h3>\n        <div className=\"space-y-3\">\n          {withdrawals.map((withdrawal) => (\n            <Card key={withdrawal.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-withdrawal-${withdrawal.id}`}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"space-y-2 flex-1\">\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-lg font-bold\">{withdrawal.amount} ر.س</span>\n                      {getStatusBadge(withdrawal.status)}\n                    </div>\n                    <div className=\"text-sm text-muted-foreground space-y-1\">\n                      <div>\n                        <span>طريقة الدفع: </span>\n                        <span className=\"font-medium\">{getPaymentMethodLabel(withdrawal.paymentMethod)}</span>\n                      </div>\n                      <div>\n                        <span>رقم الحساب: </span>\n                        <span className=\"font-medium\">{withdrawal.accountNumber}</span>\n                      </div>\n                      <div>\n                        <span>التاريخ: </span>\n                        <span className=\"font-medium\">\n                          {format(new Date(withdrawal.createdAt), \"PPP\", { locale: ar })}\n                        </span>\n                      </div>\n                    </div>\n                    {withdrawal.adminNote && (\n                      <div className=\"p-3 bg-muted rounded-xl mt-2\">\n                        <p className=\"text-sm font-medium\">ملاحظة الإدارة:</p>\n                        <p className=\"text-sm text-muted-foreground\">{withdrawal.adminNote}</p>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n        {withdrawals.length === 0 && (\n          <div className=\"text-center py-12\">\n            <p className=\"text-muted-foreground\">لا توجد طلبات سحب سابقة</p>\n          </div>\n        )}\n      </div>\n\n      <Dialog open={showWithdrawalDialog} onOpenChange={setShowWithdrawalDialog}>\n        <DialogContent className=\"rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle>طلب سحب جديد</DialogTitle>\n            <DialogDescription>\n              املأ البيانات المطلوبة لطلب سحب أرباحك\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"amount\">المبلغ (ر.س)</Label>\n              <Input\n                id=\"amount\"\n                type=\"number\"\n                value={withdrawalAmount}\n                onChange={(e) => setWithdrawalAmount(e.target.value)}\n                placeholder=\"أدخل المبلغ\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-amount\"\n                min=\"0\"\n                step=\"0.01\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                الرصيد المتاح: {wallet?.balance || \"0\"} ر.س\n              </p>\n            </div>\n\n            <div>\n              <Label htmlFor=\"payment-method\">طريقة الدفع</Label>\n              <Select value={withdrawalMethod} onValueChange={setWithdrawalMethod}>\n                <SelectTrigger className=\"rounded-xl mt-1\" data-testid=\"select-withdrawal-method\">\n                  <SelectValue placeholder=\"اختر طريقة الدفع\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"vodafone_cash\">فودافون كاش</SelectItem>\n                  <SelectItem value=\"etisalat_cash\">اتصالات كاش</SelectItem>\n                  <SelectItem value=\"orange_cash\">أورانج كاش</SelectItem>\n                  <SelectItem value=\"bank_card\">البطاقة البنكية</SelectItem>\n                  <SelectItem value=\"bank_transfer\">تحويل بنكي</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"account-number\">رقم الحساب / المحفظة</Label>\n              <Input\n                id=\"account-number\"\n                value={withdrawalAccount}\n                onChange={(e) => setWithdrawalAccount(e.target.value)}\n                placeholder=\"أدخل رقم الحساب\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-withdrawal-account\"\n              />\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                تأكد من صحة رقم الحساب لتجنب التأخير في التحويل\n              </p>\n            </div>\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowWithdrawalDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel-withdrawal\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleWithdrawalSubmit}\n              disabled={createWithdrawalMutation.isPending}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-withdrawal\"\n            >\n              <Download className=\"h-4 w-4 ml-1\" />\n              إرسال الطلب\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":11608},"client/src/pages/freelancer-dashboard/Orders.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingBag } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function OrdersPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n      payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      completed: { label: \"مكتمل\", variant: \"default\" },\n      cancelled: { label: \"ملغي\", variant: \"destructive\" },\n    };\n    const statusInfo = statusConfig[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  const getServiceLabel = (serviceType: string) => {\n    const services: Record<string, string> = {\n      google_play_reviews: \"مراجعات Google Play\",\n      ios_reviews: \"مراجعات iOS\",\n      website_reviews: \"مراجعات المواقع\",\n      ux_testing: \"اختبار تجربة المستخدم\",\n      software_testing: \"اختبار البرمجيات\",\n      social_media: \"وسائل التواصل الاجتماعي\",\n      social_media_single: \"التفاعل مع السوشيال ميديا (حساب واحد شهرياً)\",\n      social_media_dual: \"التفاعل مع السوشيال ميديا (حسابين شهرياً)\",\n      google_maps_reviews: \"مراجعات Google Maps\",\n      google_maps: \"مراجعات Google Maps\",\n    };\n    return services[serviceType] || serviceType;\n  };\n\n  const getPaymentMethodLabel = (method: string) => {\n    const methods: Record<string, string> = {\n      vodafone_cash: \"فودافون كاش\",\n      etisalat_cash: \"اتصالات كاش\",\n      orange_cash: \"أورانج كاش\",\n      bank_card: \"البطاقة البنكية\",\n    };\n    return methods[method] || method;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">الطلبات الواردة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تابع طلبات الخدمات الواردة من أصحاب المشاريع\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        {orders.map((order) => (\n          <Card key={order.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-order-${order.id}`}>\n            <CardHeader>\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex items-start gap-2\">\n                  <ShoppingBag className=\"h-5 w-5 text-primary mt-0.5\" />\n                  <div>\n                    <CardTitle className=\"text-lg\">{getServiceLabel(order.serviceType)}</CardTitle>\n                    <CardDescription>\n                      الكمية: {order.quantity}\n                    </CardDescription>\n                  </div>\n                </div>\n                {getStatusBadge(order.status)}\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              {/* تفاصيل المبلغ */}\n              <div className=\"p-3 bg-muted/50 rounded-xl space-y-1.5 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-muted-foreground\">المبلغ الإجمالي:</span>\n                  <span className=\"font-medium\">${order.totalAmount}</span>\n                </div>\n                {order.platformFee && parseFloat(order.platformFee) > 0 && (\n                  <>\n                    <div className=\"flex justify-between text-amber-600\">\n                      <span>رسوم المنصة (10%):</span>\n                      <span className=\"font-medium\">-${order.platformFee}</span>\n                    </div>\n                    <div className=\"flex justify-between pt-1.5 border-t border-border\">\n                      <span className=\"text-muted-foreground\">صافي المبلغ للجروب:</span>\n                      <span className=\"font-semibold\">${order.netAmount || (parseFloat(order.totalAmount) - parseFloat(order.platformFee)).toFixed(2)}</span>\n                    </div>\n                  </>\n                )}\n              </div>\n\n              {/* تفاصيل التوزيع */}\n              {order.leaderCommission && (\n                <div className=\"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-xl space-y-1.5 text-sm border border-blue-200 dark:border-blue-800\">\n                  <div className=\"flex justify-between text-blue-700 dark:text-blue-400\">\n                    <span className=\"font-medium\">عمولة قائد الجروب (3%):</span>\n                    <span className=\"font-bold\">${order.leaderCommission}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">المبلغ للتوزيع على الأعضاء:</span>\n                    <span className=\"font-semibold\">${order.memberDistribution}</span>\n                  </div>\n                  <div className=\"flex justify-between text-xs pt-1.5 border-t border-blue-200 dark:border-blue-800\">\n                    <span className=\"text-muted-foreground\">عدد الأعضاء: {order.groupMembersCount}</span>\n                    <span>\n                      <span className=\"text-muted-foreground\">نصيب كل عضو: </span>\n                      <span className=\"font-bold text-green-600\">${order.perMemberAmount}</span>\n                    </span>\n                  </div>\n                </div>\n              )}\n              \n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div>\n                  <p className=\"text-muted-foreground\">طريقة الدفع:</p>\n                  <p className=\"font-medium\">{getPaymentMethodLabel(order.paymentMethod)}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">التاريخ:</p>\n                  <p className=\"font-medium\">\n                    {format(new Date(order.createdAt), \"PPP\", { locale: ar })}\n                  </p>\n                </div>\n              </div>\n              {order.paymentDetails && (\n                <div className=\"p-3 bg-muted rounded-xl\">\n                  <p className=\"text-sm font-medium\">تفاصيل الدفع:</p>\n                  <p className=\"text-sm text-muted-foreground\">{order.paymentDetails}</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {orders.length === 0 && (\n        <div className=\"text-center py-12\">\n          <ShoppingBag className=\"h-12 w-12 text-muted-foreground mx-auto mb-3\" />\n          <p className=\"text-muted-foreground\">لا توجد طلبات واردة حالياً</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":7460},"client/src/components/FreelancerDashboardLayout.tsx":{"content":"import { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { FreelancerSidebar } from \"@/components/FreelancerSidebar\";\n\ninterface FreelancerDashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function FreelancerDashboardLayout({ children }: FreelancerDashboardLayoutProps) {\n  const style = {\n    \"--sidebar-width\": \"18rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\" dir=\"rtl\">\n        <FreelancerSidebar />\n        <div className=\"flex flex-col flex-1\">\n          <header className=\"flex items-center p-4 border-b\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":905},"client/src/pages/freelancer-dashboard/AvailableTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Search, CheckCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function AvailableTasks() {\n  const { toast } = useToast();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: myTasks = [], isLoading: isLoadingMyTasks } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n    queryFn: async () => {\n      console.log('[MY TASKS] Fetching my tasks...');\n      const response = await fetch('/api/tasks/my-tasks', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) {\n        console.error('[MY TASKS] Failed to fetch:', response.status);\n        return [];\n      }\n      const data = await response.json();\n      console.log(`[MY TASKS] Received ${data.length} tasks:`, data);\n      return data;\n    },\n  });\n  const { data: availableTasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/available\"],\n    queryFn: async () => {\n      console.log('[AVAILABLE TASKS] Fetching available tasks...');\n      const response = await fetch('/api/tasks/available', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) {\n        console.error('[AVAILABLE TASKS] Failed to fetch:', response.status);\n        return [];\n      }\n      const data = await response.json();\n      console.log(`[AVAILABLE TASKS] Received ${data.length} tasks:`, data);\n      return data;\n    },\n  });\n\n  const acceptTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest(`/api/tasks/${taskId}/accept`, \"POST\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/available\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم قبول المهمة بنجاح\",\n        description: \"يمكنك الآن البدء بالعمل على هذه المهمة\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء قبول المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredTasks = availableTasks.filter((task) =>\n    task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.description.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    task.serviceType.includes(searchQuery)\n  );\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">المهام المتاحة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تصفح واختر المهام التي تناسب مهاراتك\n        </p>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            placeholder=\"ابحث عن مهمة...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pr-10 rounded-xl\"\n            data-testid=\"input-search-tasks\"\n          />\n        </div>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n        {filteredTasks.map((task) => (\n          <Card key={task.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n              <CardDescription>{task.description}</CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              {/* تفاصيل المكافأة */}\n              <div className=\"p-3 bg-muted/50 rounded-xl space-y-1.5 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-muted-foreground\">المكافأة الإجمالية:</span>\n                  <span className=\"font-medium\">${task.reward}</span>\n                </div>\n                {task.platformFee && parseFloat(task.platformFee) > 0 && (\n                  <>\n                    <div className=\"flex justify-between text-amber-600\">\n                      <span>رسوم المنصة (10%):</span>\n                      <span className=\"font-medium\">-${task.platformFee}</span>\n                    </div>\n                    <div className=\"flex justify-between pt-1.5 border-t border-border text-base font-bold text-green-600\">\n                      <span>صافي المكافأة:</span>\n                      <span>${task.netReward || (parseFloat(task.reward) - parseFloat(task.platformFee)).toFixed(2)}</span>\n                    </div>\n                  </>\n                )}\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">نوع الخدمة:</span>\n                <Badge variant=\"outline\">{task.serviceType}</Badge>\n              </div>\n            </CardContent>\n            <CardFooter>\n              <Button\n                className=\"w-full rounded-xl\"\n                onClick={() => acceptTaskMutation.mutate(task.id)}\n                disabled={acceptTaskMutation.isPending}\n                data-testid={`button-accept-${task.id}`}\n              >\n                <CheckCircle className=\"ml-2 h-4 w-4\" />\n                قبول المهمة\n              </Button>\n            </CardFooter>\n          </Card>\n        ))}\n      </div>\n\n      {filteredTasks.length === 0 && (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">لا توجد مهام متاحة حالياً</p>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":6383},"client/src/pages/freelancer-dashboard/Overview.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { CheckCircle2, Clock, ListTodo, ShoppingBag } from \"lucide-react\";\nimport type { Task, Order } from \"@shared/schema\";\n\nexport default function FreelancerOverview() {\n  const { data: myTasks = [] } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const completedTasks = myTasks.filter((t) => t.status === \"approved\").length;\n  const activeTasks = myTasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\").length;\n  const pendingTasks = myTasks.filter((t) => t.status === \"submitted\").length;\n  const totalOrders = orders.length;\n\n  const stats = [\n    {\n      title: \"المهام المكتملة\",\n      value: completedTasks,\n      icon: CheckCircle2,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"المهام النشطة\",\n      value: activeTasks,\n      icon: Clock,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"المهام قيد المراجعة\",\n      value: pendingTasks,\n      icon: ListTodo,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"إجمالي الطلبات\",\n      value: totalOrders,\n      icon: ShoppingBag,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مرحباً بك في لوحة التحكم</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إليك نظرة عامة على أنشطتك وإحصائياتك\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>نشاطاتك الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد نشاطات حديثة\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>الإشعارات الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد إشعارات جديدة\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3520},"client/src/pages/product-owner-dashboard/Overview.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { FolderKanban, Clock, CheckCircle2, ShoppingCart } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\n\nexport default function ProductOwnerOverview() {\n  const { data: orders = [] } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  const totalOrders = orders.length;\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\").length;\n  const completedOrders = orders.filter((o) => o.status === \"completed\").length;\n  const totalSpent = orders.reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const stats = [\n    {\n      title: \"إجمالي الطلبات\",\n      value: totalOrders,\n      icon: ShoppingCart,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"قيد المعالجة\",\n      value: pendingOrders,\n      icon: Clock,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"مكتملة\",\n      value: completedOrders,\n      icon: CheckCircle2,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"إجمالي الإنفاق\",\n      value: `$${totalSpent.toFixed(2)}`,\n      icon: FolderKanban,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مرحباً بك في لوحة التحكم</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إليك نظرة عامة على طلباتك ومشاريعك\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>نشاطاتك الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد نشاطات حديثة\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <CardTitle>الإشعارات الأخيرة</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-muted-foreground text-center py-8\">\n              لا توجد إشعارات جديدة\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3434},"client/src/pages/freelancer-dashboard/MyTasks.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Play, Send } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Task } from \"@shared/schema\";\n\nexport default function MyTasks() {\n  const { toast } = useToast();\n  const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n  const [submissionText, setSubmissionText] = useState(\"\");\n  const [showSubmitDialog, setShowSubmitDialog] = useState(false);\n\n  const { data: myTasks = [], isLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks/my-tasks\"],\n  });\n\n  const startTaskMutation = useMutation({\n    mutationFn: async (taskId: string) => {\n      return apiRequest( `/api/tasks/${taskId}/start`,\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      toast({\n        title: \"تم بدء المهمة\",\n        description: \"المهمة الآن قيد التنفيذ\",\n      });\n    },\n  });\n\n  const submitTaskMutation = useMutation({\n    mutationFn: async (data: { taskId: string; submission: string }) => {\n      return apiRequest( `/api/tasks/${data.taskId}/submit`,\"PATCH\", { submission: data.submission });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks/my-tasks\"] });\n      setShowSubmitDialog(false);\n      setSubmissionText(\"\");\n      toast({\n        title: \"تم تسليم المهمة\",\n        description: \"تم إرسال المهمة للمراجعة بنجاح\",\n      });\n    },\n  });\n\n  const handleSubmitTask = (task: Task) => {\n    setSelectedTask(task);\n    setSubmissionText(task.submission || \"\");\n    setShowSubmitDialog(true);\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n      assigned: { label: \"مقبولة\", variant: \"secondary\" },\n      in_progress: { label: \"قيد التنفيذ\", variant: \"default\" },\n      submitted: { label: \"تم التسليم\", variant: \"secondary\" },\n      approved: { label: \"موافق عليها\", variant: \"default\" },\n      rejected: { label: \"مرفوضة\", variant: \"destructive\" },\n    };\n    \n    const statusInfo = statusMap[status] || { label: status, variant: \"outline\" as const };\n    return <Badge variant={statusInfo.variant}>{statusInfo.label}</Badge>;\n  };\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">مهامي</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تتبع تقدمك في المهام المقبولة\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        {myTasks.map((task) => (\n          <Card key={task.id} className=\"rounded-2xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n            <CardHeader>\n              <div className=\"flex items-start justify-between gap-2\">\n                <div>\n                  <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                  <CardDescription>{task.description}</CardDescription>\n                </div>\n                {getStatusBadge(task.status)}\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              {/* تفاصيل المكافأة */}\n              <div className=\"p-3 bg-muted/50 rounded-xl space-y-1.5 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-muted-foreground\">المكافأة الإجمالية:</span>\n                  <span className=\"font-medium\">${task.reward}</span>\n                </div>\n                {task.platformFee && parseFloat(task.platformFee) > 0 && (\n                  <>\n                    <div className=\"flex justify-between text-amber-600\">\n                      <span>رسوم المنصة (10%):</span>\n                      <span className=\"font-medium\">-${task.platformFee}</span>\n                    </div>\n                    <div className=\"flex justify-between pt-1.5 border-t border-border text-base font-bold text-green-600\">\n                      <span>صافي المكافأة:</span>\n                      <span>${task.netReward || (parseFloat(task.reward) - parseFloat(task.platformFee)).toFixed(2)}</span>\n                    </div>\n                  </>\n                )}\n              </div>\n              \n              {task.feedback && task.status === \"rejected\" && (\n                <div className=\"p-3 bg-destructive/10 rounded-xl\">\n                  <p className=\"text-sm text-destructive font-medium\">سبب الرفض:</p>\n                  <p className=\"text-sm text-destructive\">{task.feedback}</p>\n                </div>\n              )}\n            </CardContent>\n            <CardFooter className=\"gap-2\">\n              {task.status === \"assigned\" && (\n                <Button\n                  className=\"flex-1 rounded-xl\"\n                  onClick={() => startTaskMutation.mutate(task.id)}\n                  disabled={startTaskMutation.isPending}\n                  data-testid={`button-start-${task.id}`}\n                >\n                  <Play className=\"ml-2 h-4 w-4\" />\n                  بدء العمل\n                </Button>\n              )}\n              {task.status === \"in_progress\" && (\n                <Button\n                  className=\"flex-1 rounded-xl\"\n                  onClick={() => handleSubmitTask(task)}\n                  data-testid={`button-submit-${task.id}`}\n                >\n                  <Send className=\"ml-2 h-4 w-4\" />\n                  تسليم المهمة\n                </Button>\n              )}\n            </CardFooter>\n          </Card>\n        ))}\n      </div>\n\n      {myTasks.length === 0 && (\n        <div className=\"text-center py-12\">\n          <p className=\"text-muted-foreground\">لا توجد مهام مقبولة حالياً</p>\n        </div>\n      )}\n\n      <Dialog open={showSubmitDialog} onOpenChange={setShowSubmitDialog}>\n        <DialogContent className=\"rounded-2xl\">\n          <DialogHeader>\n            <DialogTitle>تسليم المهمة</DialogTitle>\n            <DialogDescription>\n              أضف تقريراً عن عملك وأي ملاحظات\n            </DialogDescription>\n          </DialogHeader>\n          <div>\n            <Label htmlFor=\"submission\">التقرير</Label>\n            <Textarea\n              id=\"submission\"\n              value={submissionText}\n              onChange={(e) => setSubmissionText(e.target.value)}\n              placeholder=\"اكتب تفاصيل ما أنجزته...\"\n              className=\"mt-2 rounded-xl\"\n              rows={5}\n              data-testid=\"textarea-submission\"\n            />\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowSubmitDialog(false)}\n              className=\"rounded-xl\"\n              data-testid=\"button-cancel\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={() => selectedTask && submitTaskMutation.mutate({ taskId: selectedTask.id, submission: submissionText })}\n              disabled={submitTaskMutation.isPending || !submissionText.trim()}\n              className=\"rounded-xl\"\n              data-testid=\"button-confirm-submit\"\n            >\n              <Send className=\"ml-2 h-4 w-4\" />\n              إرسال التقرير\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":8225},"client/src/pages/freelancer-dashboard/Settings.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { User, Lock, Save } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Freelancer } from \"@shared/schema\";\n\nexport default function SettingsPage() {\n  const { toast } = useToast();\n  const [fullName, setFullName] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [bio, setBio] = useState(\"\");\n  const [aboutMe, setAboutMe] = useState(\"\");\n  const [jobTitle, setJobTitle] = useState(\"\");\n\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user = userStr ? JSON.parse(userStr) : null;\n\n  // Fetch freelancer data\n  const { data: freelancer, isLoading } = useQuery<Freelancer>({\n    queryKey: [\"/api/freelancers\", user?.id],\n    enabled: !!user?.id,\n  });\n\n  // Populate form when data loads\n  useEffect(() => {\n    if (freelancer) {\n      setFullName(freelancer.fullName || \"\");\n      setPhone(freelancer.phone || \"\");\n      setBio(freelancer.bio || \"\");\n      setAboutMe(freelancer.aboutMe || \"\");\n      setJobTitle(freelancer.jobTitle || \"\");\n    }\n  }, [freelancer]);\n\n  // Update profile mutation\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: Partial<Freelancer>) => {\n      return await apiRequest( `/api/freelancers/${user?.id}`,\"PATCH\", data);\n    },\n    onSuccess: async (response) => {\n      // Update cache\n      queryClient.invalidateQueries({ queryKey: [\"/api/freelancers\", user?.id] });\n      \n      // Update localStorage\n      const currentUserStr = localStorage.getItem(\"user\");\n      const currentUser = currentUserStr ? JSON.parse(currentUserStr) : null;\n      \n      if (currentUser) {\n        const updatedUser = { ...currentUser, fullName, phone, bio, aboutMe, jobTitle };\n        localStorage.setItem(\"user\", JSON.stringify(updatedUser));\n        window.dispatchEvent(new Event(\"userLoggedIn\"));\n      }\n\n      toast({\n        title: \"تم التحديث\",\n        description: \"تم تحديث معلومات حسابك بنجاح\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تحديث معلوماتك\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Change password mutation\n  const changePasswordMutation = useMutation({\n    mutationFn: async (data: { currentPassword: string; newPassword: string }) => {\n      return await apiRequest( \"/api/auth/change-password\",\"PATCH\", data);\n    },\n    onSuccess: () => {\n      setCurrentPassword(\"\");\n      setNewPassword(\"\");\n      setConfirmPassword(\"\");\n      toast({\n        title: \"تم تغيير كلمة المرور\",\n        description: \"تم تحديث كلمة المرور بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error?.message || \"حدث خطأ أثناء تغيير كلمة المرور\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUpdateProfile = () => {\n    if (!fullName.trim()) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء إدخال الاسم الكامل\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    updateProfileMutation.mutate({\n      fullName: fullName.trim(),\n      phone: phone.trim(),\n      bio: bio.trim(),\n      aboutMe: aboutMe.trim(),\n      jobTitle: jobTitle.trim(),\n    });\n  };\n\n  const handleChangePassword = () => {\n    if (!currentPassword || !newPassword || !confirmPassword) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء ملء جميع الحقول\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      toast({\n        title: \"خطأ\",\n        description: \"كلمة المرور الجديدة وتأكيدها غير متطابقين\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (newPassword.length < 6) {\n      toast({\n        title: \"خطأ\",\n        description: \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    changePasswordMutation.mutate({ currentPassword, newPassword });\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">الإعدادات</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          إدارة حسابك وتفضيلاتك\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        {/* Personal Information */}\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <div className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5 text-primary\" />\n              <CardTitle>المعلومات الشخصية</CardTitle>\n            </div>\n            <CardDescription>تحديث بياناتك الأساسية</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"fullName\">الاسم الكامل *</Label>\n              <Input\n                id=\"fullName\"\n                value={fullName}\n                onChange={(e) => setFullName(e.target.value)}\n                placeholder=\"أدخل اسمك الكامل\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-fullname\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={freelancer?.email || \"\"}\n                disabled\n                className=\"rounded-xl mt-1 bg-muted\"\n                data-testid=\"input-email\"\n              />\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                لا يمكن تغيير البريد الإلكتروني\n              </p>\n            </div>\n            <div>\n              <Label htmlFor=\"phone\">رقم الهاتف</Label>\n              <Input\n                id=\"phone\"\n                value={phone}\n                onChange={(e) => setPhone(e.target.value)}\n                placeholder=\"رقم الهاتف\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-phone\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"jobTitle\">المسمى الوظيفي</Label>\n              <Input\n                id=\"jobTitle\"\n                value={jobTitle}\n                onChange={(e) => setJobTitle(e.target.value)}\n                placeholder=\"مثال: مطور واجهات أمامية\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-jobtitle\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"bio\">نبذة مختصرة</Label>\n              <Textarea\n                id=\"bio\"\n                value={bio}\n                onChange={(e) => setBio(e.target.value)}\n                placeholder=\"اكتب نبذة مختصرة عنك...\"\n                className=\"rounded-xl mt-1\"\n                rows={3}\n                data-testid=\"textarea-bio\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"aboutMe\">عني</Label>\n              <Textarea\n                id=\"aboutMe\"\n                value={aboutMe}\n                onChange={(e) => setAboutMe(e.target.value)}\n                placeholder=\"اكتب تفاصيل أكثر عن خبراتك ومهاراتك...\"\n                className=\"rounded-xl mt-1\"\n                rows={4}\n                data-testid=\"textarea-aboutme\"\n              />\n            </div>\n            <Button\n              onClick={handleUpdateProfile}\n              disabled={updateProfileMutation.isPending}\n              className=\"rounded-xl w-full\"\n              data-testid=\"button-save-profile\"\n            >\n              {updateProfileMutation.isPending ? (\n                \"جاري الحفظ...\"\n              ) : (\n                <>\n                  <Save className=\"ml-2 h-4 w-4\" />\n                  حفظ التغييرات\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n\n        {/* Security */}\n        <Card className=\"rounded-2xl\">\n          <CardHeader>\n            <div className=\"flex items-center gap-2\">\n              <Lock className=\"h-5 w-5 text-primary\" />\n              <CardTitle>الأمان</CardTitle>\n            </div>\n            <CardDescription>تغيير كلمة المرور</CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"currentPassword\">كلمة المرور الحالية *</Label>\n              <Input\n                id=\"currentPassword\"\n                type=\"password\"\n                value={currentPassword}\n                onChange={(e) => setCurrentPassword(e.target.value)}\n                placeholder=\"أدخل كلمة المرور الحالية\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-current-password\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"newPassword\">كلمة المرور الجديدة *</Label>\n              <Input\n                id=\"newPassword\"\n                type=\"password\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                placeholder=\"أدخل كلمة مرور جديدة\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-new-password\"\n              />\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                يجب أن تكون 6 أحرف على الأقل\n              </p>\n            </div>\n            <div>\n              <Label htmlFor=\"confirmPassword\">تأكيد كلمة المرور *</Label>\n              <Input\n                id=\"confirmPassword\"\n                type=\"password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                placeholder=\"أعد إدخال كلمة المرور الجديدة\"\n                className=\"rounded-xl mt-1\"\n                data-testid=\"input-confirm-password\"\n              />\n            </div>\n            <Button\n              onClick={handleChangePassword}\n              disabled={changePasswordMutation.isPending}\n              variant=\"outline\"\n              className=\"rounded-xl w-full\"\n              data-testid=\"button-change-password\"\n            >\n              {changePasswordMutation.isPending ? (\n                \"جاري التحديث...\"\n              ) : (\n                <>\n                  <Lock className=\"ml-2 h-4 w-4\" />\n                  تغيير كلمة المرور\n                </>\n              )}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11936},"client/src/components/ProductOwnerSidebar.tsx":{"content":"import {\n  Home,\n  FolderKanban,\n  Clock,\n  CheckCircle2,\n  CreditCard,\n  ShoppingCart,\n  Settings,\n  ChevronDown,\n  MessageCircle,\n  Bell,\n} from \"lucide-react\";\nimport { useLocation, Link } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n} from \"@/components/ui/sidebar\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\n\nconst menuItems = [\n  {\n    title: \"الرئيسية\",\n    url: \"/product-owner-dashboard\",\n    icon: Home,\n  },\n  {\n    title: \"المشاريع\",\n    icon: FolderKanban,\n    items: [\n      { title: \"جميع المشاريع\", url: \"/product-owner-dashboard/projects\" },\n      { title: \"قيد التنفيذ\", url: \"/product-owner-dashboard/projects/active\" },\n      { title: \"المكتملة\", url: \"/product-owner-dashboard/projects/completed\" },\n    ],\n  },\n  {\n    title: \"المدفوعات\",\n    url: \"/product-owner-dashboard/payments\",\n    icon: CreditCard,\n  },\n  {\n    title: \"طلباتي\",\n    url: \"/product-owner-dashboard/orders\",\n    icon: ShoppingCart,\n  },\n  {\n    title: \"المحادثات\",\n    url: \"/product-owner-dashboard/conversations\",\n    icon: MessageCircle,\n  },\n  {\n    title: \"الإشعارات\",\n    url: \"/product-owner-dashboard/notifications\",\n    icon: Bell,\n  },\n  {\n    title: \"الإعدادات\",\n    url: \"/product-owner-dashboard/settings\",\n    icon: Settings,\n  },\n];\n\nexport function ProductOwnerSidebar() {\n  const [location] = useLocation();\n\n  return (\n    <Sidebar side=\"right\">\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel className=\"text-lg font-bold text-primary\">\n            لوحة التحكم - صاحب مشروع\n          </SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => {\n                const isActive = location === item.url || location.startsWith(item.url + \"/\");\n                \n                if (item.items) {\n                  return (\n                    <Collapsible\n                      key={item.title}\n                      defaultOpen={item.items.some((subItem) => location === subItem.url)}\n                      className=\"group/collapsible\"\n                    >\n                      <SidebarMenuItem>\n                        <CollapsibleTrigger asChild>\n                          <SidebarMenuButton data-testid={`sidebar-${item.title}`}>\n                            <item.icon className=\"ml-2\" />\n                            <span>{item.title}</span>\n                            <ChevronDown className=\"mr-auto transition-transform group-data-[state=open]/collapsible:rotate-180\" />\n                          </SidebarMenuButton>\n                        </CollapsibleTrigger>\n                        <CollapsibleContent>\n                          <SidebarMenuSub>\n                            {item.items.map((subItem) => (\n                              <SidebarMenuSubItem key={subItem.title}>\n                                <SidebarMenuSubButton\n                                  asChild\n                                  isActive={location === subItem.url}\n                                  data-testid={`sidebar-sub-${subItem.title}`}\n                                >\n                                  <Link href={subItem.url}>{subItem.title}</Link>\n                                </SidebarMenuSubButton>\n                              </SidebarMenuSubItem>\n                            ))}\n                          </SidebarMenuSub>\n                        </CollapsibleContent>\n                      </SidebarMenuItem>\n                    </Collapsible>\n                  );\n                }\n\n                return (\n                  <SidebarMenuItem key={item.title}>\n                    <SidebarMenuButton\n                      asChild\n                      isActive={isActive}\n                      data-testid={`sidebar-${item.title}`}\n                    >\n                      <Link href={item.url}>\n                        <item.icon className=\"ml-2\" />\n                        <span>{item.title}</span>\n                      </Link>\n                    </SidebarMenuButton>\n                  </SidebarMenuItem>\n                );\n              })}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n    </Sidebar>\n  );\n}\n","size_bytes":4542},"client/src/components/ProductOwnerDashboardLayout.tsx":{"content":"import { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { ProductOwnerSidebar } from \"@/components/ProductOwnerSidebar\";\n\ninterface ProductOwnerDashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function ProductOwnerDashboardLayout({ children }: ProductOwnerDashboardLayoutProps) {\n  const style = {\n    \"--sidebar-width\": \"18rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\" dir=\"rtl\">\n        <ProductOwnerSidebar />\n        <div className=\"flex flex-col flex-1\">\n          <header className=\"flex items-center p-4 border-b\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":917},"client/src/pages/freelancer-dashboard/Wallet.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Wallet as WalletIcon, TrendingUp, DollarSign } from \"lucide-react\";\nimport type { Wallet } from \"@shared/schema\";\n\nexport default function WalletPage() {\n  const { data: wallet, isLoading } = useQuery<Wallet>({\n    queryKey: [\"/api/wallet\"],\n  });\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center py-12\">جاري التحميل...</div>;\n  }\n\n  const balance = parseFloat(wallet?.balance || \"0\");\n  const totalEarned = parseFloat(wallet?.totalEarned || \"0\");\n  const totalWithdrawn = parseFloat(wallet?.totalWithdrawn || \"0\");\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h2 className=\"text-3xl font-bold\">المحفظة</h2>\n        <p className=\"text-muted-foreground mt-1\">\n          تتبع أرباحك ورصيدك المتاح\n        </p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-3\">\n        <Card className=\"rounded-2xl hover-elevate bg-gradient-to-br from-primary/10 to-primary/5\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                الرصيد المتاح\n              </CardTitle>\n              <WalletIcon className=\"h-5 w-5 text-primary\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold\">{balance.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              متاح للسحب\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl hover-elevate\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                إجمالي الأرباح\n              </CardTitle>\n              <TrendingUp className=\"h-5 w-5 text-green-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-green-600\">{totalEarned.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              منذ بداية الانضمام\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"rounded-2xl hover-elevate\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"text-sm font-medium\">\n                إجمالي المسحوبات\n              </CardTitle>\n              <DollarSign className=\"h-5 w-5 text-blue-600\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-blue-600\">{totalWithdrawn.toFixed(2)} ر.س</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              إجمالي ما تم سحبه\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle>آخر المعاملات</CardTitle>\n          <CardDescription>سجل المعاملات الأخيرة</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            لا توجد معاملات حديثة\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":3495},"client/src/pages/product-owner-dashboard/Settings.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { User, Mail, Save } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\ninterface ProductOwner {\n  id: string;\n  email: string;\n  fullName: string;\n}\n\nexport default function SettingsPage() {\n  const { toast } = useToast();\n  const [isEditing, setIsEditing] = useState(false);\n  const [fullName, setFullName] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user: ProductOwner | null = userStr ? JSON.parse(userStr) : null;\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: { fullName: string }) => {\n      if (!user?.id) throw new Error(\"User ID not found\");\n      const response = await apiRequest(`/api/product-owners/${user.id}`,\"PATCH\",  data);\n      return { response, submittedData: data };\n    },\n    onSuccess: ({ response, submittedData }) => {\n      toast({\n        title: \"تم التحديث\",\n        description: \"تم تحديث معلومات حسابك بنجاح\",\n      });\n      setIsEditing(false);\n      // Read current user from localStorage (to avoid stale closure)\n      const currentUserStr = localStorage.getItem(\"user\");\n      const currentUser = currentUserStr ? JSON.parse(currentUserStr) : null;\n      \n      if (currentUser) {\n        // Update localStorage - use response data if available, otherwise use submitted data\n        const updatedData = response || submittedData;\n        const updatedUser = { ...currentUser, ...updatedData };\n        localStorage.setItem(\"user\", JSON.stringify(updatedUser));\n        console.log(\"Updated localStorage.user:\", updatedUser);\n        // Trigger userLoggedIn event to update Navbar\n        window.dispatchEvent(new Event(\"userLoggedIn\"));\n      }\n    },\n    onError: (error) => {\n      console.error(\"Profile update error:\", error);\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء تحديث معلوماتك\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUpdateProfile = () => {\n    const newFullName = fullName.trim();\n    if (!newFullName) {\n      toast({\n        title: \"خطأ\",\n        description: \"الاسم الكامل مطلوب\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateProfileMutation.mutate({ fullName: newFullName });\n  };\n\n  if (!user) {\n    return (\n      <div className=\"space-y-6\">\n        <h1 className=\"text-3xl font-bold\">الإعدادات</h1>\n        <Card>\n          <CardContent className=\"py-8\">\n            <p className=\"text-center text-muted-foreground\">\n              يرجى تسجيل الدخول أولاً\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div>\n        <h1 className=\"text-3xl font-bold\" data-testid=\"text-settings-title\">الإعدادات</h1>\n        <p className=\"text-muted-foreground\">إدارة معلومات حسابك وتفضيلاتك</p>\n      </div>\n\n      {/* Profile Information */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <User className=\"h-5 w-5\" />\n            معلومات الحساب\n          </CardTitle>\n          <CardDescription>\n            معلوماتك الشخصية الأساسية\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n            <div className=\"flex items-center gap-2\">\n              <Mail className=\"h-4 w-4 text-muted-foreground\" />\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={user.email}\n                disabled\n                className=\"bg-muted\"\n                data-testid=\"input-email\"\n              />\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              لا يمكن تغيير البريد الإلكتروني\n            </p>\n          </div>\n\n          <Separator />\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"fullName\">الاسم الكامل</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"fullName\"\n                type=\"text\"\n                value={isEditing ? fullName : user.fullName}\n                onChange={(e) => setFullName(e.target.value)}\n                disabled={!isEditing}\n                className={!isEditing ? \"bg-muted\" : \"\"}\n                data-testid=\"input-fullname\"\n              />\n              {!isEditing ? (\n                <Button\n                  onClick={() => {\n                    setIsEditing(true);\n                    setFullName(user.fullName);\n                  }}\n                  variant=\"outline\"\n                  data-testid=\"button-edit-profile\"\n                >\n                  تعديل\n                </Button>\n              ) : (\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={handleUpdateProfile}\n                    disabled={updateProfileMutation.isPending}\n                    data-testid=\"button-save-profile\"\n                  >\n                    <Save className=\"ml-2 h-4 w-4\" />\n                    {updateProfileMutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n                  </Button>\n                  <Button\n                    onClick={() => setIsEditing(false)}\n                    variant=\"outline\"\n                    data-testid=\"button-cancel-edit\"\n                  >\n                    إلغاء\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Account Type Badge */}\n      <Card>\n        <CardHeader>\n          <CardTitle>نوع الحساب</CardTitle>\n          <CardDescription>\n            معلومات عن نوع حسابك\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"px-3 py-1 bg-primary/10 text-primary rounded-md font-semibold\" data-testid=\"badge-account-type\">\n              صاحب مشروع\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6771},"client/src/pages/FreelancerInstructions.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { AlertCircle, CheckCircle2, ShieldAlert, ArrowRight, Wallet, Pin, XCircle, AlertTriangle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function FreelancerInstructions() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [agreed, setAgreed] = useState(false);\n\n  const acceptInstructionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest(\"/api/freelancers/accept-instructions\", \"PATCH\", {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم التأكيد\",\n        description: \"تم حفظ موافقتك على التعليمات بنجاح\",\n      });\n      // Redirect to freelancer dashboard\n      setLocation(\"/freelancer-dashboard\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء حفظ الموافقة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleContinue = () => {\n    if (!agreed) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يجب الموافقة على التعليمات للمتابعة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    acceptInstructionsMutation.mutate();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background py-8 px-4\" dir=\"rtl\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <Card className=\"border-primary\">\n          <CardHeader>\n            <div className=\"flex items-center gap-3\">\n              <AlertCircle className=\"h-8 w-8 text-primary\" />\n              <div>\n                <CardTitle className=\"text-2xl\">تعليمات هامة لكل المستقلين داخل المنصة</CardTitle>\n                <CardDescription>\n                  يرجى قراءة التعليمات بعناية قبل البدء في العمل على المنصة\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Section 1: التقييمات */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              1. التقييمات – Google Map و Google Play و App Store\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2\">\n                <XCircle className=\"h-5 w-5 text-destructive\" />\n                <p className=\"font-bold text-destructive\">يُمنع تمامًا:</p>\n              </div>\n              <p className=\"mt-2\">تقييم أي خريطة Google Map أو تطبيق يحمل <strong>3.4 نجوم أو أقل</strong>.</p>\n            </div>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب عليك <strong>قراءة جميع المراجعات</strong> قبل تنفيذ أي تقييم، والتأكد من أن الشركة أو التطبيق ذو سمعة جيدة.</li>\n              <li>لا تعمل أبدًا بعشوائية أو \"بالخَش\".</li>\n              <li>لا تقم بتقييم أو رفع تقييم شركة سيئة السمعة أو لا تستحق ذلك.</li>\n              <li className=\"flex items-start gap-2 text-destructive font-semibold\">\n                <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                <span>أي مخالفة قد تؤدي لإيقاف حسابك داخل المنصة.</span>\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 2: التفاعل مع السوشيال ميديا */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-blue-500\" />\n              2. خدمة التفاعل مع منشورات السوشيال ميديا\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">قبل قبول أي طلب تفاعل، قم بالبحث عن الشركة أولًا:</p>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>سمعتها</li>\n              <li>نشاطها</li>\n              <li>تقييم العملاء السابقين</li>\n            </ul>\n\n            <div className=\"bg-amber-50 dark:bg-amber-950 border border-amber-300 dark:border-amber-700 rounded-lg p-4 mt-4\">\n              <div className=\"flex items-start gap-2 text-amber-800 dark:text-amber-200\">\n                <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                <p className=\"font-semibold\">\n                  إذا كانت الشركة سيئة السمعة أو يتعرض لها العملاء بشكاوى كثيرة، <strong>لا تقم بأي تفاعل معها</strong>.\n                </p>\n              </div>\n            </div>\n\n            <p className=\"mt-3 text-sm text-muted-foreground\">\n              <strong>الهدف:</strong> حماية المستقل والمنصة من التعامل مع جهات غير موثوقة.\n            </p>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Section 3: إخلاء المسؤولية */}\n        <Card className=\"border-amber-500\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-amber-600 dark:text-amber-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              إخلاء مسؤولية المنصة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <p>\n              نؤكد نحن كمنصّة أن <strong>هدفنا الأساسي</strong> هو دعم الشركات ذات السمعة الجيدة فعليًا، وتقديم خدمات تساعدها على الظهور بشكل أفضل، وتعزيز مكانتها الحقيقية في السوق.\n            </p>\n\n            <div className=\"bg-muted rounded-lg p-4\">\n              <p className=\"font-semibold\">\n                نحن <strong>لا نسمح بأي شكل من الأشكال</strong> بالتعامل مع شركات أو تطبيقات سيئة السمعة أو تقدم خدمات سيئة للناس، ثم يتم تحسين صورتها من خلال التقييمات أو التفاعل غير العادل.\n              </p>\n            </div>\n\n            <p className=\"font-bold text-lg mt-4\">\n              وحرصًا منّا على الأمانة والصدق أمام الله أولًا، وأمام المستخدمين ثانيًا:\n            </p>\n\n            <Card className=\"bg-primary/5 border-primary\">\n              <CardContent className=\"pt-6 space-y-3\">\n                <div className=\"flex items-center gap-2\">\n                  <CheckCircle2 className=\"h-5 w-5 text-primary\" />\n                  <p className=\"font-bold text-primary\">نحن كمنصّة نُبرئ ذمتنا أمام الله من:</p>\n                </div>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>أي تقييم يتم تنفيذه لصالح شركة سيئة السمعة أو غير مستحقة.</li>\n                  <li>أي محاولة لرفع تقييم شركة تقدم خدمات ضعيفة أو مضرة للناس.</li>\n                  <li>أي نشاط يقوم به المستقل دون التأكد من سمعة الجهة التي يتعامل معها.</li>\n                </ul>\n              </CardContent>\n            </Card>\n\n            <div className=\"mt-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                <p className=\"font-bold text-lg\">هدف المنصة الحقيقي:</p>\n              </div>\n              <p className=\"mb-2\">دعم الشركات الجيدة التي تقدم خدمة محترمة ولكن تعرضت لانخفاض تقييم بسبب:</p>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm\">\n                <li>منافسين مسيئين</li>\n                <li>حملات تشويه</li>\n                <li>سوء فهم من المستخدمين</li>\n              </ul>\n              <p className=\"mt-3\">\n                مساعدة هذه الشركات على <strong>إثبات مكانتها الحقيقية وجودة خدماتها</strong> أمام الجمهور.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 4: مسؤولية المستقل */}\n        <Card className=\"border-destructive\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-destructive\">\n              <AlertCircle className=\"h-6 w-6\" />\n              مسؤولية المستقل\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">قبل قبول أي طلب (تقييم – تفاعل – مراجعات):</p>\n            \n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب عليك <strong>البحث عن الشركة جيدًا</strong>.</li>\n              <li><strong>التأكد</strong> من أنها جيدة وسمعتها محترمة.</li>\n            </ul>\n\n            <div className=\"bg-destructive/10 border-2 border-destructive rounded-lg p-4 mt-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <XCircle className=\"h-6 w-6 text-destructive\" />\n                <p className=\"font-bold text-destructive text-lg\">\n                  إذا كانت الشركة سيئة بالفعل أو لديها شكاوى حقيقية كثيرة...\n                </p>\n              </div>\n              <p className=\"font-bold text-xl mt-2 text-destructive\">\n                يُمنع تمامًا العمل معها أو تحسين تقييمها.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 5: نظام احتجاز الأموال لضمان الجودة */}\n        <Card className=\"border-blue-500 border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-blue-600 dark:text-blue-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              نظام احتجاز الأموال لضمان الجودة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <Wallet className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n                <p className=\"font-bold text-blue-800 dark:text-blue-200\">\n                  فترة احتجاز الأرباح\n                </p>\n              </div>\n              <p className=\"text-blue-900 dark:text-blue-100 leading-relaxed\">\n                يتم احتجاز الأموال في حسابك لمدة <strong>أسبوع واحد (7 أيام)</strong> بعد تنفيذ أي مهمة.\n              </p>\n            </div>\n\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Pin className=\"h-5 w-5 text-foreground\" />\n                <p className=\"font-semibold text-lg\">الهدف من فترة الاحتجاز:</p>\n              </div>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>التأكد من أن جميع التقييمات <strong>شرعية 100%</strong></li>\n                <li>التحقق من أن المهام نُفذت بواسطة <strong>أعضاء الجروب الحقيقيين</strong></li>\n                <li>حماية المنصة وأصحاب المنتجات من أي تلاعب</li>\n                <li>ضمان جودة الخدمة المقدمة</li>\n              </ul>\n            </div>\n\n            <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n                <p className=\"font-bold text-green-800 dark:text-green-200\">\n                  بعد انقضاء المدة (أسبوع واحد):\n                </p>\n              </div>\n              <p className=\"text-green-900 dark:text-green-100\">\n                يمكنك <strong>سحب الأرباح بالكامل</strong> من محفظتك إلى حسابك البنكي أو المحفظة الإلكترونية.\n              </p>\n            </div>\n\n            <div className=\"flex items-start gap-2 text-muted-foreground text-sm mt-3\">\n              <ShieldAlert className=\"h-4 w-4 flex-shrink-0 mt-0.5\" />\n              <p>هذا النظام يحمي كل من المستقلين وأصحاب المنتجات ويضمن شفافية العمليات على المنصة.</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Consent Checkbox */}\n        <Card className=\"border-primary border-2\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <Checkbox\n                id=\"agree\"\n                checked={agreed}\n                onCheckedChange={(checked) => setAgreed(checked as boolean)}\n                data-testid=\"checkbox-agree-instructions\"\n              />\n              <Label\n                htmlFor=\"agree\"\n                className=\"text-base font-semibold cursor-pointer leading-relaxed\"\n              >\n                أوافق على جميع التعليمات المذكورة أعلاه، وأتعهد بالالتزام بها بشكل كامل. وأدرك أن مخالفة هذه التعليمات قد تؤدي إلى إيقاف حسابي على المنصة.\n              </Label>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Buttons */}\n        <div className=\"flex justify-center gap-4 pb-8\">\n          <Button\n            size=\"lg\"\n            onClick={handleContinue}\n            disabled={!agreed || acceptInstructionsMutation.isPending}\n            className=\"px-8\"\n            data-testid=\"button-continue-to-dashboard\"\n          >\n            {acceptInstructionsMutation.isPending ? \"جاري الحفظ...\" : \"موافق - التالي\"}\n            <ArrowRight className=\"mr-2 h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15343},"client/src/pages/product-owner-dashboard/Projects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus, Briefcase, CheckCircle, Clock, XCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, icon: Clock },\n  accepted: { label: \"مقبول\", variant: \"default\" as const, icon: CheckCircle },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, icon: Briefcase },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, icon: CheckCircle },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, icon: XCircle },\n};\n\nexport default function ProjectsPage() {\n  const { data: projects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-3xl font-bold\">مشاريعي</h1>\n        </div>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-6 bg-muted rounded w-3/4\"></div>\n                <div className=\"h-4 bg-muted rounded w-1/2 mt-2\"></div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-4 bg-muted rounded w-full mb-2\"></div>\n                <div className=\"h-4 bg-muted rounded w-2/3\"></div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const pendingProjects = projects.filter((p) => p.status === \"pending\");\n  const activeProjects = projects.filter((p) => p.status === \"accepted\" || p.status === \"in_progress\");\n  const completedProjects = projects.filter((p) => p.status === \"completed\");\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-projects-title\">مشاريعي</h1>\n          <p className=\"text-muted-foreground\">إدارة جميع مشاريعك</p>\n        </div>\n        <Link href=\"/projects/create\">\n          <Button data-testid=\"button-create-project\">\n            <Plus className=\"ml-2 h-4 w-4\" />\n            مشروع جديد\n          </Button>\n        </Link>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">الإجمالي</CardTitle>\n            <Briefcase className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-projects\">{projects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-projects\">{pendingProjects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">النشطة</CardTitle>\n            <Briefcase className=\"h-4 w-4 text-blue-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-projects\">{activeProjects.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-projects\">{completedProjects.length}</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Projects List */}\n      {projects.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع بعد</h3>\n            <p className=\"text-muted-foreground text-center mb-4\">\n              ابدأ بإنشاء مشروعك الأول\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                <Plus className=\"ml-2 h-4 w-4\" />\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n          {projects.map((project) => {\n            const config = statusConfig[project.status as keyof typeof statusConfig];\n            const StatusIcon = config?.icon || Briefcase;\n\n            return (\n              <Card key={project.id} className=\"hover-elevate\" data-testid={`card-project-${project.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <CardTitle className=\"text-lg\" data-testid={`text-project-title-${project.id}`}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge variant={config?.variant || \"secondary\"} data-testid={`badge-status-${project.id}`}>\n                      <StatusIcon className=\"ml-1 h-3 w-3\" />\n                      {config?.label || project.status}\n                    </Badge>\n                  </div>\n                  <CardDescription>{project.description}</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"text-muted-foreground\">الميزانية:</span>\n                    <span className=\"font-semibold\" data-testid={`text-budget-${project.id}`}>\n                      ${project.budget}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"text-muted-foreground\">عدد المهام:</span>\n                    <span className=\"font-semibold\" data-testid={`text-tasks-count-${project.id}`}>\n                      {project.tasksCount || 0}\n                    </span>\n                  </div>\n                  {project.createdAt && (\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"text-muted-foreground\">تاريخ الإنشاء:</span>\n                      <span className=\"text-xs\">\n                        {format(new Date(project.createdAt), \"dd MMM yyyy\", { locale: ar })}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"pt-2\">\n                    <Link href={`/projects/${project.id}`}>\n                      <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                        عرض التفاصيل\n                      </Button>\n                    </Link>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8173},"client/src/pages/product-owner-dashboard/Orders.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingBag, CheckCircle, Clock, XCircle, DollarSign } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, icon: Clock },\n  payment_confirmed: { label: \"تم تأكيد الدفع\", variant: \"default\" as const, icon: CheckCircle },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, icon: ShoppingBag },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, icon: CheckCircle },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, icon: XCircle },\n};\n\nconst serviceTypes: Record<string, string> = {\n  google_play_reviews: \"مراجعات Google Play\",\n  ios_reviews: \"مراجعات iOS\",\n  website_reviews: \"مراجعات المواقع\",\n  ux_testing: \"اختبار تجربة المستخدم\",\n  software_testing: \"اختبار البرمجيات\",\n  social_media: \"وسائل التواصل الاجتماعي\",\n  social_media_engagement: \"تفاعل وسائل التواصل\",\n  social_media_single: \"التفاعل مع السوشيال ميديا (حساب واحد شهرياً)\",\n  social_media_dual: \"التفاعل مع السوشيال ميديا (حسابين شهرياً)\",\n  google_maps_reviews: \"مراجعات Google Maps\",\n  google_maps: \"مراجعات Google Maps\",\n};\n\nexport default function OrdersPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h1 className=\"text-3xl font-bold\">طلباتي</h1>\n        </div>\n        <div className=\"grid gap-4\">\n          {[1, 2, 3].map((i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardHeader>\n                <div className=\"h-6 bg-muted rounded w-3/4\"></div>\n                <div className=\"h-4 bg-muted rounded w-1/2 mt-2\"></div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"h-4 bg-muted rounded w-full mb-2\"></div>\n                <div className=\"h-4 bg-muted rounded w-2/3\"></div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const pendingOrders = orders.filter((o) => o.status === \"pending\" || o.status === \"payment_confirmed\");\n  const activeOrders = orders.filter((o) => o.status === \"in_progress\");\n  const completedOrders = orders.filter((o) => o.status === \"completed\");\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-orders-title\">طلباتي</h1>\n          <p className=\"text-muted-foreground\">جميع طلبات الخدمات التي قمت بشرائها</p>\n        </div>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">الإجمالي</CardTitle>\n            <ShoppingBag className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-orders\">{orders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-orders\">{pendingOrders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد التنفيذ</CardTitle>\n            <ShoppingBag className=\"h-4 w-4 text-blue-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-orders\">{activeOrders.length}</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-orders\">{completedOrders.length}</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Orders List */}\n      {orders.length === 0 ? (\n        <Card>\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <ShoppingBag className=\"h-12 w-12 text-muted-foreground mb-4\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد طلبات بعد</h3>\n            <p className=\"text-muted-foreground text-center\">\n              عندما تقوم بشراء خدمات من الجروبات، ستظهر هنا\n            </p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-4\">\n          {orders.map((order) => {\n            const config = statusConfig[order.status as keyof typeof statusConfig];\n            const StatusIcon = config?.icon || ShoppingBag;\n\n            return (\n              <Card key={order.id} className=\"hover-elevate\" data-testid={`card-order-${order.id}`}>\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg\" data-testid={`text-order-service-${order.id}`}>\n                        {serviceTypes[order.serviceType] || order.serviceType}\n                      </CardTitle>\n                      <CardDescription>\n                        رقم الطلب: {order.id.slice(0, 8)}...\n                      </CardDescription>\n                    </div>\n                    <Badge variant={config?.variant || \"secondary\"} data-testid={`badge-status-${order.id}`}>\n                      <StatusIcon className=\"ml-1 h-3 w-3\" />\n                      {config?.label || order.status}\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">الكمية</span>\n                      <p className=\"font-semibold\" data-testid={`text-quantity-${order.id}`}>\n                        {order.quantity}\n                      </p>\n                    </div>\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">المبلغ الإجمالي</span>\n                      <div className=\"flex items-center gap-1\">\n                        <DollarSign className=\"h-4 w-4 text-green-500\" />\n                        <span className=\"font-bold text-lg\" data-testid={`text-total-${order.id}`}>\n                          ${order.totalAmount}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"space-y-1\">\n                      <span className=\"text-sm text-muted-foreground\">طريقة الدفع</span>\n                      <p className=\"text-sm\" data-testid={`text-payment-method-${order.id}`}>\n                        {order.paymentMethod}\n                      </p>\n                    </div>\n                    {order.createdAt && (\n                      <div className=\"space-y-1\">\n                        <span className=\"text-sm text-muted-foreground\">تاريخ الطلب</span>\n                        <p className=\"text-sm\">\n                          {format(new Date(order.createdAt), \"dd MMM yyyy\", { locale: ar })}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* تفاصيل توزيع المبلغ */}\n                  {order.platformFee && (\n                    <div className=\"p-3 bg-muted/50 rounded-xl space-y-1.5 text-sm\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-muted-foreground\">المبلغ الإجمالي:</span>\n                        <span className=\"font-medium\">${order.totalAmount}</span>\n                      </div>\n                      <div className=\"flex justify-between text-amber-600\">\n                        <span>رسوم المنصة (10%):</span>\n                        <span className=\"font-medium\">-${order.platformFee}</span>\n                      </div>\n                      <div className=\"flex justify-between pt-1.5 border-t border-border\">\n                        <span className=\"text-muted-foreground\">صافي المبلغ للجروب:</span>\n                        <span className=\"font-semibold\">${order.netAmount}</span>\n                      </div>\n                      {order.leaderCommission && (\n                        <>\n                          <div className=\"flex justify-between text-blue-600\">\n                            <span>عمولة قائد الجروب (3%):</span>\n                            <span className=\"font-medium\">${order.leaderCommission}</span>\n                          </div>\n                          <div className=\"flex justify-between text-green-600 pt-1.5 border-t border-border\">\n                            <span>للتوزيع على الأعضاء ({order.groupMembersCount} عضو):</span>\n                            <span className=\"font-bold\">${order.memberDistribution}</span>\n                          </div>\n                          <div className=\"text-xs text-muted-foreground text-center pt-1\">\n                            نصيب كل عضو: ${order.perMemberAmount}\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  )}\n\n                  {order.paymentDetails && (\n                    <div className=\"pt-2 border-t\">\n                      <span className=\"text-sm text-muted-foreground\">تفاصيل الدفع:</span>\n                      <p className=\"text-sm mt-1\">{order.paymentDetails}</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":11111},"client/src/pages/ProductOwnerInstructions.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { CheckCircle2, ShieldAlert, AlertCircle, ArrowRight, Lightbulb, AlertTriangle, XCircle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function ProductOwnerInstructions() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [agreed, setAgreed] = useState(false);\n\n  const acceptInstructionsMutation = useMutation({\n    mutationFn: async () => {\n      return apiRequest( \"/api/product-owners/accept-instructions\",\"PATCH\", {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم التأكيد\",\n        description: \"تم حفظ موافقتك على الشروط والأحكام بنجاح\",\n      });\n      // Redirect to product owner dashboard\n      setLocation(\"/product-owner-dashboard\");\n    },\n    onError: () => {\n      toast({\n        title: \"خطأ\",\n        description: \"حدث خطأ أثناء حفظ الموافقة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleContinue = () => {\n    if (!agreed) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يجب الموافقة على الشروط والأحكام للمتابعة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    acceptInstructionsMutation.mutate();\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background py-8 px-4\" dir=\"rtl\">\n      <div className=\"max-w-4xl mx-auto space-y-6\">\n        {/* Header */}\n        <Card className=\"border-primary\">\n          <CardHeader>\n            <div className=\"flex items-center gap-3\">\n              <ShieldAlert className=\"h-8 w-8 text-primary\" />\n              <div>\n                <CardTitle className=\"text-2xl\">تعليمات هامة للشركات المتعاملة مع المنصة</CardTitle>\n                <CardDescription>\n                  نرحّب بجميع الشركات التي ترغب في الاستفادة من خدمات المستقلين داخل منصّتنا، ولكن لضمان الشفافية وحماية الجميع، يجب الالتزام بالتعليمات التالية\n                </CardDescription>\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Section 1: الالتزام بالشفافية والسمعة الجيدة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              1. الالتزام بالشفافية والسمعة الجيدة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>يجب أن تكون شركتك <strong>ذات سمعة جيدة</strong> في السوق.</li>\n              <li>إذا كانت لديك مشاكل حقيقية في الخدمة أو شكاوى كثيرة من العملاء، يرجى <strong>إصلاحها أولًا</strong> قبل طلب تقييمات أو تفاعل.</li>\n              <li className=\"text-destructive font-semibold\">\n                المنصّة لا تسمح لأي جهة سيئة السمعة باستخدام خدمات المستقلين لتحسين صورة غير حقيقية.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 2: عدم تقديم معلومات مضللة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-blue-500\" />\n              2. عدم تقديم معلومات مضللة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li><strong>يُمنع تقديم</strong> أي معلومات غير صحيحة أو مضللة للمستقلين.</li>\n              <li className=\"text-destructive font-semibold\">\n                أي محاولة لتزييف الحقائق أو إخفاء شكاوى العملاء ستؤدي إلى <strong>إيقاف حساب الشركة على الفور</strong>.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 3: قبول النقد البنّاء */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-amber-500\" />\n              3. قبول النقد البنّاء\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>إذا قام المستقل بقراءة المراجعات ووجد أن هناك مشاكل واضحة، <strong>يحق له رفض الطلب</strong>.</li>\n              <li>هذا الرفض <strong>لا يُعتبر إساءة</strong> بل جزء من سياسات المنصة للحفاظ على المصداقية.</li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 4: السماح للمستقل بالتحقق من الشركة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-purple-500\" />\n              4. السماح للمستقل بالتحقق من الشركة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <p className=\"font-semibold\">على الشركة أن تتفهّم أن المستقل سيقوم بـ:</p>\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li>مراجعة التقييمات</li>\n              <li>الاطلاع على الشكاوى</li>\n              <li>البحث عن اسم الشركة</li>\n            </ul>\n            <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4 mt-4\">\n              <p className=\"font-semibold text-blue-800 dark:text-blue-200\">\n                هذا <strong>إجراء أساسي وضروري</strong> لحماية الطرفين.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 5: استخدام المنصة للجهات التي تستحق تحسين السمعة */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-500\" />\n              5. استخدام المنصة للجهات التي تستحق تحسين السمعة\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <div className=\"flex items-center gap-2 mb-2\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                <p className=\"font-bold text-lg\">المنصة مخصصة لـ:</p>\n              </div>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm\">\n                <li>شركات خدمية جيدة لديها بعض المشاكل البسيطة.</li>\n                <li>شركات تضررت من هجمات منافسين أو تقييمات غير عادلة.</li>\n                <li>تطبيقات أو متاجر لديها جودة جيدة لكن تقييمها لا يعكس الحقيقة.</li>\n              </ul>\n            </div>\n\n            <div className=\"bg-destructive/10 border-2 border-destructive rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <XCircle className=\"h-5 w-5 text-destructive\" />\n                <p className=\"font-bold text-destructive\">وليست مخصصة لـ:</p>\n              </div>\n              <ul className=\"space-y-1 mr-6 list-disc text-sm text-destructive\">\n                <li>شركات سيئة فعليًا</li>\n                <li>شركات تستغل العملاء</li>\n                <li>شركات تقدم خدمات مضرة أو تضليلية</li>\n              </ul>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Section 6: احترام المستقل وعدم إجباره على مهام غير شرعية */}\n        <Card className=\"border-destructive\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-destructive\">\n              <AlertCircle className=\"h-6 w-6\" />\n              6. احترام المستقل وعدم إجباره على مهام غير شرعية\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <ul className=\"space-y-2 mr-6 list-disc\">\n              <li><strong>لا يجوز مطالبة المستقل</strong> بعمل مخالف للسياسات أو للأمانة المهنية.</li>\n              <li className=\"text-destructive font-bold\">\n                أي محاولة للضغط على المستقل أو طلب رفع تقييمات لشركة سيئة ستؤدي لإيقاف حساب الشركة نهائيًا.\n              </li>\n            </ul>\n          </CardContent>\n        </Card>\n\n        {/* Section 7: هدف المنصة */}\n        <Card className=\"border-primary border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-primary\">\n              <CheckCircle2 className=\"h-6 w-6\" />\n              7. هدف المنصة\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-lg leading-relaxed\">\n              هدفنا هو <strong>تحسين سمعة الشركات التي تستحق فعلًا</strong>، ومساعدتها على الظهور بالشكل الصحيح، \n              وليس <span className=\"text-destructive font-bold\">\"تلميع\"</span> شركات غير جيدة أو مضللة.\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Section 8: آلية العمل وضمان التقييمات */}\n        <Card className=\"border-blue-500 border-2\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-xl text-blue-600 dark:text-blue-400\">\n              <ShieldAlert className=\"h-6 w-6\" />\n              8. آلية العمل لضمان تقييمات حقيقية\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <CheckCircle2 className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n                <p className=\"font-bold text-green-800 dark:text-green-200 text-lg\">\n                  نوفر ضمان لمدة أسبوع\n                </p>\n              </div>\n              <p className=\"text-green-900 dark:text-green-100\">\n                إذا تم مسح التقييمات خلال أسبوع من تنفيذها، <strong>يتم استرداد كامل المبلغ إلى حسابك تلقائيًا</strong>.\n              </p>\n            </div>\n\n            <div className=\"bg-amber-50 dark:bg-amber-950 border border-amber-300 dark:border-amber-700 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-3\">\n                <Lightbulb className=\"h-5 w-5 text-amber-600 dark:text-amber-400\" />\n                <p className=\"font-bold text-amber-800 dark:text-amber-200\">\n                  نصيحتنا لك لضمان بقاء التقييمات:\n                </p>\n              </div>\n              <ul className=\"space-y-2 mr-6 list-disc text-amber-900 dark:text-amber-100\">\n                <li className=\"font-semibold\">\n                  اختر مستقلين من <strong>نفس بلدك</strong>\n                </li>\n                <li>\n                  <strong>مثال:</strong> إذا كنت في مصر، اختر مستقلين من مصر لتقييم مطعمك أو شركتك\n                </li>\n                <li>\n                  <strong>مثال:</strong> إذا كنت في السعودية، اختر مستقلين من السعودية\n                </li>\n                <li className=\"flex items-start gap-2 text-amber-800 dark:text-amber-200 font-bold mt-2\">\n                  <AlertTriangle className=\"h-5 w-5 flex-shrink-0 mt-0.5\" />\n                  <span>هذا يقلل بشكل كبير من احتمالية مسح التقييمات من قبل المنصات (Google, App Store, إلخ)</span>\n                </li>\n              </ul>\n            </div>\n\n            <p className=\"text-muted-foreground text-sm mt-4\">\n              التقييمات من نفس المنطقة الجغرافية تبدو أكثر طبيعية ومصداقية للخوارزميات الآلية.\n            </p>\n          </CardContent>\n        </Card>\n\n        <Separator />\n\n        {/* Consent Checkbox */}\n        <Card className=\"border-primary border-2\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <Checkbox\n                id=\"agree\"\n                checked={agreed}\n                onCheckedChange={(checked) => setAgreed(checked as boolean)}\n                data-testid=\"checkbox-agree-terms\"\n              />\n              <Label\n                htmlFor=\"agree\"\n                className=\"text-base font-semibold cursor-pointer leading-relaxed\"\n              >\n                أتعهد بعدم طلب تقييمات غير حقيقية، وجميع التجارب ستكون فعلية داخل المنصة. أوافق على جميع الشروط والأحكام المذكورة أعلاه، وأتعهد بالالتزام بها بشكل كامل. وأدرك أن مخالفة هذه التعليمات قد تؤدي إلى إيقاف حساب الشركة على المنصة.\n              </Label>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Action Button */}\n        <div className=\"flex justify-center gap-4 pb-8\">\n          <Button\n            size=\"lg\"\n            onClick={handleContinue}\n            disabled={!agreed || acceptInstructionsMutation.isPending}\n            className=\"px-8\"\n            data-testid=\"button-continue-to-dashboard\"\n          >\n            {acceptInstructionsMutation.isPending ? \"جاري الحفظ...\" : \"موافق - التالي\"}\n            <ArrowRight className=\"mr-2 h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15152},"client/src/pages/Services.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\"; // Added Badge import\nimport { useState, useEffect, useRef } from \"react\";\nimport { gsap } from \"gsap\";\nimport { ScrollTrigger } from \"gsap/ScrollTrigger\";\nimport { motion } from \"framer-motion\"; // Added motion import\nimport { \n  MapPin, \n  Star, \n  Users, \n  MessageSquare, \n  TrendingUp, \n  Search, \n  Target, \n  Palette, \n  X, \n  CheckCircle, \n  Clock, \n  Zap, \n  ArrowRight,\n  Rocket,\n  Play,\n  Quote,\n  Shield,\n  Sparkles,\n  BarChart3,\n  ThumbsUp,\n  Smartphone,\n  Share2,\n  Layout,\n  Globe,\n  Award,\n  UserCheck,\n  Target as TargetIcon\n} from \"lucide-react\";\n\n// Import images\nimport googleMapsCard from \"@assets/generated_images/Google_Maps_Reviews_Card_d9574a88.png\";\nimport appReviewsCard from \"@assets/generated_images/App_Reviews_Card_1c7a7d75.png\";\nimport uxTestingCard from \"@assets/generated_images/UX_Testing_Card_843ea192.png\";\nimport socialMediaCard from \"@assets/generated_images/Social_Media_Engagement_Card_ced69d5b.png\";\n\n// Register GSAP plugins\ngsap.registerPlugin(ScrollTrigger);\n\n// Animated section wrapper with GSAP\nfunction FadeInSection({ children, delay = 0 }: { children: React.ReactNode; delay?: number }) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      gsap.fromTo(element, \n        { \n          opacity: 0, \n          y: 60,\n          scale: 0.95\n        },\n        { \n          opacity: 1, \n          y: 0,\n          scale: 1,\n          duration: 0.8,\n          delay,\n          ease: \"power2.out\",\n          scrollTrigger: {\n            trigger: element,\n            start: \"top 80%\",\n            end: \"bottom 20%\",\n            toggleActions: \"play none none reverse\"\n          }\n        }\n      );\n    }\n  }, [delay]);\n\n  return (\n    <div ref={ref} className=\"opacity-0\">\n      {children}\n    </div>\n  );\n}\n\n// Gradient background component\nfunction GradientBackground() {\n  return (\n    <div className=\"absolute inset-0 overflow-hidden\">\n      <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute top-60 -left-40 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl\"></div>\n      <div className=\"absolute -bottom-40 right-1/4 w-72 h-72 bg-emerald-500/10 rounded-full blur-3xl\"></div>\n    </div>\n  );\n}\n\nconst services = [\n  {\n    title: \"تقييمات خرائط Google\",\n    description: \"رفع تقييم نشاطك التجاري على الخرائط بطريقة احترافية مبنية على مخاطبة الفئة المستهدفة بذكاء.\",\n    image: googleMapsCard,\n    icon: MapPin,\n    gradient: \"from-blue-500 to-cyan-500\",\n    features: [\"مراجعات حقيقية\", \"تحسين محركات البحث المحلي\", \"زيادة المصداقية\"],\n    fullDescription: \"نقدم خدمة متكاملة لتحسين تقييمات خرائط Google من خلال استراتيجيات مدروسة تزيد من مرئية نشاطك التجاري وتجذب المزيد من العملاء المحليين. نحن نضمن نتائج حقيقية وقابلة للقياس من خلال فريق متخصص في إدارة السمعة الرقمية.\",\n    process: [\n      { step: \"تحليل الملف الحالي\", icon: TargetIcon },\n      { step: \"تطوير استراتيجية مخصصة\", icon: Zap },\n      { step: \"تنفيذ الحملة\", icon: CheckCircle },\n      { step: \"متابعة النتائج\", icon: Clock }\n    ],\n    benefits: [\"زيادة الثقة في علامتك\", \"جذب عملاء جدد\", \"تحسين الترتيب في البحث\"]\n  },\n  {\n    title: \"تقييمات التطبيقات\",\n    description: \"تحسين تقييم تطبيقك عبر مراجعات حقيقية تساعد في رفع الثقة وزيادة التحميلات.\",\n    image: appReviewsCard,\n    icon: Smartphone,\n    gradient: \"from-purple-500 to-pink-500\",\n    features: [\"مراجعات موثوقة\", \"تحسين ترتيب المتجر\", \"زيادة التنزيلات\"],\n    fullDescription: \"نساعدك في تحسين تقييمات تطبيقك على متاجر التطبيقات مما يزيد من ثقة المستخدمين ويحسن ترتيب التطبيق ويزيد من عدد التحميلات بشكل ملحوظ. نعمل على بناء سمعة إيجابية لتطبيقك.\",\n    process: [\n      { step: \"تقييم التطبيق الحالي\", icon: TargetIcon },\n      { step: \"تحديد مجالات التحسين\", icon: Zap },\n      { step: \"تنفيذ استراتيجية المراجعات\", icon: CheckCircle },\n      { step: \"تحسين التصنيف\", icon: Clock }\n    ],\n    benefits: [\"تحسين ترتيب المتجر\", \"زيادة ثقة المستخدمين\", \"نمو مستمر في التحميلات\"]\n  },\n  {\n    title: \"اختبار تجربة المستخدم\",\n    description: \"تحليل شامل لتجربة المستخدم وتصميم رحلة واضحة تساعدك على نجاح مشروعك قبل طرحه للجمهور.\",\n    image: uxTestingCard,\n    icon: Layout,\n    gradient: \"from-orange-500 to-red-500\",\n    features: [\"اختبارات شاملة\", \"تحليل البيانات\", \"تحسين التحويلات\"],\n    fullDescription: \"نقوم باختبار شامل لتجربة المستخدم قبل إطلاق مشروعك لاكتشاف نقاط الضعف وتحسينها، مما يضمن تجربة مستخدم سلسة وناجحة من اليوم الأول. نستخدم أحدث أدوات التحليل لضمان أفضل النتائج.\",\n    process: [\n      { step: \"اختبار الوظائف الأساسية\", icon: TargetIcon },\n      { step: \"تحليل سلوك المستخدم\", icon: Zap },\n      { step: \"تحديد نقاط التحسين\", icon: CheckCircle },\n      { step: \"تنفيذ التوصيات\", icon: Clock }\n    ],\n    benefits: [\"تجربة مستخدم محسنة\", \"تقليل معدلات الخروج\", \"زيادة التحويلات\"]\n  },\n  {\n    title: \"التفاعل على وسائل التواصل\",\n    description: \"زيادة نسبة الوصول والمتابعة من خلال فريق متخصص بالتفاعل الحقيقي.\",\n    image: socialMediaCard,\n    icon: Share2,\n    gradient: \"from-green-500 to-emerald-500\",\n    features: [\"تفاعل حقيقي\", \"زيادة المتابعين\", \"تحسين الوصول\"],\n    fullDescription: \"نخلق تفاعلاً حقيقياً ومستمراً على منصات التواصل الاجتماعي لزيادة وصولك ومتابعيك وتحسين وجودك الرقمي بشكل عام. نضمن تفاعلاً طبيعياً يعكس صورة إيجابية عن علامتك التجارية.\",\n    process: [\n      { step: \"تحليل الجمهور المستهدف\", icon: TargetIcon },\n      { step: \"تخطيط استراتيجية المحتوى\", icon: Zap },\n      { step: \"تنفيذ التفاعل اليومي\", icon: CheckCircle },\n      { step: \"قياس وتحليل النتائج\", icon: Clock }\n    ],\n    benefits: [\"وصول أوسع للجمهور\", \"متابعين نشطين\", \"تفاعل حقيقي ومستمر\"]\n  },\n];\n\n// Additional services for the expanded section\nconst additionalServices = [\n  {\n    title: \"استشارات التسويق الرقمي\",\n    description: \"خطط استراتيجية مخصصة لتحقيق أهدافك التسويقية في العالم الرقمي.\",\n    icon: TrendingUp,\n    gradient: \"from-blue-500 to-blue-600\"\n  },\n  {\n    title: \"تحسين محركات البحث\",\n    description: \"تحسين موقعك لتحقيق ترتيب أعلى في نتائج محركات البحث وجذب المزيد من الزوار.\",\n    icon: Search,\n    gradient: \"from-blue-600 to-blue-700\"\n  },\n  {\n    title: \"إدارة الحملات الإعلانية\",\n    description: \"تصميم وإدارة حملات إعلانية فعالة عبر منصات التواصل الاجتماعي ومحركات البحث.\",\n    icon: Target,\n    gradient: \"from-blue-700 to-blue-800\"\n  },\n  {\n    title: \"تصميم الهوية البصرية\",\n    description: \"إنشاء هوية بصرية متكاملة تعبر عن علامتك التجارية وتجذب عملائك المستهدفين.\",\n    icon: Palette,\n    gradient: \"from-blue-800 to-blue-900\"\n  },\n];\n\nconst stats = [\n  { value: \"500\", label: \"مشروع مكتمل\", suffix: \"+\" },\n  { value: \"98\", label: \"عملاء راضون\", suffix: \"%\" },\n  { value: \"50\", label: \"خبير محترف\", suffix: \"+\" },\n  { value: \"10\", label: \"سنوات خبرة\", suffix: \"+\" }\n];\n\nexport default function Services() {\n  const [selectedService, setSelectedService] = useState(null);\n  const heroRef = useRef(null);\n  const statsRef = useRef(null);\n\n  useEffect(() => {\n    // Hero section animations\n    const tl = gsap.timeline();\n    tl.fromTo(\".hero-title\", \n      { opacity: 0, y: 50 },\n      { opacity: 1, y: 0, duration: 0.8, stagger: 0.2 }\n    )\n    .fromTo(\".hero-description\", \n      { opacity: 0, y: 30 },\n      { opacity: 1, y: 0, duration: 0.6 }, \"-=0.3\"\n    )\n    .fromTo(\".hero-cta\", \n      { opacity: 0, y: 30 },\n      { opacity: 1, y: 0, duration: 0.6, stagger: 0.1 }, \"-=0.2\"\n    );\n\n    // Stats counter animation\n    gsap.fromTo(\".stat-number\",\n      { innerText: 0 },\n      {\n        innerText: (i, target) => {\n          const value = target.getAttribute(\"data-value\");\n          return value;\n        },\n        duration: 2,\n        ease: \"power2.out\",\n        snap: { innerText: 1 },\n        scrollTrigger: {\n          trigger: statsRef.current,\n          start: \"top 70%\",\n          end: \"bottom 30%\",\n          toggleActions: \"play none none reverse\"\n        }\n      }\n    );\n\n    // Service cards animation\n    gsap.fromTo(\".service-card\",\n      { opacity: 0, y: 60 },\n      {\n        opacity: 1,\n        y: 0,\n        duration: 0.8,\n        stagger: 0.15,\n        scrollTrigger: {\n          trigger: \".services-grid\",\n          start: \"top 80%\",\n          end: \"bottom 20%\",\n          toggleActions: \"play none none reverse\"\n        }\n      }\n    );\n  }, []);\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-white overflow-hidden\">\n      <Navbar />\n      \n      {/* Enhanced Hero Section */}\n      <section ref={heroRef} className=\"relative py-24 bg-gradient-to-br from-gray-50 via-white to-blue-50/30 overflow-hidden\">\n        <GradientBackground />\n        \n        <div className=\"max-w-7xl mx-auto px-4 relative z-10 text-center\">\n          <Badge className=\"hero-badge bg-gradient-to-r from-blue-600 to-purple-600 text-white border-0 px-6 py-3 rounded-full inline-flex items-center gap-3 shadow-lg mb-8\">\n            <Sparkles className=\"h-4 w-4\" />\n            خدماتنا الاحترافية\n            <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\n          </Badge>\n\n          <h1 className=\"hero-title text-4xl md:text-6xl font-bold text-gray-900 mb-6\" dir=\"rtl\">\n            حلول <span className=\"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">رقمية متكاملة</span> لنجاحك\n          </h1>\n          \n          <p className=\"hero-description text-xl text-gray-700 max-w-3xl mx-auto mb-10 leading-relaxed\" dir=\"rtl\">\n            نقدم مجموعة متكاملة من الخدمات الاحترافية المصممة خصيصاً لتحسين وجودك الرقمي، \n            زيادة تفاعل العملاء، وتحقيق نمو مستمر لعلامتك التجارية\n          </p>\n          \n          <div className=\"hero-cta flex flex-col sm:flex-row justify-center gap-4\">\n            <Button className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1\">\n              ابدأ مشروعك الآن\n              <Rocket className=\"mr-2 h-5 w-5\" />\n            </Button>\n            <Button variant=\"outline\" className=\"border-2 border-gray-300 hover:border-blue-500 text-gray-700 hover:bg-blue-50 px-8 py-4 rounded-2xl font-semibold text-lg transition-all duration-300 group\">\n              <Play className=\"mr-2 h-5 w-5 group-hover:text-blue-600\" />\n              شاهد أعمالنا\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced Main Services Section */}\n      <section className=\"py-24 px-4 bg-white\">\n        <div className=\"max-w-7xl mx-auto\">\n          <FadeInSection>\n            <div className=\"text-center mb-20\">\n              <Badge className=\"bg-gradient-to-r from-cyan-500 to-blue-500 text-white border-0 px-6 py-2 rounded-full mb-6\">\n                خدماتنا الأساسية\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\" dir=\"rtl\">\n                حلول <span className=\"bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">مبتكرة</span> لتحقيق التميز\n              </h2>\n              <p className=\"text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed\" dir=\"rtl\">\n                نقدم مجموعة متكاملة من الخدمات الرقمية المصممة لتحقيق أهدافك ودفع نمو أعمالك إلى الأمام\n              </p>\n            </div>\n          </FadeInSection>\n\n          <div className=\"services-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 gap-8\">\n            {services.map((service, index) => {\n              const IconComponent = service.icon;\n              return (\n                <motion.div\n                  key={index}\n                  whileHover={{ y: -8, scale: 1.02 }}\n                  className=\"service-card group cursor-pointer\"\n                >\n                  <Card \n                    className=\"bg-gradient-to-br from-white to-gray-50 border border-gray-200 rounded-3xl overflow-hidden h-full transition-all duration-300 hover:shadow-2xl hover:border-transparent\"\n                    onClick={() => setSelectedService(service)}\n                  >\n                    <CardContent className=\"p-6 flex flex-col h-full relative\">\n                      {/* Gradient Overlay on Hover */}\n                      <div className={`absolute inset-0 bg-gradient-to-br ${service.gradient} opacity-0 group-hover:opacity-5 transition-opacity duration-300 rounded-3xl`}></div>\n                      \n                      {/* Icon and Image Section */}\n                      <div className=\"flex-1 flex flex-col items-center mb-6\">\n                        <div className={`w-20 h-20 rounded-2xl bg-gradient-to-r ${service.gradient} flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300 shadow-lg`}>\n                          <IconComponent className=\"w-10 h-10 text-white\" />\n                        </div>\n                        <div className=\"w-full h-40 relative mb-6 rounded-2xl overflow-hidden bg-gray-50 flex items-center justify-center p-4 border border-gray-200\">\n                          <img\n                            src={service.image}\n                            alt={service.title}\n                            className=\"w-full h-full object-contain group-hover:scale-105 transition-transform duration-300\"\n                          />\n                        </div>\n                      </div>\n\n                      {/* Content Section */}\n                      <div className=\"space-y-4 flex-1 flex flex-col relative z-10\">\n                        <h3 className=\"text-xl font-bold leading-tight text-center text-gray-900 group-hover:text-blue-600 transition-colors\" dir=\"rtl\">\n                          {service.title}\n                        </h3>\n                        \n                        <p className=\"text-gray-600 text-sm leading-relaxed text-center flex-1\" dir=\"rtl\">\n                          {service.description}\n                        </p>\n\n                        {/* Features List */}\n                        <div className=\"space-y-3 mt-4\">\n                          {service.features.map((feature, idx) => (\n                            <div key={idx} className=\"flex items-center text-gray-700 text-sm\" dir=\"rtl\">\n                              <div className={`w-2 h-2 rounded-full bg-gradient-to-r ${service.gradient} ml-3 group-hover:scale-125 transition-transform duration-300`}></div>\n                              {feature}\n                            </div>\n                          ))}\n                        </div>\n\n                        {/* Learn More Button */}\n                        <div className=\"flex justify-center pt-6 mt-auto\">\n                          <div className={`text-white text-sm bg-gradient-to-r ${service.gradient} px-6 py-3 rounded-xl backdrop-blur-sm transition-all duration-300 hover:shadow-lg group-hover:scale-105 flex items-center gap-2`}>\n                            تعرف على المزيد\n                            <ArrowRight className=\"h-4 w-4\" />\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              );\n            })}\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced Stats Section */}\n      <section ref={statsRef} className=\"py-24 bg-gradient-to-br from-gray-50 to-blue-50/30 relative overflow-hidden\">\n        <GradientBackground />\n        \n        <div className=\"max-w-7xl mx-auto px-4 relative z-10\">\n          <FadeInSection>\n            <div className=\"text-center mb-20\">\n              <Badge className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white border-0 px-6 py-2 rounded-full mb-6\">\n                <TrendingUp className=\"h-4 w-4 mr-2\" />\n                إنجازاتنا بالأرقام\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\" dir=\"rtl\">\n                ثقة <span className=\"bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">العملاء</span> تدفعنا للأمام\n              </h2>\n            </div>\n          </FadeInSection>\n          \n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n            {stats.map((stat, index) => (\n              <FadeInSection key={index} delay={index * 0.1}>\n                <div className=\"text-center p-8 bg-white rounded-3xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 hover:border-blue-200\">\n                  <div className=\"text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4\">\n                    <span className=\"stat-number\" data-value={stat.value}>0</span>\n                    {stat.suffix}\n                  </div>\n                  <div className=\"text-gray-600 text-lg font-medium\" dir=\"rtl\">{stat.label}</div>\n                </div>\n              </FadeInSection>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced Additional Services Section */}\n      <section className=\"py-24 px-4 bg-white\">\n        <div className=\"max-w-7xl mx-auto\">\n          <FadeInSection>\n            <div className=\"text-center mb-20\">\n              <Badge className=\"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-0 px-6 py-2 rounded-full mb-6\">\n                خدمات متخصصة\n              </Badge>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-gray-900 mb-6\" dir=\"rtl\">\n                حلول <span className=\"bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent\">شاملة</span> لجميع احتياجاتك\n              </h2>\n              <p className=\"text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed\" dir=\"rtl\">\n                نقدم مجموعة واسعة من الخدمات المتخصصة لتلبية جميع متطلباتك الرقمية وتحقيق أهدافك الاستراتيجية\n              </p>\n            </div>\n          </FadeInSection>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {additionalServices.map((service, index) => {\n              const IconComponent = service.icon;\n              return (\n                <FadeInSection key={index} delay={index * 0.1}>\n                  <motion.div\n                    whileHover={{ y: -5, scale: 1.02 }}\n                    className=\"group cursor-pointer\"\n                  >\n                    <div className={`bg-gradient-to-br ${service.gradient} rounded-3xl p-8 border-0 h-full transition-all duration-300 hover:shadow-2xl text-white relative overflow-hidden`}>\n                      {/* Hover Effect */}\n                      <div className=\"absolute inset-0 bg-white/0 group-hover:bg-white/5 transition-colors duration-300\"></div>\n                      \n                      <div className=\"relative z-10\">\n                        <div className=\"w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center text-white mb-6 group-hover:scale-110 transition-transform duration-300\">\n                          <IconComponent className=\"w-8 h-8\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold mb-4 leading-tight\" dir=\"rtl\">{service.title}</h3>\n                        <p className=\"text-white/90 text-sm leading-relaxed\" dir=\"rtl\">{service.description}</p>\n                        \n                        {/* Learn More Arrow */}\n                        <div className=\"flex justify-end mt-6\">\n                          <div className=\"bg-white/20 p-2 rounded-full group-hover:bg-white/30 transition-colors\">\n                            <ArrowRight className=\"h-5 w-5\" />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </motion.div>\n                </FadeInSection>\n              );\n            })}\n          </div>\n        </div>\n      </section>\n\n      {/* Enhanced CTA Section */}\n      <section className=\"py-24 px-4 bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 relative overflow-hidden\">\n        <div className=\"absolute inset-0 bg-black/10\"></div>\n        <div className=\"max-w-5xl mx-auto text-center rounded-3xl p-16 relative overflow-hidden\">\n          {/* Background Elements */}\n          <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16\"></div>\n          <div className=\"absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-24 -translate-x-24\"></div>\n          \n          <div className=\"relative z-10\">\n            <FadeInSection>\n              <h2 className=\"text-4xl lg:text-5xl font-bold text-white mb-6\" dir=\"rtl\">\n                مستعد لبدء رحلتك الرقمية؟\n              </h2>\n              <p className=\"text-xl text-blue-100 mb-10 max-w-2xl mx-auto leading-relaxed\" dir=\"rtl\">\n                اتصل بنا اليوم واحصل على استشارة مجانية لتطوير وجودك الرقمي وتحقيق نمو استثنائي لأعمالك\n              </p>\n              <div className=\"flex flex-col sm:flex-row justify-center gap-4\">\n                <Button className=\"bg-white text-blue-600 hover:bg-gray-100 px-10 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1\">\n                  <MessageSquare className=\"mr-3 h-5 w-5\" />\n                  اتصل بنا الآن\n                </Button>\n                <Button variant=\"outline\" className=\"border-2 border-white text-white hover:bg-white/10 px-10 py-4 rounded-2xl font-semibold text-lg backdrop-blur-sm transition-all duration-300\">\n                  <UserCheck className=\"mr-3 h-5 w-5\" />\n                  اطلب استشارة مجانية\n                </Button>\n              </div>\n            </FadeInSection>\n          </div>\n        </div>\n      </section>\n\n      <Footer />\n\n      {/* Enhanced Modal */}\n      {selectedService && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.9 }}\n            className=\"bg-white rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\"\n          >\n            <div className=\"p-8\">\n              {/* Header */}\n              <div className=\"flex justify-between items-start mb-8\">\n                <div className=\"flex items-center gap-4 flex-1\" dir=\"rtl\">\n                  <div className={`w-14 h-14 rounded-2xl bg-gradient-to-r ${selectedService.gradient} flex items-center justify-center`}>\n                    <selectedService.icon className=\"w-7 h-7 text-white\" />\n                  </div>\n                  <div>\n                    <h2 className=\"text-2xl font-bold text-gray-900\" dir=\"rtl\">\n                      {selectedService.title}\n                    </h2>\n                    <p className=\"text-gray-600 text-sm mt-1\" dir=\"rtl\">\n                      {selectedService.description}\n                    </p>\n                  </div>\n                </div>\n                <button \n                  onClick={() => setSelectedService(null)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-gray-100 rounded-lg\"\n                >\n                  <X className=\"w-6 h-6\" />\n                </button>\n              </div>\n\n              {/* Image */}\n              <div className=\"w-full h-64 mb-8 rounded-2xl overflow-hidden bg-gray-50 flex items-center justify-center p-6 border border-gray-200\">\n                <img\n                  src={selectedService.image}\n                  alt={selectedService.title}\n                  className=\"w-full h-full object-contain\"\n                />\n              </div>\n\n              {/* Full Description */}\n              <div className=\"mb-8\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\" dir=\"rtl\">\n                  <Sparkles className=\"w-5 h-5 text-blue-600\" />\n                  نظرة عامة على الخدمة\n                </h3>\n                <p className=\"text-gray-700 leading-relaxed text-lg\" dir=\"rtl\">\n                  {selectedService.fullDescription}\n                </p>\n              </div>\n\n              <div className=\"grid lg:grid-cols-2 gap-8\">\n                {/* Features */}\n                <div>\n                  <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\" dir=\"rtl\">\n                    <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                    المميزات الرئيسية\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {selectedService.features.map((feature, index) => (\n                      <div key={index} className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-xl\" dir=\"rtl\">\n                        <div className={`w-3 h-3 rounded-full bg-gradient-to-r ${selectedService.gradient}`}></div>\n                        <span className=\"text-gray-700\">{feature}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Benefits */}\n                <div>\n                  <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\" dir=\"rtl\">\n                    <Award className=\"w-5 h-5 text-yellow-500\" />\n                    الفوائد المتوقعة\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {selectedService.benefits.map((benefit, index) => (\n                      <div key={index} className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-xl\" dir=\"rtl\">\n                        <div className={`w-3 h-3 rounded-full bg-gradient-to-r ${selectedService.gradient}`}></div>\n                        <span className=\"text-gray-700\">{benefit}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* Process */}\n              <div className=\"mt-8\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\" dir=\"rtl\">\n                  <Zap className=\"w-5 h-5 text-orange-500\" />\n                  خطوات العمل\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                  {selectedService.process.map((step, index) => {\n                    const StepIcon = step.icon;\n                    return (\n                      <div key={index} className=\"text-center p-4 bg-gray-50 rounded-xl border border-gray-200\">\n                        <div className=\"w-12 h-12 rounded-xl bg-white border border-gray-300 flex items-center justify-center mx-auto mb-3\">\n                          <StepIcon className=\"w-6 h-6 text-blue-600\" />\n                        </div>\n                        <span className=\"text-gray-700 text-sm font-medium\">{step.step}</span>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex justify-between items-center pt-8 mt-8 border-t border-gray-200\">\n                <Button \n                  variant=\"outline\"\n                  className=\"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-3\"\n                  onClick={() => setSelectedService(null)}\n                >\n                  إغلاق\n                </Button>\n                <Button \n                  className={`bg-gradient-to-r ${selectedService.gradient} text-white px-8 py-3 hover:shadow-lg transition-all duration-300`}\n                >\n                  اختر هذه الخدمة\n                  <ArrowRight className=\"mr-2 h-5 w-5\" />\n                </Button>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":30618},"client/src/pages/PrivacyPolicy.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Shield, Eye, Lock, Database, AlertTriangle, CheckCircle2 } from \"lucide-react\";\n\nexport default function PrivacyPolicy() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <Shield className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">سياسة الخصوصية</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    نحن ملتزمون بحماية خصوصيتك وبياناتك الشخصية\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: المعلومات التي نجمعها */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-blue-600\" />\n                1. المعلومات التي نجمعها\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div>\n                <p className=\"font-semibold mb-2\">المعلومات الشخصية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>الاسم الكامل</li>\n                  <li>عنوان البريد الإلكتروني</li>\n                  <li>رقم الهاتف</li>\n                  <li>البلد والمنطقة الجغرافية</li>\n                  <li>معلومات الدفع (يتم تخزينها بشكل آمن عبر بوابات الدفع المعتمدة)</li>\n                </ul>\n              </div>\n              \n              <div>\n                <p className=\"font-semibold mb-2\">المعلومات التقنية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc\">\n                  <li>عنوان IP الخاص بك</li>\n                  <li>نوع المتصفح ونظام التشغيل</li>\n                  <li>سجلات النشاط على المنصة</li>\n                  <li>ملفات تعريف الارتباط (Cookies)</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: كيفية استخدام المعلومات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Eye className=\"h-6 w-6 text-green-600\" />\n                2. كيف نستخدم معلوماتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نستخدم المعلومات التي نجمعها للأغراض التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>تقديم خدماتنا وتحسينها</li>\n                <li>معالجة المعاملات المالية</li>\n                <li>التواصل معك بخصوص حسابك والخدمات</li>\n                <li>تحسين تجربة المستخدم على المنصة</li>\n                <li>منع الاحتيال وحماية أمان المنصة</li>\n                <li>الامتثال للمتطلبات القانونية</li>\n                <li>إرسال إشعارات مهمة حول المنصة</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: حماية البيانات */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Lock className=\"h-6 w-6\" />\n                3. حماية بياناتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4\">\n                <p className=\"font-semibold text-blue-800 dark:text-blue-200 mb-3\">\n                  إجراءات الأمان المتبعة:\n                </p>\n                <ul className=\"space-y-2 mr-6 list-disc text-blue-900 dark:text-blue-100\">\n                  <li>تشفير جميع البيانات الحساسة باستخدام SSL/TLS</li>\n                  <li>استخدام بوابات دفع آمنة ومعتمدة</li>\n                  <li>تخزين كلمات المرور بشكل مشفر (Hashed)</li>\n                  <li>مراقبة مستمرة للأنشطة المشبوهة</li>\n                  <li>تحديثات أمنية منتظمة للأنظمة</li>\n                  <li>الوصول المحدود للبيانات من قبل الموظفين المصرح لهم فقط</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: مشاركة المعلومات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"h-6 w-6 text-amber-600\" />\n                4. مشاركة معلوماتك\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحن <strong>لا نبيع</strong> معلوماتك الشخصية لأطراف ثالثة. قد نشارك معلوماتك فقط في الحالات التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>مع مزودي الخدمات:</strong> مثل بوابات الدفع ومزودي الاستضافة</li>\n                <li><strong>للامتثال القانوني:</strong> عند الطلب من الجهات الحكومية المختصة</li>\n                <li><strong>لحماية الحقوق:</strong> لحماية حقوقنا وحقوق المستخدمين الآخرين</li>\n                <li><strong>في حالة الاندماج:</strong> إذا تم الاستحواذ على الشركة أو دمجها مع شركة أخرى</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: ملفات تعريف الارتباط */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-primary\" />\n                5. ملفات تعريف الارتباط (Cookies)\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نستخدم ملفات تعريف الارتباط لتحسين تجربتك على المنصة:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>ملفات ضرورية:</strong> للحفاظ على تسجيل دخولك وتأمين جلساتك</li>\n                <li><strong>ملفات تحليلية:</strong> لفهم كيفية استخدامك للمنصة</li>\n                <li><strong>ملفات وظيفية:</strong> لتذكر تفضيلاتك وإعداداتك</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                يمكنك التحكم في ملفات تعريف الارتباط من خلال إعدادات المتصفح الخاص بك.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: حقوقك */}\n          <Card className=\"border-green-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-green-600 dark:text-green-400\">\n                <CheckCircle2 className=\"h-6 w-6\" />\n                6. حقوقك الخاصة بالبيانات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                لديك الحقوق التالية فيما يتعلق ببياناتك الشخصية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>الوصول:</strong> يمكنك طلب نسخة من بياناتك الشخصية</li>\n                <li><strong>التصحيح:</strong> يمكنك تحديث أو تصحيح معلوماتك</li>\n                <li><strong>الحذف:</strong> يمكنك طلب حذف حسابك وبياناتك</li>\n                <li><strong>الاعتراض:</strong> يمكنك الاعتراض على معالجة بياناتك لأغراض معينة</li>\n                <li><strong>نقل البيانات:</strong> يمكنك طلب نقل بياناتك إلى خدمة أخرى</li>\n                <li><strong>سحب الموافقة:</strong> يمكنك سحب موافقتك في أي وقت</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                للاستفادة من أي من هذه الحقوق، يرجى التواصل معنا عبر البريد الإلكتروني.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: الاحتفاظ بالبيانات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"h-6 w-6 text-primary\" />\n                7. مدة الاحتفاظ بالبيانات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بمعلوماتك الشخصية طالما كان حسابك نشطًا أو حسب الحاجة لتقديم خدماتنا. عند حذف حسابك:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>سيتم حذف بياناتك الشخصية خلال 30 يومًا</li>\n                <li>قد نحتفظ ببعض البيانات للامتثال القانوني</li>\n                <li>سيتم الاحتفاظ بسجلات المعاملات لأغراض محاسبية</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: خصوصية الأطفال */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <AlertTriangle className=\"h-6 w-6\" />\n                8. خصوصية الأطفال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                منصة سُمُوّ غير مخصصة للأشخاص تحت سن 18 عامًا. نحن لا نجمع معلومات شخصية من الأطفال عن قصد. إذا اكتشفنا أن طفلاً قد قدم معلومات شخصية، سنتخذ خطوات لحذف هذه المعلومات فورًا.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: التعديلات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Shield className=\"h-6 w-6 text-primary\" />\n                9. التعديلات على سياسة الخصوصية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                قد نقوم بتحديث سياسة الخصوصية هذه من وقت لآخر. سنخطرك بأي تغييرات جوهرية عبر البريد الإلكتروني أو من خلال إشعار على المنصة. يُنصح بمراجعة هذه الصفحة بشكل دوري للاطلاع على أي تحديثات.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6 space-y-3\">\n              <p className=\"text-center font-semibold\">\n                لأي أسئلة أو استفسارات حول سياسة الخصوصية\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground\">\n                يرجى التواصل معنا عبر البريد الإلكتروني أو من خلال نموذج الاتصال\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-4\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":13327},"client/src/pages/TermsConditions.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { FileText, CheckCircle2, XCircle, AlertTriangle } from \"lucide-react\";\n\nexport default function TermsConditions() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <FileText className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">الشروط والأحكام</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    يرجى قراءة هذه الشروط والأحكام بعناية قبل استخدام منصة سُمُوّ\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: القبول والموافقة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                1. القبول والموافقة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                باستخدامك لمنصة سُمُوّ، فإنك توافق على الالتزام بهذه الشروط والأحكام. إذا كنت لا توافق على أي جزء من هذه الشروط، يرجى عدم استخدام المنصة.\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يجب أن تكون بعمر 18 عامًا على الأقل لاستخدام المنصة</li>\n                <li>يجب تقديم معلومات دقيقة وصحيحة عند التسجيل</li>\n                <li>أنت مسؤول عن الحفاظ على سرية حسابك وكلمة المرور</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: استخدام المنصة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-blue-600\" />\n                2. استخدام المنصة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"font-semibold\">يُسمح باستخدام المنصة لـ:</p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>تحسين تقييمات المنتجات والخدمات ذات الجودة الحقيقية</li>\n                <li>اختبار تجربة المستخدم للمنتجات الرقمية</li>\n                <li>الحصول على تفاعل حقيقي على منصات التواصل الاجتماعي</li>\n                <li>تقديم خدمات مراجعة احترافية للتطبيقات والمواقع</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: الممنوعات */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                3. الممنوعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n                <p className=\"font-bold text-destructive mb-2\">يُمنع تمامًا:</p>\n                <ul className=\"space-y-2 mr-6 list-disc text-destructive\">\n                  <li>تحسين تقييم منتجات أو خدمات سيئة أو مضللة</li>\n                  <li>نشر محتوى كاذب أو مضلل</li>\n                  <li>انتحال شخصية الآخرين أو استخدام حسابات وهمية</li>\n                  <li>التلاعب بالنظام أو محاولة اختراق المنصة</li>\n                  <li>استخدام المنصة لأغراض غير قانونية</li>\n                  <li>إساءة استخدام بيانات المستخدمين الآخرين</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: حقوق الملكية الفكرية */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                4. حقوق الملكية الفكرية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                جميع الحقوق الخاصة بالمحتوى والتصميم والشعارات والعلامات التجارية على منصة سُمُوّ محفوظة. لا يجوز نسخ أو توزيع أو تعديل أي محتوى من المنصة دون إذن كتابي مسبق.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: المسؤولية */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <AlertTriangle className=\"h-6 w-6\" />\n                5. إخلاء المسؤولية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                منصة سُمُوّ هي وسيط بين المستقلين وأصحاب المنتجات. نحن غير مسؤولين عن:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>جودة الخدمات المقدمة من قبل المستقلين</li>\n                <li>صحة المعلومات المقدمة من قبل أصحاب المنتجات</li>\n                <li>أي نزاعات بين المستقلين وأصحاب المنتجات</li>\n                <li>أي خسائر مباشرة أو غير مباشرة ناتجة عن استخدام المنصة</li>\n              </ul>\n              <p className=\"text-sm text-muted-foreground mt-3\">\n                المستخدم يتحمل المسؤولية الكاملة عن أفعاله واستخدامه للمنصة.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: الدفع والمعاملات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                6. الدفع والمعاملات المالية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يتم احتجاز أرباح المستقلين لمدة 7 أيام لضمان جودة الخدمة</li>\n                <li>نوفر ضمان استرداد كامل المبلغ إذا تم حذف التقييمات خلال 7 أيام</li>\n                <li>جميع الأسعار مذكورة بالدولار الأمريكي ما لم يُذكر خلاف ذلك</li>\n                <li>نحن نستخدم بوابات دفع آمنة لحماية معلوماتك المالية</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: إنهاء الحساب */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                7. إنهاء وإيقاف الحساب\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بالحق في إيقاف أو إنهاء أي حساب في الحالات التالية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>مخالفة أي من الشروط والأحكام</li>\n                <li>استخدام المنصة لأغراض غير قانونية أو غير أخلاقية</li>\n                <li>محاولة التلاعب بالنظام أو الاحتيال</li>\n                <li>تقديم معلومات كاذبة أو مضللة</li>\n                <li>إساءة استخدام المنصة بأي شكل من الأشكال</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: التعديلات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                8. التعديلات على الشروط\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحتفظ بالحق في تعديل هذه الشروط والأحكام في أي وقت. سيتم إخطار المستخدمين بأي تغييرات جوهرية عبر البريد الإلكتروني أو من خلال إشعار على المنصة. استمرارك في استخدام المنصة بعد التعديلات يعني موافقتك على الشروط الجديدة.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: القانون الساري */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-6 w-6 text-primary\" />\n                9. القانون الساري وحل النزاعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                تخضع هذه الشروط والأحكام للقوانين المعمول بها في الدولة التي تعمل منها المنصة. في حالة نشوء أي نزاع، يتم حله عن طريق التفاوض الودي أولاً، وإذا تعذر ذلك، يتم اللجوء إلى المحاكم المختصة.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6\">\n              <p className=\"text-center text-sm text-muted-foreground\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-2\">\n                لأي استفسارات حول الشروط والأحكام، يرجى التواصل معنا عبر البريد الإلكتروني\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":11553},"client/src/pages/RefundPolicy.tsx":{"content":"import { Navbar } from \"@/components/Navbar\";\nimport { Footer } from \"@/components/Footer\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Wallet, CheckCircle2, Clock, AlertTriangle, XCircle, Shield } from \"lucide-react\";\n\nexport default function RefundPolicy() {\n  return (\n    <div className=\"min-h-screen flex flex-col bg-background\">\n      <Navbar />\n      \n      <main className=\"flex-1 py-12 px-4\" dir=\"rtl\">\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {/* Header */}\n          <Card className=\"border-primary\">\n            <CardHeader>\n              <div className=\"flex items-center gap-3\">\n                <Wallet className=\"h-8 w-8 text-primary\" />\n                <div>\n                  <CardTitle className=\"text-3xl\">سياسة استرداد الأموال</CardTitle>\n                  <p className=\"text-muted-foreground mt-2\">\n                    نحن ملتزمون بتقديم خدمة عالية الجودة مع ضمان حقوقك المالية\n                  </p>\n                </div>\n              </div>\n            </CardHeader>\n          </Card>\n\n          {/* Section 1: ضمان 7 أيام */}\n          <Card className=\"border-green-500 border-2\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-green-600 dark:text-green-400\">\n                <CheckCircle2 className=\"h-6 w-6\" />\n                1. ضمان استرداد الأموال لمدة 7 أيام\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded-lg p-4\">\n                <p className=\"font-bold text-green-800 dark:text-green-200 mb-3\">\n                  نوفر ضمان استرداد كامل المبلغ في الحالات التالية:\n                </p>\n                <ul className=\"space-y-2 mr-6 list-disc text-green-900 dark:text-green-100\">\n                  <li>\n                    <strong>حذف التقييمات:</strong> إذا تم حذف التقييمات من قبل منصات مثل Google، App Store، أو Play Store خلال 7 أيام من تنفيذها\n                  </li>\n                  <li>\n                    <strong>عدم التنفيذ:</strong> إذا لم يتم تنفيذ الخدمة المتفق عليها خلال المدة المحددة\n                  </li>\n                  <li>\n                    <strong>خدمة غير مطابقة:</strong> إذا كانت الخدمة المقدمة لا تطابق المواصفات المتفق عليها\n                  </li>\n                </ul>\n              </div>\n              \n              <p className=\"text-sm text-muted-foreground\">\n                يتم معالجة طلبات الاسترداد خلال 3-5 أيام عمل من تاريخ التحقق من الطلب.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Section 2: نظام احتجاز الأموال للمستقلين */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Clock className=\"h-6 w-6\" />\n                2. نظام احتجاز الأموال (7 أيام)\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"leading-relaxed\">\n                لضمان جودة الخدمات وحماية أصحاب المنتجات، يتم احتجاز أرباح المستقلين لمدة <strong>7 أيام</strong> بعد إتمام المهمة:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>التأكد من أن التقييمات لا تزال موجودة ولم يتم حذفها</li>\n                <li>التحقق من أن الخدمة تمت بشكل صحيح وفقًا للمواصفات</li>\n                <li>منح فترة كافية لأصحاب المنتجات للتحقق من الجودة</li>\n                <li>حماية المنصة والمستخدمين من التلاعب أو الاحتيال</li>\n              </ul>\n              <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-300 dark:border-blue-700 rounded-lg p-4 mt-3\">\n                <p className=\"text-blue-900 dark:text-blue-100\">\n                  بعد انقضاء فترة الـ 7 أيام، يمكن للمستقلين سحب أرباحهم بالكامل إلى حساباتهم البنكية أو محافظهم الإلكترونية.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 3: طلبات الاسترداد المؤهلة */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n                3. الحالات المؤهلة لاسترداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"font-semibold\">يمكنك طلب استرداد الأموال في الحالات التالية:</p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>حذف التقييمات خلال 7 أيام من التنفيذ</li>\n                <li>عدم تنفيذ المهام في الوقت المحدد (تأخير أكثر من 48 ساعة)</li>\n                <li>تقديم خدمة منخفضة الجودة أو غير احترافية</li>\n                <li>مخالفة المستقل للمواصفات المتفق عليها</li>\n                <li>مشاكل تقنية في المنصة منعت إتمام الخدمة</li>\n                <li>إلغاء الطلب قبل بدء التنفيذ</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 4: الحالات غير المؤهلة */}\n          <Card className=\"border-destructive\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-destructive\">\n                <XCircle className=\"h-6 w-6\" />\n                4. الحالات غير المؤهلة لاسترداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-4\">\n                <p className=\"font-bold text-destructive mb-2\">لا يمكن استرداد الأموال في الحالات التالية:</p>\n                <ul className=\"space-y-2 mr-6 list-disc text-destructive\">\n                  <li>بعد مرور 7 أيام من تنفيذ الخدمة بنجاح</li>\n                  <li>إذا كانت المشكلة ناتجة عن معلومات خاطئة قدمها صاحب المنتج</li>\n                  <li>عدم الرضا عن النتائج دون سبب موضوعي</li>\n                  <li>تغيير رأيك بعد بدء تنفيذ المهمة</li>\n                  <li>إذا كان المنتج أو الخدمة سيئة بالفعل (تقييم أقل من 3.4 نجوم)</li>\n                  <li>استخدام الخدمة لأغراض غير قانونية أو غير أخلاقية</li>\n                </ul>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Section 5: كيفية طلب الاسترداد */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Wallet className=\"h-6 w-6 text-primary\" />\n                5. كيفية طلب استرداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"font-semibold\">اتبع الخطوات التالية لطلب استرداد أموالك:</p>\n              <ol className=\"space-y-3 mr-6 list-decimal\">\n                <li>\n                  <strong>تسجيل الدخول إلى حسابك</strong>\n                  <p className=\"text-sm text-muted-foreground\">قم بتسجيل الدخول إلى لوحة التحكم الخاصة بك</p>\n                </li>\n                <li>\n                  <strong>الانتقال إلى الطلبات</strong>\n                  <p className=\"text-sm text-muted-foreground\">ابحث عن الطلب الذي تريد استرداد المال له</p>\n                </li>\n                <li>\n                  <strong>طلب الاسترداد</strong>\n                  <p className=\"text-sm text-muted-foreground\">انقر على زر \"طلب استرداد الأموال\" وحدد السبب</p>\n                </li>\n                <li>\n                  <strong>تقديم الدليل</strong>\n                  <p className=\"text-sm text-muted-foreground\">أرفق لقطات شاشة أو أي دليل يدعم طلبك</p>\n                </li>\n                <li>\n                  <strong>انتظار المراجعة</strong>\n                  <p className=\"text-sm text-muted-foreground\">سيتم مراجعة طلبك خلال 24-48 ساعة</p>\n                </li>\n              </ol>\n            </CardContent>\n          </Card>\n\n          {/* Section 6: مدة معالجة الاسترداد */}\n          <Card className=\"border-amber-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-amber-600 dark:text-amber-400\">\n                <Clock className=\"h-6 w-6\" />\n                6. مدة معالجة طلبات الاسترداد\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>\n                  <strong>المراجعة:</strong> 24-48 ساعة من تقديم الطلب\n                </li>\n                <li>\n                  <strong>الموافقة:</strong> يتم إخطارك بالقرار عبر البريد الإلكتروني\n                </li>\n                <li>\n                  <strong>الاسترداد إلى المحفظة:</strong> فوري بعد الموافقة\n                </li>\n                <li>\n                  <strong>الاسترداد إلى البطاقة/البنك:</strong> 5-7 أيام عمل\n                </li>\n                <li>\n                  <strong>الاسترداد إلى المحافظ الإلكترونية:</strong> 1-3 أيام عمل\n                </li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 7: طرق الاسترداد */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Wallet className=\"h-6 w-6 text-green-600\" />\n                7. طرق استرداد الأموال\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                يتم استرداد الأموال بنفس طريقة الدفع الأصلية:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li><strong>المحفظة داخل المنصة:</strong> استرداد فوري</li>\n                <li><strong>فودافون كاش / اتصالات كاش / أورنج كاش:</strong> 1-3 أيام</li>\n                <li><strong>بطاقة ائتمان / خصم:</strong> 5-7 أيام عمل</li>\n                <li><strong>حوالة بنكية:</strong> 3-5 أيام عمل</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 8: الحماية والضمان */}\n          <Card className=\"border-blue-500\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                <Shield className=\"h-6 w-6\" />\n                8. حمايتك مضمونة\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                نحن نضمن لك:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>معالجة عادلة وشفافة لجميع طلبات الاسترداد</li>\n                <li>حماية معلوماتك المالية والشخصية</li>\n                <li>استرداد فوري في الحالات الواضحة</li>\n                <li>دعم فني متواصل للمساعدة في عملية الاسترداد</li>\n                <li>عدم فرض أي رسوم على عمليات الاسترداد</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          {/* Section 9: النزاعات */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <AlertTriangle className=\"h-6 w-6 text-amber-600\" />\n                9. حل النزاعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"leading-relaxed\">\n                في حالة رفض طلب الاسترداد:\n              </p>\n              <ul className=\"space-y-2 mr-6 list-disc\">\n                <li>يمكنك تقديم اعتراض مع أدلة إضافية</li>\n                <li>سيتم مراجعة الطلب من قبل فريق مختص</li>\n                <li>يمكنك التواصل مع فريق الدعم لحل ودي</li>\n                <li>في حالة عدم الوصول لحل، يمكن اللجوء للتحكيم</li>\n              </ul>\n            </CardContent>\n          </Card>\n\n          <Separator />\n\n          {/* Contact Section */}\n          <Card className=\"bg-muted/50\">\n            <CardContent className=\"pt-6 space-y-3\">\n              <p className=\"text-center font-semibold\">\n                لأي استفسارات حول سياسة استرداد الأموال\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground\">\n                يرجى التواصل مع فريق الدعم عبر البريد الإلكتروني أو من خلال لوحة التحكم\n              </p>\n              <p className=\"text-center text-sm text-muted-foreground mt-4\">\n                آخر تحديث: {new Date().toLocaleDateString('ar-SA')}\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":14887},"client/src/pages/product-owner-dashboard/Conversations.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { MessageCircle, Users } from \"lucide-react\";\nimport type { Conversation } from \"@shared/schema\";\nimport { ConversationChat } from \"@/components/ConversationChat\";\n\ntype ConversationWithDetails = Conversation & {\n  group?: {\n    id: string;\n    name: string;\n    leaderId: string;\n  };\n  leader?: {\n    id: string;\n    fullName: string;\n  };\n  productOwner?: {\n    id: string;\n    fullName: string;\n  };\n};\n\nexport default function Conversations() {\n  const [location] = useLocation();\n  const [selectedConversation, setSelectedConversation] = useState<string | null>(null);\n\n  // Get current user from localStorage\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n\n  // Extract conversationId from query params\n  useEffect(() => {\n    const params = new URLSearchParams(location.split('?')[1] || '');\n    const conversationId = params.get('conversationId');\n    if (conversationId) {\n      setSelectedConversation(conversationId);\n    }\n  }, [location]);\n\n  // Fetch all conversations\n  const { data: conversations = [], isLoading: loadingConversations } = useQuery<ConversationWithDetails[]>({\n    queryKey: [\"/api/conversations\"],\n  });\n\n  const selectedConvData = conversations.find((c) => c.id === selectedConversation);\n\n  if (loadingConversations) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"text-muted-foreground\">جاري التحميل...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col p-4 gap-4\">\n      <div className=\"flex items-center gap-2\">\n        <MessageCircle className=\"h-6 w-6 text-primary\" />\n        <h1 className=\"text-2xl font-bold\">المحادثات</h1>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 flex-1 overflow-hidden\">\n        {/* Conversations List */}\n        <Card className=\"lg:col-span-1\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Users className=\"h-5 w-5\" />\n              قائمة المحادثات\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"p-0\">\n            <ScrollArea className=\"h-[calc(100vh-16rem)]\">\n              {conversations.length === 0 ? (\n                <div className=\"p-4 text-center text-muted-foreground\">\n                  لا توجد محادثات حالياً\n                </div>\n              ) : (\n                <div className=\"space-y-1 p-2\">\n                  {conversations.map((conv) => (\n                    <div\n                      key={conv.id}\n                      onClick={() => setSelectedConversation(conv.id)}\n                      className={`p-3 rounded-lg cursor-pointer transition-colors hover-elevate active-elevate-2 ${\n                        selectedConversation === conv.id\n                          ? \"bg-accent\"\n                          : \"\"\n                      }`}\n                      data-testid={`conversation-item-${conv.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar>\n                          <AvatarFallback>\n                            {conv.leader?.fullName?.charAt(0) || \"?\"}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-semibold truncate\">\n                            {conv.group?.name || \"جروب غير معروف\"}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground truncate\">\n                            {conv.leader?.fullName || \"قائد غير معروف\"}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </ScrollArea>\n          </CardContent>\n        </Card>\n\n        {/* Chat Area */}\n        <Card className=\"lg:col-span-2\">\n          {selectedConversation && selectedConvData ? (\n            <ConversationChat\n              conversationId={selectedConversation}\n              currentUserId={currentUser?.id || ''}\n              currentUserType=\"product_owner\"\n              recipientName={selectedConvData.leader?.fullName || \"قائد غير معروف\"}\n              groupName={selectedConvData.group?.name}\n            />\n          ) : (\n            <CardContent className=\"flex items-center justify-center h-full\">\n              <div className=\"text-center text-muted-foreground\">\n                <MessageCircle className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>اختر محادثة لعرضها</p>\n              </div>\n            </CardContent>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5202},"client/src/pages/product-owner-dashboard/CompletedProjects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { CheckCircle2, Calendar, DollarSign, Users } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function CompletedProjectsPage() {\n  const { data: allProjects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  // Filter for completed projects only\n  const completedProjects = allProjects.filter((p) => p.status === \"completed\");\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-completed-projects-title\">\n            المشاريع المكتملة\n          </h1>\n          <p className=\"text-muted-foreground\">\n            المشاريع التي تم إنجازها بنجاح ({completedProjects.length})\n          </p>\n        </div>\n      </div>\n\n      {completedProjects.length === 0 ? (\n        <Card className=\"rounded-2xl\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <CheckCircle2 className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع مكتملة</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              لم تكمل أي مشاريع بعد\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {completedProjects.map((project) => (\n            <Card\n              key={project.id}\n              className=\"rounded-2xl hover-elevate\"\n              data-testid={`card-project-${project.id}`}\n            >\n              <CardHeader>\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1\">\n                    <CardTitle className=\"text-lg mb-2\" data-testid={`project-title-${project.id}`}>\n                      {project.title}\n                    </CardTitle>\n                    <Badge variant=\"default\">\n                      <CheckCircle2 className=\"h-3 w-3 ml-1\" />\n                      مكتمل\n                    </Badge>\n                  </div>\n                  <CheckCircle2 className=\"h-5 w-5 text-green-600\" />\n                </div>\n                <CardDescription className=\"line-clamp-2 mt-2\">\n                  {project.description}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <DollarSign className=\"h-4 w-4\" />\n                  <span>الميزانية: ${parseFloat(project.budget).toFixed(2)}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Users className=\"h-4 w-4\" />\n                  <span>عدد المهام: {project.tasksCount}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Calendar className=\"h-4 w-4\" />\n                  <span>\n                    تاريخ الإنشاء: {format(new Date(project.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                  </span>\n                </div>\n                {project.updatedAt && (\n                  <div className=\"flex items-center gap-2 text-sm text-green-600\">\n                    <CheckCircle2 className=\"h-4 w-4\" />\n                    <span>\n                      تاريخ الإكمال: {format(new Date(project.updatedAt), \"dd MMMM yyyy\", { locale: ar })}\n                    </span>\n                  </div>\n                )}\n                <div className=\"pt-2\">\n                  <Link href={`/projects/${project.id}`}>\n                    <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                      عرض التفاصيل\n                    </Button>\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5093},"client/src/pages/product-owner-dashboard/Payments.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CreditCard, TrendingUp, DollarSign, Calendar } from \"lucide-react\";\nimport type { Order } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst paymentMethodLabels: Record<string, string> = {\n  vodafone_cash: \"فودافون كاش\",\n  etisalat_cash: \"اتصالات كاش\",\n  orange_cash: \"أورانج كاش\",\n  bank_card: \"بطاقة بنكية\",\n  bank_transfer: \"تحويل بنكي\",\n};\n\nconst statusLabels: Record<string, { label: string; variant: \"default\" | \"secondary\" | \"destructive\" | \"outline\" }> = {\n  pending: { label: \"قيد الانتظار\", variant: \"outline\" },\n  payment_confirmed: { label: \"تم الدفع\", variant: \"default\" },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"secondary\" },\n  completed: { label: \"مكتمل\", variant: \"default\" },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" },\n};\n\nexport default function PaymentsPage() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders\"],\n  });\n\n  // Calculate payment statistics\n  const totalPaid = orders\n    .filter((o) => o.status === \"payment_confirmed\" || o.status === \"in_progress\" || o.status === \"completed\")\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const pendingPayments = orders\n    .filter((o) => o.status === \"pending\")\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const thisMonthPayments = orders\n    .filter((o) => {\n      const orderDate = new Date(o.createdAt);\n      const now = new Date();\n      return orderDate.getMonth() === now.getMonth() && orderDate.getFullYear() === now.getFullYear();\n    })\n    .reduce((sum, order) => sum + parseFloat(order.totalAmount), 0);\n\n  const stats = [\n    {\n      title: \"إجمالي المدفوعات\",\n      value: `$${totalPaid.toFixed(2)}`,\n      icon: DollarSign,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"المدفوعات المعلقة\",\n      value: `$${pendingPayments.toFixed(2)}`,\n      icon: CreditCard,\n      color: \"text-yellow-600\",\n      bgColor: \"bg-yellow-50 dark:bg-yellow-950/30\",\n    },\n    {\n      title: \"هذا الشهر\",\n      value: `$${thisMonthPayments.toFixed(2)}`,\n      icon: Calendar,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"عدد المعاملات\",\n      value: orders.length,\n      icon: TrendingUp,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n  ];\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div>\n        <h1 className=\"text-3xl font-bold\" data-testid=\"text-payments-title\">المدفوعات</h1>\n        <p className=\"text-muted-foreground\">سجل جميع معاملاتك المالية</p>\n      </div>\n\n      {/* Statistics */}\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {stats.map((stat) => (\n          <Card key={stat.title} className=\"rounded-2xl hover-elevate\" data-testid={`card-stat-${stat.title}`}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2 gap-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {stat.title}\n              </CardTitle>\n              <div className={`p-2 rounded-xl ${stat.bgColor}`}>\n                <stat.icon className={`h-5 w-5 ${stat.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold\" data-testid={`value-${stat.title}`}>\n                {stat.value}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Payment History */}\n      <Card className=\"rounded-2xl\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <CreditCard className=\"h-5 w-5\" />\n            سجل المعاملات\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {orders.length === 0 ? (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              <CreditCard className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n              <p>لا توجد معاملات مالية حتى الآن</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {orders\n                .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n                .map((order) => (\n                  <div\n                    key={order.id}\n                    className=\"flex items-center justify-between p-4 border rounded-xl hover-elevate\"\n                    data-testid={`payment-item-${order.id}`}\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <h3 className=\"font-semibold\" data-testid={`payment-id-${order.id}`}>\n                          #{order.id.slice(0, 8)}\n                        </h3>\n                        <Badge variant={statusLabels[order.status]?.variant || \"outline\"}>\n                          {statusLabels[order.status]?.label || order.status}\n                        </Badge>\n                      </div>\n                      <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n                        <span className=\"flex items-center gap-1\">\n                          <CreditCard className=\"h-4 w-4\" />\n                          {paymentMethodLabels[order.paymentMethod] || order.paymentMethod}\n                        </span>\n                        <span className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-4 w-4\" />\n                          {format(new Date(order.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                        </span>\n                        <span>\n                          الكمية: {order.quantity}\n                        </span>\n                      </div>\n                    </div>\n                    <div className=\"text-left\">\n                      <div className=\"text-2xl font-bold text-green-600\" data-testid={`payment-amount-${order.id}`}>\n                        ${parseFloat(order.totalAmount).toFixed(2)}\n                      </div>\n                    </div>\n                  </div>\n                ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7007},"client/src/pages/product-owner-dashboard/ActiveProjects.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Briefcase, Calendar, DollarSign, Users } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Project } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function ActiveProjectsPage() {\n  const { data: allProjects = [], isLoading } = useQuery<Project[]>({\n    queryKey: [\"/api/projects/my\"],\n  });\n\n  // Filter for active projects only\n  const activeProjects = allProjects.filter(\n    (p) => p.status === \"accepted\" || p.status === \"in_progress\"\n  );\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\" data-testid=\"text-active-projects-title\">\n            المشاريع النشطة\n          </h1>\n          <p className=\"text-muted-foreground\">\n            المشاريع قيد التنفيذ حالياً ({activeProjects.length})\n          </p>\n        </div>\n        <Link href=\"/projects/create\">\n          <Button data-testid=\"button-create-project\">\n            إنشاء مشروع جديد\n          </Button>\n        </Link>\n      </div>\n\n      {activeProjects.length === 0 ? (\n        <Card className=\"rounded-2xl\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">لا توجد مشاريع نشطة</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              ليس لديك مشاريع قيد التنفيذ في الوقت الحالي\n            </p>\n            <Link href=\"/projects/create\">\n              <Button data-testid=\"button-create-first-project\">\n                إنشاء مشروع جديد\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n          {activeProjects.map((project) => {\n            const statusConfig = {\n              accepted: { label: \"مقبول\", variant: \"default\" as const },\n              in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const },\n            };\n\n            const status = statusConfig[project.status as keyof typeof statusConfig];\n\n            return (\n              <Card\n                key={project.id}\n                className=\"rounded-2xl hover-elevate\"\n                data-testid={`card-project-${project.id}`}\n              >\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-lg mb-2\" data-testid={`project-title-${project.id}`}>\n                        {project.title}\n                      </CardTitle>\n                      {status && (\n                        <Badge variant={status.variant}>\n                          {status.label}\n                        </Badge>\n                      )}\n                    </div>\n                    <Briefcase className=\"h-5 w-5 text-muted-foreground\" />\n                  </div>\n                  <CardDescription className=\"line-clamp-2 mt-2\">\n                    {project.description}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-3\">\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <DollarSign className=\"h-4 w-4\" />\n                    <span>الميزانية: ${parseFloat(project.budget).toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Users className=\"h-4 w-4\" />\n                    <span>عدد المهام: {project.tasksCount}</span>\n                  </div>\n                  {project.deadline && (\n                    <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                      <Calendar className=\"h-4 w-4\" />\n                      <span>\n                        الموعد النهائي: {format(new Date(project.deadline), \"dd MMMM yyyy\", { locale: ar })}\n                      </span>\n                    </div>\n                  )}\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Calendar className=\"h-4 w-4\" />\n                    <span>\n                      تاريخ الإنشاء: {format(new Date(project.createdAt), \"dd MMMM yyyy\", { locale: ar })}\n                    </span>\n                  </div>\n                  <div className=\"pt-2\">\n                    <Link href={`/projects/${project.id}`}>\n                      <Button variant=\"outline\" className=\"w-full\" data-testid={`button-view-project-${project.id}`}>\n                        عرض التفاصيل\n                      </Button>\n                    </Link>\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5774},"client/src/pages/ProjectDetails.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useParams, useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { \n  ArrowRight, \n  Calendar, \n  DollarSign, \n  Briefcase, \n  CheckCircle2, \n  Clock, \n  Plus,\n  User,\n  ListTodo\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Project, Task } from \"@shared/schema\";\n\nconst statusConfig = {\n  pending: { label: \"قيد الانتظار\", variant: \"secondary\" as const, color: \"text-yellow-600\" },\n  accepted: { label: \"مقبول\", variant: \"default\" as const, color: \"text-blue-600\" },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const, color: \"text-purple-600\" },\n  completed: { label: \"مكتمل\", variant: \"default\" as const, color: \"text-green-600\" },\n  cancelled: { label: \"ملغي\", variant: \"destructive\" as const, color: \"text-red-600\" },\n};\n\nconst taskStatusConfig = {\n  available: { label: \"متاحة\", variant: \"secondary\" as const },\n  assigned: { label: \"معينة\", variant: \"default\" as const },\n  in_progress: { label: \"قيد التنفيذ\", variant: \"default\" as const },\n  submitted: { label: \"مسلمة\", variant: \"default\" as const },\n  approved: { label: \"مقبولة\", variant: \"default\" as const },\n  rejected: { label: \"مرفوضة\", variant: \"destructive\" as const },\n};\n\nexport default function ProjectDetails() {\n  const { id } = useParams();\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [showCreateTask, setShowCreateTask] = useState(false);\n  const [taskTitle, setTaskTitle] = useState(\"\");\n  const [taskDescription, setTaskDescription] = useState(\"\");\n  const [taskReward, setTaskReward] = useState(\"\");\n\n  // Get user from localStorage\n  const userStr = localStorage.getItem(\"user\");\n  const user = userStr ? JSON.parse(userStr) : null;\n  const userType = localStorage.getItem(\"userType\");\n\n  // Fetch project details\n  const { data: project, isLoading: projectLoading } = useQuery<Project>({\n    queryKey: [\"/api/projects\", id],\n    enabled: !!id,\n  });\n\n  // Fetch tasks for this project\n  const { data: tasks = [], isLoading: tasksLoading } = useQuery<Task[]>({\n    queryKey: [\"/api/tasks\", \"project\", id],\n    enabled: !!id,\n  });\n\n  // Create task mutation\n  const createTaskMutation = useMutation({\n    mutationFn: async (data: { title: string; description: string; reward: string }) => {\n      return await apiRequest( \"/api/tasks\",\"POST\", {\n        ...data,\n        projectId: id,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tasks\", \"project\", id] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/projects\", id] });\n      setShowCreateTask(false);\n      setTaskTitle(\"\");\n      setTaskDescription(\"\");\n      setTaskReward(\"\");\n      toast({\n        title: \"تم إنشاء المهمة\",\n        description: \"تم إنشاء المهمة بنجاح ويمكن للأعضاء الآن قبولها\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المهمة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateTask = () => {\n    if (!taskTitle.trim() || !taskDescription.trim() || !taskReward) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء ملء جميع الحقول المطلوبة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    const rewardNumber = parseFloat(taskReward);\n    if (isNaN(rewardNumber) || rewardNumber <= 0) {\n      toast({\n        title: \"خطأ\",\n        description: \"الرجاء إدخال مكافأة صحيحة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createTaskMutation.mutate({\n      title: taskTitle,\n      description: taskDescription,\n      reward: rewardNumber.toString(),\n    });\n  };\n\n  if (projectLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">جاري التحميل...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!project) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Card className=\"w-full max-w-md\">\n          <CardContent className=\"flex flex-col items-center justify-center py-12\">\n            <Briefcase className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n            <h3 className=\"text-lg font-semibold mb-2\">المشروع غير موجود</h3>\n            <p className=\"text-muted-foreground text-center mb-6\">\n              لم نتمكن من العثور على المشروع المطلوب\n            </p>\n            <Button onClick={() => navigate(\"/projects\")}>\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للمشاريع\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const config = statusConfig[project.status as keyof typeof statusConfig];\n  const availableTasks = tasks.filter((t) => t.status === \"available\");\n  const assignedTasks = tasks.filter((t) => t.status === \"assigned\" || t.status === \"in_progress\");\n  const submittedTasks = tasks.filter((t) => t.status === \"submitted\");\n  const completedTasks = tasks.filter((t) => t.status === \"approved\");\n\n  // Check if user is the project leader (using acceptedByGroupId instead of groupId)\n  const isLeader = userType === \"freelancer\" && project.acceptedByGroupId;\n\n  return (\n    <div className=\"container max-w-6xl mx-auto py-8 px-4\" dir=\"rtl\">\n      {/* Back Button */}\n      <Button\n        variant=\"ghost\"\n        onClick={() => navigate(\"/projects\")}\n        className=\"mb-6\"\n        data-testid=\"button-back\"\n      >\n        <ArrowRight className=\"ml-2 h-4 w-4\" />\n        العودة للمشاريع\n      </Button>\n\n      {/* Project Header */}\n      <Card className=\"mb-6 rounded-2xl\">\n        <CardHeader>\n          <div className=\"flex items-start justify-between gap-4\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-3 mb-2\">\n                <CardTitle className=\"text-3xl\" data-testid=\"text-project-title\">\n                  {project.title}\n                </CardTitle>\n                <Badge variant={config.variant} data-testid=\"badge-status\">\n                  {config.label}\n                </Badge>\n              </div>\n              <CardDescription className=\"text-base mt-2\">\n                {project.description}\n              </CardDescription>\n            </div>\n          </div>\n        </CardHeader>\n\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-green-50 dark:bg-green-950/30\">\n                <DollarSign className=\"h-5 w-5 text-green-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">الميزانية</p>\n                <p className=\"text-lg font-bold text-green-600\" data-testid=\"text-budget\">\n                  {parseFloat(project.budget as string).toLocaleString()} ر.س\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-blue-50 dark:bg-blue-950/30\">\n                <ListTodo className=\"h-5 w-5 text-blue-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">عدد المهام</p>\n                <p className=\"text-lg font-bold\" data-testid=\"text-tasks-count\">\n                  {tasks.length}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-3 rounded-xl bg-purple-50 dark:bg-purple-950/30\">\n                <Calendar className=\"h-5 w-5 text-purple-600\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">تاريخ الإنشاء</p>\n                <p className=\"text-sm font-semibold\">\n                  {format(new Date(project.createdAt), \"d MMMM yyyy\", { locale: ar })}\n                </p>\n              </div>\n            </div>\n\n            {project.acceptedByGroupId && (\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-3 rounded-xl bg-yellow-50 dark:bg-yellow-950/30\">\n                  <User className=\"h-5 w-5 text-yellow-600\" />\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">معين لجروب</p>\n                  <p className=\"text-sm font-semibold\">\n                    نعم\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tasks Section */}\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">المهام ({tasks.length})</h2>\n          {isLeader && project.status !== \"completed\" && (\n            <Button onClick={() => setShowCreateTask(true)} data-testid=\"button-create-task\">\n              <Plus className=\"ml-2 h-4 w-4\" />\n              إنشاء مهمة جديدة\n            </Button>\n          )}\n        </div>\n\n        {/* Task Stats */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-yellow-600\">{availableTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">متاحة</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-blue-600\">{assignedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">قيد التنفيذ</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-purple-600\">{submittedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">مسلمة</p>\n              </div>\n            </CardContent>\n          </Card>\n          <Card className=\"rounded-xl\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <p className=\"text-2xl font-bold text-green-600\">{completedTasks.length}</p>\n                <p className=\"text-sm text-muted-foreground\">مكتملة</p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Tasks List */}\n        {tasksLoading ? (\n          <div className=\"grid gap-4\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"animate-pulse rounded-xl\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"h-20 bg-muted rounded\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : tasks.length === 0 ? (\n          <Card className=\"rounded-2xl\">\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <ListTodo className=\"h-16 w-16 text-muted-foreground mb-4 opacity-50\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد مهام</h3>\n              <p className=\"text-muted-foreground text-center mb-6\">\n                لم يتم إنشاء أي مهام لهذا المشروع بعد\n              </p>\n              {isLeader && (\n                <Button onClick={() => setShowCreateTask(true)} data-testid=\"button-create-first-task\">\n                  <Plus className=\"ml-2 h-4 w-4\" />\n                  إنشاء أول مهمة\n                </Button>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid gap-4\">\n            {tasks.map((task) => {\n              const taskConfig = taskStatusConfig[task.status as keyof typeof taskStatusConfig];\n              return (\n                <Card key={task.id} className=\"rounded-xl hover-elevate\" data-testid={`card-task-${task.id}`}>\n                  <CardHeader>\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <CardTitle className=\"text-lg\">{task.title}</CardTitle>\n                          <Badge variant={taskConfig.variant}>\n                            {taskConfig.label}\n                          </Badge>\n                        </div>\n                        <CardDescription>{task.description}</CardDescription>\n                      </div>\n                      <div className=\"text-left\">\n                        <p className=\"text-sm text-muted-foreground\">المكافأة</p>\n                        <p className=\"text-xl font-bold text-green-600\">\n                          {task.reward} ر.س\n                        </p>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  {task.freelancerId && (\n                    <CardContent>\n                      <Separator className=\"mb-4\" />\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                        <User className=\"h-4 w-4\" />\n                        <span>معينة لمستقل</span>\n                      </div>\n                    </CardContent>\n                  )}\n                </Card>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Create Task Dialog */}\n      <Dialog open={showCreateTask} onOpenChange={setShowCreateTask}>\n        <DialogContent data-testid=\"dialog-create-task\">\n          <DialogHeader>\n            <DialogTitle>إنشاء مهمة جديدة</DialogTitle>\n            <DialogDescription>\n              أنشئ مهمة جديدة وسيتمكن أعضاء الجروب من قبولها\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"task-title\">عنوان المهمة *</Label>\n              <Input\n                id=\"task-title\"\n                value={taskTitle}\n                onChange={(e) => setTaskTitle(e.target.value)}\n                placeholder=\"مثال: مراجعة التطبيق على Google Play\"\n                data-testid=\"input-task-title\"\n              />\n            </div>\n\n            <div>\n              <Label htmlFor=\"task-description\">وصف المهمة *</Label>\n              <Textarea\n                id=\"task-description\"\n                value={taskDescription}\n                onChange={(e) => setTaskDescription(e.target.value)}\n                placeholder=\"اشرح تفاصيل المهمة والمتطلبات...\"\n                rows={4}\n                data-testid=\"textarea-task-description\"\n              />\n            </div>\n\n            <div>\n              <Label htmlFor=\"task-reward\">المكافأة (ر.س) *</Label>\n              <Input\n                id=\"task-reward\"\n                type=\"number\"\n                value={taskReward}\n                onChange={(e) => setTaskReward(e.target.value)}\n                placeholder=\"مثال: 50\"\n                data-testid=\"input-task-reward\"\n              />\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowCreateTask(false)}\n              data-testid=\"button-cancel-task\"\n            >\n              إلغاء\n            </Button>\n            <Button\n              onClick={handleCreateTask}\n              disabled={createTaskMutation.isPending}\n              data-testid=\"button-submit-task\"\n            >\n              {createTaskMutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء المهمة\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17226},"client/src/pages/freelancer-dashboard/Conversations.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Search, MessageSquare, Loader2 } from \"lucide-react\";\nimport { DirectMessageChat } from \"@/components/DirectMessageChat\";\n\nexport default function FreelancerConversations() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedConversation, setSelectedConversation] = useState<any>(null);\n\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n\n  // Fetch conversation history\n  const { data: conversations, isLoading } = useQuery({\n    queryKey: [\"/api/direct-messages\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/direct-messages\", {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n\n      if (!response.ok) {\n        return [];\n      }\n\n      return response.json();\n    },\n  });\n\n  // Fetch user details for each conversation\n  const { data: conversationsWithDetails } = useQuery({\n    queryKey: [\"/api/direct-messages\", \"with-details\", conversations],\n    queryFn: async () => {\n      if (!conversations || conversations.length === 0) return [];\n\n      const details = await Promise.all(\n        conversations.map(async (conv: any) => {\n          const response = await fetch(`/api/freelancers/${conv.otherUserId}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n            },\n          });\n\n          if (!response.ok) return conv;\n\n          const userDetails = await response.json();\n          return {\n            ...conv,\n            userDetails,\n          };\n        })\n      );\n\n      return details;\n    },\n    enabled: !!conversations && conversations.length > 0,\n  });\n\n  const filteredConversations = conversationsWithDetails?.filter((conv: any) =>\n    conv.userDetails?.fullName?.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-[calc(100vh-80px)] flex flex-col p-6\" dir=\"rtl\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-3\">\n          <MessageSquare className=\"h-8 w-8 text-blue-600\" />\n          المحادثات\n        </h1>\n        <p className=\"text-gray-600 mt-2\">تواصل مع أعضاء المجموعات</p>\n      </div>\n\n      <div className=\"flex-1 flex gap-6 overflow-hidden\">\n        {/* Conversations List */}\n        <Card className=\"w-96 flex flex-col overflow-hidden shadow-xl\">\n          <div className=\"p-4 border-b bg-white\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\n              <Input\n                placeholder=\"ابحث عن محادثة...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10 rounded-full\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex-1 overflow-y-auto\">\n            {!conversationsWithDetails || conversationsWithDetails.length === 0 ? (\n              <div className=\"flex flex-col items-center justify-center h-full p-6 text-center\">\n                <div className=\"bg-gray-100 rounded-full p-6 mb-4\">\n                  <MessageSquare className=\"h-12 w-12 text-gray-400\" />\n                </div>\n                <p className=\"text-gray-500 font-semibold\">لا توجد محادثات</p>\n                <p className=\"text-gray-400 text-sm mt-2\">\n                  ابدأ محادثة جديدة من صفحة المجموعات\n                </p>\n              </div>\n            ) : (\n              <div className=\"divide-y\">\n                {filteredConversations?.map((conv: any) => (\n                  <div\n                    key={conv.otherUserId}\n                    onClick={() => setSelectedConversation(conv)}\n                    className={`p-4 cursor-pointer transition-all hover:bg-blue-50 ${\n                      selectedConversation?.otherUserId === conv.otherUserId\n                        ? \"bg-blue-50 border-r-4 border-blue-600\"\n                        : \"\"\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar className=\"h-12 w-12 border-2 border-gray-200\">\n                        <AvatarImage src={conv.userDetails?.profileImage} />\n                        <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-500 text-white font-bold\">\n                          {conv.userDetails?.fullName?.substring(0, 2) || \"U\"}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center justify-between mb-1\">\n                          <h3 className=\"font-semibold text-gray-900 truncate\">\n                            {conv.userDetails?.fullName || \"مستخدم\"}\n                          </h3>\n                          <span className=\"text-xs text-gray-500\">\n                            {new Date(conv.lastMessageAt).toLocaleDateString(\"ar-EG\", {\n                              month: \"short\",\n                              day: \"numeric\",\n                            })}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-gray-600 truncate\">\n                          {conv.lastMessage}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </Card>\n\n        {/* Chat Area */}\n        <div className=\"flex-1 overflow-hidden\">\n          {selectedConversation ? (\n            <DirectMessageChat\n              roomId={[currentUser?.id, selectedConversation.otherUserId].sort().join('-')}\n              receiverId={selectedConversation.otherUserId}\n              receiverType={selectedConversation.otherUserType}\n              receiverInfo={selectedConversation.userDetails}\n            />\n          ) : (\n            <Card className=\"h-full flex items-center justify-center shadow-xl\">\n              <div className=\"text-center p-6\">\n                <div className=\"bg-gradient-to-br from-blue-100 to-purple-100 rounded-full p-8 mb-4 inline-block\">\n                  <MessageSquare className=\"h-16 w-16 text-blue-600\" />\n                </div>\n                <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\n                  اختر محادثة للبدء\n                </h3>\n                <p className=\"text-gray-600\">\n                  اختر محادثة من القائمة لعرض الرسائل\n                </p>\n              </div>\n            </Card>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7252},"client/src/pages/ChatWithLeader.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation, useParams } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Navbar } from \"@/components/Navbar\";\nimport { \n  ArrowRight, \n  MapPin, \n  Clock, \n  Phone, \n  MessageCircle, \n  Send, \n  Star,\n  ShieldAlert,\n  CheckCircle2,\n  AlertTriangle,\n  Lightbulb\n} from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Group, Freelancer, Conversation, ConversationMessage } from \"@shared/schema\";\n\nexport default function ChatWithLeader() {\n  const params = useParams();\n  const groupId = params.id as string;\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const [messageContent, setMessageContent] = useState(\"\");\n  const [conversationId, setConversationId] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  \n  // Verify user authentication from backend\n  const { data: currentUser, isLoading: userLoading } = useQuery<any>({\n    queryKey: [\"/api/auth/user\"],\n  });\n\n  const isProductOwner = currentUser?.userType === \"product_owner\";\n\n  // Fetch group details\n  const { data: group, isLoading: groupLoading } = useQuery<Group>({\n    queryKey: [\"/api/groups\", groupId],\n    enabled: !!currentUser,\n  });\n\n  // Fetch leader details\n  const { data: leader } = useQuery<Freelancer>({\n    queryKey: [\"/api/freelancers\", group?.leaderId],\n    enabled: !!group?.leaderId,\n  });\n\n  // Get or create conversation\n  const getConversationMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"/api/conversations\",\"POST\", { groupId });\n      return await res.json();\n    },\n    onSuccess: (data: Conversation) => {\n      setConversationId(data.id);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إنشاء المحادثة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Fetch messages\n  const { data: messages = [] } = useQuery<ConversationMessage[]>({\n    queryKey: [\"/api/conversations\", conversationId, \"messages\"],\n    enabled: !!conversationId,\n    refetchInterval: 3000, // Refresh every 3 seconds\n  });\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      if (!conversationId) throw new Error(\"لا توجد محادثة\");\n      const res = await apiRequest(`/api/conversations/${conversationId}/messages`, \"POST\", { content });\n      return await res.json();\n    },\n    onSuccess: () => {\n      setMessageContent(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/conversations\", conversationId, \"messages\"] });\n      scrollToBottom();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء إرسال الرسالة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  useEffect(() => {\n    if (group && isProductOwner && !conversationId && !getConversationMutation.isPending) {\n      getConversationMutation.mutate();\n    }\n  }, [group, isProductOwner]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  const handleSendMessage = () => {\n    if (!messageContent.trim() || sendMessageMutation.isPending) return;\n    sendMessageMutation.mutate(messageContent);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  if (userLoading || groupLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card className=\"animate-pulse\">\n            <CardContent className=\"py-12\">\n              <div className=\"h-64 bg-muted rounded\" />\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  if (!currentUser || !isProductOwner || !group) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card>\n            <CardContent className=\"flex flex-col items-center justify-center py-12\">\n              <MessageCircle className=\"h-12 w-12 text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">\n                {!currentUser ? \"يجب تسجيل الدخول\" : \"غير متاح\"}\n              </h3>\n              <p className=\"text-muted-foreground text-center mb-4\">\n                {!currentUser \n                  ? \"الرجاء تسجيل الدخول للوصول لهذه الصفحة\" \n                  : \"هذه الصفحة متاحة لأصحاب المنتجات فقط\"}\n              </p>\n              <Button \n                onClick={() => navigate(\"/groups\")}\n                data-testid=\"button-back-to-groups\"\n              >\n                العودة للجروبات\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Navbar />\n\n      <div className=\"container mx-auto px-4 py-6\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => navigate(`/groups/${groupId}`)}\n          className=\"mb-4\"\n          data-testid=\"button-back\"\n        >\n          <ArrowRight className=\"ml-2 h-4 w-4\" />\n          العودة لتفاصيل الجروب\n        </Button>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Leader Profile Card - Right Side */}\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-6 z-50\">\n              <CardContent className=\"pt-6\">\n                {/* Leader Avatar and Name */}\n                <div className=\"flex flex-col items-center text-center mb-6\">\n                  <Avatar className=\"h-20 w-20 mb-3\">\n                    <AvatarImage src={leader?.profileImage || undefined} />\n                    <AvatarFallback className=\"text-2xl\">\n                      {leader?.fullName?.charAt(0) || \"ق\"}\n                    </AvatarFallback>\n                  </Avatar>\n                  <h2 className=\"text-xl font-bold mb-1\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                    {leader?.fullName || \"قائد الجروب\"}\n                  </h2>\n                  <Badge variant=\"default\" className=\"mb-2\">\n                    متصل\n                  </Badge>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Service Info */}\n                <div className=\"space-y-4\">\n                  <div>\n                    <p className=\"text-sm font-semibold text-muted-foreground mb-2\">الخدمة المطلوبة</p>\n                    <Badge variant=\"outline\" className=\"w-full justify-center py-2\">\n                      {group.name}\n                    </Badge>\n                  </div>\n\n                  {/* Rating */}\n                  <div>\n                    <p className=\"text-sm font-semibold text-muted-foreground mb-2\">التقييم</p>\n                    <div className=\"flex items-center justify-center gap-1\">\n                      <div className=\"flex gap-0.5\">\n                        {[1, 2, 3, 4, 5].map((star) => (\n                          <Star\n                            key={star}\n                            className=\"h-4 w-4 fill-yellow-400 text-yellow-400\"\n                          />\n                        ))}\n                      </div>\n                      <span className=\"text-sm font-bold mr-2\">4.8</span>\n                    </div>\n                  </div>\n\n                  {/* Location */}\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center text-muted-foreground\">\n                      <MapPin className=\"ml-2 h-4 w-4\" />\n                      <span className=\"text-sm\">الموقع</span>\n                    </div>\n                    <span className=\"text-sm font-semibold\">\n                      القاهرة\n                    </span>\n                  </div>\n\n                  {/* Response Time */}\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center text-green-600\">\n                      <Clock className=\"ml-2 h-4 w-4\" />\n                      <span className=\"text-sm\">وقت الاستجابة</span>\n                    </div>\n                    <span className=\"text-sm font-semibold text-green-600\">\n                      خلال دقائق\n                    </span>\n                  </div>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Safety Guidelines */}\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start gap-2\">\n                    <ShieldAlert className=\"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0\" />\n                    <p className=\"text-xs text-muted-foreground leading-relaxed\">\n                      إرشادات الأمان\n                    </p>\n                  </div>\n                  \n                  <div className=\"space-y-2 text-xs text-muted-foreground\">\n                    <div className=\"flex items-start gap-2\">\n                      <CheckCircle2 className=\"h-3 w-3 text-green-600 mt-0.5 flex-shrink-0\" />\n                      <p>لا تشارك معلومات شخصية حساسة</p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <AlertTriangle className=\"h-3 w-3 text-amber-600 mt-0.5 flex-shrink-0\" />\n                      <p>تأكد من متطلبات المشروع قبل البدء</p>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Lightbulb className=\"h-3 w-3 text-blue-600 mt-0.5 flex-shrink-0\" />\n                      <p>استخدم وسائل الدفع الآمنة عبر المنصة</p>\n                    </div>\n                  </div>\n                </div>\n\n                <Separator className=\"my-4\" />\n\n                {/* Action Buttons */}\n                <div className=\"space-y-2\">\n                  <Button\n                    variant=\"outline\"\n                    className=\"w-full\"\n                    onClick={() => {\n                      toast({\n                        title: \"قريباً\",\n                        description: \"هذه الميزة ستكون متاحة قريباً\",\n                      });\n                    }}\n                    data-testid=\"button-voice-call\"\n                  >\n                    <Phone className=\"ml-2 h-4 w-4\" />\n                    طلب محادثة شفهية\n                  </Button>\n                  \n                  <Button\n                    className=\"w-full\"\n                    disabled\n                    data-testid=\"button-chat-active\"\n                  >\n                    <MessageCircle className=\"ml-2 h-4 w-4\" />\n                    المحادثة النصية نشطة\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Chat Area - Left Side */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"h-[calc(100vh-200px)] flex flex-col\">\n              <CardHeader className=\"border-b\">\n                <CardTitle className=\"text-xl\" style={{ fontFamily: \"Tajawal, sans-serif\" }}>\n                  محادثة مع {leader?.fullName || \"قائد الجروب\"}\n                </CardTitle>\n                <CardDescription>\n                  {group.name}\n                </CardDescription>\n              </CardHeader>\n\n              {/* Messages Area */}\n              <CardContent className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n                {!conversationId ? (\n                  <div className=\"flex items-center justify-center h-full\">\n                    <div className=\"text-center text-muted-foreground\">\n                      <MessageCircle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground/50\" />\n                      <p>جاري تحميل المحادثة...</p>\n                    </div>\n                  </div>\n                ) : messages.length === 0 ? (\n                  <div className=\"flex items-center justify-center h-full\">\n                    <div className=\"text-center text-muted-foreground\">\n                      <MessageCircle className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground/50\" />\n                      <p>ابدأ المحادثة بإرسال رسالة</p>\n                    </div>\n                  </div>\n                ) : (\n                  <>\n                    {messages.map((message) => {\n                      const isOwn = message.senderType === \"product_owner\";\n                      \n                      return (\n                        <div\n                          key={message.id}\n                          className={`flex ${isOwn ? \"justify-end\" : \"justify-start\"}`}\n                          data-testid={`message-${message.id}`}\n                        >\n                          <div\n                            className={`max-w-[70%] rounded-2xl px-4 py-3 ${\n                              isOwn\n                                ? \"bg-primary text-primary-foreground\"\n                                : \"bg-muted\"\n                            }`}\n                          >\n                            {!isOwn && (\n                              <p className=\"text-xs font-semibold mb-1 text-muted-foreground\">\n                                {leader?.fullName || \"قائد الجروب\"}\n                              </p>\n                            )}\n                            <p className=\"text-sm leading-relaxed\">{message.content}</p>\n                            <p className={`text-xs mt-1 ${isOwn ? \"text-primary-foreground/70\" : \"text-muted-foreground\"}`}>\n                              {new Date(message.createdAt).toLocaleTimeString(\"ar\", {\n                                hour: \"2-digit\",\n                                minute: \"2-digit\",\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      );\n                    })}\n                    <div ref={messagesEndRef} />\n                  </>\n                )}\n              </CardContent>\n\n              {/* Message Input */}\n              <div className=\"border-t p-4\">\n                <div className=\"flex gap-2\">\n                  <Input\n                    placeholder=\"اكتب رسالتك هنا...\"\n                    value={messageContent}\n                    onChange={(e) => setMessageContent(e.target.value)}\n                    onKeyPress={handleKeyPress}\n                    disabled={!conversationId || sendMessageMutation.isPending}\n                    className=\"flex-1\"\n                    data-testid=\"input-message\"\n                  />\n                  <Button\n                    onClick={handleSendMessage}\n                    disabled={!messageContent.trim() || !conversationId || sendMessageMutation.isPending}\n                    size=\"icon\"\n                    data-testid=\"button-send\"\n                  >\n                    <Send className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":16118},"client/src/pages/freelancer-dashboard/Notifications.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2, AlertCircle, DollarSign, ClipboardList, MessageCircle, Users, Package, Wallet as WalletIcon } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport default function FreelancerNotifications() {\n  // Fetch notifications\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest( `/api/notifications/${id}/read`,\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest( \"/api/notifications/mark-all-read\",\"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case \"task_assigned\":\n      case \"task_approved\":\n      case \"task_rejected\":\n      case \"task_rejected_by_leader\":\n        return <ClipboardList className=\"h-5 w-5 text-primary\" />;\n      case \"payment_received\":\n      case \"withdrawal_approved\":\n      case \"withdrawal_rejected\":\n        return <DollarSign className=\"h-5 w-5 text-green-600\" />;\n      case \"new_message\":\n        return <MessageCircle className=\"h-5 w-5 text-blue-600\" />;\n      case \"group_member_joined\":\n      case \"group_member_removed\":\n        return <Users className=\"h-5 w-5 text-purple-600\" />;\n      case \"order_created\":\n      case \"order_completed\":\n        return <Package className=\"h-5 w-5 text-orange-600\" />;\n      case \"wallet_updated\":\n        return <WalletIcon className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <Bell className=\"h-5 w-5 text-muted-foreground\" />;\n    }\n  };\n\n  const getNotificationBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" => {\n    if (type.includes(\"approved\") || type.includes(\"completed\")) return \"default\";\n    if (type.includes(\"rejected\") || type.includes(\"removed\")) return \"destructive\";\n    return \"secondary\";\n  };\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-notifications\">الإشعارات</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            جميع إشعاراتك في مكان واحد\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {unreadCount > 0 && (\n            <Badge variant=\"default\" className=\"h-8\" data-testid=\"badge-unread-total\">\n              {unreadCount} غير مقروء\n            </Badge>\n          )}\n          {notifications.length > 0 && unreadCount > 0 && (\n            <Button\n              variant=\"outline\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              disabled={markAllAsReadMutation.isPending}\n              data-testid=\"button-mark-all-read-page\"\n            >\n              <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </div>\n      </div>\n\n      <Separator />\n\n      {isLoading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"text-center\">\n            <Bell className=\"h-12 w-12 mx-auto mb-4 opacity-20 animate-pulse\" />\n            <p className=\"text-muted-foreground\">جارٍ التحميل...</p>\n          </div>\n        </div>\n      ) : notifications.length === 0 ? (\n        <Card>\n          <CardContent className=\"py-12\">\n            <div className=\"text-center\">\n              <Bell className=\"h-16 w-16 mx-auto mb-4 opacity-20\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد إشعارات</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                ستظهر جميع الإشعارات الخاصة بك هنا\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-3\">\n          {notifications.map((notification) => (\n            <Card\n              key={notification.id}\n              className={`transition-all hover-elevate cursor-pointer ${\n                !notification.isRead ? 'border-primary/50 bg-primary/5' : ''\n              }`}\n              onClick={() => handleNotificationClick(notification)}\n              data-testid={`notification-card-${notification.id}`}\n            >\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"p-2 rounded-xl bg-background\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <CardTitle className=\"text-base\">\n                          {notification.title}\n                        </CardTitle>\n                        {!notification.isRead && (\n                          <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread-card\" />\n                        )}\n                      </div>\n                      <Badge variant={getNotificationBadgeVariant(notification.type)} className=\"flex-shrink-0\">\n                        {notification.type === \"task_approved\" && \"مُوافق عليها\"}\n                        {notification.type === \"task_rejected\" && \"مرفوضة\"}\n                        {notification.type === \"task_assigned\" && \"مهمة جديدة\"}\n                        {notification.type === \"payment_received\" && \"دفعة\"}\n                        {notification.type === \"new_message\" && \"رسالة\"}\n                        {notification.type === \"order_created\" && \"طلب جديد\"}\n                        {notification.type === \"withdrawal_approved\" && \"سحب مُوافق\"}\n                        {notification.type === \"withdrawal_rejected\" && \"سحب مرفوض\"}\n                        {![\"task_approved\", \"task_rejected\", \"task_assigned\", \"payment_received\", \"new_message\", \"order_created\", \"withdrawal_approved\", \"withdrawal_rejected\"].includes(notification.type) && \"إشعار\"}\n                      </Badge>\n                    </div>\n                    <CardDescription className=\"text-sm\">\n                      {notification.message}\n                    </CardDescription>\n                    <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                      <span>{getTimeAgo(notification.createdAt)}</span>\n                      {!notification.isRead && (\n                        <span className=\"flex items-center gap-1\">\n                          <AlertCircle className=\"h-3 w-3\" />\n                          جديد\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8796},"client/src/pages/product-owner-dashboard/Notifications.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, CheckCircle2, AlertCircle, DollarSign, ClipboardList, MessageCircle, FolderKanban, Package, Users } from \"lucide-react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\n\nexport default function ProductOwnerNotifications() {\n  // Fetch notifications\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n  });\n\n  // Fetch unread count\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread/count\"],\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  // Mark notification as read\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(`/api/notifications/${id}/read`, \"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  // Mark all as read\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"/api/notifications/mark-all-read\", \"PATCH\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread/count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getTimeAgo = (date: Date) => {\n    const now = new Date();\n    const diffMs = now.getTime() - new Date(date).getTime();\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 1) return \"الآن\";\n    if (diffMins < 60) return `منذ ${diffMins} دقيقة`;\n    if (diffHours < 24) return `منذ ${diffHours} ساعة`;\n    return `منذ ${diffDays} يوم`;\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case \"task_submitted\":\n      case \"task_assigned\":\n        return <ClipboardList className=\"h-5 w-5 text-primary\" />;\n      case \"payment_confirmed\":\n      case \"payment_pending\":\n        return <DollarSign className=\"h-5 w-5 text-green-600\" />;\n      case \"new_message\":\n        return <MessageCircle className=\"h-5 w-5 text-blue-600\" />;\n      case \"project_accepted\":\n      case \"project_completed\":\n        return <FolderKanban className=\"h-5 w-5 text-purple-600\" />;\n      case \"order_in_progress\":\n      case \"order_completed\":\n        return <Package className=\"h-5 w-5 text-orange-600\" />;\n      case \"review_submitted\":\n        return <Users className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <Bell className=\"h-5 w-5 text-muted-foreground\" />;\n    }\n  };\n\n  const getNotificationBadgeVariant = (type: string): \"default\" | \"secondary\" | \"destructive\" => {\n    if (type.includes(\"completed\") || type.includes(\"confirmed\") || type.includes(\"accepted\")) return \"default\";\n    if (type.includes(\"rejected\") || type.includes(\"failed\")) return \"destructive\";\n    return \"secondary\";\n  };\n\n  return (\n    <div className=\"space-y-6\" dir=\"rtl\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"heading-notifications\">الإشعارات</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            جميع إشعاراتك في مكان واحد\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {unreadCount > 0 && (\n            <Badge variant=\"default\" className=\"h-8\" data-testid=\"badge-unread-total\">\n              {unreadCount} غير مقروء\n            </Badge>\n          )}\n          {notifications.length > 0 && unreadCount > 0 && (\n            <Button\n              variant=\"outline\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              disabled={markAllAsReadMutation.isPending}\n              data-testid=\"button-mark-all-read-page\"\n            >\n              <CheckCircle2 className=\"ml-2 h-4 w-4\" />\n              تحديد الكل كمقروء\n            </Button>\n          )}\n        </div>\n      </div>\n\n      <Separator />\n\n      {isLoading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"text-center\">\n            <Bell className=\"h-12 w-12 mx-auto mb-4 opacity-20 animate-pulse\" />\n            <p className=\"text-muted-foreground\">جارٍ التحميل...</p>\n          </div>\n        </div>\n      ) : notifications.length === 0 ? (\n        <Card>\n          <CardContent className=\"py-12\">\n            <div className=\"text-center\">\n              <Bell className=\"h-16 w-16 mx-auto mb-4 opacity-20\" />\n              <h3 className=\"text-lg font-semibold mb-2\">لا توجد إشعارات</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                ستظهر جميع الإشعارات الخاصة بك هنا\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"space-y-3\">\n          {notifications.map((notification) => (\n            <Card\n              key={notification.id}\n              className={`transition-all hover-elevate cursor-pointer ${\n                !notification.isRead ? 'border-primary/50 bg-primary/5' : ''\n              }`}\n              onClick={() => handleNotificationClick(notification)}\n              data-testid={`notification-card-${notification.id}`}\n            >\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"p-2 rounded-xl bg-background\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <CardTitle className=\"text-base\">\n                          {notification.title}\n                        </CardTitle>\n                        {!notification.isRead && (\n                          <div className=\"h-2 w-2 rounded-full bg-primary\" data-testid=\"indicator-unread-card\" />\n                        )}\n                      </div>\n                      <Badge variant={getNotificationBadgeVariant(notification.type)} className=\"flex-shrink-0\">\n                        {notification.type === \"project_accepted\" && \"مقبول\"}\n                        {notification.type === \"project_completed\" && \"مكتمل\"}\n                        {notification.type === \"task_submitted\" && \"مُسلّم\"}\n                        {notification.type === \"payment_confirmed\" && \"مُؤكد\"}\n                        {notification.type === \"new_message\" && \"رسالة\"}\n                        {notification.type === \"order_completed\" && \"طلب مكتمل\"}\n                        {notification.type === \"review_submitted\" && \"تقييم\"}\n                        {![\"project_accepted\", \"project_completed\", \"task_submitted\", \"payment_confirmed\", \"new_message\", \"order_completed\", \"review_submitted\"].includes(notification.type) && \"إشعار\"}\n                      </Badge>\n                    </div>\n                    <CardDescription className=\"text-sm\">\n                      {notification.message}\n                    </CardDescription>\n                    <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                      <span>{getTimeAgo(notification.createdAt)}</span>\n                      {!notification.isRead && (\n                        <span className=\"flex items-center gap-1\">\n                          <AlertCircle className=\"h-3 w-3\" />\n                          جديد\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </CardHeader>\n            </Card>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":8534},"client/src/pages/GroupCommunity.tsx":{"content":"import { useState,useRef , useEffect } from \"react\";\nimport { useParams, Link, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Users,\n  MessageSquare,\n  ThumbsUp,\n  Send,\n  Image as ImageIcon,\n  Trash2,\n  ArrowRight,\n  Star,\n  MapPin,\n  Calendar,\n  TrendingUp,\n  Info,\n  Upload,\n  X,\n  Home,\n  UserPlus,\n  UserCheck,\n  Video,\n  FileText,\n  ShoppingBag,\n  UserCircle,\n  ChevronRight,\n  ExternalLink,\n  MoreHorizontal,\n  Share,\n  Camera,\n  File,\n  Flag,\n  Search,\n  Bell,\n  Menu,\n  Settings,\n  Bookmark,\n  Heart,\n  Eye,\n  Globe,\n  Briefcase,\n  Sparkles,\n  Zap,\n  MessagesSquare,\n  Target,\n  Rocket,\n  BarChart3,\n  Palette,\n  Shield,\n  Clock,\n  Award\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { gsap } from \"gsap\";\nimport { ScrollTrigger } from \"gsap/ScrollTrigger\";\n\n// Register GSAP plugins\ngsap.registerPlugin(ScrollTrigger);\n\n// Animated section wrapper with GSAP\nfunction FadeInSection({ children, delay = 0 }: { children: React.ReactNode; delay?: number }) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      gsap.fromTo(element, \n        { \n          opacity: 0, \n          y: 60,\n          scale: 0.95\n        },\n        { \n          opacity: 1, \n          y: 0,\n          scale: 1,\n          duration: 0.8,\n          delay,\n          ease: \"power2.out\",\n          scrollTrigger: {\n            trigger: element,\n            start: \"top 80%\",\n            end: \"bottom 20%\",\n            toggleActions: \"play none none reverse\"\n          }\n        }\n      );\n    }\n  }, [delay]);\n\n  return (\n    <div ref={ref} className=\"opacity-0\">\n      {children}\n    </div>\n  );\n}\n\ninterface Group {\n  id: string;\n  name: string;\n  description: string | null;\n  service: string;\n  maxMembers: number;\n  currentMembers: number;\n  leaderId: string;\n  country: string;\n  groupImage: string | null;\n  coverImage: string | null;\n  portfolioImages: string[] | null;\n  createdAt: Date;\n  rules: string[];\n  tags: string[];\n}\n\ninterface GroupMember {\n  id: string;\n  groupId: string;\n  freelancerId: string;\n  joinedAt: Date;\n  role: 'member' | 'admin' | 'moderator';\n}\n\ninterface Freelancer {\n  id: string;\n  fullName: string;\n  username: string;\n  profileImage: string | null;\n  lastSeen: Date | null;\n  bio: string | null;\n}\n\ninterface GroupPost {\n  id: string;\n  groupId: string;\n  authorId: string;\n  content: string;\n  imageUrl: string | null;\n  likesCount: number;\n  commentsCount: number;\n  sharesCount: number;\n  createdAt: Date;\n  updatedAt: Date;\n  isPinned: boolean;\n}\n\ninterface PostComment {\n  id: string;\n  postId: string;\n  authorId: string;\n  content: string;\n  imageUrl: string | null;\n  likesCount: number;\n  createdAt: Date;\n}\n\ninterface GroupEvent {\n  id: string;\n  groupId: string;\n  title: string;\n  description: string;\n  date: Date;\n  location: string;\n  organizerId: string;\n  attendees: string[];\n}\n\nexport default function GroupCommunity() {\n  const { id: groupId } = useParams<{ id: string }>();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const [activeTab, setActiveTab] = useState('home');\n\n  // Post composer state\n  const [newPostContent, setNewPostContent] = useState(\"\");\n  const [newPostImage, setNewPostImage] = useState<string | null>(null);\n  const [isUploadingPostImage, setIsUploadingPostImage] = useState(false);\n\n  // Task creation state\n  const [createTask, setCreateTask] = useState(false);\n  const [taskReward, setTaskReward] = useState(\"0\");\n  const [taskTitle, setTaskTitle] = useState(\"\");\n\n  // Comment state\n  const [commentInputs, setCommentInputs] = useState<Record<string, string>>({});\n  const [commentImages, setCommentImages] = useState<Record<string, string>>({});\n  const [expandedPosts, setExpandedPosts] = useState<Set<string>>(new Set());\n\n  // Search and notifications state\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [showNotifications, setShowNotifications] = useState(false);\n  const [showSearch, setShowSearch] = useState(false);\n\n  // Get current user\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n  const currentUserId = currentUser?.id;\n  const userType = localStorage.getItem(\"userType\");\n\n  // Fetch group data\n  const {\n    data: group,\n    isLoading: groupLoading,\n    error: groupError\n  } = useQuery<Group>({\n    queryKey: [`/groups/${groupId}`],\n    queryFn: async () => {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch(`/api/groups/${groupId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n\n      if (!response.ok) {\n        if (response.status === 404) {\n          throw new Error(\"Group not found\");\n        }\n        throw new Error(\"Failed to fetch group\");\n      }\n\n      const data = await response.json();\n      return data;\n    },\n    retry: 1,\n    enabled: !!groupId,\n  });\n\n  // Fetch group members\n  const { data: members = [] } = useQuery<GroupMember[]>({\n    queryKey: [`/api/groups/${groupId}/members`],\n  });\n\n  // Fetch group events\n  const { data: events = [] } = useQuery<GroupEvent[]>({\n    queryKey: [`/api/groups/${groupId}/events`],\n    queryFn: async () => {\n      const response = await fetch(`/api/groups/${groupId}/events`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) return [];\n      return response.json();\n    },\n  });\n\n  // Fetch group media\n  const { data: media = [] } = useQuery<GroupPost[]>({\n    queryKey: [`/api/groups/${groupId}/media`],\n    queryFn: async () => {\n      const response = await fetch(`/api/groups/${groupId}/posts?mediaOnly=true`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) return [];\n      return response.json();\n    },\n  });\n\n  // Check if current user is a member\n  const isMember = members.some(m => m.freelancerId === currentUserId);\n  const isLeader = group?.leaderId === currentUserId;\n  const userRole = members.find(m => m.freelancerId === currentUserId)?.role;\n\n  // Fetch freelancers info for members\n  const { data: freelancers = [] } = useQuery<Freelancer[]>({\n    queryKey: [\"/api/freelancers\"],\n  });\n\n  // Fetch user notifications\n  const { data: notifications = [] } = useQuery<any[]>({\n    queryKey: [\"/api/notifications\"],\n    queryFn: async () => {\n      const response = await fetch('/api/notifications', {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) return [];\n      return response.json();\n    },\n  });\n\n  // Fetch posts (only leader posts)\n  const { data: posts = [], isLoading: postsLoading } = useQuery<GroupPost[]>({\n    queryKey: ['/api/groups', groupId, 'posts'],\n    queryFn: async () => {\n      const response = await fetch(`/api/groups/${groupId}/posts?leaderOnly=true`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include',\n      });\n      if (!response.ok) throw new Error(\"Failed to fetch posts\");\n      return response.json();\n    },\n  });\n\n  // Helper functions\n  const getMemberInfo = (memberId: string) => {\n    return freelancers.find(f => f.id === memberId);\n  };\n\n  const isOnline = (lastSeen: Date | null) => {\n    if (!lastSeen) return false;\n    const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);\n    return new Date(lastSeen) > fiveMinutesAgo;\n  };\n\n  const checkIsLeader = (userId: string) => {\n    return group?.leaderId === userId;\n  };\n\n  // URL detection function\n  const detectUrls = (text: string) => {\n    const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n    return text.split(urlRegex).map((part, index) => {\n      if (part.match(urlRegex)) {\n        return (\n          <a\n            key={index}\n            href={part}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"text-blue-600 hover:text-blue-700 underline inline-flex items-center gap-1 font-medium\"\n          >\n            {part}\n            <ExternalLink className=\"w-3 h-3\" />\n          </a>\n        );\n      }\n      return part;\n    });\n  };\n\n  // Image upload handler\n  const handleImageUpload = async (file: File, type: 'post' | 'comment', postId?: string) => {\n    // Accept common image formats\n    const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];\n    if (!validTypes.includes(file.type.toLowerCase())) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار صورة بصيغة صحيحة (JPG, PNG, GIF, WEBP)\",\n        variant: \"destructive\",\n      });\n      return null;\n    }\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast({\n        title: \"خطأ\",\n        description: \"حجم الصورة كبير جداً. الحد الأقصى 5 ميجابايت\",\n        variant: \"destructive\",\n      });\n      return null;\n    }\n\n    try {\n      if (type === 'post') setIsUploadingPostImage(true);\n\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('type', 'post');\n\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch('/api/upload', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n        },\n        credentials: 'include',\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.error || 'فشل رفع الصورة');\n      }\n\n      const { url } = await response.json();\n\n      toast({\n        title: \"تم رفع الصورة\",\n        description: \"تم رفع الصورة بنجاح\",\n      });\n\n      return url;\n    } catch (error: any) {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء رفع الصورة\",\n        variant: \"destructive\",\n      });\n      return null;\n    } finally {\n      if (type === 'post') setIsUploadingPostImage(false);\n    }\n  };\n\n  // Create post mutation (only for leader)\n  const createPostMutation = useMutation({\n    mutationFn: async ({ content, imageUrl }: { content: string; imageUrl: string | null }) => {\n      return await apiRequest(`/api/groups/${groupId}/posts`, \"POST\", {\n        content,\n        imageUrl,\n        createTask,\n        taskReward,\n        taskTitle: taskTitle || \"مهمة تفاعل جديدة\",\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/groups', groupId, 'posts'] });\n      setNewPostContent(\"\");\n      setNewPostImage(null);\n      setCreateTask(false);\n      setTaskReward(\"0\");\n      setTaskTitle(\"\");\n      toast({\n        title: \"تم نشر المنشور\",\n        description: createTask ? \"تم نشر المنشور وإنشاء المهمة بنجاح\" : \"تم نشر المنشور بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء نشر المنشور\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreatePost = async () => {\n    if (!isLeader) {\n      toast({\n        title: \"غير مسموح\",\n        description: \"فقط قائد الجروب يمكنه نشر المنشورات\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!newPostContent.trim() && !newPostImage) {\n      toast({\n        title: \"تنبيه\",\n        description: \"يرجى كتابة محتوى أو إضافة صورة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createPostMutation.mutate({\n      content: newPostContent,\n      imageUrl: newPostImage,\n    });\n  };\n\n  // Join group mutation\n  const joinGroupMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/groups/${groupId}/join`, \"POST\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}`] });\n      queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/members`] });\n      toast({\n        title: \"تم الانضمام بنجاح\",\n        description: \"تم إضافتك إلى المجموعة بنجاح\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"حدث خطأ أثناء الانضمام للمجموعة\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleJoinGroup = () => {\n    if (!currentUserId || userType !== \"freelancer\") {\n      toast({\n        title: \"تنبيه\",\n        description: \"يجب تسجيل الدخول كفريلانسر للانضمام للمجموعة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    joinGroupMutation.mutate();\n  };\n\n  if (groupLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n        <div className=\"text-center\">\n          <div className=\"relative\">\n            <Users className=\"w-16 h-16 text-blue-500 mx-auto mb-4 animate-pulse\" />\n            <Sparkles className=\"w-6 h-6 text-purple-500 absolute top-0 right-0 animate-ping\" />\n          </div>\n          <p className=\"text-gray-600 font-medium\">جاري تحميل المجتمع...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!group) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n        <Card className=\"max-w-md shadow-2xl border-0 rounded-3xl bg-white/80 backdrop-blur-sm\">\n          <CardContent className=\"pt-6 text-center p-8\">\n            <Users className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n            <p className=\"text-gray-600\">المجموعة غير موجودة</p>\n            <Button\n              variant=\"outline\"\n              onClick={() => navigate(\"/groups\")}\n              className=\"mt-4 rounded-xl\"\n            >\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للجروبات\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const membersList = members\n    .map(m => getMemberInfo(m.freelancerId))\n    .filter(Boolean) as Freelancer[];\n\n  const upcomingEvents = events.filter(event => new Date(event.date) > new Date());\n  const recentMedia = media.slice(0, 6);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-purple-50/30\" dir=\"rtl\">\n      {/* Enhanced Modern Header */}\n      <div className=\"bg-white/80 backdrop-blur-xl shadow-sm border-b border-gray-100 sticky top-0 z-50\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"flex items-center justify-between h-20\">\n            {/* Left: Group Logo and Name */}\n            <div className=\"flex items-center gap-4\">\n              <div className=\"relative\">\n                <div className=\"w-14 h-14 bg-gradient-to-br from-blue-600 via-blue-500 to-purple-600 rounded-2xl flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/30 transform hover:scale-105 transition-transform\">\n                  {group.name.substring(0, 2)}\n                </div>\n                <div className=\"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 border-4 border-white rounded-full\"></div>\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent\">{group.name}</h1>\n                <p className=\"text-sm text-gray-500 flex items-center gap-2 mt-0.5\">\n                  <Users className=\"w-3.5 h-3.5\" />\n                  {group.currentMembers} عضو\n                </p>\n              </div>\n            </div>\n\n            {/* Right: Actions */}\n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"text-gray-600 hover:bg-gray-100 rounded-full\"\n                onClick={() => setShowSearch(!showSearch)}\n              >\n                <Search className=\"h-5 w-5\" />\n              </Button>\n              <div className=\"relative\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"text-gray-600 hover:bg-gray-100 rounded-full relative\"\n                  onClick={() => setShowNotifications(!showNotifications)}\n                >\n                  <Bell className=\"h-5 w-5\" />\n                  <span className=\"absolute top-1.5 right-1.5 w-2 h-2 bg-red-500 rounded-full\"></span>\n                </Button>\n\n                {/* Enhanced Notifications Dropdown */}\n                <AnimatePresence>\n                  {showNotifications && (\n                    <motion.div\n                      initial={{ opacity: 0, y: 10, scale: 0.95 }}\n                      animate={{ opacity: 1, y: 0, scale: 1 }}\n                      exit={{ opacity: 0, y: 10, scale: 0.95 }}\n                      className=\"absolute left-0 mt-2 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50\"\n                    >\n                      <div className=\"p-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white\">\n                        <h3 className=\"font-bold text-lg\">الإشعارات</h3>\n                      </div>\n                      <div className=\"max-h-96 overflow-y-auto\">\n                        {notifications.length === 0 ? (\n                          <div className=\"p-8 text-center\">\n                            <Bell className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\n                            <p className=\"text-sm text-gray-500\">لا توجد إشعارات جديدة</p>\n                          </div>\n                        ) : (\n                          notifications.slice(0, 5).map((notif: any, index: number) => (\n                            <div key={index} className=\"p-4 hover:bg-gray-50 cursor-pointer border-b border-gray-100 transition-colors\">\n                              <div className=\"flex items-start gap-3\">\n                                <div className={`w-10 h-10 rounded-full flex items-center justify-center ${notif.type === 'task_assigned' ? 'bg-purple-100' :\n                                  notif.type === 'new_member' ? 'bg-blue-100' :\n                                    'bg-green-100'\n                                  }`}>\n                                  {notif.type === 'task_assigned' ? <Star className=\"w-5 h-5 text-purple-600\" /> :\n                                    notif.type === 'new_member' ? <Users className=\"w-5 h-5 text-blue-600\" /> :\n                                      <MessageSquare className=\"w-5 h-5 text-green-600\" />}\n                                </div>\n                                <div className=\"flex-1\">\n                                  <p className=\"text-sm font-semibold text-gray-900\">{notif.title}</p>\n                                  <p className=\"text-xs text-gray-600 mt-1\">{notif.message}</p>\n                                  <p className=\"text-xs text-gray-400 mt-1\">\n                                    {formatDistanceToNow(new Date(notif.createdAt), { addSuffix: true, locale: ar })}\n                                  </p>\n                                </div>\n                              </div>\n                            </div>\n                          ))\n                        )}\n                      </div>\n                      <div className=\"p-3 bg-gray-50 text-center\">\n                        <button className=\"text-sm text-blue-600 hover:text-blue-700 font-semibold\">عرض كل الإشعارات</button>\n                      </div>\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n\n              {!isMember && !isLeader && userType === \"freelancer\" && (\n                <Button\n                  className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 shadow-lg shadow-blue-500/30 rounded-full transition-all hover:shadow-xl hover:scale-105\"\n                  onClick={handleJoinGroup}\n                  disabled={joinGroupMutation.isPending}\n                >\n                  <UserPlus className=\"ml-2 h-4 w-4\" />\n                  {joinGroupMutation.isPending ? \"جاري الانضمام...\" : \"انضم الآن\"}\n                </Button>\n              )}\n              {(isMember || isLeader) && (\n                <Badge className=\"bg-gradient-to-r from-green-500 to-emerald-500 text-white px-4 py-2 rounded-full shadow-lg shadow-green-500/30\">\n                  <UserCheck className=\"ml-2 h-4 w-4\" />\n                  عضو نشط\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Enhanced Search Bar */}\n      <AnimatePresence>\n        {showSearch && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: \"auto\" }}\n            exit={{ opacity: 0, height: 0 }}\n            className=\"border-t border-gray-100 bg-white/90 backdrop-blur-sm\"\n          >\n            <div className=\"container mx-auto px-4 py-4\">\n              <div className=\"relative max-w-2xl mx-auto\">\n                <Search className=\"absolute right-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                <Input\n                  type=\"text\"\n                  placeholder=\"ابحث في المنشورات والتعليقات...\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  className=\"pr-12 pl-4 py-6 rounded-full border-gray-200 focus:border-blue-500 bg-white shadow-sm\"\n                />\n                {searchQuery && (\n                  <button\n                    onClick={() => setSearchQuery(\"\")}\n                    className=\"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                  >\n                    <X className=\"h-5 w-5\" />\n                  </button>\n                )}\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Enhanced Admin-Only Notice */}\n      {!isLeader && (isMember || isLeader) && (\n        <div className=\"bg-gradient-to-r from-amber-50 to-orange-50 border-l-4 border-amber-500 p-4\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center\">\n                <Info className=\"w-5 h-5 text-amber-600\" />\n              </div>\n              <div className=\"flex-1\">\n                <p className=\"text-sm font-semibold text-amber-900\">ملاحظة هامة</p>\n                <p className=\"text-xs text-amber-700 mt-0.5\">فقط قائد المجموعة يمكنه نشر المنشورات في هذه المجموعة</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Enhanced Main Content */}\n      <div className=\"container mx-auto px-4 py-8 max-w-7xl\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6\">\n          {/* Enhanced Left Sidebar */}\n          <aside className=\"lg:col-span-3 space-y-6\">\n            {/* Enhanced Group Info Card */}\n            <FadeInSection delay={0.1}>\n              <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3 mb-5\">\n                    <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center\">\n                      <Info className=\"w-5 h-5 text-white\" />\n                    </div>\n                    <h3 className=\"font-bold text-gray-900 text-lg\">معلومات المجموعة</h3>\n                  </div>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl hover:shadow-md transition-all\">\n                      <span className=\"text-gray-600 flex items-center gap-2 text-sm font-medium\">\n                        <Users className=\"w-4 h-4 text-blue-600\" />\n                        الأعضاء\n                      </span>\n                      <span className=\"font-bold text-blue-600\">{group.currentMembers}</span>\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl hover:shadow-md transition-all\">\n                      <span className=\"text-gray-600 flex items-center gap-2 text-sm font-medium\">\n                        <FileText className=\"w-4 h-4 text-purple-600\" />\n                        المنشورات\n                      </span>\n                      <span className=\"font-bold text-purple-600\">{posts.length}</span>\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl hover:shadow-md transition-all\">\n                      <span className=\"text-gray-600 flex items-center gap-2 text-sm font-medium\">\n                        <Calendar className=\"w-4 h-4 text-green-600\" />\n                        تاريخ الإنشاء\n                      </span>\n                      <span className=\"font-bold text-green-600 text-xs\">\n                        {formatDistanceToNow(new Date(group.createdAt), { addSuffix: true, locale: ar })}\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </FadeInSection>\n\n            {/* Enhanced Group Description */}\n            {group.description && (\n              <FadeInSection delay={0.15}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-3 mb-4\">\n                      <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center\">\n                        <FileText className=\"w-5 h-5 text-white\" />\n                      </div>\n                      <h3 className=\"font-bold text-gray-900 text-lg\">عن المجموعة</h3>\n                    </div>\n                    <p className=\"text-gray-600 text-sm leading-relaxed\">{group.description}</p>\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            )}\n\n            {/* Enhanced Quick Actions */}\n            <FadeInSection delay={0.2}>\n              <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3 mb-5\">\n                    <div className=\"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center\">\n                      <Zap className=\"w-5 h-5 text-white\" />\n                    </div>\n                    <h3 className=\"font-bold text-gray-900 text-lg\">إجراءات سريعة</h3>\n                  </div>\n                  <div className=\"space-y-3\">\n                    {isLeader && (\n                      <button\n                        onClick={() => navigate(`/groups/${groupId}/dashboard`)}\n                        className=\"w-full flex items-center gap-3 p-3 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 rounded-xl transition-all group\"\n                      >\n                        <div className=\"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform\">\n                          <Settings className=\"w-5 h-5 text-purple-600\" />\n                        </div>\n                        <div className=\"text-right flex-1\">\n                          <p className=\"font-semibold text-sm text-gray-900\">لوحة التحكم</p>\n                          <p className=\"text-xs text-gray-500\">إدارة المجموعة والأعضاء</p>\n                        </div>\n                      </button>\n                    )}\n                    {userType === \"product_owner\" && group?.leaderId && (\n                      <button\n                        onClick={() => navigate(`/chat/${group.leaderId}`)}\n                        className=\"w-full flex items-center gap-3 p-3 hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50 rounded-xl transition-all group\"\n                      >\n                        <div className=\"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform\">\n                          <MessageSquare className=\"w-5 h-5 text-green-600\" />\n                        </div>\n                        <div className=\"text-right flex-1\">\n                          <p className=\"font-semibold text-sm text-gray-900\">محادثة القائد</p>\n                          <p className=\"text-xs text-gray-500\">تواصل مع قائد المجموعة</p>\n                        </div>\n                      </button>\n                    )}\n                    <button className=\"w-full flex items-center gap-3 p-3 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 rounded-xl transition-all group\">\n                      <div className=\"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform\">\n                        <Calendar className=\"w-5 h-5 text-blue-600\" />\n                      </div>\n                      <div className=\"text-right flex-1\">\n                        <p className=\"font-semibold text-sm text-gray-900\">الفعاليات</p>\n                        <p className=\"text-xs text-gray-500\">عرض الفعاليات القادمة</p>\n                      </div>\n                    </button>\n                  </div>\n                </CardContent>\n              </Card>\n            </FadeInSection>\n\n            {/* Enhanced Members List */}\n            <EnhancedMembersList\n              members={members}\n              getMemberInfo={getMemberInfo}\n              isOnline={isOnline}\n              checkIsLeader={checkIsLeader}\n            />\n          </aside>\n\n          {/* Enhanced Main Feed */}\n          <main className=\"lg:col-span-6 space-y-6\">\n            {/* Enhanced Create Post - Only for Leader */}\n            {isLeader && (\n              <FadeInSection delay={0.1}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-start gap-4 mb-4\">\n                      <Avatar className=\"w-12 h-12 border-2 border-white shadow-lg ring-2 ring-blue-100\">\n                        <AvatarImage src={currentUser?.profileImage} />\n                        <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-bold\">\n                          {currentUser?.fullName?.substring(0, 2) || \"Me\"}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1\">\n                        <Textarea\n                          placeholder=\"شارك شيئاً مميزاً مع المجموعة... ✨\"\n                          value={newPostContent}\n                          onChange={(e) => setNewPostContent(e.target.value)}\n                          className=\"resize-none min-h-[120px] border-0 text-base focus:ring-0 placeholder:text-gray-400 text-gray-900 p-0 bg-transparent\"\n                        />\n                      </div>\n                    </div>\n\n                    {newPostImage && (\n                      <motion.div\n                        initial={{ opacity: 0, scale: 0.95 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        className=\"relative mb-4 rounded-2xl overflow-hidden border-2 border-gray-100 shadow-lg\"\n                      >\n                        <img\n                          src={newPostImage}\n                          alt=\"معاينة\"\n                          className=\"w-full max-h-96 object-cover\"\n                        />\n                        <Button\n                          size=\"sm\"\n                          variant=\"destructive\"\n                          className=\"absolute top-3 left-3 bg-red-500/90 hover:bg-red-600 backdrop-blur-sm border-0 shadow-lg rounded-full\"\n                          onClick={() => setNewPostImage(null)}\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </motion.div>\n                    )}\n\n                    {/* Enhanced Task Creation */}\n                    <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-5 mb-4 border border-blue-100\">\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/30\">\n                            <Briefcase className=\"h-5 w-5 text-white\" />\n                          </div>\n                          <div>\n                            <h4 className=\"font-bold text-gray-900\">إنشاء مهمة للأعضاء</h4>\n                            <p className=\"text-xs text-gray-500\">سيتم إنشاء مهمة تلقائية لكل عضو في المجموعة</p>\n                          </div>\n                        </div>\n                        <Switch\n                          checked={createTask}\n                          onCheckedChange={setCreateTask}\n                          className=\"data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-blue-600 data-[state=checked]:to-purple-600\"\n                        />\n                      </div>\n\n                      <AnimatePresence>\n                        {createTask && (\n                          <motion.div\n                            initial={{ height: 0, opacity: 0 }}\n                            animate={{ height: \"auto\", opacity: 1 }}\n                            exit={{ height: 0, opacity: 0 }}\n                            className=\"overflow-hidden\"\n                          >\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2\">\n                              <div className=\"space-y-2\">\n                                <Label htmlFor=\"task-title\" className=\"text-sm font-semibold text-gray-700 flex items-center gap-2\">\n                                  <Zap className=\"w-4 h-4 text-blue-600\" />\n                                  عنوان المهمة\n                                </Label>\n                                <Input\n                                  id=\"task-title\"\n                                  placeholder=\"مثال: تفاعل مع هذا المنشور\"\n                                  value={taskTitle}\n                                  onChange={(e) => setTaskTitle(e.target.value)}\n                                  className=\"bg-white border-gray-200 focus:border-blue-500 rounded-xl\"\n                                />\n                              </div>\n                              <div className=\"space-y-2\">\n                                <Label htmlFor=\"task-reward\" className=\"text-sm font-semibold text-gray-700 flex items-center gap-2\">\n                                  <Star className=\"w-4 h-4 text-yellow-500\" />\n                                  المكافأة (ر.س)\n                                </Label>\n                                <Input\n                                  id=\"task-reward\"\n                                  type=\"number\"\n                                  min=\"0\"\n                                  step=\"0.01\"\n                                  value={taskReward}\n                                  onChange={(e) => setTaskReward(e.target.value)}\n                                  className=\"bg-white border-gray-200 focus:border-blue-500 rounded-xl\"\n                                />\n                              </div>\n                            </div>\n                          </motion.div>\n                        )}\n                      </AnimatePresence>\n                    </div>\n\n                    <Separator className=\"mb-4\" />\n\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <button\n                          onClick={() => document.getElementById('post-image-input')?.click()}\n                          className=\"flex items-center gap-2 px-4 py-2.5 hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50 rounded-xl text-gray-600 transition-all group\"\n                        >\n                          <ImageIcon className=\"h-5 w-5 text-green-500 group-hover:scale-110 transition-transform\" />\n                          <span className=\"text-sm font-medium hidden sm:inline\">صورة</span>\n                        </button>\n                        <input\n                          id=\"post-image-input\"\n                          type=\"file\"\n                          accept=\"image/*\"\n                          className=\"hidden\"\n                          onChange={async (e) => {\n                            const file = e.target.files?.[0];\n                            if (file) {\n                              const url = await handleImageUpload(file, 'post');\n                              if (url) setNewPostImage(url);\n                            }\n                          }}\n                        />\n                      </div>\n\n                      <Button\n                        className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 shadow-lg shadow-blue-500/30 rounded-full transition-all hover:shadow-xl hover:scale-105\"\n                        onClick={handleCreatePost}\n                        disabled={createPostMutation.isPending || (!newPostContent.trim() && !newPostImage)}\n                      >\n                        {createPostMutation.isPending ? \"جاري النشر...\" : \"نشر\"}\n                        <Send className=\"mr-2 h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            )}\n\n            {/* Enhanced Posts Feed */}\n            <div className=\"space-y-6\">\n              {postsLoading ? (\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 p-12 text-center\">\n                  <div className=\"animate-pulse flex flex-col items-center\">\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-blue-200 to-purple-200 rounded-full mb-4\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded-full w-1/3 mb-2\"></div>\n                    <div className=\"h-3 bg-gray-200 rounded-full w-1/4\"></div>\n                  </div>\n                </Card>\n              ) : posts.length === 0 ? (\n                <FadeInSection delay={0.2}>\n                  <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 p-16 text-center\">\n                    <div className=\"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n                      <MessageSquare className=\"w-12 h-12 text-blue-500\" />\n                    </div>\n                    <h3 className=\"text-2xl font-bold text-gray-900 mb-3\">لا توجد منشورات بعد</h3>\n                    <p className=\"text-gray-500 text-lg\">\n                      {isLeader ? \"كن أول من ينشر في هذه المجموعة! ✨\" : \"قائد المجموعة لم ينشر أي شيء بعد.\"}\n                    </p>\n                  </Card>\n                </FadeInSection>\n              ) : (\n                posts.map((post, index) => (\n                  <FadeInSection key={post.id} delay={index * 0.1}>\n                    <EnhancedPostCard\n                      post={post}\n                      groupId={groupId}\n                      currentUserId={currentUserId}\n                      getMemberInfo={getMemberInfo}\n                      checkIsLeader={checkIsLeader}\n                      commentInputs={commentInputs}\n                      setCommentInputs={setCommentInputs}\n                      commentImages={commentImages}\n                      setCommentImages={setCommentImages}\n                      expandedPosts={expandedPosts}\n                      setExpandedPosts={setExpandedPosts}\n                      toast={toast}\n                      detectUrls={detectUrls}\n                      handleImageUpload={handleImageUpload}\n                    />\n                  </FadeInSection>\n                ))\n              )}\n            </div>\n          </main>\n\n          {/* Enhanced Right Sidebar */}\n          <aside className=\"lg:col-span-3 space-y-6\">\n            {/* Enhanced Upcoming Events */}\n            {upcomingEvents.length > 0 && (\n              <FadeInSection delay={0.1}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between mb-5\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center\">\n                          <Calendar className=\"w-5 h-5 text-white\" />\n                        </div>\n                        <h3 className=\"font-bold text-gray-900 text-lg\">الفعاليات القادمة</h3>\n                      </div>\n                      <Button variant=\"ghost\" size=\"sm\" className=\"text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded-full\">\n                        عرض الكل\n                      </Button>\n                    </div>\n                    <div className=\"space-y-3\">\n                      {upcomingEvents.slice(0, 3).map(event => (\n                        <div key={event.id} className=\"p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 hover:shadow-md cursor-pointer transition-all group\">\n                          <p className=\"font-bold text-sm text-gray-900 group-hover:text-purple-600 transition-colors\">{event.title}</p>\n                          <div className=\"flex items-center gap-2 mt-2 text-xs text-gray-600\">\n                            <Calendar className=\"h-3.5 w-3.5 text-purple-500\" />\n                            <span>{formatDistanceToNow(new Date(event.date), { addSuffix: true, locale: ar })}</span>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            )}\n\n            {/* Enhanced Popular Tags */}\n            {group.tags && group.tags.length > 0 && (\n              <FadeInSection delay={0.15}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-3 mb-5\">\n                      <div className=\"w-10 h-10 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center\">\n                        <Sparkles className=\"w-5 h-5 text-white\" />\n                      </div>\n                      <h3 className=\"font-bold text-gray-900 text-lg\">الوسوم الشائعة</h3>\n                    </div>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {group.tags.slice(0, 8).map((tag, index) => (\n                        <motion.span\n                          key={index}\n                          initial={{ opacity: 0, scale: 0.8 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          transition={{ delay: index * 0.05 }}\n                          className=\"px-4 py-2 bg-gradient-to-r from-blue-50 to-purple-50 hover:from-blue-100 hover:to-purple-100 text-gray-700 rounded-full text-sm font-medium cursor-pointer transition-all hover:shadow-md hover:scale-105\"\n                        >\n                          #{tag}\n                        </motion.span>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            )}\n\n            {/* Enhanced Group Rules */}\n            {group.rules && group.rules.length > 0 && (\n              <FadeInSection delay={0.2}>\n                <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-3 mb-5\">\n                      <div className=\"w-10 h-10 bg-gradient-to-r from-red-500 to-pink-500 rounded-xl flex items-center justify-center\">\n                        <Flag className=\"w-5 h-5 text-white\" />\n                      </div>\n                      <h3 className=\"font-bold text-gray-900 text-lg\">قواعد المجموعة</h3>\n                    </div>\n                    <div className=\"space-y-3\">\n                      {group.rules.map((rule, index) => (\n                        <div key={index} className=\"flex items-start gap-3 p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl hover:shadow-sm transition-all\">\n                          <div className=\"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5\">\n                            <span className=\"text-xs font-bold text-blue-600\">{index + 1}</span>\n                          </div>\n                          <p className=\"text-sm text-gray-700 leading-relaxed\">{rule}</p>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </FadeInSection>\n            )}\n          </aside>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Enhanced Post Card Component\nfunction EnhancedPostCard({\n  post,\n  groupId,\n  currentUserId,\n  getMemberInfo,\n  checkIsLeader,\n  commentInputs,\n  setCommentInputs,\n  commentImages,\n  setCommentImages,\n  expandedPosts,\n  setExpandedPosts,\n  toast,\n  detectUrls,\n  handleImageUpload\n}: any) {\n  const author = getMemberInfo(post.authorId);\n  const isAuthorLeader = checkIsLeader(post.authorId);\n\n  // Fetch comments\n  const { data: comments = [] } = useQuery<PostComment[]>({\n    queryKey: [`/api/posts/${post.id}/comments`],\n    queryFn: async () => {\n      const response = await fetch(`/api/posts/${post.id}/comments`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) return [];\n      return response.json();\n    },\n  });\n\n  // Fetch reactions\n  const { data: reactionsData, refetch: refetchReactions } = useQuery({\n    queryKey: [`/api/posts/${post.id}/reactions`],\n    queryFn: async () => {\n      const response = await fetch(`/api/posts/${post.id}/reactions`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      if (!response.ok) return { reactions: [], userReaction: null };\n      return response.json();\n    },\n  });\n\n  const reactions = reactionsData?.reactions || [];\n  const userReaction = reactionsData?.userReaction;\n\n  // Toggle reaction mutation\n  const toggleReactionMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(`/api/posts/${post.id}/reactions`, \"POST\", { type: 'like' });\n    },\n    onSuccess: () => {\n      refetchReactions();\n    },\n  });\n\n  // Create comment mutation\n  const createCommentMutation = useMutation({\n    mutationFn: async ({ content, imageUrl }: { content: string; imageUrl: string | null }) => {\n      return await apiRequest(`/api/posts/${post.id}/comments`, \"POST\", {\n        content,\n        imageUrl,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/posts/${post.id}/comments`] });\n      setCommentInputs((prev: Record<string, string>) => ({ ...prev, [post.id]: \"\" }));\n      setCommentImages((prev: Record<string, string>) => {\n        const newState = { ...prev };\n        delete newState[post.id];\n        return newState;\n      });\n\n      // Auto expand comments\n      const newExpanded = new Set(expandedPosts);\n      newExpanded.add(post.id);\n      setExpandedPosts(newExpanded);\n    },\n  });\n\n  const handleCommentSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const content = commentInputs[post.id];\n    const imageUrl = commentImages[post.id];\n\n    // Require image upload\n    if (!imageUrl) {\n      toast({\n        title: \"صورة مطلوبة\",\n        description: \"يجب إرفاق صورة مع التعليق لإثبات المهمة\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createCommentMutation.mutate({\n      content: content || \"\",\n      imageUrl: imageUrl || null,\n    });\n  };\n\n  const handleShare = () => {\n    const url = `${window.location.origin}/groups/${groupId}/community?postId=${post.id}`;\n    navigator.clipboard.writeText(url).then(() => {\n      toast({\n        title: \"تم نسخ الرابط\",\n        description: \"تم نسخ رابط المنشور إلى الحافظة\",\n      });\n    }).catch(() => {\n      toast({\n        title: \"خطأ\",\n        description: \"فشل نسخ الرابط\",\n        variant: \"destructive\",\n      });\n    });\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg hover:shadow-xl transition-all duration-300 rounded-2xl overflow-hidden bg-white/80 backdrop-blur-sm\">\n      <CardContent className=\"p-0\">\n        {/* Enhanced Post Header */}\n        <div className=\"p-6 flex items-start justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <Avatar className=\"w-14 h-14 border-2 border-white shadow-lg ring-2 ring-blue-100\">\n              <AvatarImage src={author?.profileImage} />\n              <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-bold\">\n                {author?.fullName?.substring(0, 2)}\n              </AvatarFallback>\n            </Avatar>\n            <div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-bold text-gray-900 text-lg\">{author?.fullName}</span>\n                {isAuthorLeader && (\n                  <Badge className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white text-xs px-3 py-1 rounded-full shadow-md\">\n                    قائد\n                  </Badge>\n                )}\n              </div>\n              <div className=\"flex items-center gap-2 text-sm text-gray-500 mt-1\">\n                <span>{formatDistanceToNow(new Date(post.createdAt), { addSuffix: true, locale: ar })}</span>\n                <span>•</span>\n                <Globe className=\"w-3.5 h-3.5\" />\n              </div>\n            </div>\n          </div>\n\n          <Button variant=\"ghost\" size=\"icon\" className=\"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full\">\n            <MoreHorizontal className=\"w-5 h-5\" />\n          </Button>\n        </div>\n\n        {/* Enhanced Post Content */}\n        <div className=\"px-6 pb-3\">\n          <p className=\"text-gray-800 whitespace-pre-wrap leading-relaxed text-base\">\n            {detectUrls(post.content)}\n          </p>\n        </div>\n\n        {/* Enhanced Post Image */}\n        {post.imageUrl && (\n          <div className=\"mt-3 bg-gray-50\">\n            <img\n              src={post.imageUrl}\n              alt=\"Post content\"\n              className=\"w-full max-h-[600px] object-contain mx-auto\"\n            />\n          </div>\n        )}\n\n        {/* Enhanced Post Stats */}\n        <div className=\"px-6 py-4 flex items-center justify-between text-sm text-gray-500 border-b border-gray-100\">\n          <div className=\"flex items-center gap-1\">\n            {reactions.length > 0 && (\n              <div className=\"flex items-center gap-2 bg-gradient-to-r from-blue-50 to-purple-50 px-3 py-1.5 rounded-full\">\n                <ThumbsUp className=\"w-4 h-4 text-blue-500 fill-blue-500\" />\n                <span className=\"text-blue-700 font-semibold\">{reactions.length}</span>\n              </div>\n            )}\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <button\n              className=\"hover:underline font-medium\"\n              onClick={() => {\n                const newExpanded = new Set(expandedPosts);\n                if (newExpanded.has(post.id)) {\n                  newExpanded.delete(post.id);\n                } else {\n                  newExpanded.add(post.id);\n                }\n                setExpandedPosts(newExpanded);\n              }}\n            >\n              {comments.length} تعليق\n            </button>\n          </div>\n        </div>\n\n        {/* Enhanced Post Actions */}\n        <div className=\"px-3 py-2 flex items-center justify-between border-b border-gray-100\">\n          <Button\n            variant=\"ghost\"\n            className={`flex-1 gap-2 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 rounded-xl ${userReaction ? 'text-blue-600' : 'text-gray-600'}`}\n            onClick={() => toggleReactionMutation.mutate()}\n          >\n            <ThumbsUp className={`w-5 h-5 ${userReaction ? 'fill-blue-600' : ''}`} />\n            <span className=\"font-semibold\">أعجبني</span>\n          </Button>\n          <Button\n            variant=\"ghost\"\n            className=\"flex-1 gap-2 text-gray-600 hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50 rounded-xl\"\n            onClick={() => {\n              const input = document.getElementById(`comment-input-${post.id}`);\n              input?.focus();\n            }}\n          >\n            <MessageSquare className=\"w-5 h-5\" />\n            <span className=\"font-semibold\">تعليق</span>\n          </Button>\n          <Button\n            variant=\"ghost\"\n            className=\"flex-1 gap-2 text-gray-600 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 rounded-xl\"\n            onClick={handleShare}\n          >\n            <Share className=\"w-5 h-5\" />\n            <span className=\"font-semibold\">مشاركة</span>\n          </Button>\n        </div>\n\n        {/* Enhanced Comments Section */}\n        <div className=\"bg-gradient-to-br from-gray-50 to-blue-50/30 p-6 space-y-5\">\n          {/* Enhanced Comments List */}\n          {expandedPosts.has(post.id) && comments.length > 0 && (\n            <div className=\"space-y-4 mb-4\">\n              {comments.map((comment) => {\n                const commentAuthor = getMemberInfo(comment.authorId);\n                return (\n                  <motion.div\n                    key={comment.id}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    className=\"flex gap-3\"\n                  >\n                    <Avatar className=\"w-10 h-10 mt-1 border-2 border-white shadow-md\">\n                      <AvatarImage src={commentAuthor?.profileImage} />\n                      <AvatarFallback className=\"text-xs bg-gradient-to-br from-gray-200 to-gray-300\">\n                        {commentAuthor?.fullName?.substring(0, 2)}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <div className=\"bg-white rounded-2xl px-5 py-3 inline-block shadow-sm border border-gray-100\">\n                        <p className=\"font-bold text-sm text-gray-900\">{commentAuthor?.fullName}</p>\n                        <p className=\"text-sm text-gray-800 mt-1\">{comment.content}</p>\n                      </div>\n                      {comment.imageUrl && (\n                        <img\n                          src={comment.imageUrl}\n                          alt=\"Comment attachment\"\n                          className=\"mt-3 rounded-xl max-h-48 object-cover border-2 border-white shadow-md\"\n                        />\n                      )}\n                      <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500 px-2\">\n                        <span>{formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true, locale: ar })}</span>\n                        <button className=\"font-semibold hover:underline hover:text-blue-600\">أعجبني</button>\n                        <button className=\"font-semibold hover:underline hover:text-blue-600\">رد</button>\n                      </div>\n                    </div>\n                  </motion.div>\n                );\n              })}\n            </div>\n          )}\n\n          {/* Enhanced Comment Input */}\n          <div className=\"flex gap-3 items-start\">\n            <Avatar className=\"w-10 h-10 border-2 border-white shadow-md\">\n              <AvatarImage src={getMemberInfo(currentUserId)?.profileImage} />\n              <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white\">\n                {getMemberInfo(currentUserId)?.fullName?.substring(0, 2)}\n              </AvatarFallback>\n            </Avatar>\n            <div className=\"flex-1\">\n              <form onSubmit={handleCommentSubmit} className=\"relative\">\n                <Input\n                  id={`comment-input-${post.id}`}\n                  placeholder=\"اكتب تعليقاً وأرفق صورة (مطلوب)...\"\n                  value={commentInputs[post.id] || \"\"}\n                  onChange={(e) => setCommentInputs((prev: Record<string, string>) => ({ ...prev, [post.id]: e.target.value }))}\n                  className=\"bg-white border-gray-200 rounded-full pr-4 pl-24 py-6 focus-visible:ring-2 focus-visible:ring-blue-500 shadow-sm\"\n                />\n                <div className=\"absolute left-2 top-1/2 -translate-y-1/2 flex items-center gap-1\">\n                  <button\n                    type=\"button\"\n                    className=\"p-2 text-gray-500 hover:bg-blue-50 hover:text-blue-600 rounded-full transition-all\"\n                    onClick={() => document.getElementById(`comment-image-${post.id}`)?.click()}\n                  >\n                    <Camera className=\"w-5 h-5\" />\n                  </button>\n                  <input\n                    id={`comment-image-${post.id}`}\n                    type=\"file\"\n                    accept=\"image/*\"\n                    className=\"hidden\"\n                    onChange={async (e) => {\n                      const file = e.target.files?.[0];\n                      if (file) {\n                        const url = await handleImageUpload(file, 'comment', post.id);\n                        if (url) {\n                          setCommentImages((prev: Record<string, string>) => ({ ...prev, [post.id]: url }));\n                        }\n                      }\n                    }}\n                  />\n                  <button\n                    type=\"submit\"\n                    disabled={!commentImages[post.id] || createCommentMutation.isPending}\n                    className=\"p-2 text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 rounded-full transition-all disabled:opacity-50 disabled:hover:from-blue-600 disabled:hover:to-purple-600 shadow-lg shadow-blue-500/30\"\n                    title={!commentImages[post.id] ? \"يجب إرفاق صورة أولاً\" : \"إرسال\"}\n                  >\n                    <Send className=\"w-5 h-5 rtl:rotate-180\" />\n                  </button>\n                </div>\n              </form>\n              {commentImages[post.id] && (\n                <motion.div\n                  initial={{ opacity: 0, scale: 0.95 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  className=\"relative mt-3 inline-block\"\n                >\n                  <img\n                    src={commentImages[post.id]}\n                    alt=\"Attachment\"\n                    className=\"h-24 rounded-xl border-2 border-white shadow-md\"\n                  />\n                  <button\n                    className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 shadow-lg hover:bg-red-600 hover:scale-110 transition-all\"\n                    onClick={() => setCommentImages((prev: Record<string, string>) => {\n                      const newState = { ...prev };\n                      delete newState[post.id];\n                      return newState;\n                    })}\n                  >\n                    <X className=\"w-4 h-4\" />\n                  </button>\n                </motion.div>\n              )}\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\n// Enhanced Members List Component\nfunction EnhancedMembersList({ members, getMemberInfo, isOnline, checkIsLeader }: { members: GroupMember[], getMemberInfo: any, isOnline: any, checkIsLeader: any }) {\n  const [, navigate] = useLocation();\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n  const userType = localStorage.getItem(\"userType\");\n  \n  // Get first 8 members\n  const displayedMembers = members.slice(0, 8);\n\n  return (\n    <FadeInSection delay={0.25}>\n      <Card className=\"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-5\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center\">\n                <Users className=\"w-5 h-5 text-white\" />\n              </div>\n              <h3 className=\"font-bold text-gray-900 text-lg\">أعضاء المجموعة</h3>\n            </div>\n            <Badge className=\"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-3 py-1 rounded-full shadow-md\">\n              {members.length}\n            </Badge>\n          </div>\n\n          <div className=\"space-y-4\">\n            {displayedMembers.map((member) => {\n              const info = getMemberInfo(member.freelancerId);\n              if (!info) return null;\n\n              const online = isOnline(info.lastSeen);\n\n              return (\n                <motion.div\n                  key={member.id}\n                  initial={{ opacity: 0, x: -10 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  className=\"flex items-center justify-between p-3 rounded-xl hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all group\"\n                >\n                  <div className=\"flex items-center gap-3 flex-1\">\n                    <div className=\"relative\">\n                      <Avatar className=\"w-11 h-11 border-2 border-white shadow-md ring-2 ring-gray-100 group-hover:ring-blue-200 transition-all\">\n                        <AvatarImage src={info.profileImage} />\n                        <AvatarFallback className=\"text-xs bg-gradient-to-br from-gray-100 to-gray-200 font-semibold\">\n                          {info.fullName?.substring(0, 2)}\n                        </AvatarFallback>\n                      </Avatar>\n                      {online && (\n                        <span className=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full shadow-sm\"></span>\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"font-bold text-sm text-gray-900 leading-none group-hover:text-blue-600 transition-colors\">{info.fullName}</p>\n                      <p className=\"text-xs text-gray-500 mt-1.5 flex items-center gap-1\">\n                        {checkIsLeader(member.freelancerId) ? (\n                          <>\n                            <Star className=\"w-3 h-3 text-yellow-500 fill-yellow-500\" />\n                            قائد المجموعة\n                          </>\n                        ) : (\n                          info.jobTitle || 'عضو'\n                        )}\n                      </p>\n                    </div>\n                  </div>\n                  {currentUser?.id !== member.freelancerId && (\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => navigate(`/chat/${member.freelancerId}`)}\n                      className=\"opacity-0 group-hover:opacity-100 transition-opacity\"\n                    >\n                      <MessageSquare className=\"w-4 h-4\" />\n                    </Button>\n                  )}\n                </motion.div>\n              );\n            })}\n          </div>\n\n          {members.length > 8 && (\n            <Button variant=\"ghost\" className=\"w-full mt-4 text-blue-600 hover:text-blue-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 text-sm font-semibold rounded-xl\">\n              عرض كل الأعضاء ({members.length})\n            </Button>\n          )}\n        </CardContent>\n      </Card>\n    </FadeInSection>\n  );\n}","size_bytes":67296},"server/seed-admin.ts":{"content":"import { db } from \"./db\";\nimport { roles, permissions, rolePermissions, adminUsers } from \"@shared/schema\";\nimport bcrypt from \"bcrypt\";\nimport { eq } from \"drizzle-orm\";\n\n// تعريف الصلاحيات الأساسية\nconst basePermissions = [\n  // إدارة المستخدمين الإداريين\n  { name: \"admin_users:view\", nameAr: \"عرض المستخدمين الإداريين\", resource: \"admin_users\", action: \"view\", description: \"Can view admin users list\" },\n  { name: \"admin_users:create\", nameAr: \"إنشاء مستخدم إداري\", resource: \"admin_users\", action: \"create\", description: \"Can create new admin users\" },\n  { name: \"admin_users:edit\", nameAr: \"تعديل مستخدم إداري\", resource: \"admin_users\", action: \"edit\", description: \"Can edit admin users\" },\n  { name: \"admin_users:delete\", nameAr: \"حذف مستخدم إداري\", resource: \"admin_users\", action: \"delete\", description: \"Can delete admin users\" },\n  \n  // إدارة الأدوار والصلاحيات\n  { name: \"roles:view\", nameAr: \"عرض الأدوار\", resource: \"roles\", action: \"view\", description: \"Can view roles\" },\n  { name: \"roles:manage\", nameAr: \"إدارة الأدوار\", resource: \"roles\", action: \"manage\", description: \"Can manage roles and permissions\" },\n  \n  // إدارة الفريلانسرز\n  { name: \"freelancers:view\", nameAr: \"عرض الفريلانسرز\", resource: \"freelancers\", action: \"view\", description: \"Can view freelancers\" },\n  { name: \"freelancers:edit\", nameAr: \"تعديل الفريلانسرز\", resource: \"freelancers\", action: \"edit\", description: \"Can edit freelancers\" },\n  { name: \"freelancers:delete\", nameAr: \"حذف الفريلانسرز\", resource: \"freelancers\", action: \"delete\", description: \"Can delete freelancers\" },\n  { name: \"freelancers:ban\", nameAr: \"حظر الفريلانسرز\", resource: \"freelancers\", action: \"ban\", description: \"Can ban freelancers\" },\n  \n  // إدارة أصحاب المنتجات\n  { name: \"product_owners:view\", nameAr: \"عرض أصحاب المنتجات\", resource: \"product_owners\", action: \"view\", description: \"Can view product owners\" },\n  { name: \"product_owners:edit\", nameAr: \"تعديل أصحاب المنتجات\", resource: \"product_owners\", action: \"edit\", description: \"Can edit product owners\" },\n  { name: \"product_owners:delete\", nameAr: \"حذف أصحاب المنتجات\", resource: \"product_owners\", action: \"delete\", description: \"Can delete product owners\" },\n  { name: \"product_owners:ban\", nameAr: \"حظر أصحاب المنتجات\", resource: \"product_owners\", action: \"ban\", description: \"Can ban product owners\" },\n  \n  // إدارة الجروبات\n  { name: \"groups:view\", nameAr: \"عرض الجروبات\", resource: \"groups\", action: \"view\", description: \"Can view groups\" },\n  { name: \"groups:edit\", nameAr: \"تعديل الجروبات\", resource: \"groups\", action: \"edit\", description: \"Can edit groups\" },\n  { name: \"groups:delete\", nameAr: \"حذف الجروبات\", resource: \"groups\", action: \"delete\", description: \"Can delete groups\" },\n  \n  // إدارة المشاريع\n  { name: \"projects:view\", nameAr: \"عرض المشاريع\", resource: \"projects\", action: \"view\", description: \"Can view projects\" },\n  { name: \"projects:edit\", nameAr: \"تعديل المشاريع\", resource: \"projects\", action: \"edit\", description: \"Can edit projects\" },\n  { name: \"projects:delete\", nameAr: \"حذف المشاريع\", resource: \"projects\", action: \"delete\", description: \"Can delete projects\" },\n  \n  // إدارة الطلبات\n  { name: \"orders:view\", nameAr: \"عرض الطلبات\", resource: \"orders\", action: \"view\", description: \"Can view orders\" },\n  { name: \"orders:edit\", nameAr: \"تعديل الطلبات\", resource: \"orders\", action: \"edit\", description: \"Can edit orders\" },\n  { name: \"orders:cancel\", nameAr: \"إلغاء الطلبات\", resource: \"orders\", action: \"cancel\", description: \"Can cancel orders\" },\n  { name: \"orders:refund\", nameAr: \"استرجاع المبالغ\", resource: \"orders\", action: \"refund\", description: \"Can refund orders\" },\n  \n  // إدارة المهام\n  { name: \"tasks:view\", nameAr: \"عرض المهام\", resource: \"tasks\", action: \"view\", description: \"Can view tasks\" },\n  { name: \"tasks:edit\", nameAr: \"تعديل المهام\", resource: \"tasks\", action: \"edit\", description: \"Can edit tasks\" },\n  \n  // إدارة السحوبات\n  { name: \"withdrawals:view\", nameAr: \"عرض السحوبات\", resource: \"withdrawals\", action: \"view\", description: \"Can view withdrawals\" },\n  { name: \"withdrawals:approve\", nameAr: \"الموافقة على السحوبات\", resource: \"withdrawals\", action: \"approve\", description: \"Can approve withdrawals\" },\n  { name: \"withdrawals:reject\", nameAr: \"رفض السحوبات\", resource: \"withdrawals\", action: \"reject\", description: \"Can reject withdrawals\" },\n  \n  // إدارة المدفوعات\n  { name: \"payments:view\", nameAr: \"عرض المدفوعات\", resource: \"payments\", action: \"view\", description: \"Can view payments\" },\n  { name: \"payments:process\", nameAr: \"معالجة المدفوعات\", resource: \"payments\", action: \"process\", description: \"Can process payments\" },\n  \n  // التقارير والإحصائيات\n  { name: \"reports:view\", nameAr: \"عرض التقارير\", resource: \"reports\", action: \"view\", description: \"Can view reports and statistics\" },\n  { name: \"reports:export\", nameAr: \"تصدير التقارير\", resource: \"reports\", action: \"export\", description: \"Can export reports\" },\n  \n  // الإعدادات\n  { name: \"settings:view\", nameAr: \"عرض الإعدادات\", resource: \"settings\", action: \"view\", description: \"Can view settings\" },\n  { name: \"settings:edit\", nameAr: \"تعديل الإعدادات\", resource: \"settings\", action: \"edit\", description: \"Can edit settings\" },\n  \n  // الإشعارات\n  { name: \"notifications:view\", nameAr: \"عرض الإشعارات\", resource: \"notifications\", action: \"view\", description: \"Can view notifications\" },\n  { name: \"notifications:send\", nameAr: \"إرسال الإشعارات\", resource: \"notifications\", action: \"send\", description: \"Can send notifications\" },\n];\n\n// تعريف الأدوار الأساسية\nconst baseRoles = [\n  {\n    name: \"admin\",\n    nameAr: \"مدير\",\n    description: \"صلاحيات كاملة لإدارة جميع أجزاء المنصة\",\n    isSystemRole: true,\n    permissions: [\"*\"], // جميع الصلاحيات\n  },\n  {\n    name: \"developer\",\n    nameAr: \"مبرمج\",\n    description: \"صلاحيات تقنية للمطورين\",\n    isSystemRole: true,\n    permissions: [\n      \"freelancers:view\", \"freelancers:edit\",\n      \"product_owners:view\", \"product_owners:edit\",\n      \"groups:view\", \"groups:edit\",\n      \"projects:view\", \"projects:edit\",\n      \"orders:view\", \"orders:edit\",\n      \"tasks:view\", \"tasks:edit\",\n      \"reports:view\",\n      \"settings:view\", \"settings:edit\",\n    ],\n  },\n  {\n    name: \"marketer\",\n    nameAr: \"مسوّق\",\n    description: \"صلاحيات تسويقية\",\n    isSystemRole: true,\n    permissions: [\n      \"freelancers:view\",\n      \"product_owners:view\",\n      \"groups:view\",\n      \"orders:view\",\n      \"reports:view\",\n      \"notifications:view\", \"notifications:send\",\n    ],\n  },\n  {\n    name: \"support\",\n    nameAr: \"دعم فني\",\n    description: \"صلاحيات الدعم الفني\",\n    isSystemRole: true,\n    permissions: [\n      \"freelancers:view\", \"freelancers:edit\",\n      \"product_owners:view\", \"product_owners:edit\",\n      \"groups:view\",\n      \"projects:view\",\n      \"orders:view\", \"orders:edit\",\n      \"tasks:view\",\n      \"withdrawals:view\",\n      \"notifications:view\", \"notifications:send\",\n    ],\n  },\n  {\n    name: \"partner\",\n    nameAr: \"شريك\",\n    description: \"صلاحيات محدودة للشركاء\",\n    isSystemRole: true,\n    permissions: [\n      \"freelancers:view\",\n      \"product_owners:view\",\n      \"groups:view\",\n      \"projects:view\",\n      \"orders:view\",\n      \"reports:view\",\n    ],\n  },\n];\n\nasync function seedAdminSystem() {\n  console.log(\"Starting admin system seeding...\");\n\n  try {\n    // 1. إضافة الصلاحيات\n    console.log(\"Inserting permissions...\");\n    const insertedPermissions: Record<string, string> = {};\n    \n    for (const perm of basePermissions) {\n      const [existing] = await db.select().from(permissions).where(eq(permissions.name, perm.name));\n      \n      if (!existing) {\n        const [inserted] = await db.insert(permissions).values(perm).returning();\n        insertedPermissions[perm.name] = inserted.id;\n        console.log(`  ✓ Created permission: ${perm.nameAr}`);\n      } else {\n        insertedPermissions[perm.name] = existing.id;\n        console.log(`  - Permission exists: ${perm.nameAr}`);\n      }\n    }\n\n    // 2. إضافة الأدوار\n    console.log(\"\\nInserting roles...\");\n    for (const role of baseRoles) {\n      const [existingRole] = await db.select().from(roles).where(eq(roles.name, role.name));\n      \n      let roleId: string;\n      if (!existingRole) {\n        const [inserted] = await db.insert(roles).values({\n          name: role.name,\n          nameAr: role.nameAr,\n          description: role.description,\n          isSystemRole: role.isSystemRole,\n        }).returning();\n        roleId = inserted.id;\n        console.log(`  ✓ Created role: ${role.nameAr}`);\n      } else {\n        roleId = existingRole.id;\n        console.log(`  - Role exists: ${role.nameAr}`);\n      }\n\n      // 3. ربط الأدوار بالصلاحيات\n      if (role.permissions.includes(\"*\")) {\n        // إعطاء جميع الصلاحيات للمدير\n        for (const permId of Object.values(insertedPermissions)) {\n          const [existing] = await db.select().from(rolePermissions)\n            .where(eq(rolePermissions.roleId, roleId));\n          \n          if (!existing) {\n            await db.insert(rolePermissions).values({\n              roleId,\n              permissionId: permId,\n            });\n          }\n        }\n        console.log(`    ✓ Assigned all permissions to ${role.nameAr}`);\n      } else {\n        // إعطاء صلاحيات محددة\n        for (const permName of role.permissions) {\n          const permId = insertedPermissions[permName];\n          if (permId) {\n            const [existing] = await db.select().from(rolePermissions)\n              .where(eq(rolePermissions.roleId, roleId));\n            \n            if (!existing || !existing.permissionId) {\n              await db.insert(rolePermissions).values({\n                roleId,\n                permissionId: permId,\n              }).onConflictDoNothing();\n            }\n          }\n        }\n        console.log(`    ✓ Assigned ${role.permissions.length} permissions to ${role.nameAr}`);\n      }\n    }\n\n    // 4. إنشاء مستخدم إداري افتراضي (اختياري)\n    const [adminRole] = await db.select().from(roles).where(eq(roles.name, \"admin\"));\n    const [existingAdmin] = await db.select().from(adminUsers).where(eq(adminUsers.email, \"admin@sumou.com\"));\n    \n    if (!existingAdmin && adminRole) {\n      const hashedPassword = await bcrypt.hash(\"Admin@123\", 10);\n      await db.insert(adminUsers).values({\n        email: \"admin@sumou.com\",\n        password: hashedPassword,\n        fullName: \"مدير المنصة\",\n        phone: \"+966500000000\",\n        roleId: adminRole.id,\n        isActive: true,\n      });\n      console.log(\"\\n✓ Created default admin user:\");\n      console.log(\"  Email: admin@sumou.com\");\n      console.log(\"  Password: Admin@123\");\n    }\n\n    console.log(\"\\n✅ Admin system seeding completed successfully!\");\n  } catch (error) {\n    console.error(\"❌ Error seeding admin system:\", error);\n    throw error;\n  }\n}\n\n// تشغيل الـ seeding\nseedAdminSystem()\n  .then(() => process.exit(0))\n  .catch(() => process.exit(1));\n","size_bytes":11914},"client/src/components/AdminSidebar.tsx":{"content":"import { \n  LayoutDashboard, \n  Users, \n  UserCog, \n  Shield, \n  Briefcase, \n  Building2, \n  UsersRound, \n  FolderKanban, \n  ShoppingCart, \n  Wallet, \n  DollarSign, \n  BarChart3, \n  Settings, \n  Bell,\n  FileText,\n  LogOut,\n} from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarHeader,\n  SidebarFooter,\n} from \"@/components/ui/sidebar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\n\nconst menuItems = [\n  {\n    title: \"لوحة التحكم\",\n    url: \"/admin\",\n    icon: LayoutDashboard,\n  },\n  {\n    title: \"المستخدمون الإداريون\",\n    url: \"/admin/users\",\n    icon: UserCog,\n  },\n  {\n    title: \"الأدوار والصلاحيات\",\n    url: \"/admin/roles\",\n    icon: Shield,\n  },\n  {\n    title: \"الفريلانسرز\",\n    url: \"/admin/freelancers\",\n    icon: Briefcase,\n  },\n  {\n    title: \"أصحاب المنتجات\",\n    url: \"/admin/product-owners\",\n    icon: Building2,\n  },\n  {\n    title: \"الجروبات\",\n    url: \"/admin/groups\",\n    icon: UsersRound,\n  },\n  {\n    title: \"المشاريع\",\n    url: \"/admin/projects\",\n    icon: FolderKanban,\n  },\n  {\n    title: \"الطلبات\",\n    url: \"/admin/orders\",\n    icon: ShoppingCart,\n  },\n  {\n    title: \"السحوبات\",\n    url: \"/admin/withdrawals\",\n    icon: Wallet,\n  },\n  {\n    title: \"المدفوعات\",\n    url: \"/admin/payments\",\n    icon: DollarSign,\n  },\n  {\n    title: \"التقارير\",\n    url: \"/admin/reports\",\n    icon: BarChart3,\n  },\n  {\n    title: \"الإشعارات\",\n    url: \"/admin/notifications\",\n    icon: Bell,\n  },\n  {\n    title: \"السجلات\",\n    url: \"/admin/logs\",\n    icon: FileText,\n  },\n  {\n    title: \"الإعدادات\",\n    url: \"/admin/settings\",\n    icon: Settings,\n  },\n];\n\nexport function AdminSidebar() {\n  const [location, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleLogout = async () => {\n    try {\n      // Call logout endpoint to clear HttpOnly cookie\n      await fetch(\"/api/admin/logout\", {\n        method: \"POST\",\n        credentials: \"include\", // Important: include cookies\n      });\n      \n      // Clear local user data (non-sensitive)\n      localStorage.removeItem(\"adminUser\");\n      \n      toast({\n        title: \"تم تسجيل الخروج\",\n        description: \"نراك قريباً\",\n      });\n      \n      setLocation(\"/admin/login\");\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n      // Still clear local data and redirect even if API call fails\n      localStorage.removeItem(\"adminUser\");\n      setLocation(\"/admin/login\");\n    }\n  };\n\n  const user = JSON.parse(localStorage.getItem(\"adminUser\") || \"{}\");\n\n  return (\n    <Sidebar side=\"right\">\n      <SidebarHeader className=\"border-b p-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-10 h-10 bg-primary/10 rounded-xl flex items-center justify-center\">\n            <Shield className=\"w-5 h-5 text-primary\" />\n          </div>\n          <div className=\"flex-1\">\n            <h2 className=\"font-bold text-lg\">لوحة الإدارة</h2>\n            <p className=\"text-xs text-muted-foreground\">منصة سُمُوّ</p>\n          </div>\n        </div>\n      </SidebarHeader>\n\n      <SidebarContent>\n        <SidebarGroup>\n          <SidebarGroupLabel>القائمة الرئيسية</SidebarGroupLabel>\n          <SidebarGroupContent>\n            <SidebarMenu>\n              {menuItems.map((item) => (\n                <SidebarMenuItem key={item.title}>\n                  <SidebarMenuButton asChild isActive={location === item.url}>\n                    <Link href={item.url} data-testid={`link-${item.url.replace(/\\//g, '-')}`}>\n                      <item.icon className=\"ml-2\" />\n                      <span>{item.title}</span>\n                    </Link>\n                  </SidebarMenuButton>\n                </SidebarMenuItem>\n              ))}\n            </SidebarMenu>\n          </SidebarGroupContent>\n        </SidebarGroup>\n      </SidebarContent>\n\n      <SidebarFooter className=\"border-t p-4\">\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center gap-3 p-2 bg-muted/50 rounded-lg\">\n            <div className=\"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center\">\n              <Users className=\"w-5 h-5 text-primary\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"font-medium text-sm truncate\">{user.fullName}</p>\n              <p className=\"text-xs text-muted-foreground truncate\">{user.email}</p>\n            </div>\n          </div>\n          <Button \n            variant=\"outline\" \n            className=\"w-full\" \n            onClick={handleLogout}\n            data-testid=\"button-logout\"\n          >\n            <LogOut className=\"ml-2 h-4 w-4\" />\n            تسجيل الخروج\n          </Button>\n        </div>\n      </SidebarFooter>\n    </Sidebar>\n  );\n}\n","size_bytes":5100},"client/src/components/GroupChat.tsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Send, Loader2 } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Card } from '@/components/ui/card';\nimport { useToast } from '@/hooks/use-toast';\nimport { getSocket, joinGroupChat, leaveGroupChat, sendGroupMessage, startTyping, stopTyping } from '@/lib/socket';\nimport { format } from 'date-fns';\nimport { ar } from 'date-fns/locale';\n\ninterface Message {\n  id: string;\n  groupId: string;\n  senderId: string;\n  content: string;\n  type: string;\n  createdAt: Date;\n  sender?: {\n    id: string;\n    fullName: string;\n    profileImage?: string;\n  };\n}\n\ninterface GroupChatProps {\n  groupId: string;\n  currentUserId: string;\n}\n\nexport function GroupChat({ groupId, currentUserId }: GroupChatProps) {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [typingUsers, setTypingUsers] = useState<Set<string>>(new Set());\n  const [isConnected, setIsConnected] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout>();\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n\n  // Fetch initial messages\n  const { data: initialMessages, isLoading } = useQuery<Message[]>({\n    queryKey: [`/api/groups/${groupId}/messages`],\n  });\n\n  // Initialize socket and join group chat\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    setIsConnected(socket.connected);\n\n    // Join group chat room\n    joinGroupChat(groupId);\n\n    // Handle connection events\n    const handleConnect = () => {\n      setIsConnected(true);\n      joinGroupChat(groupId);\n    };\n\n    const handleDisconnect = () => {\n      setIsConnected(false);\n    };\n\n    // Handle incoming messages\n    const handleGroupMessage = (message: Message) => {\n      setMessages((prev) => [...prev, message]);\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    };\n\n    // Handle typing indicators\n    const handleTypingStart = ({ userId }: { userId: string }) => {\n      if (userId !== currentUserId) {\n        setTypingUsers((prev) => new Set(prev).add(userId));\n      }\n    };\n\n    const handleTypingStop = ({ userId }: { userId: string }) => {\n      setTypingUsers((prev) => {\n        const newSet = new Set(prev);\n        newSet.delete(userId);\n        return newSet;\n      });\n    };\n\n    // Handle errors\n    const handleError = ({ message }: { message: string }) => {\n      toast({\n        variant: 'destructive',\n        title: 'خطأ',\n        description: message,\n      });\n    };\n\n    socket.on('connect', handleConnect);\n    socket.on('disconnect', handleDisconnect);\n    socket.on('group:message', handleGroupMessage);\n    socket.on('typing:start', handleTypingStart);\n    socket.on('typing:stop', handleTypingStop);\n    socket.on('error', handleError);\n\n    // Load initial messages\n    if (initialMessages) {\n      setMessages(initialMessages);\n      setTimeout(() => messagesEndRef.current?.scrollIntoView(), 100);\n    }\n\n    return () => {\n      socket.off('connect', handleConnect);\n      socket.off('disconnect', handleDisconnect);\n      socket.off('group:message', handleGroupMessage);\n      socket.off('typing:start', handleTypingStart);\n      socket.off('typing:stop', handleTypingStop);\n      socket.off('error', handleError);\n      leaveGroupChat(groupId);\n    };\n  }, [groupId, currentUserId, initialMessages, toast]);\n\n  // Handle sending message\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !isConnected) return;\n\n    sendGroupMessage(groupId, newMessage.trim());\n    setNewMessage('');\n    stopTyping('group', groupId);\n  };\n\n  // Handle typing\n  const handleTyping = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewMessage(e.target.value);\n\n    if (!typingTimeoutRef.current) {\n      startTyping('group', groupId);\n    }\n\n    clearTimeout(typingTimeoutRef.current);\n    typingTimeoutRef.current = setTimeout(() => {\n      stopTyping('group', groupId);\n      typingTimeoutRef.current = undefined;\n    }, 1000);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-96\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"flex flex-col h-[600px]\">\n      {/* Connection status */}\n      {!isConnected && (\n        <div className=\"bg-yellow-50 border-b border-yellow-200 px-4 py-2 text-sm text-yellow-800 text-center\">\n          جارٍ الاتصال بالخادم...\n        </div>\n      )}\n\n      {/* Messages container */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {messages.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-center text-muted-foreground\">\n            <p className=\"text-lg font-medium\">لا توجد رسائل بعد</p>\n            <p className=\"text-sm\">كن أول من يبدأ المحادثة!</p>\n          </div>\n        ) : (\n          <>\n            {messages.map((message) => {\n              const isOwnMessage = message.senderId === currentUserId;\n              return (\n                <div\n                  key={message.id}\n                  className={`flex gap-3 ${isOwnMessage ? 'flex-row-reverse' : 'flex-row'}`}\n                >\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={message.sender?.profileImage} />\n                    <AvatarFallback>\n                      {message.sender?.fullName?.charAt(0) || '؟'}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className={`flex flex-col ${isOwnMessage ? 'items-end' : 'items-start'} max-w-[70%]`}>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <span className=\"text-sm font-medium\">\n                        {isOwnMessage ? 'أنت' : message.sender?.fullName}\n                      </span>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {format(new Date(message.createdAt), 'p', { locale: ar })}\n                      </span>\n                    </div>\n                    <div\n                      className={`rounded-2xl px-4 py-2 ${\n                        isOwnMessage\n                          ? 'bg-primary text-primary-foreground'\n                          : 'bg-muted'\n                      }`}\n                    >\n                      <p className=\"text-sm whitespace-pre-wrap break-words\">{message.content}</p>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n            <div ref={messagesEndRef} />\n          </>\n        )}\n        \n        {/* Typing indicator */}\n        {typingUsers.size > 0 && (\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground px-4\">\n            <div className=\"flex gap-1\">\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\n            </div>\n            <span>جارٍ الكتابة...</span>\n          </div>\n        )}\n      </div>\n\n      {/* Message input */}\n      <form onSubmit={handleSendMessage} className=\"border-t p-4\">\n        <div className=\"flex gap-2\">\n          <Input\n            value={newMessage}\n            onChange={handleTyping}\n            placeholder=\"اكتب رسالتك...\"\n            className=\"flex-1\"\n            disabled={!isConnected}\n            dir=\"rtl\"\n          />\n          <Button\n            type=\"submit\"\n            size=\"icon\"\n            disabled={!newMessage.trim() || !isConnected}\n          >\n            <Send className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </form>\n    </Card>\n  );\n}\n","size_bytes":8305},"client/src/lib/socket.ts":{"content":"import { io, Socket } from 'socket.io-client';\n\nconst SOCKET_URL = import.meta.env.VITE_API_URL || 'http://localhost:3000';\n\nlet socket: Socket | null = null;\n\nexport const initializeSocket = (token: string): Socket => {\n  if (socket?.connected) {\n    return socket;\n  }\n\n  socket = io(SOCKET_URL, {\n    auth: {\n      token\n    },\n    autoConnect: true,\n    reconnection: true,\n    reconnectionDelay: 1000,\n    reconnectionDelayMax: 5000,\n    reconnectionAttempts: 5,\n  });\n\n  socket.on('connect', () => {\n    console.log('✅ Socket connected');\n  });\n\n  socket.on('disconnect', () => {\n    console.log('❌ Socket disconnected');\n  });\n\n  socket.on('connect_error', (error) => {\n    console.error('Socket connection error:', error);\n  });\n\n  return socket;\n};\n\nexport const getSocket = (): Socket | null => {\n  return socket;\n};\n\nexport const disconnectSocket = () => {\n  if (socket) {\n    socket.disconnect();\n    socket = null;\n  }\n};\n\n// Group chat helpers\nexport const joinGroupChat = (groupId: string) => {\n  socket?.emit('join:group', groupId);\n};\n\nexport const leaveGroupChat = (groupId: string) => {\n  socket?.emit('leave:group', groupId);\n};\n\nexport const sendGroupMessage = (groupId: string, content: string) => {\n  socket?.emit('group:message', { groupId, content });\n};\n\n// Conversation helpers (product owner ↔ group leader)\nexport const joinConversation = (conversationId: string) => {\n  socket?.emit('join:conversation', conversationId);\n};\n\nexport const leaveConversation = (conversationId: string) => {\n  socket?.emit('leave:conversation', conversationId);\n};\n\nexport const sendConversationMessage = (conversationId: string, content: string) => {\n  socket?.emit('conversation:message', { conversationId, content });\n};\n\n// Direct message helpers\nexport const joinDirectChat = (roomId: string) => {\n  socket?.emit('join:direct', roomId);\n};\n\nexport const leaveDirectChat = (roomId: string) => {\n  socket?.emit('leave:direct', roomId);\n};\n\nexport const sendDirectMessage = (receiverId: string, receiverType: string, content: string, roomId: string) => {\n  socket?.emit('direct:message', { receiverId, receiverType, content, roomId });\n};\n\n// Typing indicators\nexport const startTyping = (roomType: 'group' | 'conversation', roomId: string) => {\n  socket?.emit('typing:start', { roomType, roomId });\n};\n\nexport const stopTyping = (roomType: 'group' | 'conversation', roomId: string) => {\n  socket?.emit('typing:stop', { roomType, roomId });\n};\n","size_bytes":2462},"client/src/pages/admin/Orders.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ShoppingCart, Clock, CheckCircle, DollarSign } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface Order {\n  id: string;\n  productOwnerId: string;\n  ownerName: string;\n  groupId: string;\n  groupName: string;\n  serviceType: string;\n  status: string;\n  totalAmount: number;\n  platformFee: number;\n  leaderCommission: number;\n  quantity: number;\n  createdAt: string;\n}\n\nexport default function AdminOrders() {\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/admin/orders\"],\n  });\n\n  const pendingOrders = orders.filter(o => o.status === \"pending\").length;\n  const completedOrders = orders.filter(o => o.status === \"completed\").length;\n  const totalRevenue = orders.reduce((sum, o) => sum + o.platformFee, 0);\n  const totalSales = orders.reduce((sum, o) => sum + o.totalAmount, 0);\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return (\n          <Badge variant=\"secondary\">\n            <Clock className=\"h-3 w-3 ml-1\" />\n            قيد الانتظار\n          </Badge>\n        );\n      case \"in_progress\":\n        return (\n          <Badge variant=\"default\" className=\"bg-blue-600\">\n            <Clock className=\"h-3 w-3 ml-1\" />\n            قيد التنفيذ\n          </Badge>\n        );\n      case \"completed\":\n        return (\n          <Badge variant=\"default\" className=\"bg-green-600\">\n            <CheckCircle className=\"h-3 w-3 ml-1\" />\n            مكتمل\n          </Badge>\n        );\n      default:\n        return <Badge>{status}</Badge>;\n    }\n  };\n\n  const getServiceLabel = (type: string) => {\n    const labels: Record<string, string> = {\n      google_maps_reviews: \"تقييمات خرائط جوجل\",\n      app_reviews: \"تقييمات التطبيقات\",\n      ux_testing: \"اختبار تجربة المستخدم\",\n      social_media_engagement: \"تفاعل وسائل التواصل\",\n    };\n    return labels[type] || type;\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">الطلبات المباشرة</h1>\n        <p className=\"text-muted-foreground mt-1\">إدارة ومراقبة الطلبات المباشرة من أصحاب المنتجات</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card data-testid=\"card-total-orders\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الطلبات</CardTitle>\n            <ShoppingCart className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{orders.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-pending-orders\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-count\">{pendingOrders}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-completed-orders\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-count\">{completedOrders}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-total-revenue\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">عمولة المنصة</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-revenue\">\n              {totalRevenue.toLocaleString('ar-SA')} ر.س\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              من إجمالي {totalSales.toLocaleString('ar-SA')} ر.س\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>جميع الطلبات</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">جاري التحميل...</div>\n          ) : orders.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">لا توجد طلبات</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>صاحب المنتج</TableHead>\n                    <TableHead>الجروب</TableHead>\n                    <TableHead>نوع الخدمة</TableHead>\n                    <TableHead>الكمية</TableHead>\n                    <TableHead>المبلغ الإجمالي</TableHead>\n                    <TableHead>عمولة المنصة</TableHead>\n                    <TableHead>عمولة القائد</TableHead>\n                    <TableHead>الحالة</TableHead>\n                    <TableHead>تاريخ الطلب</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {orders.map((order) => (\n                    <TableRow key={order.id} data-testid={`row-order-${order.id}`}>\n                      <TableCell className=\"font-medium\">{order.ownerName}</TableCell>\n                      <TableCell>{order.groupName}</TableCell>\n                      <TableCell>{getServiceLabel(order.serviceType)}</TableCell>\n                      <TableCell>{order.quantity}</TableCell>\n                      <TableCell>{order.totalAmount.toLocaleString('ar-SA')} ر.س</TableCell>\n                      <TableCell className=\"text-green-600 font-bold\">\n                        {order.platformFee.toLocaleString('ar-SA')} ر.س\n                      </TableCell>\n                      <TableCell>{order.leaderCommission.toLocaleString('ar-SA')} ر.س</TableCell>\n                      <TableCell>{getStatusBadge(order.status)}</TableCell>\n                      <TableCell>\n                        {formatDistanceToNow(new Date(order.createdAt), {\n                          addSuffix: true,\n                          locale: ar,\n                        })}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7396},"test-db.js":{"content":"import pkg from 'pg';\nconst { Pool } = pkg;\n\nconst pool = new Pool({\n  connectionString: 'postgres://postgres:1234@localhost:5432/smoo'\n});\n\n(async () => {\n  try {\n    const res = await pool.query('SELECT NOW()');\n    console.log('DB Connected:', res.rows[0]);\n    pool.end();\n  } catch (err) {\n    console.error('DB Connection Error:', err);\n  }\n})();\n","size_bytes":353},"client/src/pages/admin/Dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { \n  Users, \n  Building2, \n  UsersRound, \n  FolderKanban, \n  ShoppingCart, \n  ClipboardList, \n  Wallet, \n  DollarSign,\n  TrendingUp,\n  AlertCircle,\n} from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport default function AdminDashboard() {\n  const { data: stats, isLoading } = useQuery({\n    queryKey: [\"/api/admin/statistics\"],\n  });\n\n  const statCards = [\n    {\n      title: \"الفريلانسرز\",\n      value: stats?.freelancers || 0,\n      icon: Users,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-50 dark:bg-blue-950/30\",\n    },\n    {\n      title: \"أصحاب المنتجات\",\n      value: stats?.productOwners || 0,\n      icon: Building2,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-50 dark:bg-purple-950/30\",\n    },\n    {\n      title: \"الجروبات\",\n      value: stats?.groups || 0,\n      icon: UsersRound,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-950/30\",\n    },\n    {\n      title: \"المشاريع\",\n      value: stats?.projects || 0,\n      icon: FolderKanban,\n      color: \"text-orange-600\",\n      bgColor: \"bg-orange-50 dark:bg-orange-950/30\",\n    },\n    {\n      title: \"الطلبات\",\n      value: stats?.orders || 0,\n      icon: ShoppingCart,\n      color: \"text-pink-600\",\n      bgColor: \"bg-pink-50 dark:bg-pink-950/30\",\n    },\n    {\n      title: \"المهام\",\n      value: stats?.tasks || 0,\n      icon: ClipboardList,\n      color: \"text-cyan-600\",\n      bgColor: \"bg-cyan-50 dark:bg-cyan-950/30\",\n    },\n    {\n      title: \"السحوبات\",\n      value: stats?.withdrawals || 0,\n      icon: Wallet,\n      color: \"text-indigo-600\",\n      bgColor: \"bg-indigo-50 dark:bg-indigo-950/30\",\n    },\n    {\n      title: \"السحوبات المعلقة\",\n      value: stats?.pendingWithdrawals || 0,\n      icon: AlertCircle,\n      color: \"text-amber-600\",\n      bgColor: \"bg-amber-50 dark:bg-amber-950/30\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">لوحة التحكم</h1>\n        <p className=\"text-muted-foreground\">نظرة عامة على منصة سُمُوّ</p>\n      </div>\n\n      {/* Revenue Card */}\n      <Card className=\"bg-gradient-to-br from-primary/10 via-primary/5 to-transparent\">\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"text-base font-medium text-muted-foreground\">\n                إجمالي الإيرادات\n              </CardTitle>\n              <div className=\"flex items-baseline gap-2 mt-2\">\n                <span className=\"text-4xl font-bold\">\n                  ${isLoading ? \"...\" : stats?.totalRevenue.toLocaleString()}\n                </span>\n                <TrendingUp className=\"h-5 w-5 text-green-600\" />\n              </div>\n            </div>\n            <div className=\"w-16 h-16 bg-primary/20 rounded-2xl flex items-center justify-center\">\n              <DollarSign className=\"w-8 h-8 text-primary\" />\n            </div>\n          </div>\n        </CardHeader>\n      </Card>\n\n      {/* Statistics Grid */}\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {statCards.map((card) => (\n          <Card key={card.title} className=\"hover-elevate\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">\n                {card.title}\n              </CardTitle>\n              <div className={`w-10 h-10 ${card.bgColor} rounded-xl flex items-center justify-center`}>\n                <card.icon className={`h-5 w-5 ${card.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              {isLoading ? (\n                <Skeleton className=\"h-8 w-20\" />\n              ) : (\n                <div className=\"text-2xl font-bold\" data-testid={`stat-${card.title}`}>\n                  {card.value.toLocaleString()}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Quick Actions */}\n      <Card>\n        <CardHeader>\n          <CardTitle>إجراءات سريعة</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-3 md:grid-cols-2 lg:grid-cols-3\">\n            <a \n              href=\"/admin/users/create\" \n              className=\"p-4 border rounded-lg hover-elevate cursor-pointer transition-all\"\n              data-testid=\"link-create-user\"\n            >\n              <Users className=\"h-5 w-5 mb-2 text-primary\" />\n              <h3 className=\"font-semibold\">إضافة مستخدم إداري</h3>\n              <p className=\"text-sm text-muted-foreground\">إنشاء حساب جديد لفريق العمل</p>\n            </a>\n\n            <a \n              href=\"/admin/withdrawals\" \n              className=\"p-4 border rounded-lg hover-elevate cursor-pointer transition-all\"\n              data-testid=\"link-withdrawals\"\n            >\n              <Wallet className=\"h-5 w-5 mb-2 text-amber-600\" />\n              <h3 className=\"font-semibold\">مراجعة السحوبات</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                {stats?.pendingWithdrawals || 0} سحب قيد الانتظار\n              </p>\n            </a>\n\n            <a \n              href=\"/admin/reports\" \n              className=\"p-4 border rounded-lg hover-elevate cursor-pointer transition-all\"\n              data-testid=\"link-reports\"\n            >\n              <TrendingUp className=\"h-5 w-5 mb-2 text-green-600\" />\n              <h3 className=\"font-semibold\">التقارير المالية</h3>\n              <p className=\"text-sm text-muted-foreground\">عرض التحليلات والإحصائيات</p>\n            </a>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":6020},"client/src/pages/GroupLeaderDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { useParams, useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n    Users,\n    Settings,\n    UserPlus,\n    Shield,\n    Trash2,\n    Check,\n    X,\n    ArrowRight,\n    Globe,\n    Lock,\n    Copy,\n    LayoutDashboard,\n    Activity,\n    Search,\n    Briefcase,\n    MessageCircle,\n    DollarSign,\n    Clock\n} from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface GroupMember {\n    id: string;\n    groupId: string;\n    freelancerId: string;\n    role: string;\n    freelancer: {\n        id: string;\n        fullName: string;\n        username: string;\n        profileImage: string;\n        jobTitle: string;\n    };\n}\n\ninterface GroupJoinRequest {\n    id: string;\n    freelancerId: string;\n    createdAt: string;\n    message?: string;\n    freelancer: {\n        id: string;\n        fullName: string;\n        username: string;\n        profileImage: string;\n        jobTitle: string;\n    };\n}\n\nexport default function GroupLeaderDashboard() {\n    const { id: groupId } = useParams<{ id: string }>();\n    const [, navigate] = useLocation();\n    const { toast } = useToast();\n    const [activeTab, setActiveTab] = useState(\"overview\");\n\n    // Fetch group data\n    const { data: group, isLoading: groupLoading } = useQuery({\n        queryKey: [`/groups/${groupId}`],\n        queryFn: async () => {\n            const res = await fetch(`/api/groups/${groupId}`, {\n                headers: { 'Authorization': `Bearer ${localStorage.getItem(\"token\")}` }\n            });\n            if (!res.ok) throw new Error(\"Failed to fetch group\");\n            return res.json();\n        }\n    });\n\n    // Fetch members\n    const { data: members = [], isLoading: membersLoading } = useQuery<GroupMember[]>({\n        queryKey: [`/api/groups/${groupId}/members`],\n        enabled: !!groupId,\n    });\n\n    // Fetch requests\n    const { data: requests = [], isLoading: requestsLoading } = useQuery<GroupJoinRequest[]>({\n        queryKey: [`/api/groups/${groupId}/requests`],\n        enabled: !!groupId,\n        queryFn: async () => {\n            const res = await fetch(`/api/groups/${groupId}/requests`, {\n                headers: { 'Authorization': `Bearer ${localStorage.getItem(\"token\")}` }\n            });\n            if (!res.ok) return [];\n            return res.json();\n        }\n    });\n\n    // Fetch orders for the group leader\n    const { data: orders = [], isLoading: ordersLoading } = useQuery({\n        queryKey: [`/api/orders`],\n        queryFn: async () => {\n            const res = await fetch(`/api/orders`, {\n                headers: { 'Authorization': `Bearer ${localStorage.getItem(\"token\")}` }\n            });\n            if (!res.ok) return [];\n            return res.json();\n        }\n    });\n\n    // Fetch conversations\n    const { data: conversations = [], isLoading: conversationsLoading } = useQuery({\n        queryKey: [`/api/conversations`],\n        queryFn: async () => {\n            const res = await fetch(`/api/conversations`, {\n                headers: { 'Authorization': `Bearer ${localStorage.getItem(\"token\")}` }\n            });\n            if (!res.ok) return [];\n            return res.json();\n        }\n    });\n\n    // Update group mutation\n    const updateGroupMutation = useMutation({\n        mutationFn: async (data: any) => {\n            return await apiRequest(`/api/groups/${groupId}`, \"PATCH\", data);\n        },\n        onSuccess: () => {\n            queryClient.invalidateQueries({ queryKey: [`/groups/${groupId}`] });\n            toast({\n                title: \"تم التحديث\",\n                description: \"تم تحديث إعدادات المجموعة بنجاح\",\n            });\n        },\n        onError: (error: any) => {\n            toast({\n                title: \"خطأ\",\n                description: error.message || \"حدث خطأ أثناء التحديث\",\n                variant: \"destructive\",\n            });\n        }\n    });\n\n    // Handle request mutation\n    const handleRequestMutation = useMutation({\n        mutationFn: async ({ requestId, status }: { requestId: string, status: 'approved' | 'rejected' }) => {\n            return await apiRequest(`/api/groups/${groupId}/requests/${requestId}`, \"PATCH\", { status });\n        },\n        onSuccess: (_, variables) => {\n            queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/requests`] });\n            queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/members`] });\n            queryClient.invalidateQueries({ queryKey: [`/groups/${groupId}`] }); // Update member count\n            toast({\n                title: variables.status === 'approved' ? \"تم القبول\" : \"تم الرفض\",\n                description: variables.status === 'approved' ? \"تم قبول العضو بنجاح\" : \"تم رفض طلب الانضمام\",\n            });\n        },\n        onError: (error: any) => {\n            toast({\n                title: \"خطأ\",\n                description: error.message || \"حدث خطأ أثناء معالجة الطلب\",\n                variant: \"destructive\",\n            });\n        }\n    });\n\n    // Remove member mutation\n    const removeMemberMutation = useMutation({\n        mutationFn: async (freelancerId: string) => {\n            return await apiRequest(`/api/groups/${groupId}/members/${freelancerId}`, \"DELETE\");\n        },\n        onSuccess: () => {\n            queryClient.invalidateQueries({ queryKey: [`/api/groups/${groupId}/members`] });\n            queryClient.invalidateQueries({ queryKey: [`/groups/${groupId}`] }); // Update member count\n            toast({\n                title: \"تم الحذف\",\n                description: \"تم إزالة العضو من المجموعة\",\n            });\n        },\n        onError: (error: any) => {\n            toast({\n                title: \"خطأ\",\n                description: error.message || \"حدث خطأ أثناء حذف العضو\",\n                variant: \"destructive\",\n            });\n        }\n    });\n\n    const copyGroupLink = () => {\n        const url = `${window.location.origin}/groups/${groupId}`;\n        navigator.clipboard.writeText(url);\n        toast({\n            title: \"تم النسخ\",\n            description: \"تم نسخ رابط المجموعة للحافظة\",\n        });\n    };\n\n    if (groupLoading) {\n        return (\n            <div className=\"flex items-center justify-center min-h-screen\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n            </div>\n        );\n    }\n\n    if (!group) {\n        return <div>Group not found</div>;\n    }\n\n    // Check if current user is leader\n    const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n    if (group.leaderId !== currentUser.id) {\n        return (\n            <div className=\"flex flex-col items-center justify-center min-h-screen p-4\">\n                <Shield className=\"w-16 h-16 text-red-500 mb-4\" />\n                <h1 className=\"text-2xl font-bold text-gray-900\">غير مصرح</h1>\n                <p className=\"text-gray-600 mb-4\">فقط قائد المجموعة يمكنه الوصول لهذه الصفحة</p>\n                <Button onClick={() => navigate(`/groups/${groupId}`)}>\n                    العودة للمجموعة\n                </Button>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-gray-50/50\" dir=\"rtl\">\n            <div className=\"bg-white border-b border-gray-200 sticky top-0 z-30\">\n                <div className=\"container mx-auto px-4\">\n                    <div className=\"flex items-center justify-between h-16\">\n                        <div className=\"flex items-center gap-4\">\n                            <Button variant=\"ghost\" size=\"icon\" onClick={() => navigate(`/groups/${groupId}`)}>\n                                <ArrowRight className=\"w-5 h-5\" />\n                            </Button>\n                            <h1 className=\"text-xl font-bold text-gray-900\">لوحة تحكم القائد</h1>\n                            <Badge variant=\"outline\" className=\"bg-blue-50 text-blue-700 border-blue-200\">\n                                {group.name}\n                            </Badge>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"container mx-auto px-4 py-8 max-w-6xl\">\n                <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\n                    {/* Sidebar Navigation */}\n                    <div className=\"lg:col-span-3\">\n                        <Card className=\"border-0 shadow-lg bg-white/80 backdrop-blur-sm sticky top-24\">\n                            <CardContent className=\"p-4 space-y-2\">\n                                <Button\n                                    variant={activeTab === \"overview\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"overview\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"overview\")}\n                                >\n                                    <LayoutDashboard className=\"w-4 h-4\" />\n                                    نظرة عامة\n                                </Button>\n                                <Button\n                                    variant={activeTab === \"settings\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"settings\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"settings\")}\n                                >\n                                    <Settings className=\"w-4 h-4\" />\n                                    الإعدادات\n                                </Button>\n                                <Button\n                                    variant={activeTab === \"members\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"members\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"members\")}\n                                >\n                                    <Users className=\"w-4 h-4\" />\n                                    الأعضاء\n                                    <Badge variant=\"secondary\" className=\"mr-auto bg-blue-100 text-blue-700\">\n                                        {group.currentMembers}\n                                    </Badge>\n                                </Button>\n                                <Button\n                                    variant={activeTab === \"requests\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"requests\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"requests\")}\n                                >\n                                    <UserPlus className=\"w-4 h-4\" />\n                                    طلبات الانضمام\n                                    {requests.length > 0 && (\n                                        <Badge variant=\"secondary\" className=\"mr-auto bg-red-100 text-red-700 animate-pulse\">\n                                            {requests.length}\n                                        </Badge>\n                                    )}\n                                </Button>\n                                <Button\n                                    variant={activeTab === \"orders\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"orders\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"orders\")}\n                                >\n                                    <Briefcase className=\"w-4 h-4\" />\n                                    الطلبات\n                                    {orders.length > 0 && (\n                                        <Badge variant=\"secondary\" className=\"mr-auto bg-orange-100 text-orange-700\">\n                                            {orders.length}\n                                        </Badge>\n                                    )}\n                                </Button>\n                                <Button\n                                    variant={activeTab === \"conversations\" ? \"default\" : \"ghost\"}\n                                    className={`w-full justify-start gap-3 ${activeTab === \"conversations\" ? \"bg-blue-600 hover:bg-blue-700\" : \"hover:bg-blue-50\"}`}\n                                    onClick={() => setActiveTab(\"conversations\")}\n                                >\n                                    <MessageCircle className=\"w-4 h-4\" />\n                                    المحادثات\n                                    {conversations.length > 0 && (\n                                        <Badge variant=\"secondary\" className=\"mr-auto bg-green-100 text-green-700\">\n                                            {conversations.length}\n                                        </Badge>\n                                    )}\n                                </Button>\n                            </CardContent>\n                        </Card>\n                    </div>\n\n                    {/* Main Content */}\n                    <div className=\"lg:col-span-9\">\n                        <AnimatePresence mode=\"wait\">\n                            <motion.div\n                                key={activeTab}\n                                initial={{ opacity: 0, y: 20 }}\n                                animate={{ opacity: 1, y: 0 }}\n                                exit={{ opacity: 0, y: -20 }}\n                                transition={{ duration: 0.2 }}\n                            >\n                                {activeTab === \"overview\" && (\n                                    <div className=\"space-y-6\">\n                                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                                            <Card className=\"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-lg\">\n                                                <CardContent className=\"p-6\">\n                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                        <div className=\"p-3 bg-white/20 rounded-xl backdrop-blur-sm\">\n                                                            <Users className=\"w-6 h-6 text-white\" />\n                                                        </div>\n                                                        <Badge className=\"bg-white/20 hover:bg-white/30 text-white border-0\">\n                                                            {Math.round((group.currentMembers / group.maxMembers) * 100)}% ممتلئ\n                                                        </Badge>\n                                                    </div>\n                                                    <h3 className=\"text-3xl font-bold mb-1\">{group.currentMembers}</h3>\n                                                    <p className=\"text-blue-100 text-sm\">عضو نشط حالياً</p>\n                                                </CardContent>\n                                            </Card>\n\n                                            <Card className=\"bg-gradient-to-br from-purple-500 to-purple-600 text-white border-0 shadow-lg\">\n                                                <CardContent className=\"p-6\">\n                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                        <div className=\"p-3 bg-white/20 rounded-xl backdrop-blur-sm\">\n                                                            <UserPlus className=\"w-6 h-6 text-white\" />\n                                                        </div>\n                                                        {requests.length > 0 && (\n                                                            <Badge className=\"bg-red-500 hover:bg-red-600 text-white border-0 animate-pulse\">\n                                                                جديد\n                                                            </Badge>\n                                                        )}\n                                                    </div>\n                                                    <h3 className=\"text-3xl font-bold mb-1\">{requests.length}</h3>\n                                                    <p className=\"text-purple-100 text-sm\">طلب انضمام معلق</p>\n                                                </CardContent>\n                                            </Card>\n\n                                            <Card className=\"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white border-0 shadow-lg\">\n                                                <CardContent className=\"p-6\">\n                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                        <div className=\"p-3 bg-white/20 rounded-xl backdrop-blur-sm\">\n                                                            <Activity className=\"w-6 h-6 text-white\" />\n                                                        </div>\n                                                    </div>\n                                                    <h3 className=\"text-3xl font-bold mb-1\">{group.status === 'active' ? 'نشط' : 'غير نشط'}</h3>\n                                                    <p className=\"text-emerald-100 text-sm\">حالة المجموعة</p>\n                                                </CardContent>\n                                            </Card>\n                                        </div>\n\n                                        <Card>\n                                            <CardHeader>\n                                                <CardTitle>مشاركة المجموعة</CardTitle>\n                                                <CardDescription>شارك رابط مجموعتك لدعوة أعضاء جدد</CardDescription>\n                                            </CardHeader>\n                                            <CardContent>\n                                                <div className=\"flex gap-2\">\n                                                    <Input\n                                                        value={`${window.location.origin}/groups/${groupId}`}\n                                                        readOnly\n                                                        className=\"bg-gray-50\"\n                                                    />\n                                                    <Button onClick={copyGroupLink} className=\"gap-2\">\n                                                        <Copy className=\"w-4 h-4\" />\n                                                        نسخ\n                                                    </Button>\n                                                </div>\n                                            </CardContent>\n                                        </Card>\n                                    </div>\n                                )}\n\n                                {activeTab === \"settings\" && (\n                                    <Card>\n                                        <CardHeader>\n                                            <CardTitle>إعدادات المجموعة</CardTitle>\n                                            <CardDescription>تعديل المعلومات الأساسية وخصوصية المجموعة</CardDescription>\n                                        </CardHeader>\n                                        <CardContent className=\"space-y-6\">\n                                            <div className=\"space-y-2\">\n                                                <Label>اسم المجموعة</Label>\n                                                <Input\n                                                    defaultValue={group.name}\n                                                    onChange={(e) => updateGroupMutation.mutate({ name: e.target.value })}\n                                                />\n                                            </div>\n\n                                            <div className=\"space-y-2\">\n                                                <Label>الوصف</Label>\n                                                <Textarea\n                                                    defaultValue={group.description || \"\"}\n                                                    onChange={(e) => updateGroupMutation.mutate({ description: e.target.value })}\n                                                    rows={4}\n                                                />\n                                            </div>\n\n                                            <div className=\"flex items-center justify-between p-4 border rounded-xl bg-gray-50\">\n                                                <div className=\"space-y-0.5\">\n                                                    <Label className=\"text-base flex items-center gap-2\">\n                                                        {group.privacy === 'private' ? <Lock className=\"w-4 h-4\" /> : <Globe className=\"w-4 h-4\" />}\n                                                        خصوصية المجموعة\n                                                    </Label>\n                                                    <p className=\"text-sm text-gray-500\">\n                                                        {group.privacy === 'private'\n                                                            ? \"المجموعة خاصة، لا يمكن للأعضاء الانضمام إلا بموافقة\"\n                                                            : \"المجموعة عامة، يمكن لأي شخص الانضمام مباشرة\"}\n                                                    </p>\n                                                </div>\n                                                <Switch\n                                                    checked={group.privacy === 'private'}\n                                                    onCheckedChange={(checked) =>\n                                                        updateGroupMutation.mutate({ privacy: checked ? 'private' : 'public' })\n                                                    }\n                                                />\n                                            </div>\n                                        </CardContent>\n                                    </Card>\n                                )}\n\n                                {activeTab === \"members\" && (\n                                    <Card>\n                                        <CardHeader>\n                                            <CardTitle>إدارة الأعضاء</CardTitle>\n                                            <CardDescription>قائمة بجميع أعضاء المجموعة ({members.length})</CardDescription>\n                                        </CardHeader>\n                                        <CardContent>\n                                            <div className=\"space-y-4\">\n                                                <div className=\"relative\">\n                                                    <Search className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                                                    <Input placeholder=\"بحث عن عضو...\" className=\"pr-10\" />\n                                                </div>\n\n                                                <div className=\"space-y-4\">\n                                                    {members.map((member: any) => (\n                                                        <div key={member.id} className=\"flex items-center justify-between p-4 border rounded-xl hover:bg-gray-50 transition-colors\">\n                                                            <div className=\"flex items-center gap-4\">\n                                                                <Avatar>\n                                                                    <AvatarImage src={member.freelancer?.profileImage} />\n                                                                    <AvatarFallback>{member.freelancer?.fullName?.substring(0, 2)}</AvatarFallback>\n                                                                </Avatar>\n                                                                <div>\n                                                                    <h4 className=\"font-semibold text-gray-900 flex items-center gap-2\">\n                                                                        {member.freelancer?.fullName}\n                                                                        {member.role === 'leader' && (\n                                                                            <Badge variant=\"secondary\" className=\"text-xs bg-yellow-100 text-yellow-700\">\n                                                                                قائد\n                                                                            </Badge>\n                                                                        )}\n                                                                    </h4>\n                                                                    <p className=\"text-sm text-gray-500\">{member.freelancer?.jobTitle || \"عضو\"}</p>\n                                                                </div>\n                                                            </div>\n\n                                                            {member.role !== 'leader' && (\n                                                                <Button\n                                                                    variant=\"ghost\"\n                                                                    size=\"icon\"\n                                                                    className=\"text-red-500 hover:text-red-600 hover:bg-red-50\"\n                                                                    onClick={() => {\n                                                                        if (confirm(\"هل أنت متأكد من إزالة هذا العضو؟\")) {\n                                                                            removeMemberMutation.mutate(member.freelancerId);\n                                                                        }\n                                                                    }}\n                                                                >\n                                                                    <Trash2 className=\"w-4 h-4\" />\n                                                                </Button>\n                                                            )}\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            </div>\n                                        </CardContent>\n                                    </Card>\n                                )}\n\n                                {activeTab === \"requests\" && (\n                                    <Card>\n                                        <CardHeader>\n                                            <CardTitle>طلبات الانضمام</CardTitle>\n                                            <CardDescription>\n                                                {requests.length === 0\n                                                    ? \"لا توجد طلبات انضمام معلقة حالياً\"\n                                                    : `لديك ${requests.length} طلب انضمام معلق`}\n                                            </CardDescription>\n                                        </CardHeader>\n                                        <CardContent>\n                                            {requests.length === 0 ? (\n                                                <div className=\"text-center py-12\">\n                                                    <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                                        <UserPlus className=\"w-8 h-8 text-gray-400\" />\n                                                    </div>\n                                                    <p className=\"text-gray-500\">لا توجد طلبات جديدة</p>\n                                                </div>\n                                            ) : (\n                                                <div className=\"space-y-4\">\n                                                    {requests.map((request: any) => (\n                                                        <div key={request.id} className=\"flex items-center justify-between p-4 border rounded-xl bg-white shadow-sm\">\n                                                            <div className=\"flex items-center gap-4\">\n                                                                <Avatar className=\"w-12 h-12\">\n                                                                    <AvatarImage src={request.freelancer?.profileImage} />\n                                                                    <AvatarFallback>{request.freelancer?.fullName?.substring(0, 2)}</AvatarFallback>\n                                                                </Avatar>\n                                                                <div>\n                                                                    <h4 className=\"font-semibold text-gray-900\">{request.freelancer?.fullName}</h4>\n                                                                    <p className=\"text-sm text-gray-500 mb-1\">{request.freelancer?.jobTitle}</p>\n                                                                    <p className=\"text-xs text-gray-400\">\n                                                                        منذ {formatDistanceToNow(new Date(request.createdAt), { locale: ar })}\n                                                                    </p>\n                                                                    {request.message && (\n                                                                        <p className=\"text-sm bg-gray-50 p-2 rounded mt-2 text-gray-600\">\n                                                                            \"{request.message}\"\n                                                                        </p>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n\n                                                            <div className=\"flex gap-2\">\n                                                                <Button\n                                                                    size=\"sm\"\n                                                                    className=\"bg-green-600 hover:bg-green-700 text-white gap-2\"\n                                                                    onClick={() => handleRequestMutation.mutate({ requestId: request.id, status: 'approved' })}\n                                                                    disabled={handleRequestMutation.isPending}\n                                                                >\n                                                                    <Check className=\"w-4 h-4\" />\n                                                                    قبول\n                                                                </Button>\n                                                                <Button\n                                                                    size=\"sm\"\n                                                                    variant=\"outline\"\n                                                                    className=\"text-red-600 border-red-200 hover:bg-red-50 gap-2\"\n                                                                    onClick={() => handleRequestMutation.mutate({ requestId: request.id, status: 'rejected' })}\n                                                                    disabled={handleRequestMutation.isPending}\n                                                                >\n                                                                    <X className=\"w-4 h-4\" />\n                                                                    رفض\n                                                                </Button>\n                                                            </div>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            )}\n                                        </CardContent>\n                                    </Card>\n                                )}\n\n                                {activeTab === \"orders\" && (\n                                    <Card>\n                                        <CardHeader>\n                                            <CardTitle>الطلبات المستقبلة</CardTitle>\n                                            <CardDescription>\n                                                {orders.length === 0\n                                                    ? \"لا توجد طلبات من أصحاب المشاريع حالياً\"\n                                                    : `لديك ${orders.length} طلب من أصحاب المشاريع`}\n                                            </CardDescription>\n                                        </CardHeader>\n                                        <CardContent>\n                                            {orders.length === 0 ? (\n                                                <div className=\"text-center py-12\">\n                                                    <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                                        <Briefcase className=\"w-8 h-8 text-gray-400\" />\n                                                    </div>\n                                                    <p className=\"text-gray-500\">لا توجد طلبات جديدة حالياً</p>\n                                                </div>\n                                            ) : (\n                                                <div className=\"space-y-4\">\n                                                    {orders.map((order: any) => (\n                                                        <div key={order.id} className=\"p-4 border rounded-xl hover:shadow-md transition-shadow\">\n                                                            <div className=\"flex justify-between items-start mb-3\">\n                                                                <div>\n                                                                    <h4 className=\"font-semibold text-gray-900\">\n                                                                        طلب خدمة: {order.serviceType}\n                                                                    </h4>\n                                                                    <p className=\"text-sm text-gray-500\">\n                                                                        من {order.productOwner?.fullName || \"صاحب مشروع\"}\n                                                                    </p>\n                                                                </div>\n                                                                <Badge className={`\n                                                                    ${order.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : ''}\n                                                                    ${order.status === 'payment_confirmed' ? 'bg-green-100 text-green-800' : ''}\n                                                                    ${order.status === 'in_progress' ? 'bg-blue-100 text-blue-800' : ''}\n                                                                    ${order.status === 'completed' ? 'bg-gray-100 text-gray-800' : ''}\n                                                                `}>\n                                                                    {order.status === 'pending' && 'في انتظار الدفع'}\n                                                                    {order.status === 'payment_confirmed' && 'تم تأكيد الدفع'}\n                                                                    {order.status === 'in_progress' && 'قيد التنفيذ'}\n                                                                    {order.status === 'completed' && 'مكتمل'}\n                                                                </Badge>\n                                                            </div>\n                                                            <div className=\"grid grid-cols-3 gap-3 mb-3\">\n                                                                <div className=\"bg-blue-50 p-3 rounded-lg\">\n                                                                    <p className=\"text-xs text-gray-600\">الكمية المطلوبة</p>\n                                                                    <p className=\"font-semibold text-lg text-blue-600\">{order.quantity}</p>\n                                                                </div>\n                                                                <div className=\"bg-green-50 p-3 rounded-lg\">\n                                                                    <p className=\"text-xs text-gray-600\">إجمالي المبلغ</p>\n                                                                    <p className=\"font-semibold text-lg text-green-600\">${parseFloat(order.totalAmount).toFixed(2)}</p>\n                                                                </div>\n                                                                <div className=\"bg-purple-50 p-3 rounded-lg\">\n                                                                    <p className=\"text-xs text-gray-600\">عمولتك</p>\n                                                                    <p className=\"font-semibold text-lg text-purple-600\">${parseFloat(order.leaderCommission).toFixed(2)}</p>\n                                                                </div>\n                                                            </div>\n                                                            <div className=\"flex gap-2\">\n                                                                <Button size=\"sm\" variant=\"outline\" className=\"flex-1\">\n                                                                    عرض التفاصيل\n                                                                </Button>\n                                                                {order.status === 'payment_confirmed' && (\n                                                                    <Button size=\"sm\" className=\"flex-1 gap-2\">\n                                                                        <Check className=\"w-4 h-4\" />\n                                                                        تم الاستقبال\n                                                                    </Button>\n                                                                )}\n                                                            </div>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            )}\n                                        </CardContent>\n                                    </Card>\n                                )}\n\n                                {activeTab === \"conversations\" && (\n                                    <Card>\n                                        <CardHeader>\n                                            <CardTitle>المحادثات</CardTitle>\n                                            <CardDescription>\n                                                {conversations.length === 0\n                                                    ? \"لا توجد محادثات حالياً\"\n                                                    : `لديك ${conversations.length} محادثة نشطة`}\n                                            </CardDescription>\n                                        </CardHeader>\n                                        <CardContent>\n                                            {conversations.length === 0 ? (\n                                                <div className=\"text-center py-12\">\n                                                    <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n                                                        <MessageCircle className=\"w-8 h-8 text-gray-400\" />\n                                                    </div>\n                                                    <p className=\"text-gray-500\">لا توجد محادثات حالياً</p>\n                                                </div>\n                                            ) : (\n                                                <div className=\"space-y-3\">\n                                                    {conversations.map((conversation: any) => (\n                                                        <div key={conversation.id} className=\"p-4 border rounded-xl hover:bg-gray-50 cursor-pointer transition-colors\">\n                                                            <div className=\"flex items-center gap-4\">\n                                                                <Avatar>\n                                                                    <AvatarImage src={conversation.productOwner?.profileImage} />\n                                                                    <AvatarFallback>\n                                                                        {conversation.productOwner?.fullName?.substring(0, 2)}\n                                                                    </AvatarFallback>\n                                                                </Avatar>\n                                                                <div className=\"flex-1\">\n                                                                    <h4 className=\"font-semibold text-gray-900\">\n                                                                        {conversation.productOwner?.fullName}\n                                                                    </h4>\n                                                                    <p className=\"text-sm text-gray-500\">\n                                                                        {conversation.group?.name}\n                                                                    </p>\n                                                                    {conversation.lastMessageAt && (\n                                                                        <p className=\"text-xs text-gray-400 mt-1\">\n                                                                            آخر رسالة منذ{' '}\n                                                                            {formatDistanceToNow(new Date(conversation.lastMessageAt), { locale: ar })}\n                                                                        </p>\n                                                                    )}\n                                                                </div>\n                                                                <Button size=\"sm\" variant=\"outline\">\n                                                                    فتح المحادثة\n                                                                </Button>\n                                                            </div>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            )}\n                                        </CardContent>\n                                    </Card>\n                                )}\n                            </motion.div>\n                        </AnimatePresence>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","size_bytes":46306},"client/src/components/Ballpit.tsx":{"content":"import { useRef, useEffect, useState } from 'react';\nimport { Renderer, Program, Triangle, Mesh } from 'ogl';\n\nexport type RaysOrigin =\n  | 'top-center'\n  | 'top-left'\n  | 'top-right'\n  | 'right'\n  | 'left'\n  | 'bottom-center'\n  | 'bottom-right'\n  | 'bottom-left';\n\ninterface LightRaysProps {\n  raysOrigin?: RaysOrigin;\n  raysColor?: string;\n  raysSpeed?: number;\n  lightSpread?: number;\n  rayLength?: number;\n  pulsating?: boolean;\n  fadeDistance?: number;\n  saturation?: number;\n  followMouse?: boolean;\n  mouseInfluence?: number;\n  noiseAmount?: number;\n  distortion?: number;\n  className?: string;\n}\n\nconst DEFAULT_COLOR = '#ffffff';\n\nconst hexToRgb = (hex: string): [number, number, number] => {\n  const m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return m ? [parseInt(m[1], 16) / 255, parseInt(m[2], 16) / 255, parseInt(m[3], 16) / 255] : [1, 1, 1];\n};\n\nconst getAnchorAndDir = (\n  origin: RaysOrigin,\n  w: number,\n  h: number\n): { anchor: [number, number]; dir: [number, number] } => {\n  const outside = 0.2;\n  switch (origin) {\n    case 'top-left':\n      return { anchor: [0, -outside * h], dir: [0, 1] };\n    case 'top-right':\n      return { anchor: [w, -outside * h], dir: [0, 1] };\n    case 'left':\n      return { anchor: [-outside * w, 0.5 * h], dir: [1, 0] };\n    case 'right':\n      return { anchor: [(1 + outside) * w, 0.5 * h], dir: [-1, 0] };\n    case 'bottom-left':\n      return { anchor: [0, (1 + outside) * h], dir: [0, -1] };\n    case 'bottom-center':\n      return { anchor: [0.5 * w, (1 + outside) * h], dir: [0, -1] };\n    case 'bottom-right':\n      return { anchor: [w, (1 + outside) * h], dir: [0, -1] };\n    default: // \"top-center\"\n      return { anchor: [0.5 * w, -outside * h], dir: [0, 1] };\n  }\n};\n\ntype Vec2 = [number, number];\ntype Vec3 = [number, number, number];\n\ninterface Uniforms {\n  iTime: { value: number };\n  iResolution: { value: Vec2 };\n  rayPos: { value: Vec2 };\n  rayDir: { value: Vec2 };\n  raysColor: { value: Vec3 };\n  raysSpeed: { value: number };\n  lightSpread: { value: number };\n  rayLength: { value: number };\n  pulsating: { value: number };\n  fadeDistance: { value: number };\n  saturation: { value: number };\n  mousePos: { value: Vec2 };\n  mouseInfluence: { value: number };\n  noiseAmount: { value: number };\n  distortion: { value: number };\n}\n\nconst LightRays: React.FC<LightRaysProps> = ({\n  raysOrigin = 'top-center',\n  raysColor = DEFAULT_COLOR,\n  raysSpeed = 1,\n  lightSpread = 1,\n  rayLength = 2,\n  pulsating = false,\n  fadeDistance = 1.0,\n  saturation = 1.0,\n  followMouse = true,\n  mouseInfluence = 0.1,\n  noiseAmount = 0.0,\n  distortion = 0.0,\n  className = ''\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const uniformsRef = useRef<Uniforms | null>(null);\n  const rendererRef = useRef<Renderer | null>(null);\n  const mouseRef = useRef({ x: 0.5, y: 0.5 });\n  const smoothMouseRef = useRef({ x: 0.5, y: 0.5 });\n  const animationIdRef = useRef<number | null>(null);\n  const meshRef = useRef<Mesh | null>(null);\n  const cleanupFunctionRef = useRef<(() => void) | null>(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    observerRef.current = new IntersectionObserver(\n      entries => {\n        const entry = entries[0];\n        setIsVisible(entry.isIntersecting);\n      },\n      { threshold: 0.1 }\n    );\n\n    observerRef.current.observe(containerRef.current);\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n        observerRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!isVisible || !containerRef.current) return;\n\n    if (cleanupFunctionRef.current) {\n      cleanupFunctionRef.current();\n      cleanupFunctionRef.current = null;\n    }\n\n    const initializeWebGL = async () => {\n      try {\n        const container = containerRef.current;\n        if (!container) return;\n\n        await new Promise(resolve => setTimeout(resolve, 10));\n\n        if (!containerRef.current) return;\n\n        const renderer = new Renderer({\n          dpr: Math.min(window.devicePixelRatio, 2),\n          alpha: true\n        });\n        rendererRef.current = renderer;\n\n      const gl = renderer.gl;\n      gl.canvas.style.width = '100%';\n      gl.canvas.style.height = '100%';\n\n      const currentContainer = containerRef.current;\n      if (!currentContainer) {\n        renderer.gl.getExtension('WEBGL_lose_context')?.loseContext();\n        return;\n      }\n\n      while (currentContainer.firstChild) {\n        currentContainer.removeChild(currentContainer.firstChild);\n      }\n      currentContainer.appendChild(gl.canvas);\n\n      const vert = `\nattribute vec2 position;\nvarying vec2 vUv;\nvoid main() {\n  vUv = position * 0.5 + 0.5;\n  gl_Position = vec4(position, 0.0, 1.0);\n}`;\n\n      const frag = `precision highp float;\n\nuniform float iTime;\nuniform vec2  iResolution;\n\nuniform vec2  rayPos;\nuniform vec2  rayDir;\nuniform vec3  raysColor;\nuniform float raysSpeed;\nuniform float lightSpread;\nuniform float rayLength;\nuniform float pulsating;\nuniform float fadeDistance;\nuniform float saturation;\nuniform vec2  mousePos;\nuniform float mouseInfluence;\nuniform float noiseAmount;\nuniform float distortion;\n\nvarying vec2 vUv;\n\nfloat noise(vec2 st) {\n  return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);\n}\n\nfloat rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord,\n                  float seedA, float seedB, float speed) {\n  vec2 sourceToCoord = coord - raySource;\n  vec2 dirNorm = normalize(sourceToCoord);\n  float cosAngle = dot(dirNorm, rayRefDirection);\n\n  float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2;\n  \n  float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001));\n\n  float distance = length(sourceToCoord);\n  float maxDistance = iResolution.x * rayLength;\n  float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);\n  \n  float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);\n  float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;\n\n  float baseStrength = clamp(\n    (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +\n    (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),\n    0.0, 1.0\n  );\n\n  return baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);\n  \n  vec2 finalRayDir = rayDir;\n  if (mouseInfluence > 0.0) {\n    vec2 mouseScreenPos = mousePos * iResolution.xy;\n    vec2 mouseDirection = normalize(mouseScreenPos - rayPos);\n    finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));\n  }\n\n  vec4 rays1 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349,\n                           1.5 * raysSpeed);\n  vec4 rays2 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234,\n                           1.1 * raysSpeed);\n\n  fragColor = rays1 * 0.5 + rays2 * 0.4;\n\n  if (noiseAmount > 0.0) {\n    float n = noise(coord * 0.01 + iTime * 0.1);\n    fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);\n  }\n\n  float brightness = 1.0 - (coord.y / iResolution.y);\n  fragColor.x *= 0.1 + brightness * 0.8;\n  fragColor.y *= 0.3 + brightness * 0.6;\n  fragColor.z *= 0.5 + brightness * 0.5;\n\n  if (saturation != 1.0) {\n    float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));\n    fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);\n  }\n\n  fragColor.rgb *= raysColor;\n}\n\nvoid main() {\n  vec4 color;\n  mainImage(color, gl_FragCoord.xy);\n  gl_FragColor  = color;\n}`;\n\n      const uniforms: Uniforms = {\n        iTime: { value: 0 },\n        iResolution: { value: [1, 1] },\n\n        rayPos: { value: [0, 0] },\n        rayDir: { value: [0, 1] },\n\n        raysColor: { value: hexToRgb(raysColor) },\n        raysSpeed: { value: raysSpeed },\n        lightSpread: { value: lightSpread },\n        rayLength: { value: rayLength },\n        pulsating: { value: pulsating ? 1.0 : 0.0 },\n        fadeDistance: { value: fadeDistance },\n        saturation: { value: saturation },\n        mousePos: { value: [0.5, 0.5] },\n        mouseInfluence: { value: mouseInfluence },\n        noiseAmount: { value: noiseAmount },\n        distortion: { value: distortion }\n      };\n      uniformsRef.current = uniforms;\n\n      const geometry = new Triangle(gl);\n      const program = new Program(gl, {\n        vertex: vert,\n        fragment: frag,\n        uniforms\n      });\n      const mesh = new Mesh(gl, { geometry, program });\n      meshRef.current = mesh;\n\n      const updatePlacement = () => {\n        if (!containerRef.current || !renderer) return;\n\n        renderer.dpr = Math.min(window.devicePixelRatio, 2);\n\n        const { clientWidth: wCSS, clientHeight: hCSS } = containerRef.current;\n        renderer.setSize(wCSS, hCSS);\n\n        const dpr = renderer.dpr;\n        const w = wCSS * dpr;\n        const h = hCSS * dpr;\n\n        uniforms.iResolution.value = [w, h];\n\n        const { anchor, dir } = getAnchorAndDir(raysOrigin, w, h);\n        uniforms.rayPos.value = anchor;\n        uniforms.rayDir.value = dir;\n      };\n\n      const loop = (t: number) => {\n        if (!rendererRef.current || !uniformsRef.current || !meshRef.current) {\n          return;\n        }\n\n        uniforms.iTime.value = t * 0.001;\n\n        if (followMouse && mouseInfluence > 0.0) {\n          const smoothing = 0.92;\n\n          smoothMouseRef.current.x = smoothMouseRef.current.x * smoothing + mouseRef.current.x * (1 - smoothing);\n          smoothMouseRef.current.y = smoothMouseRef.current.y * smoothing + mouseRef.current.y * (1 - smoothing);\n\n          uniforms.mousePos.value = [smoothMouseRef.current.x, smoothMouseRef.current.y];\n        }\n\n        try {\n          renderer.render({ scene: mesh });\n          animationIdRef.current = requestAnimationFrame(loop);\n        } catch (error) {\n          console.warn('WebGL rendering error:', error);\n          return;\n        }\n      };\n\n      window.addEventListener('resize', updatePlacement);\n      updatePlacement();\n      animationIdRef.current = requestAnimationFrame(loop);\n\n      cleanupFunctionRef.current = () => {\n        if (animationIdRef.current) {\n          cancelAnimationFrame(animationIdRef.current);\n          animationIdRef.current = null;\n        }\n\n        window.removeEventListener('resize', updatePlacement);\n\n        if (renderer) {\n          try {\n            const canvas = renderer.gl.canvas;\n            const loseContextExt = renderer.gl.getExtension('WEBGL_lose_context');\n            if (loseContextExt) {\n              loseContextExt.loseContext();\n            }\n\n            if (canvas && canvas.parentNode) {\n              canvas.parentNode.removeChild(canvas);\n            }\n          } catch (error) {\n            console.warn('Error during WebGL cleanup:', error);\n          }\n        }\n\n        rendererRef.current = null;\n        uniformsRef.current = null;\n        meshRef.current = null;\n      };\n      } catch (error) {\n        console.warn('WebGL initialization error:', error);\n      }\n    };\n\n    initializeWebGL();\n\n    return () => {\n      if (cleanupFunctionRef.current) {\n        cleanupFunctionRef.current();\n        cleanupFunctionRef.current = null;\n      }\n    };\n  }, [\n    isVisible,\n    raysOrigin,\n    raysColor,\n    raysSpeed,\n    lightSpread,\n    rayLength,\n    pulsating,\n    fadeDistance,\n    saturation,\n    followMouse,\n    mouseInfluence,\n    noiseAmount,\n    distortion\n  ]);\n\n  useEffect(() => {\n    if (!uniformsRef.current || !containerRef.current || !rendererRef.current) return;\n\n    const u = uniformsRef.current;\n    const renderer = rendererRef.current;\n\n    u.raysColor.value = hexToRgb(raysColor);\n    u.raysSpeed.value = raysSpeed;\n    u.lightSpread.value = lightSpread;\n    u.rayLength.value = rayLength;\n    u.pulsating.value = pulsating ? 1.0 : 0.0;\n    u.fadeDistance.value = fadeDistance;\n    u.saturation.value = saturation;\n    u.mouseInfluence.value = mouseInfluence;\n    u.noiseAmount.value = noiseAmount;\n    u.distortion.value = distortion;\n\n    const { clientWidth: wCSS, clientHeight: hCSS } = containerRef.current;\n    const dpr = renderer.dpr;\n    const { anchor, dir } = getAnchorAndDir(raysOrigin, wCSS * dpr, hCSS * dpr);\n    u.rayPos.value = anchor;\n    u.rayDir.value = dir;\n  }, [\n    raysColor,\n    raysSpeed,\n    lightSpread,\n    raysOrigin,\n    rayLength,\n    pulsating,\n    fadeDistance,\n    saturation,\n    mouseInfluence,\n    noiseAmount,\n    distortion\n  ]);\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!containerRef.current || !rendererRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / rect.width;\n      const y = (e.clientY - rect.top) / rect.height;\n      mouseRef.current = { x, y };\n    };\n\n    if (followMouse) {\n      window.addEventListener('mousemove', handleMouseMove);\n      return () => window.removeEventListener('mousemove', handleMouseMove);\n    }\n  }, [followMouse]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={`w-full h-full pointer-events-none z-[3] overflow-hidden relative ${className}`.trim()}\n    />\n  );\n};\n\nexport default LightRays;\n","size_bytes":13454},"client/src/pages/admin/ProductOwners.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Building2, ShoppingCart, Folder, CheckCircle, XCircle, DollarSign } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface ProductOwner {\n  id: string;\n  userId: string;\n  fullName: string;\n  email: string;\n  companyName: string | null;\n  country: string;\n  totalSpent: number;\n  projectsCreated: number;\n  ordersPlaced: number;\n  isActive: boolean;\n  createdAt: string;\n}\n\nexport default function AdminProductOwners() {\n  const { toast } = useToast();\n\n  const { data: productOwners = [], isLoading } = useQuery<ProductOwner[]>({\n    queryKey: [\"/api/admin/product-owners\"],\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest(`/api/admin/product-owners/${id}/toggle-status`,\"PATCH\", {});\n      return res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/product-owners\"] });\n      toast({\n        title: \"تم التحديث بنجاح\",\n        description: data.message,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeOwners = productOwners.filter(po => po.isActive).length;\n  const totalSpent = productOwners.reduce((sum, po) => sum + po.totalSpent, 0);\n  const totalProjects = productOwners.reduce((sum, po) => sum + po.projectsCreated, 0);\n  const totalOrders = productOwners.reduce((sum, po) => sum + po.ordersPlaced, 0);\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">أصحاب المنتجات</h1>\n        <p className=\"text-muted-foreground mt-1\">إدارة ومراقبة أصحاب المنتجات المسجلين في المنصة</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card data-testid=\"card-total-owners\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الأصحاب</CardTitle>\n            <Building2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{productOwners.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-active-owners\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">النشطون</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-count\">{activeOwners}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {productOwners.length > 0 ? Math.round((activeOwners / productOwners.length) * 100) : 0}% من الإجمالي\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-total-spent\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الإنفاق</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-spent\">\n              {totalSpent.toLocaleString('ar-SA')} ر.س\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-projects-orders\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المشاريع والطلبات</CardTitle>\n            <Folder className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"text-lg font-bold\">{totalProjects}</div>\n              <span className=\"text-xs text-muted-foreground\">مشروع</span>\n            </div>\n            <div className=\"flex items-center gap-2 mt-1\">\n              <div className=\"text-lg font-bold\">{totalOrders}</div>\n              <span className=\"text-xs text-muted-foreground\">طلب</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>قائمة أصحاب المنتجات</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">جاري التحميل...</div>\n          ) : productOwners.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">لا يوجد أصحاب منتجات مسجلين</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>الاسم</TableHead>\n                    <TableHead>البريد الإلكتروني</TableHead>\n                    <TableHead>اسم الشركة</TableHead>\n                    <TableHead>الدولة</TableHead>\n                    <TableHead>المشاريع</TableHead>\n                    <TableHead>الطلبات</TableHead>\n                    <TableHead>إجمالي الإنفاق</TableHead>\n                    <TableHead>الحالة</TableHead>\n                    <TableHead>تاريخ التسجيل</TableHead>\n                    <TableHead>الإجراءات</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {productOwners.map((owner) => (\n                    <TableRow key={owner.id} data-testid={`row-owner-${owner.id}`}>\n                      <TableCell className=\"font-medium\">{owner.fullName}</TableCell>\n                      <TableCell>{owner.email}</TableCell>\n                      <TableCell>{owner.companyName || \"-\"}</TableCell>\n                      <TableCell>{owner.country}</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <Folder className=\"h-4 w-4 text-muted-foreground\" />\n                          <span>{owner.projectsCreated}</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <ShoppingCart className=\"h-4 w-4 text-muted-foreground\" />\n                          <span>{owner.ordersPlaced}</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>{owner.totalSpent.toLocaleString('ar-SA')} ر.س</TableCell>\n                      <TableCell>\n                        {owner.isActive ? (\n                          <Badge variant=\"default\" className=\"bg-green-600\">\n                            <CheckCircle className=\"h-3 w-3 ml-1\" />\n                            نشط\n                          </Badge>\n                        ) : (\n                          <Badge variant=\"secondary\">\n                            <XCircle className=\"h-3 w-3 ml-1\" />\n                            غير نشط\n                          </Badge>\n                        )}\n                      </TableCell>\n                      <TableCell>\n                        {formatDistanceToNow(new Date(owner.createdAt), {\n                          addSuffix: true,\n                          locale: ar,\n                        })}\n                      </TableCell>\n                      <TableCell>\n                        <Button\n                          size=\"sm\"\n                          variant={owner.isActive ? \"destructive\" : \"default\"}\n                          onClick={() => toggleStatusMutation.mutate(owner.id)}\n                          disabled={toggleStatusMutation.isPending}\n                          data-testid={`button-toggle-${owner.id}`}\n                        >\n                          {owner.isActive ? \"إيقاف\" : \"تفعيل\"}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":9013},"client/src/pages/admin/Groups.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Users, Star, FolderCheck, CheckCircle, XCircle } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface Group {\n  id: string;\n  name: string;\n  description: string;\n  leaderId: string;\n  leaderName: string;\n  memberCount: number;\n  maxMembers: number;\n  country: string;\n  projectsCompleted: number;\n  rating: number;\n  isActive: boolean;\n  createdAt: string;\n}\n\nexport default function AdminGroups() {\n  const { toast } = useToast();\n\n  const { data: groups = [], isLoading } = useQuery<Group[]>({\n    queryKey: [\"/api/admin/groups\"],\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest( `/api/admin/groups/${id}/toggle-status`,\"PATCH\", {});\n      return res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/groups\"] });\n      toast({\n        title: \"تم التحديث بنجاح\",\n        description: data.message,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeGroups = groups.filter(g => g.isActive).length;\n  const totalMembers = groups.reduce((sum, g) => sum + g.memberCount, 0);\n  const averageRating = groups.length > 0\n    ? groups.reduce((sum, g) => sum + g.rating, 0) / groups.length\n    : 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">الجروبات</h1>\n        <p className=\"text-muted-foreground mt-1\">إدارة ومراقبة الجروبات في المنصة</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card data-testid=\"card-total-groups\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الجروبات</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{groups.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-active-groups\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">النشطة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-count\">{activeGroups}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-total-members\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الأعضاء</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-members-count\">{totalMembers}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-average-rating\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">متوسط التقييم</CardTitle>\n            <Star className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-rating\">\n              {averageRating.toFixed(1)} ⭐\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>قائمة الجروبات</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">جاري التحميل...</div>\n          ) : groups.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">لا توجد جروبات</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>الاسم</TableHead>\n                    <TableHead>القائد</TableHead>\n                    <TableHead>الدولة</TableHead>\n                    <TableHead>الأعضاء</TableHead>\n                    <TableHead>المشاريع المكتملة</TableHead>\n                    <TableHead>التقييم</TableHead>\n                    <TableHead>الحالة</TableHead>\n                    <TableHead>تاريخ الإنشاء</TableHead>\n                    <TableHead>الإجراءات</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {groups.map((group) => (\n                    <TableRow key={group.id} data-testid={`row-group-${group.id}`}>\n                      <TableCell className=\"font-medium\">{group.name}</TableCell>\n                      <TableCell>{group.leaderName}</TableCell>\n                      <TableCell>{group.country}</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <Users className=\"h-4 w-4 text-muted-foreground\" />\n                          <span>{group.memberCount} / {group.maxMembers}</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <FolderCheck className=\"h-4 w-4 text-green-600\" />\n                          <span>{group.projectsCompleted}</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <span>{group.rating.toFixed(1)}</span>\n                          <span className=\"text-yellow-500\">⭐</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        {group.isActive ? (\n                          <Badge variant=\"default\" className=\"bg-green-600\">\n                            <CheckCircle className=\"h-3 w-3 ml-1\" />\n                            نشط\n                          </Badge>\n                        ) : (\n                          <Badge variant=\"secondary\">\n                            <XCircle className=\"h-3 w-3 ml-1\" />\n                            غير نشط\n                          </Badge>\n                        )}\n                      </TableCell>\n                      <TableCell>\n                        {formatDistanceToNow(new Date(group.createdAt), {\n                          addSuffix: true,\n                          locale: ar,\n                        })}\n                      </TableCell>\n                      <TableCell>\n                        <Button\n                          size=\"sm\"\n                          variant={group.isActive ? \"destructive\" : \"default\"}\n                          onClick={() => toggleStatusMutation.mutate(group.id)}\n                          disabled={toggleStatusMutation.isPending}\n                          data-testid={`button-toggle-${group.id}`}\n                        >\n                          {group.isActive ? \"إيقاف\" : \"تفعيل\"}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":8284},"client/src/pages/DirectChat.tsx":{"content":"import { useParams, useLocation } from \"wouter\";\nimport { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowRight } from \"lucide-react\";\nimport { DirectMessageChat } from \"@/components/DirectMessageChat\";\n\nexport default function DirectChat() {\n  const { userId } = useParams<{ userId: string }>();\n  const [, navigate] = useLocation();\n  const [conversationId, setConversationId] = useState<string | null>(null);\n\n  // Get current user\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n\n  const userType = localStorage.getItem(\"userType\");\n\n  // Determine the other user's type - assume freelancer by default\n  const otherUserType = \"freelancer\";\n\n  // Fetch receiver info\n  const { data: receiverInfo } = useQuery({\n    queryKey: [`/api/freelancers/${userId}`],\n    queryFn: async () => {\n      const response = await fetch(`/api/freelancers/${userId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n      });\n      \n      if (!response.ok) {\n        return null;\n      }\n      \n      return response.json();\n    },\n    enabled: !!userId,\n  });\n\n  // Set a room ID for socket communication\n  useEffect(() => {\n    if (userId) {\n      // Create a unique room ID by sorting user IDs\n      const roomId = [currentUser?.id, userId].sort().join('-');\n      setConversationId(roomId);\n    }\n  }, [userId, currentUser?.id]);\n\n  if (!currentUser) {\n    navigate(\"/login\");\n    return null;\n  }\n\n  if (!conversationId) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50\">\n      <div className=\"container mx-auto px-4 py-6 h-screen flex flex-col\">\n        {/* Header */}\n        <div className=\"mb-4 flex items-center gap-4\">\n          <Button \n            variant=\"ghost\" \n            size=\"icon\" \n            onClick={() => navigate(\"/freelancers\")}\n            className=\"rounded-full hover:bg-white/50\"\n          >\n            <ArrowRight className=\"h-5 w-5\" />\n          </Button>\n        </div>\n\n        {/* Chat Component - Full Height */}\n        <div className=\"flex-1 overflow-hidden\">\n          <DirectMessageChat \n            roomId={conversationId} \n            receiverId={userId!}\n            receiverType={otherUserType}\n            receiverInfo={receiverInfo}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2515},"client/src/pages/AdminLogin.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Shield, Mail, Lock, Loader2 } from \"lucide-react\";\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    email: \"\",\n    password: \"\",\n  });\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      const response = await fetch(\"/api/admin/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(formData),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.error || \"فشل تسجيل الدخول\");\n      }\n\n      // No need to store token - it's now in HttpOnly cookie\n      // Only store non-sensitive user data for UI purposes\n      localStorage.setItem(\"adminUser\", JSON.stringify(data.user));\n\n      toast({\n        title: \"تم تسجيل الدخول بنجاح\",\n        description: `مرحباً ${data.user.fullName}`,\n      });\n\n      // Redirect to admin dashboard\n      setLocation(\"/admin\");\n    } catch (error: any) {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-3 text-center\">\n          <div className=\"mx-auto w-16 h-16 bg-primary/10 rounded-2xl flex items-center justify-center\">\n            <Shield className=\"w-8 h-8 text-primary\" />\n          </div>\n          <CardTitle className=\"text-2xl font-bold\">لوحة تحكم المسؤولين</CardTitle>\n          <CardDescription>\n            قم بتسجيل الدخول للوصول إلى لوحة التحكم\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleLogin} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">البريد الإلكتروني</Label>\n              <div className=\"relative\">\n                <Mail className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  placeholder=\"admin@sumou.com\"\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  className=\"pr-10\"\n                  required\n                  data-testid=\"input-email\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">كلمة المرور</Label>\n              <div className=\"relative\">\n                <Lock className=\"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder=\"••••••••\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  className=\"pr-10\"\n                  required\n                  data-testid=\"input-password\"\n                />\n              </div>\n            </div>\n\n            <Button \n              type=\"submit\" \n              className=\"w-full\" \n              disabled={loading}\n              data-testid=\"button-login\"\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />\n                  جاري تسجيل الدخول...\n                </>\n              ) : (\n                \"تسجيل الدخول\"\n              )}\n            </Button>\n          </form>\n\n          <div className=\"mt-6 p-4 bg-blue-50 dark:bg-blue-950/30 rounded-lg text-sm\">\n            <p className=\"text-muted-foreground text-center\">\n              الحساب الافتراضي: <span className=\"font-mono\">admin@sumou.com</span>\n              <br />\n              كلمة المرور: <span className=\"font-mono\">Admin@123</span>\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":4853},"api/index.js":{"content":"import app from '../dist/index.js';\n\nexport default app;","size_bytes":56},"client/src/pages/freelancer-dashboard/Groups.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription, CardFooter } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Users, Settings, Plus, Shield } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function FreelancerGroups() {\n    const { data: groups = [], isLoading } = useQuery({\n        queryKey: [\"/api/groups\"],\n        queryFn: async () => {\n            const res = await fetch(\"/api/groups\");\n            if (!res.ok) throw new Error(\"Failed to fetch groups\");\n            return res.json();\n        }\n    });\n\n    const currentUser = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n    const myGroups = groups.filter((g: any) => g.leaderId === currentUser.id);\n\n    if (isLoading) {\n        return (\n            <div className=\"flex items-center justify-center min-h-[400px]\">\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-6\" dir=\"rtl\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-gray-900\">مجموعاتي</h1>\n                    <p className=\"text-gray-500 mt-1\">إدارة المجموعات التي تقودها</p>\n                </div>\n                <Link href=\"/groups\">\n                    <Button className=\"gap-2\">\n                        <Plus className=\"w-4 h-4\" />\n                        إنشاء مجموعة جديدة\n                    </Button>\n                </Link>\n            </div>\n\n            {myGroups.length === 0 ? (\n                <div className=\"text-center py-16 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200\">\n                    <div className=\"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-sm\">\n                        <Shield className=\"w-8 h-8 text-gray-400\" />\n                    </div>\n                    <h3 className=\"text-lg font-bold text-gray-900 mb-2\">لا توجد مجموعات بعد</h3>\n                    <p className=\"text-gray-500 mb-6 max-w-md mx-auto\">\n                        لم تقم بإنشاء أي مجموعة حتى الآن. قم بإنشاء مجموعتك الخاصة وابدأ في بناء مجتمعك.\n                    </p>\n                    <Link href=\"/groups\">\n                        <Button variant=\"outline\" className=\"gap-2\">\n                            <Users className=\"w-4 h-4\" />\n                            تصفح المجموعات\n                        </Button>\n                    </Link>\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                    {myGroups.map((group: any) => (\n                        <Card key={group.id} className=\"hover:shadow-lg transition-all duration-300 group border-gray-200\">\n                            <CardHeader>\n                                <div className=\"flex justify-between items-start mb-2\">\n                                    <Badge\n                                        variant={group.privacy === 'private' ? \"secondary\" : \"default\"}\n                                        className={group.privacy === 'private' ? \"bg-gray-100 text-gray-700\" : \"bg-blue-100 text-blue-700 hover:bg-blue-200\"}\n                                    >\n                                        {group.privacy === 'private' ? 'مجموعة خاصة' : 'مجموعة عامة'}\n                                    </Badge>\n                                    {group.status === 'active' && (\n                                        <span className=\"flex h-2 w-2 rounded-full bg-green-500 ring-2 ring-green-100\"></span>\n                                    )}\n                                </div>\n                                <CardTitle className=\"text-xl font-bold line-clamp-1\">{group.name}</CardTitle>\n                                <CardDescription className=\"line-clamp-2 h-10\">\n                                    {group.description || \"لا يوجد وصف للمجموعة\"}\n                                </CardDescription>\n                            </CardHeader>\n                            <CardContent>\n                                <div className=\"flex items-center gap-4 text-sm text-gray-500 bg-gray-50 p-3 rounded-lg\">\n                                    <div className=\"flex items-center gap-2\">\n                                        <Users className=\"w-4 h-4 text-blue-500\" />\n                                        <span className=\"font-medium\">{group.currentMembers}</span>\n                                        <span>عضو</span>\n                                    </div>\n                                    <div className=\"w-px h-4 bg-gray-300\"></div>\n                                    <div className=\"flex items-center gap-2\">\n                                        <Shield className=\"w-4 h-4 text-purple-500\" />\n                                        <span>قائد</span>\n                                    </div>\n                                </div>\n                            </CardContent>\n                            <CardFooter>\n                                <Link href={`/groups/${group.id}/dashboard`} className=\"w-full\">\n                                    <Button className=\"w-full gap-2 bg-white text-gray-900 border border-gray-200 hover:bg-gray-50 hover:text-primary hover:border-primary/20 shadow-sm\">\n                                        <Settings className=\"w-4 h-4\" />\n                                        إدارة المجموعة\n                                    </Button>\n                                </Link>\n                            </CardFooter>\n                        </Card>\n                    ))}\n                </div>\n            )}\n        </div>\n    );\n}\n","size_bytes":6047},"client/src/components/DirectMessageChat.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Send, Loader2, Phone, Video, MoreVertical } from \"lucide-react\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { getSocket } from \"@/lib/socket\";\n\ninterface DirectMessageChatProps {\n  roomId: string;\n  receiverId: string;\n  receiverType: string;\n  receiverInfo?: {\n    fullName: string;\n    profileImage?: string;\n  };\n}\n\nexport function DirectMessageChat({ roomId, receiverId, receiverType, receiverInfo }: DirectMessageChatProps) {\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState<any[]>([]);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const socket = getSocket();\n\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n  const currentUserType = localStorage.getItem(\"userType\");\n\n  // Fetch initial messages\n  const { data: initialMessages, isLoading } = useQuery({\n    queryKey: [`/api/direct-messages/${receiverId}`],\n    queryFn: async () => {\n      const response = await fetch(\n        `/api/direct-messages/${receiverId}?userType=${receiverType}`,\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n          },\n        }\n      );\n\n      if (!response.ok) {\n        return [];\n      }\n\n      return response.json();\n    },\n  });\n\n  useEffect(() => {\n    if (initialMessages) {\n      setMessages(initialMessages);\n    }\n  }, [initialMessages]);\n\n  // Socket.IO listeners\n  useEffect(() => {\n    if (!socket || !roomId) return;\n\n    // Join direct chat room\n    socket.emit(\"join:direct\", roomId);\n\n    // Listen for new messages\n    const handleNewMessage = (newMessage: any) => {\n      // Prevent duplicate messages by checking if message already exists\n      setMessages((prev) => {\n        const exists = prev.some(m => \n          m.id === newMessage.id || \n          (m.content === newMessage.content && \n           m.senderId === newMessage.senderId && \n           Math.abs(new Date(m.createdAt).getTime() - new Date(newMessage.createdAt).getTime()) < 1000)\n        );\n        if (exists) return prev;\n        return [...prev, newMessage];\n      });\n      messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    };\n\n    socket.on(\"direct:message\", handleNewMessage);\n\n    return () => {\n      socket.off(\"direct:message\", handleNewMessage);\n      socket.emit(\"leave:direct\", roomId);\n    };\n  }, [socket, roomId]);\n\n  // Auto-scroll to bottom\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (content: string) => {\n      const response = await fetch(\"/api/direct-messages\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n        },\n        body: JSON.stringify({\n          receiverId,\n          receiverType,\n          content,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to send message\");\n      }\n\n      return response.json();\n    },\n    onSuccess: (data) => {\n      // Don't emit socket, the server will broadcast it\n      setMessage(\"\");\n      // Invalidate query to refresh\n      queryClient.invalidateQueries({ queryKey: [`/api/direct-messages/${receiverId}`] });\n    },\n  });\n\n  const handleSend = () => {\n    if (!message.trim() || sendMessageMutation.isPending) return;\n    sendMessageMutation.mutate(message.trim());\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-full p-8\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex flex-col h-full bg-white rounded-2xl shadow-xl overflow-hidden\">\n      {/* Chat Header */}\n      <div className=\"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4 flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Avatar className=\"h-12 w-12 border-2 border-white shadow-lg\">\n            <AvatarImage src={receiverInfo?.profileImage} />\n            <AvatarFallback className=\"bg-white text-blue-600 font-bold\">\n              {receiverInfo?.fullName?.substring(0, 2) || \"U\"}\n            </AvatarFallback>\n          </Avatar>\n          <div>\n            <h2 className=\"text-white font-bold text-lg\">\n              {receiverInfo?.fullName || \"مستخدم\"}\n            </h2>\n            <p className=\"text-blue-100 text-sm\">متصل الآن</p>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Button variant=\"ghost\" size=\"icon\" className=\"text-white hover:bg-white/20\">\n            <Phone className=\"h-5 w-5\" />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\" className=\"text-white hover:bg-white/20\">\n            <Video className=\"h-5 w-5\" />\n          </Button>\n          <Button variant=\"ghost\" size=\"icon\" className=\"text-white hover:bg-white/20\">\n            <MoreVertical className=\"h-5 w-5\" />\n          </Button>\n        </div>\n      </div>\n\n      {/* Messages Area */}\n      <div className=\"flex-1 overflow-y-auto p-6 bg-gradient-to-b from-gray-50 to-white space-y-4\">\n        {messages.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-center\">\n            <div className=\"bg-gray-100 rounded-full p-6 mb-4\">\n              <Send className=\"h-12 w-12 text-gray-400\" />\n            </div>\n            <p className=\"text-gray-500 text-lg font-semibold\">لا توجد رسائل بعد</p>\n            <p className=\"text-gray-400 text-sm mt-2\">ابدأ المحادثة بإرسال رسالة</p>\n          </div>\n        ) : (\n          messages.map((msg, index) => {\n            const isSender = msg.senderId === currentUser?.id;\n            const showAvatar = index === 0 || messages[index - 1]?.senderId !== msg.senderId;\n            \n            return (\n              <div\n                key={msg.id || index}\n                className={`flex gap-3 items-end ${isSender ? \"flex-row-reverse\" : \"flex-row\"}`}\n              >\n                {/* Avatar */}\n                {showAvatar ? (\n                  <Avatar className=\"h-10 w-10 border-2 border-gray-200 shadow-md\">\n                    <AvatarImage src={isSender ? currentUser?.profileImage : receiverInfo?.profileImage} />\n                    <AvatarFallback className=\"text-xs font-semibold bg-gradient-to-br from-blue-500 to-purple-500 text-white\">\n                      {isSender \n                        ? currentUser?.fullName?.substring(0, 2) \n                        : receiverInfo?.fullName?.substring(0, 2) || \"U\"}\n                    </AvatarFallback>\n                  </Avatar>\n                ) : (\n                  <div className=\"w-10\" />\n                )}\n                \n                {/* Message Bubble */}\n                <div\n                  className={`flex flex-col max-w-[70%] ${\n                    isSender ? \"items-end\" : \"items-start\"\n                  }`}\n                >\n                  {showAvatar && (\n                    <span className={`text-xs font-semibold mb-1 px-1 ${\n                      isSender ? \"text-blue-600\" : \"text-gray-700\"\n                    }`}>\n                      {isSender ? \"أنت\" : receiverInfo?.fullName || \"مستخدم\"}\n                    </span>\n                  )}\n                  <div\n                    className={`rounded-2xl px-5 py-3 shadow-md ${\n                      isSender\n                        ? \"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-br-sm\"\n                        : \"bg-white border border-gray-200 text-gray-800 rounded-bl-sm\"\n                    }`}\n                  >\n                    <p className=\"text-sm leading-relaxed whitespace-pre-wrap break-words\">{msg.content}</p>\n                  </div>\n                  <span className={`text-xs mt-1 px-1 ${\n                    isSender ? \"text-gray-400\" : \"text-gray-500\"\n                  }`}>\n                    {new Date(msg.createdAt).toLocaleTimeString(\"ar-EG\", {\n                      hour: \"2-digit\",\n                      minute: \"2-digit\",\n                    })}\n                  </span>\n                </div>\n              </div>\n            );\n          })\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      {/* Input Area */}\n      <div className=\"border-t border-gray-200 bg-white px-6 py-4\">\n        <div className=\"flex items-center gap-3\">\n          <Input\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n            onKeyPress={(e) => {\n              if (e.key === \"Enter\" && !e.shiftKey) {\n                e.preventDefault();\n                handleSend();\n              }\n            }}\n            placeholder=\"اكتب رسالتك هنا...\"\n            className=\"flex-1 rounded-full border-2 border-gray-200 focus:border-blue-500 px-6 py-3 text-sm\"\n            disabled={sendMessageMutation.isPending}\n          />\n          <Button\n            onClick={handleSend}\n            disabled={!message.trim() || sendMessageMutation.isPending}\n            className=\"rounded-full h-12 w-12 p-0 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 shadow-lg hover:shadow-xl transition-all\"\n          >\n            {sendMessageMutation.isPending ? (\n              <Loader2 className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <Send className=\"h-5 w-5\" />\n            )}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":9959},"client/src/components/AdminDashboardLayout.tsx":{"content":"import { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\nimport { AdminSidebar } from \"@/components/AdminSidebar\";\n\ninterface AdminDashboardLayoutProps {\n  children: React.ReactNode;\n}\n\nexport function AdminDashboardLayout({ children }: AdminDashboardLayoutProps) {\n  const style = {\n    \"--sidebar-width\": \"20rem\",\n    \"--sidebar-width-icon\": \"4rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\" dir=\"rtl\">\n        <AdminSidebar />\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center p-4 border-b bg-background\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n          </header>\n          <main className=\"flex-1 overflow-auto p-6\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","size_bytes":905},"client/src/pages/GroupChatPage.tsx":{"content":"import { useParams } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { GroupChat } from \"@/components/GroupChat\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { ArrowRight, MessageSquare } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\ninterface Group {\n  id: string;\n  name: string;\n  groupImage?: string;\n}\n\nexport default function GroupChatPage() {\n  const { id } = useParams<{ id: string }>();\n  const groupId = id!;\n\n  // Get current user from localStorage\n  const currentUser = localStorage.getItem(\"user\")\n    ? JSON.parse(localStorage.getItem(\"user\")!)\n    : null;\n\n  // Get group details\n  const { data: group, isLoading } = useQuery<Group>({\n    queryKey: [`/api/groups/${groupId}`],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n\n  if (!group) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center\">\n        <Card className=\"w-full max-w-md\">\n          <CardContent className=\"pt-6 text-center\">\n            <p className=\"text-muted-foreground\">المجموعة غير موجودة</p>\n            <Link href=\"/groups\">\n              <Button className=\"mt-4\">العودة للمجموعات</Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-6 flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <Link href={`/groups/${groupId}/community`}>\n              <Button variant=\"ghost\" size=\"icon\">\n                <ArrowRight className=\"h-5 w-5\" />\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-3\">\n                <MessageSquare className=\"h-8 w-8 text-primary\" />\n                محادثة المجموعة\n              </h1>\n              <p className=\"text-muted-foreground mt-1\">{group.name}</p>\n            </div>\n          </div>\n        </div>\n\n        {/* Chat Component */}\n        <GroupChat groupId={groupId} currentUserId={currentUser?.id || ''} />\n      </div>\n    </div>\n  );\n}\n","size_bytes":2636},"client/src/pages/admin/Freelancers.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Users, TrendingUp, DollarSign, CheckCircle, XCircle } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface Freelancer {\n  id: string;\n  userId: string;\n  fullName: string;\n  email: string;\n  country: string;\n  rating: number;\n  totalEarnings: number;\n  availableBalance: number;\n  pendingBalance: number;\n  tasksCompleted: number;\n  isActive: boolean;\n  createdAt: string;\n}\n\nexport default function AdminFreelancers() {\n  const { toast } = useToast();\n\n  const { data: freelancers = [], isLoading } = useQuery<Freelancer[]>({\n    queryKey: [\"/api/admin/freelancers\"],\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest( `/api/admin/freelancers/${id}/toggle-status`,\"PATCH\", {});\n      return res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/freelancers\"] });\n      toast({\n        title: \"تم التحديث بنجاح\",\n        description: data.message,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeFreelancers = freelancers.filter(f => f.isActive).length;\n  const totalEarnings = freelancers.reduce((sum, f) => sum + f.totalEarnings, 0);\n  const averageRating = freelancers.length > 0\n    ? freelancers.reduce((sum, f) => sum + f.rating, 0) / freelancers.length\n    : 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">الفريلانسرز</h1>\n        <p className=\"text-muted-foreground mt-1\">إدارة ومراقبة الفريلانسرز المسجلين في المنصة</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card data-testid=\"card-total-freelancers\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الفريلانسرز</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{freelancers.length}</div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-active-freelancers\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">النشطون</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-active-count\">{activeFreelancers}</div>\n            <p className=\"text-xs text-muted-foreground\">\n              {freelancers.length > 0 ? Math.round((activeFreelancers / freelancers.length) * 100) : 0}% من الإجمالي\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-total-earnings\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الأرباح</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-earnings\">\n              {totalEarnings.toLocaleString('ar-SA')} ر.س\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-average-rating\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">متوسط التقييم</CardTitle>\n            <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-rating\">\n              {averageRating.toFixed(1)} ⭐\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>قائمة الفريلانسرز</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">جاري التحميل...</div>\n          ) : freelancers.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">لا يوجد فريلانسرز مسجلين</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>الاسم</TableHead>\n                    <TableHead>البريد الإلكتروني</TableHead>\n                    <TableHead>الدولة</TableHead>\n                    <TableHead>التقييم</TableHead>\n                    <TableHead>المهام المكتملة</TableHead>\n                    <TableHead>الرصيد المتاح</TableHead>\n                    <TableHead>الرصيد المعلق</TableHead>\n                    <TableHead>الحالة</TableHead>\n                    <TableHead>تاريخ التسجيل</TableHead>\n                    <TableHead>الإجراءات</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {freelancers.map((freelancer) => (\n                    <TableRow key={freelancer.id} data-testid={`row-freelancer-${freelancer.id}`}>\n                      <TableCell className=\"font-medium\">{freelancer.fullName}</TableCell>\n                      <TableCell>{freelancer.email}</TableCell>\n                      <TableCell>{freelancer.country}</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1\">\n                          <span>{freelancer.rating.toFixed(1)}</span>\n                          <span className=\"text-yellow-500\">⭐</span>\n                        </div>\n                      </TableCell>\n                      <TableCell>{freelancer.tasksCompleted}</TableCell>\n                      <TableCell>{freelancer.availableBalance.toLocaleString('ar-SA')} ر.س</TableCell>\n                      <TableCell>{freelancer.pendingBalance.toLocaleString('ar-SA')} ر.س</TableCell>\n                      <TableCell>\n                        {freelancer.isActive ? (\n                          <Badge variant=\"default\" className=\"bg-green-600\">\n                            <CheckCircle className=\"h-3 w-3 ml-1\" />\n                            نشط\n                          </Badge>\n                        ) : (\n                          <Badge variant=\"secondary\">\n                            <XCircle className=\"h-3 w-3 ml-1\" />\n                            غير نشط\n                          </Badge>\n                        )}\n                      </TableCell>\n                      <TableCell>\n                        {formatDistanceToNow(new Date(freelancer.createdAt), {\n                          addSuffix: true,\n                          locale: ar,\n                        })}\n                      </TableCell>\n                      <TableCell>\n                        <Button\n                          size=\"sm\"\n                          variant={freelancer.isActive ? \"destructive\" : \"default\"}\n                          onClick={() => toggleStatusMutation.mutate(freelancer.id)}\n                          disabled={toggleStatusMutation.isPending}\n                          data-testid={`button-toggle-${freelancer.id}`}\n                        >\n                          {freelancer.isActive ? \"إيقاف\" : \"تفعيل\"}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":8537},"server/seed-data.ts":{"content":"import { db } from \"./db\";\nimport { freelancers, productOwners, campaigns, groups, groupMembers, orders } from \"@shared/schema\";\nimport bcrypt from \"bcrypt\";\nimport { randomUUID } from \"crypto\";\n\nasync function seedData() {\n  try {\n    console.log(\"🌱 Starting database seeding...\");\n\n    // Check if data already exists\n    const existingFreelancers = await db.select().from(freelancers).limit(1);\n    if (existingFreelancers.length > 0) {\n      console.log(\"✅ Database already has data. Skipping seed.\");\n      process.exit(0);\n    }\n\n    // Seed Freelancers\n    console.log(\"📝 Creating freelancers...\");\n    const hashedPassword = await bcrypt.hash(\"Test@1234\", 10);\n    \n    const freelancerIds = [\n      \"f1-\" + randomUUID(),\n      \"f2-\" + randomUUID(),\n      \"f3-\" + randomUUID(),\n      \"f4-\" + randomUUID(),\n    ];\n\n    await db.insert(freelancers).values([\n      {\n        id: freelancerIds[0],\n        email: \"ahmed@example.com\",\n        password: hashedPassword,\n        fullName: \"أحمد محمد\",\n        username: \"ahmed_tester\",\n        phone: \"966501234567\",\n        countryCode: \"+966\",\n        jobTitle: \"مختبر تطبيقات محترف\",\n        teamSize: 5,\n        services: [\"google_play_review\", \"ux_testing\"],\n        bio: \"خبرة 3 سنوات في اختبار التطبيقات والمواقع\",\n        aboutMe: \"متخصص في اختبار تجربة المستخدم والإبلاغ عن الأخطاء بدقة عالية\",\n        isVerified: true,\n        acceptedInstructions: true,\n      },\n      {\n        id: freelancerIds[1],\n        email: \"fatima@example.com\",\n        password: hashedPassword,\n        fullName: \"فاطمة علي\",\n        username: \"fatima_reviews\",\n        phone: \"966501234568\",\n        countryCode: \"+966\",\n        jobTitle: \"متخصصة في تقييم التطبيقات\",\n        teamSize: 3,\n        services: [\"ios_review\", \"website_review\"],\n        bio: \"متخصصة في تقييم جودة التطبيقات والمواقع الإلكترونية\",\n        aboutMe: \"خبرة في مجال ضمان الجودة والاختبار الوظيفي للمنتجات الرقمية\",\n        isVerified: true,\n        acceptedInstructions: true,\n      },\n      {\n        id: freelancerIds[2],\n        email: \"mohammed@example.com\",\n        password: hashedPassword,\n        fullName: \"محمد حسن\",\n        username: \"mohammed_leader\",\n        phone: \"966501234569\",\n        countryCode: \"+966\",\n        jobTitle: \"قائد فريق اختبار\",\n        teamSize: 10,\n        services: [\"software_testing\", \"ux_testing\", \"google_play_review\"],\n        bio: \"قائد فريق متخصص في اختبارات البرمجيات الشاملة\",\n        aboutMe: \"إدارة فرق الاختبار والتأكد من معايير الجودة العالية\",\n        isVerified: true,\n        acceptedInstructions: true,\n      },\n      {\n        id: freelancerIds[3],\n        email: \"sara@example.com\",\n        password: hashedPassword,\n        fullName: \"سارة محمود\",\n        username: \"sara_social\",\n        phone: \"966501234570\",\n        countryCode: \"+966\",\n        jobTitle: \"متخصصة في التسويق الرقمي\",\n        teamSize: 2,\n        services: [\"social_media_engagement\"],\n        bio: \"متخصصة في التفاعل عبر وسائل التواصل الاجتماعي\",\n        aboutMe: \"خبرة في زيادة التفاعل والمتابعين على منصات التواصل\",\n        isVerified: true,\n        acceptedInstructions: true,\n      },\n    ]);\n\n    console.log(\"✅ Freelancers created\");\n\n    // Seed Product Owners\n    console.log(\"📝 Creating product owners...\");\n    const ownerIds = [\n      \"o1-\" + randomUUID(),\n      \"o2-\" + randomUUID(),\n    ];\n\n    await db.insert(productOwners).values([\n      {\n        id: ownerIds[0],\n        email: \"startup@example.com\",\n        password: hashedPassword,\n        fullName: \"شركة النجم الناشئة\",\n        companyName: \"AlNajm Startup\",\n        phone: \"966501234571\",\n        productName: \"تطبيق التسوق الذكي\",\n        productType: \"mobile_app\",\n        productDescription: \"تطبيق تسوق باستخدام الذكاء الاصطناعي\",\n        productUrl: \"https://alnajm-shop.example.com\",\n        services: [\"google_play_review\", \"ux_testing\"],\n        acceptedInstructions: true,\n      },\n      {\n        id: ownerIds[1],\n        email: \"tech-hub@example.com\",\n        password: hashedPassword,\n        fullName: \"مركز التكنولوجيا\",\n        companyName: \"Tech Hub Solutions\",\n        phone: \"966501234572\",\n        productName: \"منصة التعليم الإلكترونية\",\n        productType: \"web_app\",\n        productDescription: \"منصة تعليم عبر الإنترنت تفاعلية\",\n        productUrl: \"https://tech-hub-learning.example.com\",\n        services: [\"website_review\", \"software_testing\"],\n        acceptedInstructions: true,\n      },\n    ]);\n\n    console.log(\"✅ Product owners created\");\n\n    // Seed Campaigns\n    console.log(\"📝 Creating campaigns...\");\n    const campaignIds = [\n      \"c1-\" + randomUUID(),\n      \"c2-\" + randomUUID(),\n    ];\n\n    await db.insert(campaigns).values([\n      {\n        id: campaignIds[0],\n        productOwnerId: ownerIds[0],\n        title: \"اختبار تطبيق التسوق - إصدار جديد\",\n        description: \"نحتاج إلى اختبار شامل للإصدار الجديد من تطبيقنا\",\n        productType: \"mobile_app\",\n        productUrl: \"https://alnajm-shop.example.com\",\n        services: [\"google_play_review\", \"ux_testing\"],\n        package: \"premium\",\n        budget: \"500\",\n        testersNeeded: 20,\n        testersAssigned: 0,\n        status: \"active\",\n        startDate: new Date(),\n        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n      },\n      {\n        id: campaignIds[1],\n        productOwnerId: ownerIds[1],\n        title: \"اختبار منصة التعليم\",\n        description: \"اختبار وظائف منصة التعليم الجديدة\",\n        productType: \"web_app\",\n        productUrl: \"https://tech-hub-learning.example.com\",\n        services: [\"website_review\", \"software_testing\"],\n        package: \"standard\",\n        budget: \"300\",\n        testersNeeded: 15,\n        testersAssigned: 0,\n        status: \"active\",\n        startDate: new Date(),\n        endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n      },\n    ]);\n\n    console.log(\"✅ Campaigns created\");\n\n    // Seed Groups\n    console.log(\"📝 Creating groups...\");\n    const groupIds = [\n      \"g1-\" + randomUUID(),\n      \"g2-\" + randomUUID(),\n    ];\n\n    await db.insert(groups).values([\n      {\n        id: groupIds[0],\n        name: \"فريق الاختبار المتقدم\",\n        description: \"فريق متخصص في اختبار التطبيقات والمواقع\",\n        leaderId: freelancerIds[2],\n        maxMembers: 700,\n        currentMembers: 4,\n        status: \"active\",\n        privacy: \"public\",\n        averageRating: \"4.8\",\n        totalRatings: 25,\n      },\n      {\n        id: groupIds[1],\n        name: \"فريق التسويق الرقمي\",\n        description: \"فريق متخصص في التفاعل على وسائل التواصل الاجتماعي\",\n        leaderId: freelancerIds[3],\n        maxMembers: 700,\n        currentMembers: 2,\n        status: \"active\",\n        privacy: \"public\",\n        averageRating: \"4.5\",\n        totalRatings: 10,\n      },\n    ]);\n\n    console.log(\"✅ Groups created\");\n\n    // Seed Group Members\n    console.log(\"📝 Adding group members...\");\n    await db.insert(groupMembers).values([\n      {\n        id: \"gm1-\" + randomUUID(),\n        groupId: groupIds[0],\n        freelancerId: freelancerIds[0],\n        role: \"member\",\n        status: \"active\",\n        joinedAt: new Date(),\n      },\n      {\n        id: \"gm2-\" + randomUUID(),\n        groupId: groupIds[0],\n        freelancerId: freelancerIds[1],\n        role: \"member\",\n        status: \"active\",\n        joinedAt: new Date(),\n      },\n      {\n        id: \"gm3-\" + randomUUID(),\n        groupId: groupIds[1],\n        freelancerId: freelancerIds[3],\n        role: \"leader\",\n        status: \"active\",\n        joinedAt: new Date(),\n      },\n    ]);\n\n    console.log(\"✅ Group members added\");\n\n    // Seed Orders\n    console.log(\"📝 Creating orders...\");\n    await db.insert(orders).values([\n      {\n        id: \"ord1-\" + randomUUID(),\n        productOwnerId: ownerIds[0],\n        groupId: groupIds[0],\n        serviceType: \"google_play_review\",\n        quantity: 10,\n        pricePerUnit: \"25\",\n        totalAmount: \"250\",\n        status: \"pending\",\n      },\n      {\n        id: \"ord2-\" + randomUUID(),\n        productOwnerId: ownerIds[1],\n        groupId: groupIds[0],\n        serviceType: \"website_review\",\n        quantity: 15,\n        pricePerUnit: \"20\",\n        totalAmount: \"300\",\n        status: \"pending\",\n      },\n    ]);\n\n    console.log(\"✅ Orders created\");\n\n    console.log(\"✅ Database seeding completed successfully!\");\n    process.exit(0);\n  } catch (error) {\n    console.error(\"❌ Error seeding database:\", error);\n    process.exit(1);\n  }\n}\n\nseedData();\n","size_bytes":9287},"client/src/pages/admin/Withdrawals.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Wallet, Clock, CheckCircle, XCircle, DollarSign } from \"lucide-react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface Withdrawal {\n  id: string;\n  freelancerId: string;\n  freelancerName: string;\n  amount: number;\n  status: \"pending\" | \"completed\" | \"rejected\";\n  paymentMethod: string;\n  accountDetails: string;\n  createdAt: string;\n  processedAt: string | null;\n}\n\nexport default function AdminWithdrawals() {\n  const { toast } = useToast();\n\n  const { data: withdrawals = [], isLoading } = useQuery<Withdrawal[]>({\n    queryKey: [\"/api/admin/withdrawals\"],\n  });\n\n  const approveMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest(`/api/admin/withdrawals/${id}/approve`,\"PATCH\", {});\n      return res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/withdrawals\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/statistics\"] });\n      toast({\n        title: \"تم الاعتماد بنجاح\",\n        description: data.message,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await apiRequest(`/api/admin/withdrawals/${id}/reject`,\"PATCH\", {});\n      return res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/withdrawals\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/statistics\"] });\n      toast({\n        title: \"تم الرفض\",\n        description: data.message,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const pendingWithdrawals = withdrawals.filter(w => w.status === \"pending\");\n  const completedWithdrawals = withdrawals.filter(w => w.status === \"completed\");\n  const rejectedWithdrawals = withdrawals.filter(w => w.status === \"rejected\");\n  const totalPendingAmount = pendingWithdrawals.reduce((sum, w) => sum + w.amount, 0);\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case \"pending\":\n        return (\n          <Badge variant=\"secondary\">\n            <Clock className=\"h-3 w-3 ml-1\" />\n            قيد الانتظار\n          </Badge>\n        );\n      case \"completed\":\n        return (\n          <Badge variant=\"default\" className=\"bg-green-600\">\n            <CheckCircle className=\"h-3 w-3 ml-1\" />\n            مكتمل\n          </Badge>\n        );\n      case \"rejected\":\n        return (\n          <Badge variant=\"destructive\">\n            <XCircle className=\"h-3 w-3 ml-1\" />\n            مرفوض\n          </Badge>\n        );\n      default:\n        return <Badge>{status}</Badge>;\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold\">طلبات السحب</h1>\n        <p className=\"text-muted-foreground mt-1\">مراجعة واعتماد طلبات سحب الأرباح</p>\n      </div>\n\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        <Card data-testid=\"card-pending-withdrawals\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">قيد الانتظار</CardTitle>\n            <Clock className=\"h-4 w-4 text-yellow-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-pending-count\">\n              {pendingWithdrawals.length}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {totalPendingAmount.toLocaleString('ar-SA')} ر.س\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-completed-withdrawals\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المكتملة</CardTitle>\n            <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-completed-count\">\n              {completedWithdrawals.length}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-rejected-withdrawals\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">المرفوضة</CardTitle>\n            <XCircle className=\"h-4 w-4 text-red-600\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-rejected-count\">\n              {rejectedWithdrawals.length}\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card data-testid=\"card-total-withdrawals\">\n          <CardHeader className=\"flex flex-row items-center justify-between gap-1 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">إجمالي الطلبات</CardTitle>\n            <Wallet className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">\n              {withdrawals.length}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>جميع طلبات السحب</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">جاري التحميل...</div>\n          ) : withdrawals.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">لا توجد طلبات سحب</div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>اسم الفريلانسر</TableHead>\n                    <TableHead>المبلغ</TableHead>\n                    <TableHead>طريقة الدفع</TableHead>\n                    <TableHead>تفاصيل الحساب</TableHead>\n                    <TableHead>الحالة</TableHead>\n                    <TableHead>تاريخ الطلب</TableHead>\n                    <TableHead>تاريخ المعالجة</TableHead>\n                    <TableHead>الإجراءات</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {withdrawals.map((withdrawal) => (\n                    <TableRow key={withdrawal.id} data-testid={`row-withdrawal-${withdrawal.id}`}>\n                      <TableCell className=\"font-medium\">{withdrawal.freelancerName}</TableCell>\n                      <TableCell>\n                        <div className=\"flex items-center gap-1 font-bold text-green-600\">\n                          <DollarSign className=\"h-4 w-4\" />\n                          {withdrawal.amount.toLocaleString('ar-SA')} ر.س\n                        </div>\n                      </TableCell>\n                      <TableCell>{withdrawal.paymentMethod}</TableCell>\n                      <TableCell className=\"max-w-xs truncate\">{withdrawal.accountDetails}</TableCell>\n                      <TableCell>{getStatusBadge(withdrawal.status)}</TableCell>\n                      <TableCell>\n                        {formatDistanceToNow(new Date(withdrawal.createdAt), {\n                          addSuffix: true,\n                          locale: ar,\n                        })}\n                      </TableCell>\n                      <TableCell>\n                        {withdrawal.processedAt\n                          ? formatDistanceToNow(new Date(withdrawal.processedAt), {\n                              addSuffix: true,\n                              locale: ar,\n                            })\n                          : \"-\"}\n                      </TableCell>\n                      <TableCell>\n                        {withdrawal.status === \"pending\" && (\n                          <div className=\"flex gap-2\">\n                            <Button\n                              size=\"sm\"\n                              variant=\"default\"\n                              className=\"bg-green-600 hover:bg-green-700\"\n                              onClick={() => approveMutation.mutate(withdrawal.id)}\n                              disabled={approveMutation.isPending || rejectMutation.isPending}\n                              data-testid={`button-approve-${withdrawal.id}`}\n                            >\n                              <CheckCircle className=\"h-4 w-4 ml-1\" />\n                              اعتماد\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              variant=\"destructive\"\n                              onClick={() => rejectMutation.mutate(withdrawal.id)}\n                              disabled={approveMutation.isPending || rejectMutation.isPending}\n                              data-testid={`button-reject-${withdrawal.id}`}\n                            >\n                              <XCircle className=\"h-4 w-4 ml-1\" />\n                              رفض\n                            </Button>\n                          </div>\n                        )}\n                        {withdrawal.status !== \"pending\" && (\n                          <span className=\"text-muted-foreground text-sm\">تمت المعالجة</span>\n                        )}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10472},"client/src/pages/admin/CreateUser.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { UserPlus, ArrowLeft, Loader2 } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Switch } from \"@/components/ui/switch\";\n\nexport default function CreateAdminUser() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const { data: roles, isLoading: rolesLoading } = useQuery<any[]>({\n    queryKey: [\"/api/admin/roles\"],\n  });\n\n  const [formData, setFormData] = useState({\n    email: \"\",\n    password: \"\",\n    fullName: \"\",\n    phone: \"\",\n    roleId: \"\",\n    isActive: true,\n  });\n\n  const createUserMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"/api/admin/users\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({\n        title: \"تم الإنشاء بنجاح\",\n        description: \"تم إضافة المستخدم الإداري\",\n      });\n      setLocation(\"/admin/users\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"خطأ\",\n        description: error.message || \"فشل إنشاء المستخدم\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.roleId) {\n      toast({\n        title: \"خطأ\",\n        description: \"يرجى اختيار الدور\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createUserMutation.mutate(formData);\n  };\n\n  return (\n    <div className=\"max-w-2xl space-y-6\">\n      <div className=\"flex items-center gap-3\">\n        <Button \n          variant=\"ghost\" \n          size=\"icon\"\n          onClick={() => setLocation(\"/admin/users\")}\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"h-5 w-5\" />\n        </Button>\n        <div>\n          <h1 className=\"text-3xl font-bold\">إضافة مستخدم إداري جديد</h1>\n          <p className=\"text-muted-foreground\">إنشاء حساب جديد لفريق العمل</p>\n        </div>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center\">\n              <UserPlus className=\"w-6 h-6 text-primary\" />\n            </div>\n            <div>\n              <CardTitle>بيانات المستخدم</CardTitle>\n              <CardDescription>أدخل معلومات المستخدم الجديد</CardDescription>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"grid gap-4 md:grid-cols-2\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"fullName\">الاسم الكامل *</Label>\n                <Input\n                  id=\"fullName\"\n                  value={formData.fullName}\n                  onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}\n                  required\n                  data-testid=\"input-fullname\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">البريد الإلكتروني *</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={formData.email}\n                  onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  required\n                  data-testid=\"input-email\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\">كلمة المرور *</Label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  required\n                  minLength={8}\n                  data-testid=\"input-password\"\n                />\n                <p className=\"text-xs text-muted-foreground\">يجب أن تكون 8 أحرف على الأقل</p>\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"phone\">رقم الهاتف</Label>\n                <Input\n                  id=\"phone\"\n                  type=\"tel\"\n                  value={formData.phone}\n                  onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                  placeholder=\"+966XXXXXXXXX\"\n                  data-testid=\"input-phone\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"role\">الدور *</Label>\n              {rolesLoading ? (\n                <div className=\"text-sm text-muted-foreground\">جاري تحميل الأدوار...</div>\n              ) : (\n                <Select\n                  value={formData.roleId}\n                  onValueChange={(value) => setFormData({ ...formData, roleId: value })}\n                >\n                  <SelectTrigger data-testid=\"select-role\">\n                    <SelectValue placeholder=\"اختر الدور\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {roles?.map((role) => (\n                      <SelectItem key={role.id} value={role.id}>\n                        {role.nameAr} - {role.name}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              )}\n            </div>\n\n            <div className=\"flex items-center justify-between p-4 bg-muted/50 rounded-lg\">\n              <div className=\"space-y-0.5\">\n                <Label htmlFor=\"isActive\">تفعيل الحساب</Label>\n                <p className=\"text-sm text-muted-foreground\">\n                  السماح للمستخدم بتسجيل الدخول\n                </p>\n              </div>\n              <Switch\n                id=\"isActive\"\n                checked={formData.isActive}\n                onCheckedChange={(checked) => setFormData({ ...formData, isActive: checked })}\n                data-testid=\"switch-active\"\n              />\n            </div>\n\n            <div className=\"flex gap-3 pt-4\">\n              <Button \n                type=\"submit\" \n                disabled={createUserMutation.isPending}\n                data-testid=\"button-submit\"\n              >\n                {createUserMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />\n                    جاري الإنشاء...\n                  </>\n                ) : (\n                  <>\n                    <UserPlus className=\"ml-2 h-4 w-4\" />\n                    إنشاء المستخدم\n                  </>\n                )}\n              </Button>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => setLocation(\"/admin/users\")}\n                data-testid=\"button-cancel\"\n              >\n                إلغاء\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7857},"client/src/pages/admin/Users.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { UserPlus, MoreVertical, Edit, Trash2, CheckCircle2, XCircle } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useLocation } from \"wouter\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nexport default function AdminUsers() {\n  const [, setLocation] = useLocation();\n  const { data: users, isLoading } = useQuery<any[]>({\n    queryKey: [\"/api/admin/users\"],\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">المستخدمون الإداريون</h1>\n          <p className=\"text-muted-foreground\">إدارة فريق العمل والصلاحيات</p>\n        </div>\n        <Button onClick={() => setLocation(\"/admin/users/create\")} data-testid=\"button-create-user\">\n          <UserPlus className=\"ml-2 h-4 w-4\" />\n          إضافة مستخدم جديد\n        </Button>\n      </div>\n\n      {isLoading ? (\n        <div>جاري التحميل...</div>\n      ) : (\n        <div className=\"grid gap-4\">\n          {users?.map((user) => (\n            <Card key={user.id} className=\"hover-elevate\" data-testid={`card-user-${user.id}`}>\n              <CardHeader>\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <CardTitle className=\"text-lg\">{user.fullName}</CardTitle>\n                      {user.isActive ? (\n                        <Badge variant=\"default\" className=\"gap-1\">\n                          <CheckCircle2 className=\"h-3 w-3\" />\n                          نشط\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"secondary\" className=\"gap-1\">\n                          <XCircle className=\"h-3 w-3\" />\n                          غير نشط\n                        </Badge>\n                      )}\n                    </div>\n                    <CardDescription>{user.email}</CardDescription>\n                  </div>\n\n                  <DropdownMenu>\n                    <DropdownMenuTrigger asChild>\n                      <Button variant=\"ghost\" size=\"icon\" data-testid={`button-menu-${user.id}`}>\n                        <MoreVertical className=\"h-4 w-4\" />\n                      </Button>\n                    </DropdownMenuTrigger>\n                    <DropdownMenuContent align=\"end\">\n                      <DropdownMenuItem onClick={() => setLocation(`/admin/users/${user.id}/edit`)}>\n                        <Edit className=\"ml-2 h-4 w-4\" />\n                        تعديل\n                      </DropdownMenuItem>\n                      <DropdownMenuItem className=\"text-red-600\">\n                        <Trash2 className=\"ml-2 h-4 w-4\" />\n                        حذف\n                      </DropdownMenuItem>\n                    </DropdownMenuContent>\n                  </DropdownMenu>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <span className=\"text-muted-foreground\">الدور:</span>\n                    <p className=\"font-medium mt-1\">{user.roleNameAr || user.roleName}</p>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">رقم الهاتف:</span>\n                    <p className=\"font-medium mt-1\">{user.phone || \"غير محدد\"}</p>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">تاريخ الإنشاء:</span>\n                    <p className=\"font-medium mt-1\">\n                      {format(new Date(user.createdAt), \"dd MMM yyyy\", { locale: ar })}\n                    </p>\n                  </div>\n                  <div>\n                    <span className=\"text-muted-foreground\">آخر تسجيل دخول:</span>\n                    <p className=\"font-medium mt-1\">\n                      {user.lastLogin \n                        ? format(new Date(user.lastLogin), \"dd MMM yyyy\", { locale: ar })\n                        : \"لم يسجل دخول بعد\"}\n                    </p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n\n          {users?.length === 0 && (\n            <Card>\n              <CardContent className=\"flex flex-col items-center justify-center py-12\">\n                <UserPlus className=\"h-12 w-12 text-muted-foreground mb-4\" />\n                <h3 className=\"text-lg font-semibold mb-2\">لا يوجد مستخدمون</h3>\n                <p className=\"text-muted-foreground text-center mb-4\">\n                  ابدأ بإضافة أعضاء فريق العمل\n                </p>\n                <Button onClick={() => setLocation(\"/admin/users/create\")}>\n                  <UserPlus className=\"ml-2 h-4 w-4\" />\n                  إضافة مستخدم جديد\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5548},"client/src/components/ConversationChat.tsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Send, Loader2, ArrowLeft } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport { Card } from '@/components/ui/card';\nimport { useToast } from '@/hooks/use-toast';\nimport { getSocket, joinConversation, leaveConversation, sendConversationMessage, startTyping, stopTyping } from '@/lib/socket';\nimport { format } from 'date-fns';\nimport { ar } from 'date-fns/locale';\nimport { Link } from 'wouter';\n\ninterface Message {\n  id: string;\n  conversationId: string;\n  senderId: string;\n  senderType: string;\n  content: string;\n  isRead: boolean;\n  createdAt: Date;\n  sender?: {\n    id: string;\n    fullName: string;\n    profileImage?: string;\n    type: string;\n  };\n}\n\ninterface ConversationChatProps {\n  conversationId: string;\n  currentUserId: string;\n  currentUserType: 'product_owner' | 'freelancer';\n  recipientName?: string;\n  recipientImage?: string;\n  groupName?: string;\n}\n\nexport function ConversationChat({\n  conversationId,\n  currentUserId,\n  currentUserType,\n  recipientName,\n  recipientImage,\n  groupName,\n}: ConversationChatProps) {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [isConnected, setIsConnected] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout>();\n  const { toast } = useToast();\n\n  // Fetch initial messages\n  const { data: initialMessages, isLoading } = useQuery<Message[]>({\n    queryKey: [`/api/conversations/${conversationId}/messages`],\n  });\n\n  // Initialize socket and join conversation\n  useEffect(() => {\n    const socket = getSocket();\n    if (!socket) return;\n\n    setIsConnected(socket.connected);\n\n    // Join conversation room\n    joinConversation(conversationId);\n\n    // Handle connection events\n    const handleConnect = () => {\n      setIsConnected(true);\n      joinConversation(conversationId);\n    };\n\n    const handleDisconnect = () => {\n      setIsConnected(false);\n    };\n\n    // Handle incoming messages\n    const handleConversationMessage = (message: Message) => {\n      setMessages((prev) => [...prev, message]);\n      messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    };\n\n    // Handle typing indicators\n    const handleTypingStart = ({ userId }: { userId: string }) => {\n      if (userId !== currentUserId) {\n        setIsTyping(true);\n      }\n    };\n\n    const handleTypingStop = ({ userId }: { userId: string }) => {\n      if (userId !== currentUserId) {\n        setIsTyping(false);\n      }\n    };\n\n    // Handle errors\n    const handleError = ({ message }: { message: string }) => {\n      toast({\n        variant: 'destructive',\n        title: 'خطأ',\n        description: message,\n      });\n    };\n\n    socket.on('connect', handleConnect);\n    socket.on('disconnect', handleDisconnect);\n    socket.on('conversation:message', handleConversationMessage);\n    socket.on('typing:start', handleTypingStart);\n    socket.on('typing:stop', handleTypingStop);\n    socket.on('error', handleError);\n\n    // Load initial messages\n    if (initialMessages) {\n      setMessages(initialMessages);\n      setTimeout(() => messagesEndRef.current?.scrollIntoView(), 100);\n    }\n\n    return () => {\n      socket.off('connect', handleConnect);\n      socket.off('disconnect', handleDisconnect);\n      socket.off('conversation:message', handleConversationMessage);\n      socket.off('typing:start', handleTypingStart);\n      socket.off('typing:stop', handleTypingStop);\n      socket.off('error', handleError);\n      leaveConversation(conversationId);\n    };\n  }, [conversationId, currentUserId, initialMessages, toast]);\n\n  // Handle sending message\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !isConnected) return;\n\n    sendConversationMessage(conversationId, newMessage.trim());\n    setNewMessage('');\n    stopTyping('conversation', conversationId);\n  };\n\n  // Handle typing\n  const handleTyping = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewMessage(e.target.value);\n\n    if (!typingTimeoutRef.current) {\n      startTyping('conversation', conversationId);\n    }\n\n    clearTimeout(typingTimeoutRef.current);\n    typingTimeoutRef.current = setTimeout(() => {\n      stopTyping('conversation', conversationId);\n      typingTimeoutRef.current = undefined;\n    }, 1000);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-96\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"flex flex-col h-[calc(100vh-12rem)]\">\n      {/* Chat header */}\n      <div className=\"border-b px-6 py-4 flex items-center gap-4\">\n        <Link href={currentUserType === 'product_owner' ? '/product-owner-dashboard/conversations' : '/freelancer-dashboard/conversations'}>\n          <Button variant=\"ghost\" size=\"icon\">\n            <ArrowLeft className=\"h-5 w-5\" />\n          </Button>\n        </Link>\n        <Avatar>\n          <AvatarImage src={recipientImage} />\n          <AvatarFallback>{recipientName?.charAt(0) || '؟'}</AvatarFallback>\n        </Avatar>\n        <div className=\"flex-1\">\n          <h3 className=\"font-semibold\">{recipientName}</h3>\n          {groupName && <p className=\"text-sm text-muted-foreground\">{groupName}</p>}\n        </div>\n        {!isConnected && (\n          <div className=\"text-sm text-yellow-600\">جارٍ الاتصال...</div>\n        )}\n      </div>\n\n      {/* Messages container */}\n      <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\n        {messages.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center h-full text-center text-muted-foreground\">\n            <p className=\"text-lg font-medium\">لا توجد رسائل بعد</p>\n            <p className=\"text-sm\">ابدأ المحادثة الآن!</p>\n          </div>\n        ) : (\n          <>\n            {messages.map((message) => {\n              const isOwnMessage = message.senderId === currentUserId;\n              return (\n                <div\n                  key={message.id}\n                  className={`flex gap-3 ${isOwnMessage ? 'flex-row-reverse' : 'flex-row'}`}\n                >\n                  <Avatar className=\"h-10 w-10\">\n                    <AvatarImage src={message.sender?.profileImage} />\n                    <AvatarFallback>\n                      {message.sender?.fullName?.charAt(0) || '؟'}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className={`flex flex-col ${isOwnMessage ? 'items-end' : 'items-start'} max-w-[70%]`}>\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <span className=\"text-sm font-medium\">\n                        {isOwnMessage ? 'أنت' : message.sender?.fullName}\n                      </span>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {format(new Date(message.createdAt), 'p', { locale: ar })}\n                      </span>\n                    </div>\n                    <div\n                      className={`rounded-2xl px-4 py-3 ${\n                        isOwnMessage\n                          ? 'bg-primary text-primary-foreground'\n                          : 'bg-muted'\n                      }`}\n                    >\n                      <p className=\"text-sm whitespace-pre-wrap break-words\">{message.content}</p>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n            <div ref={messagesEndRef} />\n          </>\n        )}\n\n        {/* Typing indicator */}\n        {isTyping && (\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground px-4\">\n            <div className=\"flex gap-1\">\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '0ms' }} />\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '150ms' }} />\n              <span className=\"w-2 h-2 bg-muted-foreground rounded-full animate-bounce\" style={{ animationDelay: '300ms' }} />\n            </div>\n            <span>جارٍ الكتابة...</span>\n          </div>\n        )}\n      </div>\n\n      {/* Message input */}\n      <form onSubmit={handleSendMessage} className=\"border-t p-6\">\n        <div className=\"flex gap-3\">\n          <Input\n            value={newMessage}\n            onChange={handleTyping}\n            placeholder=\"اكتب رسالتك...\"\n            className=\"flex-1\"\n            disabled={!isConnected}\n            dir=\"rtl\"\n          />\n          <Button\n            type=\"submit\"\n            disabled={!newMessage.trim() || !isConnected}\n          >\n            <Send className=\"h-4 w-4 ml-2\" />\n            إرسال\n          </Button>\n        </div>\n      </form>\n    </Card>\n  );\n}\n","size_bytes":9200},"client/src/components/LightRays.tsx":{"content":"import { useRef, useEffect, useState } from 'react';\nimport { Renderer, Program, Triangle, Mesh } from 'ogl';\n\nexport type RaysOrigin =\n  | 'top-center'\n  | 'top-left'\n  | 'top-right'\n  | 'right'\n  | 'left'\n  | 'bottom-center'\n  | 'bottom-right'\n  | 'bottom-left';\n\ninterface LightRaysProps {\n  raysOrigin?: RaysOrigin;\n  raysColor?: string;\n  raysSpeed?: number;\n  lightSpread?: number;\n  rayLength?: number;\n  pulsating?: boolean;\n  fadeDistance?: number;\n  saturation?: number;\n  followMouse?: boolean;\n  mouseInfluence?: number;\n  noiseAmount?: number;\n  distortion?: number;\n  className?: string;\n}\n\nconst DEFAULT_COLOR = '#ffffff';\n\nconst hexToRgb = (hex: string): [number, number, number] => {\n  const m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return m ? [parseInt(m[1], 16) / 255, parseInt(m[2], 16) / 255, parseInt(m[3], 16) / 255] : [1, 1, 1];\n};\n\nconst getAnchorAndDir = (\n  origin: RaysOrigin,\n  w: number,\n  h: number\n): { anchor: [number, number]; dir: [number, number] } => {\n  const outside = 0.2;\n  switch (origin) {\n    case 'top-left':\n      return { anchor: [0, -outside * h], dir: [0, 1] };\n    case 'top-right':\n      return { anchor: [w, -outside * h], dir: [0, 1] };\n    case 'left':\n      return { anchor: [-outside * w, 0.5 * h], dir: [1, 0] };\n    case 'right':\n      return { anchor: [(1 + outside) * w, 0.5 * h], dir: [-1, 0] };\n    case 'bottom-left':\n      return { anchor: [0, (1 + outside) * h], dir: [0, -1] };\n    case 'bottom-center':\n      return { anchor: [0.5 * w, (1 + outside) * h], dir: [0, -1] };\n    case 'bottom-right':\n      return { anchor: [w, (1 + outside) * h], dir: [0, -1] };\n    default: // \"top-center\"\n      return { anchor: [0.5 * w, -outside * h], dir: [0, 1] };\n  }\n};\n\ntype Vec2 = [number, number];\ntype Vec3 = [number, number, number];\n\ninterface Uniforms {\n  iTime: { value: number };\n  iResolution: { value: Vec2 };\n  rayPos: { value: Vec2 };\n  rayDir: { value: Vec2 };\n  raysColor: { value: Vec3 };\n  raysSpeed: { value: number };\n  lightSpread: { value: number };\n  rayLength: { value: number };\n  pulsating: { value: number };\n  fadeDistance: { value: number };\n  saturation: { value: number };\n  mousePos: { value: Vec2 };\n  mouseInfluence: { value: number };\n  noiseAmount: { value: number };\n  distortion: { value: number };\n}\n\nconst LightRays: React.FC<LightRaysProps> = ({\n  raysOrigin = 'top-center',\n  raysColor = DEFAULT_COLOR,\n  raysSpeed = 1,\n  lightSpread = 1,\n  rayLength = 2,\n  pulsating = false,\n  fadeDistance = 1.0,\n  saturation = 1.0,\n  followMouse = true,\n  mouseInfluence = 0.1,\n  noiseAmount = 0.0,\n  distortion = 0.0,\n  className = ''\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const uniformsRef = useRef<Uniforms | null>(null);\n  const rendererRef = useRef<Renderer | null>(null);\n  const mouseRef = useRef({ x: 0.5, y: 0.5 });\n  const smoothMouseRef = useRef({ x: 0.5, y: 0.5 });\n  const animationIdRef = useRef<number | null>(null);\n  const meshRef = useRef<Mesh | null>(null);\n  const cleanupFunctionRef = useRef<(() => void) | null>(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    observerRef.current = new IntersectionObserver(\n      entries => {\n        const entry = entries[0];\n        setIsVisible(entry.isIntersecting);\n      },\n      { threshold: 0.1 }\n    );\n\n    observerRef.current.observe(containerRef.current);\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n        observerRef.current = null;\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!isVisible || !containerRef.current) return;\n\n    if (cleanupFunctionRef.current) {\n      cleanupFunctionRef.current();\n      cleanupFunctionRef.current = null;\n    }\n\n    const initializeWebGL = async () => {\n      if (!containerRef.current) return;\n\n      await new Promise(resolve => setTimeout(resolve, 10));\n\n      if (!containerRef.current) return;\n\n      const renderer = new Renderer({\n        dpr: Math.min(window.devicePixelRatio, 2),\n        alpha: true\n      });\n      rendererRef.current = renderer;\n\n      const gl = renderer.gl;\n      gl.canvas.style.width = '100%';\n      gl.canvas.style.height = '100%';\n\n      while (containerRef.current.firstChild) {\n        containerRef.current.removeChild(containerRef.current.firstChild);\n      }\n      containerRef.current.appendChild(gl.canvas);\n\n      const vert = `\nattribute vec2 position;\nvarying vec2 vUv;\nvoid main() {\n  vUv = position * 0.5 + 0.5;\n  gl_Position = vec4(position, 0.0, 1.0);\n}`;\n\n      const frag = `precision highp float;\n\nuniform float iTime;\nuniform vec2  iResolution;\n\nuniform vec2  rayPos;\nuniform vec2  rayDir;\nuniform vec3  raysColor;\nuniform float raysSpeed;\nuniform float lightSpread;\nuniform float rayLength;\nuniform float pulsating;\nuniform float fadeDistance;\nuniform float saturation;\nuniform vec2  mousePos;\nuniform float mouseInfluence;\nuniform float noiseAmount;\nuniform float distortion;\n\nvarying vec2 vUv;\n\nfloat noise(vec2 st) {\n  return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);\n}\n\nfloat rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord,\n                  float seedA, float seedB, float speed) {\n  vec2 sourceToCoord = coord - raySource;\n  vec2 dirNorm = normalize(sourceToCoord);\n  float cosAngle = dot(dirNorm, rayRefDirection);\n\n  float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2;\n  \n  float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001));\n\n  float distance = length(sourceToCoord);\n  float maxDistance = iResolution.x * rayLength;\n  float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);\n  \n  float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);\n  float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;\n\n  float baseStrength = clamp(\n    (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +\n    (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),\n    0.0, 1.0\n  );\n\n  return baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);\n  \n  vec2 finalRayDir = rayDir;\n  if (mouseInfluence > 0.0) {\n    vec2 mouseScreenPos = mousePos * iResolution.xy;\n    vec2 mouseDirection = normalize(mouseScreenPos - rayPos);\n    finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));\n  }\n\n  vec4 rays1 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349,\n                           1.5 * raysSpeed);\n  vec4 rays2 = vec4(1.0) *\n               rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234,\n                           1.1 * raysSpeed);\n\n  fragColor = rays1 * 0.5 + rays2 * 0.4;\n\n  if (noiseAmount > 0.0) {\n    float n = noise(coord * 0.01 + iTime * 0.1);\n    fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);\n  }\n\n  float brightness = 1.0 - (coord.y / iResolution.y);\n  fragColor.x *= 0.1 + brightness * 0.8;\n  fragColor.y *= 0.3 + brightness * 0.6;\n  fragColor.z *= 0.5 + brightness * 0.5;\n\n  if (saturation != 1.0) {\n    float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));\n    fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);\n  }\n\n  fragColor.rgb *= raysColor;\n}\n\nvoid main() {\n  vec4 color;\n  mainImage(color, gl_FragCoord.xy);\n  gl_FragColor  = color;\n}`;\n\n      const uniforms: Uniforms = {\n        iTime: { value: 0 },\n        iResolution: { value: [1, 1] },\n\n        rayPos: { value: [0, 0] },\n        rayDir: { value: [0, 1] },\n\n        raysColor: { value: hexToRgb(raysColor) },\n        raysSpeed: { value: raysSpeed },\n        lightSpread: { value: lightSpread },\n        rayLength: { value: rayLength },\n        pulsating: { value: pulsating ? 1.0 : 0.0 },\n        fadeDistance: { value: fadeDistance },\n        saturation: { value: saturation },\n        mousePos: { value: [0.5, 0.5] },\n        mouseInfluence: { value: mouseInfluence },\n        noiseAmount: { value: noiseAmount },\n        distortion: { value: distortion }\n      };\n      uniformsRef.current = uniforms;\n\n      const geometry = new Triangle(gl);\n      const program = new Program(gl, {\n        vertex: vert,\n        fragment: frag,\n        uniforms\n      });\n      const mesh = new Mesh(gl, { geometry, program });\n      meshRef.current = mesh;\n\n      const updatePlacement = () => {\n        if (!containerRef.current || !renderer) return;\n\n        renderer.dpr = Math.min(window.devicePixelRatio, 2);\n\n        const { clientWidth: wCSS, clientHeight: hCSS } = containerRef.current;\n        renderer.setSize(wCSS, hCSS);\n\n        const dpr = renderer.dpr;\n        const w = wCSS * dpr;\n        const h = hCSS * dpr;\n\n        uniforms.iResolution.value = [w, h];\n\n        const { anchor, dir } = getAnchorAndDir(raysOrigin, w, h);\n        uniforms.rayPos.value = anchor;\n        uniforms.rayDir.value = dir;\n      };\n\n      const loop = (t: number) => {\n        if (!rendererRef.current || !uniformsRef.current || !meshRef.current) {\n          return;\n        }\n\n        uniforms.iTime.value = t * 0.001;\n\n        if (followMouse && mouseInfluence > 0.0) {\n          const smoothing = 0.92;\n\n          smoothMouseRef.current.x = smoothMouseRef.current.x * smoothing + mouseRef.current.x * (1 - smoothing);\n          smoothMouseRef.current.y = smoothMouseRef.current.y * smoothing + mouseRef.current.y * (1 - smoothing);\n\n          uniforms.mousePos.value = [smoothMouseRef.current.x, smoothMouseRef.current.y];\n        }\n\n        try {\n          renderer.render({ scene: mesh });\n          animationIdRef.current = requestAnimationFrame(loop);\n        } catch (error) {\n          console.warn('WebGL rendering error:', error);\n          return;\n        }\n      };\n\n      window.addEventListener('resize', updatePlacement);\n      updatePlacement();\n      animationIdRef.current = requestAnimationFrame(loop);\n\n      cleanupFunctionRef.current = () => {\n        if (animationIdRef.current) {\n          cancelAnimationFrame(animationIdRef.current);\n          animationIdRef.current = null;\n        }\n\n        window.removeEventListener('resize', updatePlacement);\n\n        if (renderer) {\n          try {\n            const canvas = renderer.gl.canvas;\n            const loseContextExt = renderer.gl.getExtension('WEBGL_lose_context');\n            if (loseContextExt) {\n              loseContextExt.loseContext();\n            }\n\n            if (canvas && canvas.parentNode) {\n              canvas.parentNode.removeChild(canvas);\n            }\n          } catch (error) {\n            console.warn('Error during WebGL cleanup:', error);\n          }\n        }\n\n        rendererRef.current = null;\n        uniformsRef.current = null;\n        meshRef.current = null;\n      };\n    };\n\n    initializeWebGL();\n\n    return () => {\n      if (cleanupFunctionRef.current) {\n        cleanupFunctionRef.current();\n        cleanupFunctionRef.current = null;\n      }\n    };\n  }, [\n    isVisible,\n    raysOrigin,\n    raysColor,\n    raysSpeed,\n    lightSpread,\n    rayLength,\n    pulsating,\n    fadeDistance,\n    saturation,\n    followMouse,\n    mouseInfluence,\n    noiseAmount,\n    distortion\n  ]);\n\n  useEffect(() => {\n    if (!uniformsRef.current || !containerRef.current || !rendererRef.current) return;\n\n    const u = uniformsRef.current;\n    const renderer = rendererRef.current;\n\n    u.raysColor.value = hexToRgb(raysColor);\n    u.raysSpeed.value = raysSpeed;\n    u.lightSpread.value = lightSpread;\n    u.rayLength.value = rayLength;\n    u.pulsating.value = pulsating ? 1.0 : 0.0;\n    u.fadeDistance.value = fadeDistance;\n    u.saturation.value = saturation;\n    u.mouseInfluence.value = mouseInfluence;\n    u.noiseAmount.value = noiseAmount;\n    u.distortion.value = distortion;\n\n    const { clientWidth: wCSS, clientHeight: hCSS } = containerRef.current;\n    const dpr = renderer.dpr;\n    const { anchor, dir } = getAnchorAndDir(raysOrigin, wCSS * dpr, hCSS * dpr);\n    u.rayPos.value = anchor;\n    u.rayDir.value = dir;\n  }, [\n    raysColor,\n    raysSpeed,\n    lightSpread,\n    raysOrigin,\n    rayLength,\n    pulsating,\n    fadeDistance,\n    saturation,\n    mouseInfluence,\n    noiseAmount,\n    distortion\n  ]);\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!containerRef.current || !rendererRef.current) return;\n      const rect = containerRef.current.getBoundingClientRect();\n      const x = (e.clientX - rect.left) / rect.width;\n      const y = (e.clientY - rect.top) / rect.height;\n      mouseRef.current = { x, y };\n    };\n\n    if (followMouse) {\n      window.addEventListener('mousemove', handleMouseMove);\n      return () => window.removeEventListener('mousemove', handleMouseMove);\n    }\n  }, [followMouse]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={`w-full h-full pointer-events-none z-[3] overflow-hidden relative ${className}`.trim()}\n    />\n  );\n};\n\nexport default LightRays;\n","size_bytes":13133}},"version":2}